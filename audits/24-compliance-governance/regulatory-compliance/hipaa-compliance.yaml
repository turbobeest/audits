audit:
  id: compliance-governance.regulatory-compliance.hipaa-compliance
  name: HIPAA Compliance Audit
  version: 1.0.0
  last_updated: '2025-01-19'
  status: active
  category: compliance-governance
  category_number: 24
  subcategory: regulatory-compliance
  tier: phd
  estimated_duration: 8-16 hours  # median: 12h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: critical
  scope: process
  default_profiles:
  - full
  - security
  - production
  blocks_phase: true
  parallelizable: true
description:
  what: |
    Comprehensive audit of Health Insurance Portability and Accountability Act
    (HIPAA) compliance for covered entities and business associates handling
    Protected Health Information (PHI). Examines Privacy Rule implementation,
    Security Rule technical/administrative/physical safeguards, Breach Notification
    procedures, and Business Associate Agreements. Evaluates encryption (now
    mandatory), access controls, audit logging, risk assessments, workforce
    training, and incident response capabilities against 2025-2026 requirements.
  why_it_matters: |
    HIPAA non-compliance carries severe consequences:
    - Civil penalties: $100-$50,000 per violation, up to $1.5M annually per category
    - Criminal penalties: Up to $250,000 and 10 years imprisonment
    - 2025 enforcement record: 19+ settlements, $8M+ in fines
    - Reputational damage in healthcare sector
    - 2025 updates: Encryption now mandatory (no longer addressable)
    - All previously addressable safeguards now required (MFA, encryption, access controls)
    - OCR audits more frequent and comprehensive
    - Breach notification within 60 days or face additional penalties
  when_to_run:
  - Before handling PHI/ePHI
  - Annual compliance assessment (minimum)
  - After system or process changes affecting PHI
  - Following workforce changes
  - After security incidents or near-misses
  - Prior to Business Associate engagements
  - When implementing AI/ML systems with PHI
prerequisites:
  required_artifacts:
  - type: security_policies
    description: HIPAA Security Rule policies and procedures
    location_hints:
    - compliance/hipaa/policies/
    - docs/security-policies/
    - policies/hipaa/
  - type: risk_assessment
    description: Current HIPAA risk assessment
    location_hints:
    - compliance/hipaa/risk-assessment.xlsx
    - security/risk-analysis/
  - type: baa_inventory
    description: Business Associate Agreement inventory
    location_hints:
    - legal/baa/
    - compliance/business-associates/
    - vendor-agreements/hipaa/
  optional_artifacts:
  - type: training_records
    description: Workforce HIPAA training documentation
    location_hints:
    - hr/training/hipaa/
    - compliance/training-records/
  - type: incident_log
    description: Security incident and breach log
    location_hints:
    - security/incidents/
    - compliance/breach-log/
  - type: audit_logs
    description: System audit log samples
    location_hints:
    - logs/audit/
    - security/audit-logs/
  access_requirements:
  - Access to HIPAA compliance documentation
  - Access to security configuration settings
  - Access to audit log systems
  - Access to encryption configuration
  - Access to access control system
discovery:
  file_patterns:
  - glob: '**/hipaa/**/*'
    purpose: HIPAA-specific compliance documentation
  - glob: '**/phi/**/*'
    purpose: PHI handling documentation
  - glob: '**/baa*.{pdf,docx,md}'
    purpose: Business Associate Agreements
  - glob: '**/encryption*.{yaml,tf,json}'
    purpose: Encryption configuration
  - glob: '**/audit*.{yaml,json,log}'
    purpose: Audit logging configuration
  code_patterns:
  - pattern: phi|protected.?health|medical.?record|patient.?data
    type: regex
    scope: source
    purpose: Identify PHI handling code
  - pattern: encrypt|aes|tls|ssl
    type: regex
    scope: config
    purpose: Identify encryption implementation
  - pattern: audit.?log|access.?log|activity.?log
    type: regex
    scope: source
    purpose: Identify audit logging implementation
  - pattern: hipaa|healthcare|hl7|fhir
    type: regex
    scope: source
    purpose: Identify healthcare-specific code
  documents_to_review:
  - type: HIPAA Policies and Procedures
    purpose: Verify all required policies exist and are current
    analysis_checklist:
    - Access control policy
    - Audit control policy
    - Integrity control policy
    - Transmission security policy
    - Workstation use policy
    - Device and media controls
    - Facility access controls
    - Incident response procedures
    - Contingency plan
    - Business associate management
  - type: Risk Assessment
    purpose: Verify comprehensive risk analysis
    analysis_checklist:
    - All ePHI systems identified
    - Threats and vulnerabilities documented
    - Risk levels assigned
    - Mitigation measures documented
    - Conducted within past 12 months
  - type: Business Associate Agreements
    purpose: Verify BAA compliance
    analysis_checklist:
    - All BAs identified and inventoried
    - BAAs contain required provisions
    - Subcontractor requirements
    - Breach notification terms
knowledge_sources:
  specifications:
  - id: hipaa-security-rule
    name: HIPAA Security Rule (45 CFR Part 164)
    url: https://www.hhs.gov/hipaa/for-professionals/security/index.html
    offline_cache: true
    priority: required
  - id: hipaa-privacy-rule
    name: HIPAA Privacy Rule (45 CFR Part 164)
    url: https://www.hhs.gov/hipaa/for-professionals/privacy/index.html
    offline_cache: true
    priority: required
  - id: hipaa-breach-notification
    name: HIPAA Breach Notification Rule
    url: https://www.hhs.gov/hipaa/for-professionals/breach-notification/index.html
    offline_cache: true
    priority: required
  guides:
  - id: ocr-guidance
    name: HHS OCR HIPAA Guidance
    url: https://www.hhs.gov/hipaa/for-professionals/compliance-enforcement/index.html
    offline_cache: true
    priority: required
  - id: nist-hipaa
    name: NIST HIPAA Security Rule Toolkit
    url: https://csrc.nist.gov/projects/security-content-automation-protocol/hipaa
    offline_cache: true
    priority: recommended
  learning_resources:
  - id: hcca-certification
    title: HCCA Healthcare Compliance Certification
    type: book
    reference: Health Care Compliance Association
tooling:
  assessment_tools:
  - tool: HIPAA Security Rule Checklist
    purpose: Evaluate against 45 CFR 164 requirements
    description: |
      Assess compliance with Security Rule standards:
      - Administrative Safeguards (164.308)
      - Physical Safeguards (164.310)
      - Technical Safeguards (164.312)
      - Organizational Requirements (164.314)
      - Policies and Procedures (164.316)
  scripts:
  - id: encryption-check
    language: bash
    purpose: Verify encryption configuration
    source: inline
    code: |
      #!/bin/bash
      echo "=== HIPAA Encryption Compliance Check ==="

      # Check for encryption configuration
      echo "Searching for encryption configuration..."
      grep -r -l "AES.?256\|aes256\|encrypt" \
        --include="*.yaml" --include="*.tf" --include="*.json" . 2>/dev/null

      # Check for TLS configuration
      echo ""
      echo "Searching for TLS configuration..."
      grep -r -l "TLS.?1\.[23]\|tls1[23]\|ssl" \
        --include="*.yaml" --include="*.tf" --include="*.json" . 2>/dev/null

      # Check for KMS usage
      echo ""
      echo "Searching for KMS/key management..."
      grep -r -l "kms\|key.?management\|encryption.?key" \
        --include="*.tf" --include="*.yaml" . 2>/dev/null
    offline_capable: true
  - id: audit-log-check
    language: bash
    purpose: Verify audit logging configuration
    source: inline
    code: |
      #!/bin/bash
      echo "=== HIPAA Audit Control Check ==="

      # Check for audit logging configuration
      echo "Searching for audit logging..."
      grep -r -l "audit.?log\|cloudtrail\|activity.?log" \
        --include="*.yaml" --include="*.tf" --include="*.json" . 2>/dev/null

      # Check for access logging
      echo ""
      echo "Searching for access logging..."
      grep -r -l "access.?log\|login.?log\|authentication" \
        --include="*.yaml" --include="*.tf" . 2>/dev/null

      # Check for log retention
      echo ""
      echo "Searching for log retention configuration..."
      grep -r -i "retention\|expire\|lifecycle" \
        --include="*.yaml" --include="*.tf" . 2>/dev/null | head -20
    offline_capable: true
  - id: access-control-check
    language: bash
    purpose: Verify access control implementation
    source: inline
    code: |
      #!/bin/bash
      echo "=== HIPAA Access Control Check ==="

      # Check for RBAC/IAM configuration
      echo "Searching for access control configuration..."
      grep -r -l "rbac\|iam\|role\|permission" \
        --include="*.yaml" --include="*.tf" --include="*.json" . 2>/dev/null

      # Check for MFA configuration
      echo ""
      echo "Searching for MFA configuration..."
      grep -r -l "mfa\|multi.?factor\|2fa\|two.?factor" \
        --include="*.yaml" --include="*.tf" . 2>/dev/null

      # Check for session management
      echo ""
      echo "Searching for session/auto-logoff..."
      grep -r -l "session.?timeout\|auto.?log.?off\|idle" \
        --include="*.yaml" --include="*.ts" --include="*.js" . 2>/dev/null
    offline_capable: true
signals:
  critical:
  - id: HIPAA-CRIT-001
    signal: ePHI not encrypted at rest
    evidence_indicators:
    - Database storing PHI without encryption
    - File storage without encryption enabled
    - Encryption configuration missing or disabled
    explanation: |
      As of 2025, encryption is mandatory under HIPAA Security Rule
      (no longer addressable). All ePHI must be encrypted at rest
      using AES-256 or equivalent. Unencrypted ePHI is a direct
      violation subject to maximum penalties.
    remediation: |
      1. Enable AES-256 encryption for all databases containing ePHI
      2. Enable encryption for all file storage (S3, Azure Blob, etc.)
      3. Implement encryption key management
      4. Document encryption standards and key rotation
      5. Verify encryption is active, not just configured
  - id: HIPAA-CRIT-002
    signal: ePHI transmitted without encryption
    evidence_indicators:
    - HTTP (not HTTPS) endpoints handling PHI
    - TLS version below 1.2
    - Unencrypted API calls transmitting PHI
    explanation: |
      Transmission security (164.312(e)(1)) requires encryption
      for ePHI in transit. TLS 1.2 or higher is mandatory.
      Unencrypted transmission is a direct violation.
    remediation: |
      1. Enforce HTTPS on all endpoints handling PHI
      2. Configure TLS 1.2 minimum (prefer TLS 1.3)
      3. Disable weak cipher suites
      4. Implement certificate management
      5. Test transmission security regularly
  - id: HIPAA-CRIT-003
    signal: No risk assessment conducted
    evidence_indicators:
    - Risk assessment older than 12 months
    - No documented risk analysis
    - Risk assessment incomplete
    explanation: |
      Risk Analysis (164.308(a)(1)(ii)(A)) is required and must be
      conducted at least annually. It forms the foundation of all
      other HIPAA safeguards. Missing or outdated risk assessment
      is a common enforcement target.
    remediation: |
      1. Conduct comprehensive risk assessment
      2. Identify all ePHI systems and flows
      3. Document threats, vulnerabilities, and likelihood
      4. Assign risk levels and prioritize mitigation
      5. Update annually and after significant changes
  - id: HIPAA-CRIT-004
    signal: No Business Associate Agreements in place
    evidence_indicators:
    - Vendors with PHI access lacking BAAs
    - BAAs missing required provisions
    - No BAA inventory maintained
    explanation: |
      Business Associate Agreements (164.308(b), 164.314) are
      required for any entity accessing PHI on behalf of covered
      entity. Missing BAAs are common enforcement findings.
    remediation: |
      1. Inventory all vendors with PHI access
      2. Execute BAAs with required provisions
      3. Include breach notification requirements
      4. Address subcontractor requirements
      5. Review and update BAAs regularly
  - id: HIPAA-CRIT-005
    signal: No breach notification procedure
    evidence_indicators:
    - No documented breach response plan
    - No 60-day notification capability
    - No breach risk assessment process
    explanation: |
      Breach Notification Rule requires notification to HHS and
      affected individuals within 60 days. Missing procedures
      result in notification delays and additional penalties.
    remediation: |
      1. Document breach detection procedures
      2. Create breach risk assessment process
      3. Establish 60-day notification workflow
      4. Prepare notification templates
      5. Test procedures through tabletop exercises
  high:
  - id: HIPAA-HIGH-001
    signal: Access controls inadequate
    evidence_indicators:
    - No unique user identification
    - Shared accounts for PHI access
    - No role-based access control
    - MFA not implemented
    explanation: |
      Access Controls (164.312(a)(1)) require unique user IDs,
      emergency access procedures, automatic logoff, and encryption.
      As of 2025, MFA is effectively mandatory (no longer addressable).
    remediation: |
      1. Implement unique user identification
      2. Deploy multi-factor authentication
      3. Implement role-based access control
      4. Configure automatic session timeout
      5. Document emergency access procedures
  - id: HIPAA-HIGH-002
    signal: Audit controls inadequate
    evidence_indicators:
    - No audit logging for PHI access
    - Logs not retained for 6 years
    - No regular log review process
    explanation: |
      Audit Controls (164.312(b)) require mechanisms to record
      and examine activity in systems with ePHI. Documentation
      must be retained for 6 years minimum.
    remediation: |
      1. Implement comprehensive audit logging
      2. Log all access to ePHI systems
      3. Configure 6-year retention
      4. Establish regular log review process
      5. Alert on anomalous access patterns
  - id: HIPAA-HIGH-003
    signal: Integrity controls inadequate
    evidence_indicators:
    - No mechanism to detect PHI alteration
    - No integrity verification
    - Missing change detection
    explanation: |
      Integrity (164.312(c)(1)) requires mechanisms to ensure
      ePHI is not improperly altered or destroyed.
    remediation: |
      1. Implement integrity verification mechanisms
      2. Enable database audit logging
      3. Implement file integrity monitoring
      4. Configure change detection alerts
      5. Regular integrity audits
  - id: HIPAA-HIGH-004
    signal: Workforce training inadequate
    evidence_indicators:
    - No documented HIPAA training
    - Training not conducted within 12 months
    - No role-specific training
    explanation: |
      Security Awareness Training (164.308(a)(5)) requires ongoing
      training for all workforce members. 2025 guidance recommends
      quarterly sessions on emerging threats.
    remediation: |
      1. Implement comprehensive HIPAA training
      2. Conduct quarterly security awareness sessions
      3. Include phishing and social engineering
      4. Document all training with attestation
      5. Role-specific training for PHI handlers
  - id: HIPAA-HIGH-005
    signal: Contingency plan inadequate
    evidence_indicators:
    - No disaster recovery plan
    - No data backup procedures
    - No emergency mode operation plan
    - Backups not tested
    explanation: |
      Contingency Plan (164.308(a)(7)) requires data backup,
      disaster recovery, and emergency mode operation plans.
    remediation: |
      1. Create comprehensive contingency plan
      2. Implement regular backup procedures
      3. Document disaster recovery process
      4. Test backups and recovery regularly
      5. Plan for emergency mode operation
  medium:
  - id: HIPAA-MED-001
    signal: Policies and procedures not documented
    evidence_indicators:
    - Required policies missing
    - Policies not reviewed within 12 months
    - Procedures not detailed enough
    explanation: |
      Policies and Procedures (164.316) must be documented,
      maintained, and available for 6 years.
    remediation: |
      1. Document all required policies
      2. Establish annual review cycle
      3. Maintain version history
      4. Ensure 6-year retention
      5. Make policies accessible to workforce
  - id: HIPAA-MED-002
    signal: Physical safeguards inadequate
    evidence_indicators:
    - No facility access controls
    - Workstation security lacking
    - Device and media controls missing
    explanation: |
      Physical Safeguards (164.310) require facility access controls,
      workstation use and security policies, and device/media controls.
    remediation: |
      1. Implement facility access controls
      2. Document workstation security policy
      3. Establish device and media controls
      4. Control physical access to ePHI systems
      5. Secure removal and disposal procedures
  - id: HIPAA-MED-003
    signal: Incident response inadequate
    evidence_indicators:
    - No incident response procedures
    - Incidents not documented
    - No lessons learned process
    explanation: |
      Security Incident Procedures (164.308(a)(6)) require
      identifying, responding to, and mitigating security incidents.
    remediation: |
      1. Document incident response procedures
      2. Establish incident classification
      3. Create incident logging process
      4. Conduct post-incident reviews
      5. Update safeguards based on lessons learned
  low:
  - id: HIPAA-LOW-001
    signal: Minimum necessary not applied
    evidence_indicators:
    - Broad access to PHI without need
    - No minimum necessary policies
    remediation: |
      Implement minimum necessary policies limiting PHI access
      to only what is needed for specific purposes.
  - id: HIPAA-LOW-002
    signal: Designated security official not documented
    evidence_indicators:
    - No designated Security Official
    - Responsibilities not documented
    remediation: |
      Designate and document Security Official responsible
      for security policy development and implementation.
  positive:
  - id: HIPAA-POS-001
    signal: Comprehensive encryption implementation
    evidence_indicators:
    - AES-256 encryption at rest
    - TLS 1.2+ in transit
    - Key management documented
  - id: HIPAA-POS-002
    signal: Regular security assessments
    evidence_indicators:
    - Annual risk assessment current
    - Vulnerability scanning regular
    - Penetration testing conducted
  - id: HIPAA-POS-003
    signal: Comprehensive audit logging
    evidence_indicators:
    - All ePHI access logged
    - 6-year retention configured
    - Regular log review documented
procedure:
  context:
    cognitive_mode: critical
    ensemble_role: auditor
  preparation:
  - step: Determine if organization is covered entity or business associate
  - step: Gather HIPAA compliance documentation
  - step: Identify systems processing ePHI
  - step: Review previous audit findings
  steps:
  - id: '1'
    name: Review Risk Assessment
    description: |
      Evaluate the current risk assessment for completeness,
      currency, and comprehensiveness.
    duration_estimate: 1-2 hours
    questions:
    - Is risk assessment within 12 months?
    - Are all ePHI systems included?
    - Are threats and vulnerabilities documented?
    - Are risk levels and mitigations documented?
    expected_findings:
    - Risk assessment currency
    - Scope completeness
    - Gap identification
  - id: '2'
    name: Assess Technical Safeguards
    description: |
      Evaluate encryption, access controls, audit controls,
      integrity controls, and transmission security.
    duration_estimate: 2-3 hours
    commands:
    - purpose: Check encryption configuration
      command: grep -r 'encrypt\|aes\|tls' --include='*.yaml' --include='*.tf' .
    - purpose: Check access control configuration
      command: grep -r 'rbac\|iam\|mfa' --include='*.yaml' --include='*.tf' .
    expected_findings:
    - Encryption implementation status
    - Access control maturity
    - Audit logging completeness
  - id: '3'
    name: Review Administrative Safeguards
    description: |
      Assess security management process, workforce security,
      information access management, security training,
      and contingency planning.
    duration_estimate: 2-3 hours
    questions:
    - Are required policies documented?
    - Is workforce training current?
    - Is contingency plan tested?
    - Are security incidents logged?
    expected_findings:
    - Policy completeness
    - Training currency
    - Contingency readiness
  - id: '4'
    name: Evaluate Physical Safeguards
    description: |
      Review facility access controls, workstation security,
      and device/media controls.
    duration_estimate: 1-2 hours
    questions:
    - Are facility access controls in place?
    - Is workstation security documented?
    - Are device disposal procedures documented?
    expected_findings:
    - Physical security status
    - Workstation policy completeness
  - id: '5'
    name: Review Business Associate Management
    description: |
      Verify all business associates are identified and have
      compliant BAAs in place.
    duration_estimate: 1-2 hours
    questions:
    - Are all BAs inventoried?
    - Do BAAs contain required provisions?
    - Is BA compliance monitored?
    expected_findings:
    - BA inventory completeness
    - BAA compliance status
  - id: '6'
    name: Assess Breach Notification Readiness
    description: |
      Evaluate breach detection, risk assessment, and
      notification procedures.
    duration_estimate: 1 hour
    questions:
    - Can breaches be detected timely?
    - Is 60-day notification achievable?
    - Are notification procedures documented?
    expected_findings:
    - Breach response capability
    - Notification readiness
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: compliance_matrix
    format: table
    description: HIPAA Security Rule safeguards compliance
    columns:
    - Safeguard
    - Standard
    - Implementation Specification
    - Status
    - Evidence
    - Gap
    - Remediation
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Critical Findings
    - Technical Safeguards Assessment
    - Administrative Safeguards Assessment
    - Physical Safeguards Assessment
    - Business Associate Compliance
    - Prioritized Remediation Plan
  confidence_guidance:
    high: Configuration reviewed and verified
    medium: Documentation reviewed, limited verification
    low: Based on interviews or incomplete documentation
offline:
  capability: partial
  cache_manifest:
    knowledge:
    - source_id: hipaa-security-rule
      priority: required
    - source_id: hipaa-privacy-rule
      priority: required
    - source_id: ocr-guidance
      priority: required
  degradation:
  - feature: Live system encryption verification
    impact: Cannot verify encryption is active
    mitigation: Review configuration and test results offline
profiles:
  membership:
    quick:
      included: false
      reason: Comprehensive assessment required
    security:
      included: true
      priority: 3
    production:
      included: true
      priority: 5
    full:
      included: true
      priority: 2
closeout_checklist:
- id: hipaa-001
  item: Risk assessment current and comprehensive
  level: CRITICAL
  verification: manual
  verification_notes: Risk assessment conducted within 12 months covering all ePHI systems
  expected: Confirmed by reviewer
- id: hipaa-002
  item: ePHI encrypted at rest with AES-256
  level: CRITICAL
  verification: manual
  verification_notes: All databases and storage with ePHI have encryption enabled and verified
  expected: Confirmed by reviewer
- id: hipaa-003
  item: ePHI encrypted in transit with TLS 1.2+
  level: CRITICAL
  verification: manual
  verification_notes: All transmission of ePHI uses TLS 1.2 or higher
  expected: Confirmed by reviewer
- id: hipaa-004
  item: Access controls with MFA implemented
  level: CRITICAL
  verification: manual
  verification_notes: Unique user IDs, RBAC, and MFA in place for ePHI systems
  expected: Confirmed by reviewer
- id: hipaa-005
  item: Audit logging comprehensive with 6-year retention
  level: BLOCKING
  verification: manual
  verification_notes: All ePHI access logged with 6-year retention configured
  expected: Confirmed by reviewer
- id: hipaa-006
  item: Business Associate Agreements in place
  level: CRITICAL
  verification: manual
  verification_notes: All vendors with PHI access have compliant BAAs
  expected: Confirmed by reviewer
- id: hipaa-007
  item: Breach notification procedure documented
  level: BLOCKING
  verification: manual
  verification_notes: 60-day notification capability demonstrated
  expected: Confirmed by reviewer
- id: hipaa-008
  item: Workforce HIPAA training current
  level: BLOCKING
  verification: manual
  verification_notes: All workforce trained within 12 months with documentation
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - healthcare
    - health-tech
    - business-associate
    maturity:
    - growing
    - mature
    industry_scope:
    - healthcare
    - insurance
    - clearinghouse
  compliance_frameworks:
  - framework: HIPAA
    controls:
    - Security Rule
    - Privacy Rule
    - Breach Notification Rule
  - framework: HITECH
    controls:
    - All
  - framework: SOC2
    controls:
    - CC6.1
    - CC6.6
    - CC6.7
  - framework: NIST CSF
    controls:
    - PR.AC
    - PR.DS
    - PR.IP
    - DE.AE
    - RS.RP
relationships:
  commonly_combined:
  - compliance-governance.regulatory-compliance.industry-specific-regulation
  - compliance-governance.audit-trails.audit-log-completeness
  - compliance-governance.third-party-compliance.vendor-compliance
  - security-trust.data-security.encryption-implementation
  - security-trust.access-control.authentication-mechanisms
