audit:
  id: compliance-governance.regulatory-compliance.ccpa-cpra-compliance
  name: CCPA/CPRA Compliance Audit
  version: 1.0.0
  last_updated: '2025-01-19'
  status: active
  category: compliance-governance
  category_number: 24
  subcategory: regulatory-compliance
  tier: phd
  estimated_duration: 6-12 hours  # median: 9h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: critical
  scope: process
  default_profiles:
  - full
  - security
  - production
  blocks_phase: true
  parallelizable: true
description:
  what: |
    Comprehensive audit of California Consumer Privacy Act (CCPA) and California
    Privacy Rights Act (CPRA) compliance for businesses processing personal
    information of California residents. Examines consumer rights implementation,
    privacy notice requirements, opt-out mechanisms including Global Privacy
    Control (GPC) support, service provider contracts, data minimization practices,
    risk assessments, and cybersecurity audit readiness per 2026 regulations.
    Includes evaluation of Automated Decision-Making Technology (ADMT) requirements.
  why_it_matters: |
    CCPA/CPRA non-compliance carries significant consequences:
    - Civil penalties up to $2,500 per violation, $7,500 for intentional violations
    - CPPA enforcement sweeps actively targeting GPC compliance
    - Private right of action for data breaches ($100-$750 per consumer per incident)
    - New 2026 regulations mandate cybersecurity audits and risk assessments
    - Reputational damage in California's massive consumer market
    - Businesses meeting thresholds: $26.625M revenue, 100K+ consumers, or 50%+ revenue from data
    - ADMT requirements effective January 2027 require infrastructure changes now
  when_to_run:
  - Before collecting California consumer data
  - Annual compliance assessment
  - Prior to selling or sharing personal information
  - When implementing automated decision-making systems
  - Before cybersecurity audit deadlines (phased 2028-2030)
  - When revenue or data volume thresholds may be met
prerequisites:
  required_artifacts:
  - type: privacy_policy
    description: California-specific privacy notice/policy
    location_hints:
    - legal/privacy-policy-california.md
    - docs/ccpa-privacy-notice.html
    - legal/privacy-policy.md
  - type: data_inventory
    description: Inventory of personal information collected
    location_hints:
    - compliance/data-inventory.csv
    - privacy/data-mapping.xlsx
  - type: service_provider_contracts
    description: Contracts with service providers/contractors
    location_hints:
    - legal/vendor-contracts/
    - compliance/service-provider-agreements/
  optional_artifacts:
  - type: risk_assessments
    description: Privacy risk assessments for processing activities
    location_hints:
    - compliance/risk-assessments/
    - privacy/pra/
  - type: cybersecurity_documentation
    description: Cybersecurity program documentation for audit
    location_hints:
    - security/policies/
    - compliance/cybersecurity/
  - type: admt_documentation
    description: Automated decision-making technology documentation
    location_hints:
    - docs/ai-ml/
    - compliance/admt/
  access_requirements:
  - Access to privacy policy and compliance documentation
  - Access to service provider agreements
  - Access to data flow documentation
  - Access to opt-out mechanism implementation
  - Access to DSAR fulfillment systems
discovery:
  file_patterns:
  - glob: '**/privacy*.{md,html,txt,yaml}'
    purpose: Privacy policy and notices
  - glob: '**/ccpa/**/*'
    purpose: CCPA-specific compliance documentation
  - glob: '**/cpra/**/*'
    purpose: CPRA-specific documentation
  - glob: '**/opt-out*.{js,ts,yaml}'
    purpose: Opt-out mechanism implementation
  - glob: '**/consent*.{yaml,json,ts,js}'
    purpose: Consent management configuration
  code_patterns:
  - pattern: do.?not.?sell|opt.?out|gpc|global.?privacy.?control
    type: regex
    scope: source
    purpose: Identify opt-out mechanism implementation
  - pattern: california|ccpa|cpra
    type: regex
    scope: source
    purpose: Identify California-specific privacy code
  - pattern: personal.?info|sensitive.?personal
    type: regex
    scope: source
    purpose: Identify personal information handling
  - pattern: delete.*request|access.*request|dsar
    type: regex
    scope: source
    purpose: Consumer rights request handling
  documents_to_review:
  - type: Privacy Policy
    purpose: Verify California-specific disclosures
    analysis_checklist:
    - Categories of personal information collected
    - Sources of personal information
    - Business/commercial purposes for collection
    - Categories of third parties with whom PI is shared
    - Consumer rights description
    - Do Not Sell/Share link prominence
    - Financial incentive disclosures
    - 12-month lookback disclosure
  - type: Service Provider Agreements
    purpose: Verify CCPA contract requirements
    analysis_checklist:
    - Prohibition on selling/sharing received PI
    - Processing only for business purpose
    - Compliance certification
    - Subcontractor flow-down
    - Right to audit
  - type: Risk Assessments
    purpose: Verify risk assessment compliance (2026 requirement)
    analysis_checklist:
    - Purpose documentation
    - Categories of data processed
    - Benefits and risks analysis
    - Mitigation measures
    - Review date (every 3 years)
knowledge_sources:
  specifications:
  - id: ccpa-statute
    name: California Consumer Privacy Act (Civil Code 1798.100-199)
    url: https://leginfo.legislature.ca.gov/faces/codes_displayText.xhtml?division=3.&part=4.&lawCode=CIV&title=1.81.5
    offline_cache: true
    priority: required
  - id: cpra-regulations
    name: CPRA Final Regulations (2026)
    url: https://cppa.ca.gov/regulations/
    offline_cache: true
    priority: required
  guides:
  - id: cppa-guidance
    name: CPPA Official Guidance and FAQs
    url: https://cppa.ca.gov/faq.html
    offline_cache: true
    priority: required
  - id: oag-ccpa-guidance
    name: California OAG CCPA Guidance
    url: https://oag.ca.gov/privacy/ccpa
    offline_cache: true
    priority: recommended
  learning_resources:
  - id: iapp-us-privacy
    title: IAPP CIPP/US Certification Guide
    type: book
    reference: International Association of Privacy Professionals
tooling:
  assessment_tools:
  - tool: CCPA/CPRA Compliance Checklist
    purpose: Structured evaluation against statutory requirements
    description: |
      Evaluate organization against key CCPA/CPRA requirements:
      - Consumer rights (1798.100-125)
      - Privacy notice requirements (1798.100)
      - Opt-out rights (1798.120, 1798.135)
      - Service provider obligations (1798.140)
      - Risk assessment requirements (2026 regulations)
      - Cybersecurity audit requirements (2026 regulations)
      - ADMT requirements (2027 effective)
  scripts:
  - id: gpc-detection-check
    language: bash
    purpose: Check for Global Privacy Control implementation
    source: inline
    code: |
      #!/bin/bash
      echo "=== Global Privacy Control Implementation Check ==="

      # Look for GPC detection code
      echo "Searching for GPC detection..."
      grep -r -l "globalPrivacyControl\|navigator.globalPrivacyControl\|Sec-GPC" \
        --include="*.ts" --include="*.js" --include="*.tsx" . 2>/dev/null

      # Look for GPC header handling
      echo ""
      echo "Searching for GPC header handling..."
      grep -r -l "sec-gpc\|Sec-GPC" \
        --include="*.ts" --include="*.js" --include="*.py" --include="*.go" . 2>/dev/null

      # Look for opt-out preference handling
      echo ""
      echo "Searching for opt-out preference storage..."
      grep -r -l "doNotSell\|do_not_sell\|optOut\|opt_out" \
        --include="*.ts" --include="*.js" . 2>/dev/null
    offline_capable: true
  - id: ccpa-links-check
    language: bash
    purpose: Check for required CCPA links
    source: inline
    code: |
      #!/bin/bash
      echo "=== CCPA Required Links Check ==="

      # Look for Do Not Sell/Share link
      echo "Searching for 'Do Not Sell/Share' link..."
      grep -r -i "do.?not.?sell\|do.?not.?share" \
        --include="*.html" --include="*.tsx" --include="*.jsx" . 2>/dev/null | head -20

      # Look for privacy policy link
      echo ""
      echo "Searching for privacy links..."
      grep -r -i "privacy.?policy\|california.?privacy\|your.?privacy.?choices" \
        --include="*.html" --include="*.tsx" --include="*.jsx" . 2>/dev/null | head -20
    offline_capable: true
  - id: pi-categories-scan
    language: bash
    purpose: Scan for CCPA personal information categories
    source: inline
    code: |
      #!/bin/bash
      echo "=== CCPA Personal Information Categories Scan ==="
      echo "Searching for personal information category handling..."

      categories=(
        "identifier|real.?name|alias|postal.?address|email"
        "ssn|social.?security|driver.?license|passport"
        "bank.?account|credit.?card|financial"
        "biometric"
        "internet.?activity|browsing|search.?history"
        "geolocation|gps|location"
        "audio|visual|thermal|olfactory"
        "employment|professional"
        "education"
        "inference|profile"
        "sensitive.?personal"
      )

      for cat in "${categories[@]}"; do
        echo ""
        echo "--- Category pattern: $cat ---"
        grep -r -l -i "$cat" --include="*.ts" --include="*.js" --include="*.py" . 2>/dev/null | head -10
      done
    offline_capable: true
signals:
  critical:
  - id: CCPA-CRIT-001
    signal: No 'Do Not Sell or Share' mechanism implemented
    evidence_indicators:
    - No Do Not Sell/Share link on website
    - No opt-out mechanism for data sales/sharing
    - GPC signals not detected or honored
    explanation: |
      CCPA Section 1798.120 and 1798.135 require clear opt-out mechanism
      for selling/sharing personal information. The 2026 regulations require
      visible confirmation that opt-out requests including GPC have been
      processed. CPPA enforcement sweeps actively target GPC compliance.
    remediation: |
      1. Add prominent "Do Not Sell or Share My Personal Information" link
      2. Implement GPC signal detection (navigator.globalPrivacyControl, Sec-GPC header)
      3. Build opt-out preference storage and propagation
      4. Provide visible confirmation of opt-out processing
      5. Honor GPC signals without requiring additional action
  - id: CCPA-CRIT-002
    signal: Privacy notice missing required California disclosures
    evidence_indicators:
    - No California-specific privacy notice section
    - Missing categories of PI collected
    - Missing purpose disclosures
    - No 12-month lookback disclosure
    explanation: |
      CCPA Section 1798.100 requires specific disclosures including
      categories of PI collected, sources, purposes, third parties,
      and 12-month historical collection data. Deficient notice
      undermines all downstream compliance.
    remediation: |
      1. Create California-specific privacy notice section
      2. List all categories of PI collected per CCPA definitions
      3. Disclose all sources of PI
      4. Document business/commercial purposes
      5. List categories of third parties receiving PI
      6. Add 12-month lookback for categories collected, sold, disclosed
  - id: CCPA-CRIT-003
    signal: Consumer rights requests not handled within statutory timeframes
    evidence_indicators:
    - No DSAR intake mechanism
    - No process for 45-day response (extendable to 90)
    - Access requests not verified within 10 business days
    - No process for handling appeals
    explanation: |
      CCPA requires response to consumer requests within 45 days
      (extendable to 90 with notice). Failure to respond or
      systematic delays triggers enforcement action.
    remediation: |
      1. Implement DSAR intake (web form, email, toll-free number)
      2. Build workflow for 45-day SLA tracking
      3. Implement verification procedures
      4. Create response templates for each right type
      5. Document process for handling appeals
  - id: CCPA-CRIT-004
    signal: Service provider contracts missing CCPA requirements
    evidence_indicators:
    - Contracts lack prohibition on selling/sharing received PI
    - No certification of CCPA compliance
    - Processing purpose not limited in contract
    - No subcontractor flow-down provisions
    explanation: |
      CCPA Section 1798.140 requires specific contract terms for
      service providers. Without proper contracts, data disclosures
      may be classified as "sales" triggering opt-out obligations.
    remediation: |
      1. Audit all vendor contracts processing California PI
      2. Add CCPA-required provisions to all agreements
      3. Require service provider certification
      4. Include audit rights and breach notification
      5. Mandate subcontractor compliance
  high:
  - id: CCPA-HIGH-001
    signal: Risk assessments not conducted for covered activities
    evidence_indicators:
    - Selling/sharing PI without risk assessment
    - Processing sensitive PI without assessment
    - Using ADMT without documented assessment
    - No risk assessment documentation
    explanation: |
      2026 regulations require risk assessments before processing
      that presents significant privacy risks. Assessments must be
      completed before processing begins and updated every 3 years.
      Attestations due to CPPA by April 1, 2028.
    remediation: |
      1. Identify all processing requiring risk assessment
      2. Document purpose, data categories, operational elements
      3. Analyze benefits, risks, and mitigation measures
      4. Establish 3-year review cycle
      5. Prepare attestation for CPPA submission
  - id: CCPA-HIGH-002
    signal: No preparation for cybersecurity audit requirement
    evidence_indicators:
    - No cybersecurity program documentation
    - Security measures not mapped to audit requirements
    - No independent audit capability
    explanation: |
      Businesses meeting thresholds must conduct annual cybersecurity
      audits. Audits must cover 18-item CPPA checklist aligned with
      NIST CSF 2.0. Phased deadlines: April 2028 (>$100M revenue),
      April 2029 ($50-100M), April 2030 (others).
    remediation: |
      1. Document cybersecurity program against CPPA 18-item list
      2. Align security controls with NIST CSF 2.0
      3. Establish independent audit capability (internal or external)
      4. Begin evidence collection for audit
      5. Schedule audit based on revenue threshold deadline
  - id: CCPA-HIGH-003
    signal: ADMT processing without required safeguards
    evidence_indicators:
    - Automated decisions affecting employment/credit/housing
    - No pre-use notice to consumers
    - No opt-out mechanism for ADMT
    - No appeal process for ADMT decisions
    explanation: |
      ADMT requirements effective January 2027 require pre-use notices,
      opt-out rights, and appeal processes for automated decisions with
      significant effects. Infrastructure changes needed now.
    remediation: |
      1. Inventory all ADMT usage and decision categories
      2. Implement pre-use notice mechanisms
      3. Build opt-out request processing
      4. Create appeal process with human review
      5. Document logic and data used in ADMT
  - id: CCPA-HIGH-004
    signal: Dark patterns in consent/opt-out flows
    evidence_indicators:
    - Consent inferred from closing banner
    - More clicks required to opt-out than opt-in
    - Confusing language in privacy choices
    - Pre-selected consent options
    explanation: |
      2026 regulations explicitly prohibit dark patterns. Closing
      consent banners without affirmative acceptance cannot constitute
      consent. Enforcement specifically targeting manipulative UI.
    remediation: |
      1. Audit all consent and opt-out flows
      2. Remove navigation-away-equals-consent patterns
      3. Ensure equal prominence for opt-out and opt-in
      4. Use clear, plain language
      5. Remove pre-selected options
  medium:
  - id: CCPA-MED-001
    signal: Sensitive personal information collection without additional safeguards
    evidence_indicators:
    - Collecting SSN, financial, health, or precise geolocation
    - No separate consent for sensitive PI
    - No purpose limitation for sensitive PI
    explanation: |
      CPRA adds special requirements for sensitive personal information
      including right to limit use and disclosure. Higher scrutiny
      in enforcement.
    remediation: |
      1. Inventory all sensitive PI processing
      2. Implement purpose limitation
      3. Provide "Limit Use of Sensitive PI" mechanism
      4. Minimize sensitive PI collection
  - id: CCPA-MED-002
    signal: Data retention periods not documented
    evidence_indicators:
    - No retention schedule
    - PI retained indefinitely
    - No automated deletion
    explanation: |
      CPRA requires disclosure of retention periods and prohibits
      retention longer than necessary. Undefined retention is
      compliance risk.
    remediation: |
      1. Define retention periods by PI category
      2. Disclose in privacy notice
      3. Implement automated deletion
      4. Regular retention audits
  - id: CCPA-MED-003
    signal: Consumer request audit trail incomplete
    evidence_indicators:
    - Request receipt dates not logged
    - Verification methods not documented
    - Response dates not tracked
    explanation: |
      Regulations require maintaining audit trails for consumer
      requests to demonstrate compliance during investigations.
    remediation: |
      1. Log all request intake with timestamps
      2. Document verification methods used
      3. Track response dates and extensions
      4. Maintain records for 24+ months
  low:
  - id: CCPA-LOW-001
    signal: Employee training not documented
    evidence_indicators:
    - No CCPA training records
    - Customer-facing staff not trained on rights
    remediation: |
      Implement documented CCPA training for relevant personnel.
  - id: CCPA-LOW-002
    signal: Financial incentive programs not disclosed
    evidence_indicators:
    - Loyalty programs not described in privacy notice
    - No opt-in mechanism for incentive programs
    remediation: |
      Disclose financial incentives and obtain opt-in consent.
  positive:
  - id: CCPA-POS-001
    signal: GPC signals fully honored
    evidence_indicators:
    - GPC detection implemented
    - Opt-out applied without additional friction
    - Confirmation displayed to users
  - id: CCPA-POS-002
    signal: Automated DSAR fulfillment
    evidence_indicators:
    - Self-service data access portal
    - Automated deletion capability
    - Sub-45-day average response time
  - id: CCPA-POS-003
    signal: Risk assessments comprehensive and current
    evidence_indicators:
    - All covered processing assessed
    - Within 3-year review cycle
    - Attestation ready for CPPA
procedure:
  context:
    cognitive_mode: critical
    ensemble_role: auditor
  preparation:
  - step: Determine if business meets CCPA thresholds
  - step: Gather privacy policy and compliance documentation
  - step: Inventory service provider relationships
  - step: Review previous enforcement actions in industry
  steps:
  - id: '1'
    name: Assess Applicability and Scope
    description: |
      Determine if business meets CCPA thresholds and scope
      of California consumer data processing.
    duration_estimate: 30-60 minutes
    questions:
    - Does annual revenue exceed $26.625M?
    - Is 50%+ revenue from selling/sharing PI?
    - Are 100K+ California consumers processed?
    - What categories of California PI are collected?
    expected_findings:
    - Applicability determination
    - Scope of California consumer data
  - id: '2'
    name: Review Privacy Notice
    description: |
      Evaluate California-specific privacy disclosures
      against statutory requirements.
    duration_estimate: 1-2 hours
    questions:
    - Are all required disclosures present?
    - Is 12-month lookback provided?
    - Are categories per CCPA definitions?
    - Is Do Not Sell/Share link prominent?
    expected_findings:
    - Privacy notice gaps
    - Disclosure completeness
  - id: '3'
    name: Test Opt-Out Mechanisms
    description: |
      Verify Do Not Sell/Share and GPC implementation
      meets regulatory requirements.
    duration_estimate: 1-2 hours
    commands:
    - purpose: Check for GPC implementation
      command: grep -r 'globalPrivacyControl\|Sec-GPC' --include='*.ts' --include='*.js' .
    - purpose: Check for opt-out links
      command: grep -r -i 'do.?not.?sell' --include='*.html' --include='*.tsx' .
    expected_findings:
    - GPC implementation status
    - Opt-out mechanism functionality
  - id: '4'
    name: Evaluate Consumer Rights Processes
    description: |
      Assess DSAR intake, verification, and fulfillment
      capabilities and SLA tracking.
    duration_estimate: 1-2 hours
    questions:
    - What intake methods are available?
    - How is identity verified?
    - Can 45-day SLA be met?
    - Is appeal process documented?
    expected_findings:
    - Consumer rights process maturity
    - SLA compliance capability
  - id: '5'
    name: Review Service Provider Contracts
    description: |
      Verify contracts with service providers include
      CCPA-required provisions.
    duration_estimate: 2-3 hours
    questions:
    - Do contracts prohibit selling/sharing received PI?
    - Is processing limited to contracted purpose?
    - Are audit rights included?
    - Do subcontractors flow down requirements?
    expected_findings:
    - Contract compliance gaps
    - Vendor remediation needs
  - id: '6'
    name: Assess Risk Assessment Readiness
    description: |
      Evaluate preparation for 2026 risk assessment requirements
      and attestation deadlines.
    duration_estimate: 1-2 hours
    questions:
    - What processing requires risk assessment?
    - Are assessments documented?
    - When is 3-year review due?
    - Is attestation process planned?
    expected_findings:
    - Risk assessment gaps
    - Attestation readiness
  - id: '7'
    name: Evaluate Cybersecurity Audit Readiness
    description: |
      Assess preparation for cybersecurity audit requirements
      based on applicable deadline tier.
    duration_estimate: 1-2 hours
    questions:
    - Is cybersecurity program documented?
    - Can 18-item checklist be evidenced?
    - Is independent audit capability established?
    - Is NIST CSF 2.0 alignment assessed?
    expected_findings:
    - Cybersecurity audit readiness
    - Evidence collection gaps
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: compliance_matrix
    format: table
    description: CCPA/CPRA requirement compliance mapping
    columns:
    - Requirement
    - Statutory Reference
    - Compliance Status
    - Evidence
    - Gap Description
    - Remediation
    - Deadline
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Applicability Assessment
    - Critical Findings
    - Consumer Rights Assessment
    - Vendor Compliance Status
    - 2026+ Regulation Readiness
    - Prioritized Remediation Plan
  confidence_guidance:
    high: Documentation reviewed and implementation verified
    medium: Documentation reviewed, limited implementation testing
    low: Based on interviews or incomplete documentation
offline:
  capability: partial
  cache_manifest:
    knowledge:
    - source_id: ccpa-statute
      priority: required
    - source_id: cpra-regulations
      priority: required
    - source_id: cppa-guidance
      priority: required
  degradation:
  - feature: GPC signal testing
    impact: Cannot verify live GPC handling
    mitigation: Review code implementation offline
profiles:
  membership:
    quick:
      included: false
      reason: Comprehensive review requires full assessment
    security:
      included: true
      priority: 8
    production:
      included: true
      priority: 5
    full:
      included: true
      priority: 2
closeout_checklist:
- id: ccpa-001
  item: Privacy notice contains all required California disclosures
  level: CRITICAL
  verification: manual
  verification_notes: Reviewer confirms all CCPA 1798.100 disclosures present including 12-month lookback
  expected: Confirmed by reviewer
- id: ccpa-002
  item: Do Not Sell/Share mechanism implemented and functional
  level: CRITICAL
  verification: manual
  verification_notes: Link visible, opt-out processed, GPC honored with confirmation
  expected: Confirmed by reviewer
- id: ccpa-003
  item: Consumer rights request process operational
  level: CRITICAL
  verification: manual
  verification_notes: DSAR intake exists, 45-day SLA tracked, verification process documented
  expected: Confirmed by reviewer
- id: ccpa-004
  item: Service provider contracts include required CCPA provisions
  level: BLOCKING
  verification: manual
  verification_notes: All vendors processing California PI have compliant contracts
  expected: Confirmed by reviewer
- id: ccpa-005
  item: Risk assessments conducted for covered processing
  level: BLOCKING
  verification: manual
  verification_notes: Assessments exist for selling/sharing, sensitive PI, ADMT processing
  expected: Confirmed by reviewer
- id: ccpa-006
  item: Cybersecurity audit preparation underway
  level: WARNING
  verification: manual
  verification_notes: Program documented, evidence collection started, audit timeline established
  expected: Confirmed by reviewer
- id: ccpa-007
  item: No dark patterns in consent/opt-out flows
  level: BLOCKING
  verification: manual
  verification_notes: No banner close = consent, equal prominence for opt-out
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
    maturity:
    - growing
    - mature
    geographic_scope:
    - US
    - California
    - global
    thresholds:
    - $26.625M+ annual revenue
    - 100K+ California consumers
    - 50%+ revenue from data sales/sharing
  compliance_frameworks:
  - framework: CCPA
    controls:
    - 1798.100-199
  - framework: CPRA
    controls:
    - All Regulations
  - framework: SOC2
    controls:
    - CC5.1
    - CC5.2
    - P1-P8
  - framework: NIST CSF
    controls:
    - 2.0 Full Framework
relationships:
  commonly_combined:
  - compliance-governance.data-privacy.privacy-policy-accuracy
  - compliance-governance.data-privacy.consent-management
  - compliance-governance.third-party-compliance.vendor-compliance
  - compliance-governance.certifications-attestations.soc2-readiness
  - security-trust.data-security.encryption-implementation
