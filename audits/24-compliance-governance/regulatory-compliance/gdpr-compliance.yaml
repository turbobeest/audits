audit:
  id: compliance-governance.regulatory-compliance.gdpr-compliance
  name: GDPR Compliance Audit
  version: 1.0.0
  last_updated: '2025-01-19'
  status: active
  category: compliance-governance
  category_number: 24
  subcategory: regulatory-compliance
  tier: phd
  estimated_duration: 8-16 hours  # median: 12h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: critical
  scope: process
  default_profiles:
  - full
  - security
  - production
  blocks_phase: true
  parallelizable: true
description:
  what: |
    Comprehensive audit of General Data Protection Regulation (GDPR) compliance
    for systems processing personal data of EU/EEA residents. Examines technical
    controls, organizational measures, data subject rights implementation,
    lawful basis documentation, privacy by design implementation, and cross-border
    transfer mechanisms. Reviews records of processing activities (Article 30),
    Data Protection Impact Assessments (DPIAs), breach notification procedures,
    and consent management mechanisms.
  why_it_matters: |
    GDPR non-compliance carries severe consequences:
    - Fines up to 4% of global annual turnover or EUR 20 million (whichever higher)
    - Cumulative GDPR fines since 2018 exceed EUR 5.88 billion across 2,245 penalties
    - Reputational damage and loss of customer trust
    - Potential suspension of data processing activities
    - Individual liability for data protection officers and executives
    - Enforcement intensifying with focus on accountability and proactive compliance
    - 2026 supervisory authorities emphasizing evidence-based compliance
  when_to_run:
  - Before processing EU/EEA personal data
  - Annual compliance assessment
  - After significant system or process changes
  - Prior to launching new products/services in EU
  - Following acquisition or merger
  - After data breach incidents
  - Before AI/ML systems deployment involving personal data
prerequisites:
  required_artifacts:
  - type: records_of_processing
    description: Article 30 records of processing activities (ROPA)
    location_hints:
    - compliance/gdpr/ropa.xlsx
    - docs/compliance/processing-activities.md
    - privacy/data-inventory.csv
  - type: privacy_policy
    description: Published privacy policy/notice
    location_hints:
    - legal/privacy-policy.md
    - docs/privacy-notice.html
  - type: data_flow_diagrams
    description: Documentation of how personal data flows through systems
    location_hints:
    - docs/architecture/data-flows/
    - compliance/data-mapping/
  optional_artifacts:
  - type: dpia_records
    description: Data Protection Impact Assessments
    location_hints:
    - compliance/gdpr/dpias/
    - privacy/impact-assessments/
  - type: consent_records
    description: Consent management system documentation
    location_hints:
    - compliance/consent/
  - type: dpa_agreements
    description: Data Processing Agreements with vendors
    location_hints:
    - legal/dpa/
    - vendor-agreements/
  access_requirements:
  - Access to compliance documentation repository
  - Read access to configuration management systems
  - Access to database schemas for data inventory verification
  - Access to consent management platform
  - Access to audit log systems
discovery:
  file_patterns:
  - glob: '**/privacy*.{md,html,txt,yaml}'
    purpose: Privacy policy and related documentation
  - glob: '**/gdpr/**/*'
    purpose: GDPR-specific compliance documentation
  - glob: '**/dpia*.{md,docx,xlsx}'
    purpose: Data Protection Impact Assessments
  - glob: '**/consent*.{yaml,json,ts,js}'
    purpose: Consent management configuration
  - glob: '**/data-processing*.{md,yaml,json}'
    purpose: Data processing agreements and records
  code_patterns:
  - pattern: consent|gdpr|privacy|personal.?data
    type: regex
    scope: source
    purpose: Identify code handling personal data or consent
  - pattern: email|phone|address|birthdate|ssn|passport
    type: regex
    scope: source
    purpose: Identify personal data field references
  - pattern: delete.*user|erase|forget|anonymize
    type: regex
    scope: source
    purpose: Right to erasure implementation
  - pattern: export.*data|portability|download.*data
    type: regex
    scope: source
    purpose: Data portability implementation
  documents_to_review:
  - type: Records of Processing Activities
    purpose: Verify Article 30 compliance and data inventory completeness
    analysis_checklist:
    - Lists all processing activities
    - Identifies legal basis for each activity
    - Documents data categories and subjects
    - Specifies retention periods
    - Lists recipients and transfers
    - Describes technical security measures
  - type: Privacy Policy
    purpose: Verify transparency requirements (Articles 13-14)
    analysis_checklist:
    - Clear and plain language
    - Identity and contact of controller
    - DPO contact details if applicable
    - Purposes and legal basis
    - Data subject rights explanation
    - Retention periods
    - International transfer disclosure
  - type: Data Processing Agreements
    purpose: Verify processor compliance (Article 28)
    analysis_checklist:
    - Subject matter and duration
    - Nature and purpose of processing
    - Processor obligations specified
    - Sub-processor requirements
    - Security measures
    - Audit rights
knowledge_sources:
  specifications:
  - id: gdpr-regulation
    name: General Data Protection Regulation (EU) 2016/679
    url: https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX:32016R0679
    offline_cache: true
    priority: required
  - id: edpb-guidelines
    name: European Data Protection Board Guidelines
    url: https://edpb.europa.eu/our-work-tools/general-guidance/guidelines-recommendations-best-practices_en
    offline_cache: true
    priority: required
  guides:
  - id: ico-guide
    name: ICO Guide to the UK GDPR
    url: https://ico.org.uk/for-organisations/guide-to-data-protection/guide-to-the-general-data-protection-regulation-gdpr/
    offline_cache: true
    priority: recommended
  - id: gdpr-eu-checklist
    name: GDPR.eu Compliance Checklist
    url: https://gdpr.eu/checklist/
    offline_cache: true
    priority: recommended
  learning_resources:
  - id: iapp-gdpr-cert
    title: IAPP CIPP/E Certification Study Guide
    type: book
    reference: International Association of Privacy Professionals
tooling:
  assessment_tools:
  - tool: GDPR Compliance Checklist
    purpose: Structured evaluation against regulatory requirements
    description: |
      Evaluate organization against key GDPR articles:
      - Lawful processing (Art. 6)
      - Consent requirements (Art. 7)
      - Special categories (Art. 9)
      - Transparency (Art. 12-14)
      - Data subject rights (Art. 15-22)
      - Security (Art. 32)
      - Breach notification (Art. 33-34)
      - DPIAs (Art. 35)
      - Records of processing (Art. 30)
      - International transfers (Art. 44-49)
  scripts:
  - id: personal-data-scanner
    language: bash
    purpose: Scan codebase for potential personal data handling
    source: inline
    code: |
      #!/bin/bash
      echo "=== Personal Data Pattern Scan ==="
      echo "Searching for potential PII field references..."

      patterns=(
        "email"
        "phone"
        "address"
        "birth.?date"
        "ssn|social.?security"
        "passport"
        "national.?id"
        "ip.?address"
        "location"
        "cookie"
        "user.?id"
        "first.?name|last.?name|full.?name"
      )

      for pattern in "${patterns[@]}"; do
        echo ""
        echo "--- Pattern: $pattern ---"
        grep -r -i -l "$pattern" --include="*.ts" --include="*.js" --include="*.py" --include="*.java" --include="*.go" . 2>/dev/null | head -20
      done
    offline_capable: true
  - id: consent-implementation-check
    language: bash
    purpose: Verify consent management implementation
    source: inline
    code: |
      #!/bin/bash
      echo "=== Consent Implementation Check ==="

      # Check for consent-related code
      echo "Looking for consent management code..."
      grep -r -l "consent" --include="*.ts" --include="*.js" --include="*.py" . 2>/dev/null

      # Check for cookie consent implementations
      echo ""
      echo "Looking for cookie consent..."
      grep -r -l "cookie.*consent\|consent.*cookie" --include="*.ts" --include="*.js" --include="*.html" . 2>/dev/null

      # Check for opt-in/opt-out mechanisms
      echo ""
      echo "Looking for opt-in/opt-out mechanisms..."
      grep -r -l "opt.?in\|opt.?out" --include="*.ts" --include="*.js" . 2>/dev/null
    offline_capable: true
signals:
  critical:
  - id: GDPR-CRIT-001
    signal: No Records of Processing Activities (ROPA)
    evidence_indicators:
    - No Article 30 documentation found
    - Processing activities not inventoried
    - Legal basis not documented for processing
    explanation: |
      Article 30 requires controllers to maintain records of processing
      activities. This is a fundamental GDPR requirement that enables
      demonstration of compliance and is typically the first document
      requested in regulatory investigations.
    remediation: |
      1. Create comprehensive ROPA covering all processing activities
      2. Document: purposes, legal basis, data categories, recipients
      3. Include retention periods and security measures
      4. Review and update at least annually
      5. Use GDPR.eu template as starting point
  - id: GDPR-CRIT-002
    signal: Personal data processed without lawful basis
    evidence_indicators:
    - Processing activities without documented legal basis
    - Consent relied upon but no valid consent mechanism
    - Legitimate interest claimed without balancing test
    explanation: |
      Article 6 requires all processing to have a lawful basis.
      Processing without lawful basis is fundamentally unlawful
      and exposes organization to maximum penalties.
    remediation: |
      1. Map all processing activities to lawful bases
      2. For consent: implement GDPR-compliant consent mechanisms
      3. For legitimate interest: document balancing tests
      4. For contract: verify processing is necessary for contract
      5. Document legal basis for each processing activity in ROPA
  - id: GDPR-CRIT-003
    signal: No breach notification procedure
    evidence_indicators:
    - No documented breach response plan
    - No mechanism for 72-hour supervisory authority notification
    - No process for assessing breach severity
    explanation: |
      Articles 33-34 require notification to supervisory authority within
      72 hours and to affected individuals when high risk. Organizations
      must have procedures to detect, report, and investigate breaches.
    remediation: |
      1. Create breach response procedure with clear escalation
      2. Implement breach detection mechanisms
      3. Create templates for supervisory authority notification
      4. Define criteria for individual notification
      5. Test procedure through tabletop exercises
  - id: GDPR-CRIT-004
    signal: International transfers without adequate safeguards
    evidence_indicators:
    - Data transferred outside EEA without legal mechanism
    - No Standard Contractual Clauses in place
    - Reliance on invalidated mechanisms (Privacy Shield)
    - No Transfer Impact Assessments for third countries
    explanation: |
      Chapter V restricts international transfers unless adequate
      safeguards exist. Post-Schrems II, transfers to US and other
      countries require supplementary measures and TIAs.
    remediation: |
      1. Map all international data transfers
      2. Implement appropriate transfer mechanisms (SCCs, BCRs)
      3. Conduct Transfer Impact Assessments
      4. Implement supplementary technical measures where needed
      5. Document and regularly review transfer mechanisms
  high:
  - id: GDPR-HIGH-001
    signal: Data subject rights not fully implemented
    evidence_indicators:
    - No process for handling access requests (Article 15)
    - No mechanism for data erasure (Article 17)
    - No data portability capability (Article 20)
    - Response times exceed 30 days
    explanation: |
      Articles 15-22 grant data subjects significant rights. Failure
      to respond to requests within one month (extendable to three)
      can result in complaints to supervisory authorities.
    remediation: |
      1. Implement request intake mechanism
      2. Create processes for each right (access, rectification, erasure, etc.)
      3. Build technical capability for automated data export/deletion
      4. Train staff on handling requests
      5. Track and report on request metrics
  - id: GDPR-HIGH-002
    signal: Privacy policy does not meet transparency requirements
    evidence_indicators:
    - Missing required information (controller identity, DPO, rights)
    - Not in clear, plain language
    - Not easily accessible
    - Missing legal basis per processing purpose
    explanation: |
      Articles 12-14 require clear, transparent information about
      processing at the time of collection. Non-compliant privacy
      notices undermine the validity of any consent obtained.
    remediation: |
      1. Audit current privacy policy against Articles 13-14 requirements
      2. Rewrite in clear, plain language (aim for 8th grade reading level)
      3. Include all required elements (controller, DPO, purposes, legal bases, rights)
      4. Make easily accessible (linked from every page)
      5. Provide layered notice where appropriate
  - id: GDPR-HIGH-003
    signal: DPIA not conducted for high-risk processing
    evidence_indicators:
    - Large-scale processing of special categories
    - Systematic monitoring of public areas
    - Automated decision-making with legal effects
    - No DPIA documentation
    explanation: |
      Article 35 requires DPIAs for processing likely to result in
      high risk to individuals. Failure to conduct required DPIAs
      is a direct compliance violation.
    remediation: |
      1. Identify processing requiring DPIA (use EDPB criteria)
      2. Conduct DPIA before processing begins
      3. Document assessment, risks identified, mitigations
      4. Consult DPO where applicable
      5. Review and update DPIAs when processing changes
  - id: GDPR-HIGH-004
    signal: Consent mechanism does not meet GDPR requirements
    evidence_indicators:
    - Pre-ticked consent boxes
    - Bundled consent (all-or-nothing)
    - No clear affirmative action required
    - Cannot demonstrate consent was given
    - No mechanism to withdraw consent
    explanation: |
      Article 7 requires consent to be freely given, specific, informed,
      and unambiguous. Controller must be able to demonstrate consent.
      Invalid consent means no lawful basis for processing.
    remediation: |
      1. Redesign consent flows with granular, unbundled options
      2. Remove pre-ticked boxes
      3. Implement clear affirmative action requirement
      4. Store consent records with timestamp and version
      5. Provide easy consent withdrawal mechanism
  medium:
  - id: GDPR-MED-001
    signal: Retention periods not defined or enforced
    evidence_indicators:
    - No retention schedule documented
    - Personal data kept indefinitely
    - No automated deletion mechanisms
    explanation: |
      Article 5(1)(e) requires data to be kept no longer than necessary.
      Unclear or excessive retention increases risk and storage costs.
    remediation: |
      1. Define retention periods for each data category
      2. Document justification for retention periods
      3. Implement automated deletion or anonymization
      4. Regular reviews to identify data for deletion
  - id: GDPR-MED-002
    signal: Processor agreements incomplete
    evidence_indicators:
    - Data Processing Agreements missing Article 28 requirements
    - No sub-processor management process
    - No audit rights in contracts
    explanation: |
      Article 28 specifies required terms for processor agreements.
      Incomplete agreements create liability and audit findings.
    remediation: |
      1. Review all processor agreements against Article 28
      2. Amend or replace non-compliant agreements
      3. Implement sub-processor notification process
      4. Exercise audit rights periodically
  - id: GDPR-MED-003
    signal: Security measures not documented
    evidence_indicators:
    - No documentation of Article 32 technical measures
    - Encryption not implemented for sensitive data
    - Access controls not documented
    explanation: |
      Article 32 requires appropriate technical and organizational
      measures. Documentation is essential to demonstrate compliance.
    remediation: |
      1. Document all security measures implemented
      2. Conduct security risk assessment
      3. Implement encryption for personal data
      4. Review and test measures regularly
  low:
  - id: GDPR-LOW-001
    signal: Staff training not documented
    evidence_indicators:
    - No GDPR training records
    - No role-specific privacy training
    remediation: |
      Implement documented GDPR training program with regular refreshers.
  - id: GDPR-LOW-002
    signal: Privacy policy update process unclear
    evidence_indicators:
    - No version history maintained
    - No notification mechanism for policy changes
    remediation: |
      Implement versioned privacy policy with change notifications.
  positive:
  - id: GDPR-POS-001
    signal: Comprehensive ROPA maintained and current
    evidence_indicators:
    - All processing activities documented
    - Regular review and update cycle
    - Linked to data flow diagrams
  - id: GDPR-POS-002
    signal: Privacy by design implemented
    evidence_indicators:
    - Privacy considered in development lifecycle
    - Data minimization principles applied
    - Privacy-enhancing technologies used
  - id: GDPR-POS-003
    signal: Automated data subject rights fulfillment
    evidence_indicators:
    - Self-service data access portal
    - Automated deletion capability
    - Machine-readable data export
procedure:
  context:
    cognitive_mode: critical
    ensemble_role: auditor
  preparation:
  - step: Obtain list of systems processing EU personal data
  - step: Gather existing compliance documentation
  - step: Identify DPO or privacy lead contact
  - step: Review previous audit findings if any
  steps:
  - id: '1'
    name: Review Records of Processing Activities
    description: |
      Examine Article 30 documentation for completeness
      and accuracy against actual processing activities.
    duration_estimate: 2-3 hours
    questions:
    - Are all processing activities documented?
    - Is legal basis identified for each activity?
    - Are data categories and retention periods specified?
    - Are recipients and transfers documented?
    expected_findings:
    - ROPA completeness assessment
    - Gaps in processing documentation
  - id: '2'
    name: Assess Lawful Basis Documentation
    description: |
      Verify each processing activity has valid lawful basis
      with appropriate documentation.
    duration_estimate: 1-2 hours
    questions:
    - Is consent valid where relied upon?
    - Are legitimate interest assessments documented?
    - Are contract necessities clearly identified?
    expected_findings:
    - Processing activities lacking lawful basis
    - Consent mechanism deficiencies
  - id: '3'
    name: Evaluate Data Subject Rights Implementation
    description: |
      Test the organization's ability to fulfill data subject
      rights requests across all systems.
    duration_estimate: 2-3 hours
    questions:
    - Can access requests be fulfilled within 30 days?
    - Is data erasure possible across all systems?
    - Can data be exported in machine-readable format?
    - Is consent withdrawal possible?
    expected_findings:
    - Rights implementation gaps
    - Technical limitations preventing fulfillment
  - id: '4'
    name: Review Privacy Policy and Notices
    description: |
      Assess transparency materials against Articles 12-14
      requirements for completeness and clarity.
    duration_estimate: 1-2 hours
    questions:
    - Does privacy policy contain all required elements?
    - Is language clear and understandable?
    - Are processing purposes specific?
    - Is policy easily accessible?
    expected_findings:
    - Missing required disclosures
    - Clarity improvements needed
  - id: '5'
    name: Assess Security Measures
    description: |
      Evaluate technical and organizational security measures
      for appropriateness under Article 32.
    duration_estimate: 2-3 hours
    commands:
    - purpose: Check for encryption implementation
      command: grep -r -l 'encrypt' --include='*.yaml' --include='*.tf' .
    - purpose: Review access control configuration
      command: find . -name '*rbac*' -o -name '*iam*' -o -name '*permission*'
    expected_findings:
    - Security measure documentation status
    - Technical control gaps
  - id: '6'
    name: Review International Transfer Mechanisms
    description: |
      Identify all transfers outside EEA and verify adequate
      safeguards are in place.
    duration_estimate: 1-2 hours
    questions:
    - Where does personal data flow geographically?
    - Are SCCs or other mechanisms in place?
    - Have Transfer Impact Assessments been conducted?
    expected_findings:
    - Unprotected transfers
    - TIA gaps for high-risk transfers
  - id: '7'
    name: Assess Breach Response Capability
    description: |
      Review breach detection, notification, and response
      procedures against Articles 33-34 requirements.
    duration_estimate: 1 hour
    questions:
    - Is breach detection automated?
    - Can 72-hour notification be met?
    - Is severity assessment process defined?
    expected_findings:
    - Breach response procedure gaps
    - Notification template availability
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: compliance_matrix
    format: table
    description: GDPR Article compliance mapping
    columns:
    - Article
    - Requirement
    - Compliance Status
    - Evidence
    - Gap Description
    - Remediation
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Critical Findings
    - Compliance Score by Article
    - Risk Assessment
    - Prioritized Remediation Plan
    - Timeline Recommendations
  confidence_guidance:
    high: Documentation reviewed and verified against implementation
    medium: Documentation reviewed, limited implementation verification
    low: Based on interviews or incomplete documentation
offline:
  capability: partial
  cache_manifest:
    knowledge:
    - source_id: gdpr-regulation
      priority: required
    - source_id: edpb-guidelines
      priority: required
    - source_id: ico-guide
      priority: recommended
  degradation:
  - feature: Live system data flow verification
    impact: Cannot verify actual data flows
    mitigation: Export data flow diagrams before going offline
profiles:
  membership:
    quick:
      included: false
      reason: Comprehensive review requires full assessment
    security:
      included: true
      priority: 5
    production:
      included: true
      priority: 3
    full:
      included: true
      priority: 1
closeout_checklist:
- id: gdpr-001
  item: Records of Processing Activities exist and are complete
  level: CRITICAL
  verification: manual
  verification_notes: Reviewer confirms ROPA covers all processing activities with required Article 30
    elements
  expected: Confirmed by reviewer
- id: gdpr-002
  item: Lawful basis documented for all processing activities
  level: CRITICAL
  verification: manual
  verification_notes: Each processing activity in ROPA has valid legal basis documented
  expected: Confirmed by reviewer
- id: gdpr-003
  item: Privacy policy meets Article 12-14 requirements
  level: BLOCKING
  verification: manual
  verification_notes: Privacy policy contains all required disclosures in clear language
  expected: Confirmed by reviewer
- id: gdpr-004
  item: Data subject rights request process operational
  level: BLOCKING
  verification: manual
  verification_notes: Process exists to handle access, erasure, portability requests within timeframes
  expected: Confirmed by reviewer
- id: gdpr-005
  item: International transfers have adequate safeguards
  level: CRITICAL
  verification: manual
  verification_notes: All transfers outside EEA have valid mechanism (adequacy, SCCs, BCRs)
  expected: Confirmed by reviewer
- id: gdpr-006
  item: Breach notification procedure in place
  level: BLOCKING
  verification: manual
  verification_notes: Documented procedure enables 72-hour supervisory authority notification
  expected: Confirmed by reviewer
- id: gdpr-007
  item: DPIAs conducted for high-risk processing
  level: BLOCKING
  verification: manual
  verification_notes: DPIAs exist for processing meeting EDPB criteria
  expected: Confirmed by reviewer
- id: gdpr-008
  item: Consent mechanisms are GDPR-compliant
  level: BLOCKING
  verification: manual
  verification_notes: Where consent is legal basis, mechanism meets Article 7 requirements
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
    maturity:
    - growing
    - mature
    geographic_scope:
    - EU
    - EEA
    - global
  compliance_frameworks:
  - framework: GDPR
    controls:
    - All Articles
  - framework: SOC2
    controls:
    - CC5.1
    - CC5.2
    - P1-P8
  - framework: ISO27001
    controls:
    - A.18.1.4
    - A.18.1.1
  - framework: ISO27701
    controls:
    - All
relationships:
  commonly_combined:
  - compliance-governance.data-privacy.privacy-policy-accuracy
  - compliance-governance.data-privacy.consent-management
  - compliance-governance.data-privacy.data-subject-rights-implementation
  - compliance-governance.audit-trails.audit-log-completeness
  - security-trust.data-security.encryption-implementation
