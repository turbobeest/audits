audit:
  id: compliance-governance.regulatory-compliance.coppa-compliance
  name: COPPA Compliance Audit
  version: 1.0.0
  last_updated: '2025-01-19'
  status: active
  category: compliance-governance
  category_number: 24
  subcategory: regulatory-compliance
  tier: phd
  estimated_duration: 4-8 hours  # median: 6h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: critical
  scope: process
  default_profiles:
  - full
  - security
  - production
  blocks_phase: true
  parallelizable: true
description:
  what: |
    Comprehensive audit of Children's Online Privacy Protection Act (COPPA)
    compliance for operators of websites, apps, and online services directed
    to children under 13 or with actual knowledge of child users. Evaluates
    verifiable parental consent mechanisms, privacy notice requirements,
    data collection limitations, parental access and deletion rights, data
    security programs, and third-party compliance. Addresses 2025 FTC rule
    amendments effective April 2026 including expanded personal information
    definitions, enhanced consent requirements, and mandatory security programs.
  why_it_matters: |
    COPPA non-compliance carries severe consequences:
    - FTC enforcement with civil penalties up to $53,088 per violation
    - Major settlements often reach millions of dollars
    - Reputational damage with parents and educators
    - 2025 amendments dramatically expand requirements (effective April 2026)
    - Expanded personal information definition includes biometrics
    - Mandatory written security programs now required
    - Enhanced parental consent verification requirements
    - Third-party SDK/vendor compliance is operator responsibility
  when_to_run:
  - Before launching child-directed services
  - Annual compliance assessment
  - Before adding data collection features
  - When implementing third-party SDKs
  - Prior to April 2026 amendment deadline
  - After FTC enforcement actions in industry
prerequisites:
  required_artifacts:
  - type: privacy_policy
    description: Children's privacy policy
    location_hints:
    - legal/privacy-policy-children.md
    - docs/coppa-notice.html
    - policies/children-privacy/
  - type: data_inventory
    description: Personal information collected from children
    location_hints:
    - compliance/coppa/data-inventory.xlsx
    - privacy/data-mapping/
  - type: consent_mechanism
    description: Verifiable parental consent implementation
    location_hints:
    - compliance/coppa/consent/
    - docs/parental-consent/
  optional_artifacts:
  - type: safe_harbor_certification
    description: FTC-approved safe harbor program membership
    location_hints:
    - compliance/coppa/safe-harbor/
  - type: security_program
    description: Written information security program
    location_hints:
    - security/policies/
    - compliance/coppa/security/
  - type: third_party_inventory
    description: Third-party SDK and service inventory
    location_hints:
    - compliance/vendors/
    - docs/third-party-services/
  access_requirements:
  - Access to privacy policy and notices
  - Access to consent mechanism implementation
  - Access to data collection code
  - Access to third-party SDK configuration
  - Access to security program documentation
discovery:
  file_patterns:
  - glob: '**/coppa/**/*'
    purpose: COPPA-specific documentation
  - glob: '**/privacy*.{md,html,txt}'
    purpose: Privacy policies
  - glob: '**/consent*.{ts,js,yaml}'
    purpose: Consent mechanism code
  - glob: '**/parental*.{ts,js,yaml}'
    purpose: Parental consent implementation
  code_patterns:
  - pattern: age.?gate|birth.?date|age.?check
    type: regex
    scope: source
    purpose: Identify age verification
  - pattern: parent.*consent|verifiable.*consent
    type: regex
    scope: source
    purpose: Identify parental consent
  - pattern: coppa|child.*privacy|under.?13
    type: regex
    scope: source
    purpose: Identify COPPA-specific code
  - pattern: collect.*personal|tracking|analytics
    type: regex
    scope: source
    purpose: Identify data collection
  documents_to_review:
  - type: Children's Privacy Policy
    purpose: Verify notice requirements met
    analysis_checklist:
    - Contact information for operator
    - Types of personal information collected
    - How information is collected
    - How information is used
    - Whether information is disclosed
    - Parental consent procedures
    - Parental review/deletion rights
    - No-more-than-necessary policy
  - type: Direct Notice to Parents
    purpose: Verify direct notice requirements
    analysis_checklist:
    - Clear and understandable language
    - Types of information to be collected
    - Purposes for collection
    - How consent can be provided
    - How consent can be withdrawn
knowledge_sources:
  specifications:
  - id: coppa-rule
    name: COPPA Rule (16 CFR Part 312)
    url: https://www.ecfr.gov/current/title-16/chapter-I/subchapter-C/part-312
    offline_cache: true
    priority: required
  - id: coppa-2025-amendments
    name: FTC COPPA Rule Amendments (2025)
    url: https://www.ftc.gov/legal-library/browse/rules/childrens-online-privacy-protection-rule-coppa
    offline_cache: true
    priority: required
  guides:
  - id: ftc-coppa-guidance
    name: FTC COPPA Compliance Guidance
    url: https://www.ftc.gov/business-guidance/resources/complying-coppa-frequently-asked-questions
    offline_cache: true
    priority: required
  - id: coppa-safe-harbor
    name: FTC COPPA Safe Harbor Programs
    url: https://www.ftc.gov/safe-harbor-program
    offline_cache: true
    priority: recommended
  learning_resources:
  - id: coppa-compliance-guide
    title: FTC COPPA Compliance Guide
    type: article
    reference: Federal Trade Commission
tooling:
  assessment_tools:
  - tool: COPPA Compliance Checklist
    purpose: Evaluate against COPPA requirements
    description: |
      Assess compliance with COPPA requirements:
      - Privacy notice (312.4)
      - Direct notice to parents (312.4)
      - Verifiable parental consent (312.5)
      - Parental rights (312.6)
      - Prohibition on conditioning (312.7)
      - Data retention/deletion (312.10)
      - Confidentiality/security (312.8)
      - Safe harbor (312.11) if applicable
  scripts:
  - id: age-gate-check
    language: bash
    purpose: Check for age verification implementation
    source: inline
    code: |
      #!/bin/bash
      echo "=== COPPA Age Gate Check ==="

      # Search for age verification
      echo "Searching for age verification..."
      grep -r -l "age.?gate\|age.?check\|birth.?date\|age.?verify" \
        --include="*.ts" --include="*.js" --include="*.tsx" . 2>/dev/null | head -15

      # Search for under-13 handling
      echo ""
      echo "Searching for under-13 specific handling..."
      grep -r "under.?13\|child.*age\|minor" \
        --include="*.ts" --include="*.js" . 2>/dev/null | head -15
    offline_capable: true
  - id: consent-mechanism-check
    language: bash
    purpose: Verify parental consent implementation
    source: inline
    code: |
      #!/bin/bash
      echo "=== COPPA Consent Mechanism Check ==="

      # Search for parental consent
      echo "Searching for parental consent mechanisms..."
      grep -r -l "parent.*consent\|verif.*consent\|guardian" \
        --include="*.ts" --include="*.js" --include="*.py" . 2>/dev/null | head -15

      # Search for consent verification methods
      echo ""
      echo "Searching for consent verification methods..."
      grep -r "credit.?card\|knowledge.?based\|video.?conf\|sign.*consent" \
        --include="*.ts" --include="*.js" . 2>/dev/null | head -15

      # Search for consent withdrawal
      echo ""
      echo "Searching for consent withdrawal..."
      grep -r "revoke.*consent\|withdraw.*consent" \
        --include="*.ts" --include="*.js" . 2>/dev/null | head -15
    offline_capable: true
  - id: third-party-sdk-scan
    language: bash
    purpose: Scan for third-party SDKs that may collect data
    source: inline
    code: |
      #!/bin/bash
      echo "=== Third-Party SDK Scan ==="

      # Check for common analytics/advertising SDKs
      echo "Searching for analytics SDKs..."
      grep -r -l "google.?analytics\|firebase\|amplitude\|mixpanel" \
        --include="*.json" --include="*.yaml" --include="*.ts" . 2>/dev/null | head -15

      # Check for advertising SDKs
      echo ""
      echo "Searching for advertising SDKs..."
      grep -r -l "admob\|facebook.*ads\|unity.*ads" \
        --include="*.json" --include="*.yaml" . 2>/dev/null | head -15

      # Check package files for SDKs
      echo ""
      echo "Checking package dependencies..."
      if [ -f "package.json" ]; then
        grep -i "analytics\|tracking\|ads\|firebase" package.json
      fi
    offline_capable: true
signals:
  critical:
  - id: COPPA-CRIT-001
    signal: Personal information collected without verifiable parental consent
    evidence_indicators:
    - Data collected before consent verified
    - No consent mechanism implemented
    - Consent method not FTC-approved
    - Consent not verifiable
    explanation: |
      COPPA requires verifiable parental consent before collecting,
      using, or disclosing personal information from children under 13.
      2025 amendments add new approved methods (text-plus, knowledge-based)
      but increase overall requirements.
    remediation: |
      1. Implement FTC-approved consent verification method
      2. Do not collect data until consent verified
      3. Document consent with timestamp and method
      4. Provide mechanism to withdraw consent
      5. Consider multiple consent methods for flexibility
  - id: COPPA-CRIT-002
    signal: Privacy notice does not meet COPPA requirements
    evidence_indicators:
    - No separate children's privacy notice
    - Missing required disclosures
    - Not prominent or accessible
    - Not understandable by parents
    explanation: |
      COPPA requires both online notice and direct notice to parents
      with specific required content. 2025 amendments enhance
      disclosure requirements.
    remediation: |
      1. Create COPPA-compliant privacy notice
      2. Link prominently on every page collecting data
      3. Include all required disclosures
      4. Use clear, understandable language
      5. Provide direct notice before collecting data
  - id: COPPA-CRIT-003
    signal: No written information security program
    evidence_indicators:
    - Security program not documented
    - No designated security coordinator
    - Security measures not appropriate to data
    explanation: |
      2025 amendments require formal, written information security
      programs tailored to the sensitivity of children's data.
      This is a new mandatory requirement effective April 2026.
    remediation: |
      1. Create written information security program
      2. Designate security coordinator(s)
      3. Document technical safeguards (encryption, access control)
      4. Document administrative safeguards (training, procedures)
      5. Regular security assessment and updates
  - id: COPPA-CRIT-004
    signal: Third-party SDKs collecting children's data without compliance
    evidence_indicators:
    - Analytics/advertising SDKs in children's app
    - SDKs not COPPA-compliant
    - No contractual compliance requirements
    - SDK data collection not disclosed
    explanation: |
      Operators are responsible for third-party compliance. SDKs
      collecting personal information must comply with COPPA.
      Many common SDKs are not COPPA-compliant by default.
    remediation: |
      1. Inventory all third-party SDKs
      2. Assess each for COPPA compliance
      3. Replace non-compliant SDKs or configure properly
      4. Include compliance requirements in contracts
      5. Disclose third-party data collection in notices
  high:
  - id: COPPA-HIGH-001
    signal: Parental access and deletion not implemented
    evidence_indicators:
    - No mechanism for parents to review data
    - No ability to delete child's data
    - No ability to refuse further collection
    - Process not documented
    explanation: |
      COPPA grants parents the right to review, delete, and
      refuse further collection of their child's data. Operators
      must provide reasonable means to exercise these rights.
    remediation: |
      1. Implement parental access mechanism
      2. Enable parents to review collected data
      3. Provide data deletion capability
      4. Allow refusal of further collection
      5. Document process for parents
  - id: COPPA-HIGH-002
    signal: Collecting more data than necessary
    evidence_indicators:
    - Extensive data collection from children
    - No purpose limitation
    - Data collected but not used
    - Participation conditioned on unnecessary data
    explanation: |
      COPPA prohibits conditioning participation on disclosure
      of more information than reasonably necessary. Data
      minimization is a core requirement.
    remediation: |
      1. Audit all data collection from children
      2. Eliminate unnecessary collection
      3. Document necessity for each data element
      4. Do not condition participation on unnecessary data
      5. Regular review of data collection practices
  - id: COPPA-HIGH-003
    signal: Expanded personal information categories not addressed
    evidence_indicators:
    - Biometric data collected without addressing COPPA
    - Persistent identifiers used for behavioral advertising
    - Geolocation collected
    - New categories from 2025 amendments not covered
    explanation: |
      2025 amendments expand personal information to include
      biometric identifiers (fingerprints, voiceprints) and
      government-issued identifiers. All must be addressed.
    remediation: |
      1. Review all data against 2025 expanded definitions
      2. Include biometric data in COPPA compliance
      3. Address government-issued identifiers
      4. Update privacy notices for new categories
      5. Ensure consent covers new categories
  - id: COPPA-HIGH-004
    signal: Data retention not limited
    evidence_indicators:
    - No retention policy for children's data
    - Data kept indefinitely
    - No automated deletion
    explanation: |
      COPPA requires reasonable data retention limits. Data
      should not be kept longer than reasonably necessary.
    remediation: |
      1. Define retention periods for children's data
      2. Implement automated deletion
      3. Document retention justification
      4. Delete data when consent withdrawn
      5. Regular retention review
  medium:
  - id: COPPA-MED-001
    signal: Consent records not maintained
    evidence_indicators:
    - Consent not documented
    - Consent method not recorded
    - Timestamp not captured
    explanation: |
      Operators should maintain records of consent to
      demonstrate compliance during FTC inquiries.
    remediation: |
      1. Log consent with timestamp
      2. Record consent method used
      3. Maintain records for reasonable period
      4. Make available for FTC review if requested
  - id: COPPA-MED-002
    signal: Mixed audience service not properly handled
    evidence_indicators:
    - Service appeals to both children and adults
    - No age screening mechanism
    - Children not identified for COPPA treatment
    explanation: |
      Mixed audience services have specific obligations including
      age screening. 2025 amendments clarify mixed audience standards.
    remediation: |
      1. Implement age screening for mixed audience
      2. Apply COPPA requirements to identified children
      3. Do not collect from children without consent
      4. Document mixed audience approach
  - id: COPPA-MED-003
    signal: Safe harbor program requirements not met
    evidence_indicators:
    - Safe harbor membership but requirements not followed
    - Annual reporting not submitted
    - Self-assessment not conducted
    explanation: |
      Safe harbor programs require ongoing compliance. 2025
      amendments enhance safe harbor transparency requirements
      with new annual reporting by October 2025.
    remediation: |
      1. Review safe harbor program requirements
      2. Conduct required self-assessments
      3. Submit annual reporting on time
      4. Ensure all subject operators compliant
      5. Update guidelines per new requirements
  low:
  - id: COPPA-LOW-001
    signal: Direct notice could be clearer
    evidence_indicators:
    - Language somewhat technical
    - Layout could be improved
    remediation: |
      Revise direct notice for maximum clarity and accessibility.
  - id: COPPA-LOW-002
    signal: Internal COPPA training not documented
    evidence_indicators:
    - Staff training records lacking
    - No COPPA-specific training
    remediation: |
      Implement documented COPPA training program.
  positive:
  - id: COPPA-POS-001
    signal: Robust verifiable parental consent
    evidence_indicators:
    - Multiple consent methods available
    - Consent verification documented
    - Withdrawal mechanism functional
  - id: COPPA-POS-002
    signal: Minimal data collection
    evidence_indicators:
    - Only necessary data collected
    - No behavioral advertising to children
    - Limited third-party sharing
  - id: COPPA-POS-003
    signal: Written security program comprehensive
    evidence_indicators:
    - Security coordinator designated
    - Technical and administrative safeguards documented
    - Regular security assessments conducted
procedure:
  context:
    cognitive_mode: critical
    ensemble_role: auditor
  preparation:
  - step: Determine if service is directed to children or has actual knowledge
  - step: Gather privacy notices and consent documentation
  - step: Inventory data collection practices
  - step: Review 2025 amendment requirements
  steps:
  - id: '1'
    name: Applicability Assessment
    description: |
      Determine if COPPA applies based on whether service is
      directed to children under 13 or has actual knowledge.
    duration_estimate: 30 minutes
    questions:
    - Is service primarily directed to children under 13?
    - Does service have actual knowledge of child users?
    - Is this a mixed audience service?
    - Do third-party services trigger COPPA obligations?
    expected_findings:
    - COPPA applicability determination
    - Scope of obligations
  - id: '2'
    name: Privacy Notice Review
    description: |
      Evaluate privacy notices against COPPA requirements
      including 2025 amendment enhancements.
    duration_estimate: 1 hour
    questions:
    - Does notice include all required elements?
    - Is notice prominent and accessible?
    - Does direct notice precede data collection?
    - Is language clear and understandable?
    expected_findings:
    - Notice compliance status
    - Required updates
  - id: '3'
    name: Consent Mechanism Evaluation
    description: |
      Assess verifiable parental consent mechanisms
      against FTC-approved methods.
    duration_estimate: 1-2 hours
    commands:
    - purpose: Check consent implementation
      command: grep -r 'consent\|parent\|guardian' --include='*.ts' --include='*.js' . | head -30
    expected_findings:
    - Consent mechanism adequacy
    - Verification method compliance
  - id: '4'
    name: Data Collection Assessment
    description: |
      Inventory and evaluate data collection against
      COPPA data minimization requirements.
    duration_estimate: 1-2 hours
    questions:
    - What personal information is collected?
    - Is all collection necessary for participation?
    - Are new 2025 categories addressed?
    - Is data retained only as long as necessary?
    expected_findings:
    - Data collection inventory
    - Minimization compliance
  - id: '5'
    name: Third-Party Compliance Review
    description: |
      Assess third-party SDKs and services for
      COPPA compliance.
    duration_estimate: 1-2 hours
    commands:
    - purpose: Scan for third-party SDKs
      command: grep -r 'analytics\|tracking\|ads' --include='package.json' --include='*.yaml' . | head
        -20
    expected_findings:
    - Third-party inventory
    - Compliance gaps
  - id: '6'
    name: Security Program Review
    description: |
      Evaluate written information security program
      per 2025 amendment requirements.
    duration_estimate: 1 hour
    questions:
    - Is security program documented?
    - Is security coordinator designated?
    - Are safeguards appropriate to data sensitivity?
    expected_findings:
    - Security program status
    - Required documentation
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: compliance_matrix
    format: table
    description: COPPA requirements compliance
    columns:
    - Requirement
    - Citation
    - Status
    - Evidence
    - Gap
    - Remediation
    - 2025 Amendment Impact
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Applicability Determination
    - Privacy Notice Assessment
    - Consent Mechanism Assessment
    - Data Collection Assessment
    - Third-Party Compliance
    - Security Program Status
    - 2025 Amendment Readiness
    - Remediation Plan
  confidence_guidance:
    high: Implementation reviewed and tested
    medium: Documentation reviewed, limited testing
    low: Based on interviews only
offline:
  capability: partial
  cache_manifest:
    knowledge:
    - source_id: coppa-rule
      priority: required
    - source_id: coppa-2025-amendments
      priority: required
    - source_id: ftc-coppa-guidance
      priority: required
  degradation:
  - feature: Live consent flow testing
    impact: Cannot verify consent mechanism in practice
    mitigation: Review code implementation and documentation
profiles:
  membership:
    quick:
      included: false
      reason: Comprehensive assessment required
    security:
      included: true
      priority: 8
    production:
      included: true
      priority: 5
    full:
      included: true
      priority: 3
closeout_checklist:
- id: coppa-001
  item: Verifiable parental consent mechanism implemented
  level: CRITICAL
  verification: manual
  verification_notes: FTC-approved consent method with documented verification
  expected: Confirmed by reviewer
- id: coppa-002
  item: Privacy notice meets all COPPA requirements
  level: CRITICAL
  verification: manual
  verification_notes: Notice contains all required elements and is prominent
  expected: Confirmed by reviewer
- id: coppa-003
  item: Written information security program documented
  level: CRITICAL
  verification: manual
  verification_notes: Security program meets 2025 amendment requirements
  expected: Confirmed by reviewer
- id: coppa-004
  item: Third-party SDKs COPPA-compliant
  level: CRITICAL
  verification: manual
  verification_notes: All third parties assessed and compliant or removed
  expected: Confirmed by reviewer
- id: coppa-005
  item: Parental access and deletion implemented
  level: BLOCKING
  verification: manual
  verification_notes: Parents can review and delete child's data
  expected: Confirmed by reviewer
- id: coppa-006
  item: Data collection minimized to necessary
  level: BLOCKING
  verification: manual
  verification_notes: Only necessary data collected, not conditioned on unnecessary
  expected: Confirmed by reviewer
- id: coppa-007
  item: 2025 expanded personal information categories addressed
  level: BLOCKING
  verification: manual
  verification_notes: Biometrics and government IDs addressed if collected
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - children-apps
    - edtech
    - gaming
    - entertainment
    maturity:
    - growing
    - mature
    audience_scope:
    - children-under-13
    - mixed-audience
  compliance_frameworks:
  - framework: COPPA
    controls:
    - 16 CFR Part 312
  - framework: FERPA
    controls:
    - When education records involved
  - framework: State Children's Privacy Laws
    controls:
    - Various
relationships:
  commonly_combined:
  - compliance-governance.regulatory-compliance.ferpa-compliance
  - compliance-governance.data-privacy.consent-management
  - compliance-governance.data-privacy.data-minimization
  - compliance-governance.third-party-compliance.vendor-compliance
