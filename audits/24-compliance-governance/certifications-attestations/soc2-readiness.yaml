audit:
  id: compliance-governance.certifications-attestations.soc2-readiness
  name: SOC 2 Readiness Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: compliance-governance
  category_number: 24
  subcategory: certifications-attestations
  tier: phd
  estimated_duration: 16-40 hours  # median: 28h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: critical
  scope: process
  default_profiles:
  - full
  - security
  blocks_phase: true
  parallelizable: true
description:
  what: |
    Comprehensive assessment of organizational readiness for SOC 2 (System and
    Organization Controls 2) attestation. Evaluates controls across the five
    Trust Services Criteria: Security (required), Availability, Processing
    Integrity, Confidentiality, and Privacy. Identifies gaps in policies,
    procedures, technical controls, and evidence collection that would prevent
    successful SOC 2 Type I or Type II examination.
  why_it_matters: |
    SOC 2 is increasingly required for B2B software vendors:
    - 85% of enterprise buyers require SOC 2 from vendors
    - Average sales cycle extends 2-4 months without SOC 2
    - Failed examinations cost $100K+ and damage reputation
    - SOC 2 provides competitive differentiation in security-conscious markets

    Readiness assessment before engaging auditors prevents failed examinations
    and ensures efficient use of auditor time (billable at $300-500/hour).
  when_to_run:
  - 6-12 months before planned SOC 2 examination
  - When starting SOC 2 compliance program
  - After major infrastructure or process changes
  - When preparing for Type II after Type I
  - During annual compliance program review
prerequisites:
  required_artifacts:
  - type: security_policies
    description: Information security policy documentation
    location_hints:
    - policies/security/
    - docs/compliance/policies/
    - wiki/security-policies/
  - type: system_description
    description: Description of services and infrastructure
    location_hints:
    - docs/architecture/
    - compliance/system-description.md
  - type: control_documentation
    description: Documented security and operational controls
    location_hints:
    - compliance/controls/
    - policies/
  optional_artifacts:
  - type: previous_audit_reports
    description: Prior SOC 2 reports or readiness assessments
  - type: risk_assessment
    description: Risk assessment documentation
  - type: vendor_assessments
    description: Third-party vendor security assessments
  access_requirements:
  - Access to all security policy documentation
  - Access to technical infrastructure configurations
  - Access to HR policies (onboarding, offboarding, background checks)
  - Access to change management records
  - Access to incident response documentation
discovery:
  file_patterns:
  - glob: '**/policies/**/*.{md,pdf,docx}'
    purpose: Security and operational policies
  - glob: '**/compliance/**/*'
    purpose: Compliance documentation
  - glob: '**/soc2/**/*'
    purpose: SOC 2 specific documentation
  documents_to_review:
  - type: Information Security Policy
    purpose: Assess policy framework for TSC coverage
    analysis_checklist:
    - Defines security responsibilities
    - Covers all five trust services criteria
    - Approved by management
    - Communicated to employees
    - Reviewed and updated regularly
  - type: Access Control Policy
    purpose: Evaluate logical access controls
    analysis_checklist:
    - Principle of least privilege
    - Access provisioning/deprovisioning
    - Authentication requirements
    - Privileged access management
    - Access review procedures
  - type: Change Management Policy
    purpose: Assess change control procedures
    analysis_checklist:
    - Change request process
    - Approval requirements
    - Testing procedures
    - Rollback procedures
    - Emergency change process
  - type: Incident Response Plan
    purpose: Evaluate incident management capability
    analysis_checklist:
    - Incident classification
    - Response procedures
    - Communication protocols
    - Lessons learned process
    - Regular testing
knowledge_sources:
  specifications:
  - id: aicpa-soc2
    name: AICPA SOC 2 Trust Services Criteria
    url: https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/trustdataintegritytaskforce
    offline_cache: true
    priority: required
  guides:
  - id: soc2-guide
    name: AICPA SOC 2 Guide
    url: https://www.aicpa.org/content/dam/aicpa/interestareas/frc/assuranceadvisoryservices/downloadabledocuments/soc-2-reporting-on-an-examination.pdf
    offline_cache: true
    priority: required
  learning_resources:
  - id: soc2-handbook
    title: SOC 2 Compliance Handbook
    type: book
    reference: Secureframe/Vanta publications
tooling:
  assessment_tools:
  - tool: SOC 2 Readiness Checklist
    purpose: Systematic evaluation against TSC
    description: |
      Evaluate organization against each Trust Services Criteria:
      - CC1: Control Environment
      - CC2: Communication and Information
      - CC3: Risk Assessment
      - CC4: Monitoring Activities
      - CC5: Control Activities
      - CC6: Logical and Physical Access
      - CC7: System Operations
      - CC8: Change Management
      - CC9: Risk Mitigation
  scripts:
  - id: access-control-check
    language: bash
    purpose: Check for access control configurations
    source: inline
    code: |
      #!/bin/bash
      echo "=== Access Control Configuration Check ==="

      # Check for MFA configurations
      echo "Checking for MFA configurations..."
      find . -name "*.tf" -exec grep -l "mfa\|multi_factor" {} \; 2>/dev/null

      # Check for IAM policies
      echo "Checking for IAM configurations..."
      find . \( find . -name "*.tf" -o -name "*.yaml" \) | xargs grep -l "iam\|rbac\|role" 2>/dev/null | head -20

      # Check for encryption configurations
      echo "Checking for encryption configurations..."
      find . \( find . -name "*.tf" -o -name "*.yaml" \) | xargs grep -l "encrypt\|kms\|tls" 2>/dev/null | head -20
    offline_capable: true
signals:
  critical:
  - id: SOC2-CRIT-001
    signal: No formal security policies exist
    evidence_indicators:
    - No documented information security policy
    - No access control policy
    - No change management policy
    - No incident response plan
    explanation: |
      SOC 2 requires documented policies as the foundation of the control
      environment. Without policies, there are no controls to test, and
      examination cannot proceed.
    remediation: |
      1. Develop comprehensive information security policy
      2. Create supporting policies: access control, change management, etc.
      3. Obtain management approval
      4. Communicate to all employees
      5. Implement policy review cycle
  - id: SOC2-CRIT-002
    signal: No evidence collection process
    evidence_indicators:
    - Controls not documented with evidence
    - No audit trail for key processes
    - Cannot demonstrate control operation
    - Logs not retained appropriately
    explanation: |
      SOC 2 Type II requires evidence that controls operated effectively
      over the examination period. Without evidence, auditors cannot issue
      an unqualified opinion.
    remediation: |
      1. Identify evidence required for each control
      2. Implement evidence collection procedures
      3. Establish appropriate retention periods
      4. Create evidence repository
      5. Conduct periodic evidence collection tests
  - id: SOC2-CRIT-003
    signal: Major control gaps in security category
    evidence_indicators:
    - No multi-factor authentication
    - No encryption at rest for sensitive data
    - No vulnerability management program
    - No security awareness training
    explanation: |
      Security is the only required Trust Services Criteria. Major gaps
      in security controls will result in qualified opinion or failed
      examination.
    remediation: |
      1. Implement MFA for all system access
      2. Encrypt all sensitive data at rest and in transit
      3. Establish vulnerability management program
      4. Implement security awareness training
      5. Conduct penetration testing
  high:
  - id: SOC2-HIGH-001
    signal: Access reviews not conducted regularly
    evidence_indicators:
    - No periodic access review process
    - No evidence of quarterly/semi-annual reviews
    - Terminated users still have access
    - Excessive privileges not identified
    explanation: |
      Regular access reviews are fundamental SOC 2 controls. Auditors will
      request evidence of access review completion and issues remediated.
    remediation: |
      1. Establish quarterly access review process
      2. Document review criteria and procedures
      3. Conduct reviews and document results
      4. Track and remediate findings
      5. Maintain evidence of completion
  - id: SOC2-HIGH-002
    signal: Change management process informal
    evidence_indicators:
    - No documented change requests
    - No approval trail for changes
    - No testing evidence
    - Changes deployed without review
    explanation: |
      Change management is heavily scrutinized in SOC 2 examinations.
      Each change should have request, approval, testing, and deployment
      evidence.
    remediation: |
      1. Implement formal change request system
      2. Define approval requirements
      3. Document testing procedures
      4. Maintain complete change history
      5. Conduct change management training
  - id: SOC2-HIGH-003
    signal: No risk assessment conducted
    evidence_indicators:
    - No formal risk assessment documentation
    - Risks not identified or rated
    - No risk treatment plans
    - Risk assessment not reviewed annually
    explanation: |
      Risk assessment is a foundational SOC 2 requirement (CC3). Controls
      should be mapped to identified risks.
    remediation: |
      1. Conduct comprehensive risk assessment
      2. Document risk identification methodology
      3. Rate risks by likelihood and impact
      4. Create risk treatment plans
      5. Review and update annually
  - id: SOC2-HIGH-004
    signal: Incident response not tested
    evidence_indicators:
    - No tabletop exercises conducted
    - No documented incident tests
    - Response times unknown
    - Team not trained on procedures
    explanation: |
      SOC 2 requires evidence that incident response procedures are tested
      and team members are trained. Untested procedures may not work when
      needed.
    remediation: |
      1. Schedule quarterly tabletop exercises
      2. Conduct annual simulated incident
      3. Document exercise results
      4. Update procedures based on lessons
      5. Train team on procedures
  medium:
  - id: SOC2-MED-001
    signal: Vendor management program immature
    evidence_indicators:
    - No vendor inventory
    - No vendor risk assessments
    - No SOC 2 reports collected from vendors
    - No vendor review process
    remediation: |
      1. Create comprehensive vendor inventory
      2. Assess vendor risk by data exposure
      3. Collect SOC 2/security documentation
      4. Establish vendor review process
      5. Monitor vendor security posture
  - id: SOC2-MED-002
    signal: Employee lifecycle controls incomplete
    evidence_indicators:
    - No background check process
    - Onboarding security training missing
    - Offboarding checklist incomplete
    - No confidentiality agreements
    remediation: |
      1. Implement background check process
      2. Add security training to onboarding
      3. Create comprehensive offboarding checklist
      4. Require confidentiality agreements
      5. Document and evidence all processes
  - id: SOC2-MED-003
    signal: Business continuity plans not documented
    evidence_indicators:
    - No BCP documentation
    - No disaster recovery procedures
    - Recovery objectives (RTO/RPO) not defined
    - No BC testing conducted
    remediation: |
      1. Document business continuity plan
      2. Define RTO and RPO for critical systems
      3. Create disaster recovery procedures
      4. Test plans annually
      5. Document test results
  low:
  - id: SOC2-LOW-001
    signal: Policy review cycle not formalized
    evidence_indicators:
    - Policies not dated with version
    - No formal review schedule
    - Reviews not documented
    remediation: |
      Establish annual policy review cycle with documented approvals.
  positive:
  - id: SOC2-POS-001
    signal: Comprehensive policy framework exists
    evidence_indicators:
    - All required policies documented
    - Policies approved and communicated
    - Regular review cycle in place
  - id: SOC2-POS-002
    signal: Evidence collection automated
    evidence_indicators:
    - Compliance automation platform in use
    - Evidence collected continuously
    - Audit trail maintained
  - id: SOC2-POS-003
    signal: Control monitoring established
    evidence_indicators:
    - Controls monitored for effectiveness
    - Exceptions identified and tracked
    - Remediation timely
procedure:
  context:
    cognitive_mode: critical
    ensemble_role: auditor
  preparation:
  - step: Identify scope of SOC 2 examination (systems, TSC)
  - step: Gather all existing policy documentation
  - step: Identify key control owners
  - step: Review any prior audit reports
  steps:
  - id: '1'
    name: Control Environment Assessment (CC1)
    description: |
      Evaluate organizational structure, ethics, human resources,
      and management philosophy.
    duration_estimate: 2-4 hours
    questions:
    - Is there a security function with clear responsibilities?
    - Are ethical standards documented and communicated?
    - Is there a background check process?
    - Is security awareness training provided?
    expected_findings:
    - Control environment maturity assessment
    - Organizational gaps
  - id: '2'
    name: Information and Communication (CC2)
    description: |
      Evaluate how security information is communicated internally
      and externally.
    duration_estimate: 1-2 hours
    questions:
    - How are security policies communicated?
    - Is there a system description document?
    - How are security incidents communicated?
    expected_findings:
    - Communication gaps
    - Documentation needs
  - id: '3'
    name: Risk Assessment (CC3)
    description: |
      Evaluate risk identification, assessment, and treatment processes.
    duration_estimate: 2-3 hours
    questions:
    - Has a risk assessment been conducted?
    - Are risks rated and prioritized?
    - Are controls mapped to risks?
    expected_findings:
    - Risk assessment status
    - Gap between risks and controls
  - id: '4'
    name: Monitoring Activities (CC4)
    description: |
      Evaluate ongoing monitoring of controls and remediation.
    duration_estimate: 1-2 hours
    expected_findings:
    - Monitoring maturity
    - Remediation tracking
  - id: '5'
    name: Control Activities (CC5)
    description: |
      Evaluate policies, procedures, and their implementation.
    duration_estimate: 3-4 hours
    expected_findings:
    - Policy completeness
    - Procedure documentation
  - id: '6'
    name: Logical and Physical Access (CC6)
    description: |
      Evaluate access control implementation and evidence.
    duration_estimate: 3-4 hours
    commands:
    - purpose: Check for access control configurations
      command: find . -name '*.tf' -o -name '*.yaml' | xargs grep -l 'rbac\|iam\|access' | head -20
    expected_findings:
    - Access control gaps
    - Evidence availability
  - id: '7'
    name: System Operations (CC7)
    description: |
      Evaluate vulnerability management, incident response,
      and business continuity.
    duration_estimate: 2-3 hours
    expected_findings:
    - Operations maturity
    - Incident response readiness
  - id: '8'
    name: Change Management (CC8)
    description: |
      Evaluate change control processes and evidence.
    duration_estimate: 2-3 hours
    expected_findings:
    - Change management maturity
    - Evidence gaps
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: readiness_matrix
    format: spreadsheet
    description: TSC criteria x readiness status
    columns:
    - Criteria ID
    - Criteria Description
    - Current State
    - Gap Description
    - Remediation Effort
    - Priority
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Scope Definition
    - Readiness Assessment by TSC Category
    - Critical Gaps
    - Remediation Roadmap
    - Timeline to Examination
  confidence_guidance:
    high: Documentation reviewed and control tested
    medium: Documentation reviewed, limited testing
    low: Based on interviews only
offline:
  capability: partial
  cache_manifest:
    knowledge:
    - source_id: aicpa-soc2
      priority: required
  degradation:
  - feature: Live control testing
    impact: Cannot verify technical controls
    mitigation: Export configurations before going offline
profiles:
  membership:
    quick:
      included: false
      reason: Comprehensive assessment required
    security:
      included: true
      priority: 5
    full:
      included: true
      priority: 10
closeout_checklist:
- id: soc2-001
  item: All Trust Services Criteria categories assessed
  level: CRITICAL
  verification: manual
  verification_notes: Reviewer confirms CC1-CC9 evaluated
  expected: Confirmed by reviewer
- id: soc2-002
  item: Policy framework completeness verified
  level: CRITICAL
  verification: manual
  verification_notes: All required policies exist and are current
  expected: Confirmed by reviewer
- id: soc2-003
  item: Evidence collection capability assessed
  level: CRITICAL
  verification: manual
  verification_notes: Evidence availability verified for key controls
  expected: Confirmed by reviewer
- id: soc2-004
  item: Remediation roadmap created
  level: BLOCKING
  verification: manual
  verification_notes: Prioritized remediation plan with timelines
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - saas
    - enterprise
    - fintech
    - healthcare-tech
    maturity:
    - growing
    - mature
  compliance_frameworks:
  - framework: SOC2
    controls:
    - All TSC
  - framework: ISO27001
    controls:
    - Significant overlap
relationships:
  commonly_combined:
  - compliance-governance.certifications-attestations.iso27001-readiness
  - compliance-governance.governance-framework.policy-completeness
  - security-trust.security-architecture.defense-in-depth
