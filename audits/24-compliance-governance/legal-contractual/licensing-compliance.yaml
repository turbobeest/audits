audit:
  id: compliance-governance.legal-contractual.licensing-compliance
  name: Licensing Compliance Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: compliance-governance
  category_number: 24
  subcategory: legal-contractual
  tier: expert
  estimated_duration: 4-8 hours  # median: 6h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
description:
  what: |
    Evaluates compliance with software licensing requirements including
    open source license obligations, commercial software license compliance,
    license inventory management, and license obligation tracking.
  why_it_matters: |
    Licensing compliance protects against legal risk:
    - Open source license violations can require source disclosure
    - Commercial software audits can result in significant penalties
    - GPL copyleft can "infect" proprietary code
    - IP disputes can block product releases

    Proper license management prevents costly remediation.
  when_to_run:
  - During M&A due diligence
  - Before product releases
  - When using new open source
  - During annual compliance review
  - After dependency changes
signals:
  critical:
  - id: LICENSE-CRIT-001
    signal: GPL or copyleft code in proprietary product
    evidence_indicators:
    - GPL dependencies in closed-source product
    - Copyleft obligations unmet
    - Source not available as required
    - Distribution violates license
    explanation: |
      GPL and similar copyleft licenses require source availability.
      Using in proprietary products without compliance creates legal risk.
    remediation: |
      1. Audit for copyleft licenses
      2. Evaluate compliance options
      3. Replace or isolate if needed
      4. Comply with obligations or remove
  - id: LICENSE-CRIT-002
    signal: Commercial software used without license
    evidence_indicators:
    - Unlicensed software in use
    - Exceeding license counts
    - License expired
    - Development licenses in production
    explanation: |
      Unlicensed commercial software use violates agreements and
      can result in significant penalties during audits.
    remediation: |
      1. Inventory commercial software
      2. Verify license coverage
      3. Purchase needed licenses
      4. Remove unlicensed software
  high:
  - id: LICENSE-HIGH-001
    signal: No license inventory
    evidence_indicators:
    - Dependencies not cataloged by license
    - License obligations unknown
    - Cannot answer compliance questions
    - License audit would be problematic
    explanation: |
      Without inventory, compliance status is unknown. Cannot
      demonstrate compliance or identify issues.
    remediation: |
      1. Scan for all licenses
      2. Create license inventory
      3. Identify problematic licenses
      4. Maintain ongoing
  - id: LICENSE-HIGH-002
    signal: Attribution requirements not met
    evidence_indicators:
    - Required notices missing
    - License text not included
    - Attribution incomplete
    - NOTICE file missing
    explanation: |
      Many licenses require attribution. Missing attribution
      violates license terms even if minor consequence.
    remediation: |
      1. Identify attribution requirements
      2. Create attribution file
      3. Include in distributions
      4. Automate generation
  medium:
  - id: LICENSE-MED-001
    signal: No license approval process
    evidence_indicators:
    - Any license used without review
    - No license policy
    - Developers choose freely
    remediation: |
      1. Create license policy
      2. Define approved licenses
      3. Require review for others
      4. Educate developers
  - id: LICENSE-MED-002
    signal: License obligations not tracked
    evidence_indicators:
    - Obligations not documented
    - Compliance not verified
    - Distribution requirements unclear
    remediation: |
      1. Document obligations per license
      2. Track compliance status
      3. Verify before release
  positive:
  - id: LICENSE-POS-001
    signal: Complete license compliance
    evidence_indicators:
    - All licenses inventoried
    - Obligations tracked
    - Attribution complete
    - Policy enforced
procedure:
  steps:
  - id: '1'
    name: License Inventory
    description: Scan and inventory all licenses.
    duration_estimate: 2-3 hours
    commands:
    - purpose: Scan for license files
      command: find . -name 'LICENSE*' -o -name 'COPYING*' -o -name 'NOTICE*' | head -50
    expected_findings:
    - License inventory
    - Problematic licenses
  - id: '2'
    name: Copyleft Review
    description: Identify copyleft licenses and compliance.
    duration_estimate: 1-2 hours
    expected_findings:
    - Copyleft presence
    - Compliance status
  - id: '3'
    name: Attribution Review
    description: Verify attribution compliance.
    duration_estimate: 1-2 hours
    expected_findings:
    - Attribution completeness
    - Missing notices
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: license_inventory
    format: spreadsheet
    description: All licenses with compliance status
profiles:
  membership:
    security:
      included: true
      priority: 25
    full:
      included: true
      priority: 30
relationships:
  commonly_combined:
  - compliance-governance.third-party-compliance.supply-chain-compliance
  - dependency-supply-chain.dependency-health.license-scanning
discovery:
  file_patterns:
  - glob: '**/COMPLIANCE*.md'
    purpose: Compliance documentation
  - glob: '**/audit*.yaml'
    purpose: Audit configuration
  - glob: '**/policy*.yaml'
    purpose: Policy configuration
  code_patterns:
  - pattern: audit|compliance|policy|regulation|soc2|iso27001|hipaa|pci
    type: regex
    scope: all
    purpose: Compliance references
