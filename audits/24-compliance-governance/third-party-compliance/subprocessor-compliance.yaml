audit:
  id: compliance-governance.third-party-compliance.subprocessor-compliance
  name: Subprocessor Compliance Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: compliance-governance
  category_number: 24
  subcategory: third-party-compliance
  tier: expert
  estimated_duration: 4-8 hours  # median: 6h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
description:
  what: |
    Evaluates compliance with subprocessor management requirements under
    GDPR and other privacy regulations. Assesses subprocessor inventory,
    notification processes, contractual requirements, customer communication,
    and monitoring practices.
  why_it_matters: |
    GDPR Article 28 and similar regulations require:
    - Written authorization for subprocessors
    - Customer notification of subprocessor changes
    - Contractual flow-down of data protection requirements
    - Subprocessor monitoring and compliance verification

    Subprocessor violations can result in regulatory penalties and
    customer contract breaches.
  when_to_run:
  - When processing personal data
  - During GDPR compliance assessments
  - When adding new subprocessors
  - During customer security reviews
  - Before international data transfers
signals:
  critical:
  - id: SUBPROC-CRIT-001
    signal: No subprocessor inventory
    evidence_indicators:
    - Cannot list subprocessors
    - Unknown who processes customer data
    - No subprocessor page published
    - Customer requests can't be answered
    explanation: |
      GDPR requires processors to know and disclose subprocessors.
      Unknown subprocessors prevent compliance.
    remediation: |
      1. Inventory all subprocessors
      2. Document data each receives
      3. Publish subprocessor list
      4. Maintain update process
  - id: SUBPROC-CRIT-002
    signal: No subprocessor notification to customers
    evidence_indicators:
    - Changes not communicated
    - No notification mechanism
    - Customer objection rights not enabled
    - DPA requirements not met
    explanation: |
      DPAs typically require notification of subprocessor changes.
      Failure violates contractual and regulatory requirements.
    remediation: |
      1. Create notification process
      2. Define notification timing
      3. Enable objection mechanism
      4. Document notifications
  high:
  - id: SUBPROC-HIGH-001
    signal: Subprocessors lack appropriate contracts
    evidence_indicators:
    - No DPAs with subprocessors
    - Contractual gaps
    - Obligations not flowed down
    - Processing terms unclear
    explanation: |
      GDPR requires controllers to ensure processor contracts flow
      down to subprocessors. Missing contracts create liability.
    remediation: |
      1. Review subprocessor contracts
      2. Execute DPAs where missing
      3. Ensure obligation flow-down
      4. Document contractual coverage
  medium:
  - id: SUBPROC-MED-001
    signal: Subprocessor locations not tracked
    evidence_indicators:
    - Processing locations unknown
    - Transfer mechanisms unclear
    - Adequacy decisions not verified
    remediation: |
      1. Document subprocessor locations
      2. Verify transfer mechanisms
      3. Update with changes
  positive:
  - id: SUBPROC-POS-001
    signal: Complete subprocessor management
    evidence_indicators:
    - Inventory complete and published
    - Notifications automated
    - Contracts in place
procedure:
  steps:
  - id: '1'
    name: Subprocessor Inventory Review
    description: Assess subprocessor inventory completeness.
    duration_estimate: 1-2 hours
    expected_findings:
    - Inventory completeness
    - Publication status
  - id: '2'
    name: Notification Process Assessment
    description: Evaluate customer notification process.
    duration_estimate: 1-2 hours
    expected_findings:
    - Process maturity
    - Compliance status
  - id: '3'
    name: Contractual Coverage Review
    description: Verify contractual coverage.
    duration_estimate: 2-3 hours
    expected_findings:
    - Contract coverage
    - Gaps identified
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: subprocessor_assessment
    format: spreadsheet
    description: Subprocessor compliance status
profiles:
  membership:
    security:
      included: true
      priority: 20
    full:
      included: true
      priority: 25
governance:
  compliance_frameworks:
  - framework: GDPR
    controls:
    - Art. 28
relationships:
  commonly_combined:
  - compliance-governance.third-party-compliance.vendor-compliance
  - compliance-governance.third-party-compliance.data-processing-agreement-coverage
discovery:
  file_patterns:
  - glob: '**/COMPLIANCE*.md'
    purpose: Compliance documentation
  - glob: '**/audit*.yaml'
    purpose: Audit configuration
  - glob: '**/policy*.yaml'
    purpose: Policy configuration
  code_patterns:
  - pattern: audit|compliance|policy|regulation|soc2|iso27001|hipaa|pci
    type: regex
    scope: all
    purpose: Compliance references
