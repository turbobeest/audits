audit:
  id: compliance-governance.third-party-compliance.data-processing-agreement-coverage
  name: Data Processing Agreement Coverage Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: compliance-governance
  category_number: 24
  subcategory: third-party-compliance
  tier: expert
  estimated_duration: 4-8 hours  # median: 6h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
description:
  what: |
    Evaluates Data Processing Agreement (DPA) coverage with vendors that
    process personal data. Assesses whether DPAs exist for all required
    relationships, contain all required terms per GDPR Article 28, and
    are properly executed and managed.
  why_it_matters: |
    GDPR Article 28 requires DPAs with all processors:
    - Processing without DPA is unlawful
    - DPA must contain specific required terms
    - Inadequate DPAs create joint liability
    - Customer audits verify DPA coverage

    Complete DPA coverage is fundamental to GDPR compliance.
  when_to_run:
  - During GDPR compliance assessments
  - When onboarding new vendors
  - Before regulatory inspections
  - During customer security reviews
  - Annually as part of vendor review
signals:
  critical:
  - id: DPA-CRIT-001
    signal: Vendors processing personal data without DPAs
    evidence_indicators:
    - No DPA executed with processor
    - Personal data shared without agreement
    - Verbal agreements only
    - Processing terms not documented
    explanation: |
      Processing personal data without DPA violates GDPR Article 28.
      This creates direct regulatory liability.
    remediation: |
      1. Identify all vendors processing personal data
      2. Execute DPAs with each
      3. Prioritize by data volume/sensitivity
      4. Document coverage
  - id: DPA-CRIT-002
    signal: DPAs missing required GDPR terms
    evidence_indicators:
    - Subject matter not specified
    - Security obligations inadequate
    - Audit rights missing
    - Subprocessor terms absent
    explanation: |
      Article 28 specifies required DPA contents. Incomplete DPAs
      may not provide legal protection.
    remediation: |
      1. Review all DPAs against Article 28
      2. Identify missing terms
      3. Amend or replace inadequate DPAs
      4. Use compliant DPA template
  high:
  - id: DPA-HIGH-001
    signal: DPA inventory incomplete
    evidence_indicators:
    - No central DPA tracking
    - Cannot locate executed DPAs
    - Coverage unknown
    - Renewal dates untracked
    explanation: |
      Without DPA inventory, you cannot demonstrate coverage or
      manage renewals. This creates audit risk.
    remediation: |
      1. Create DPA inventory
      2. Collect all executed DPAs
      3. Track key terms and dates
      4. Integrate with vendor management
  medium:
  - id: DPA-MED-001
    signal: Standard DPA template not used
    evidence_indicators:
    - Inconsistent DPA terms
    - Ad-hoc negotiations
    - Missing standard protections
    remediation: |
      1. Create standard DPA template
      2. Include all required terms
      3. Use for all vendor negotiations
      4. Document deviations
  positive:
  - id: DPA-POS-001
    signal: Complete DPA coverage
    evidence_indicators:
    - All processors have DPAs
    - DPAs contain required terms
    - Coverage tracked and managed
procedure:
  steps:
  - id: '1'
    name: DPA Inventory Assessment
    description: Review DPA inventory and coverage.
    duration_estimate: 2-3 hours
    expected_findings:
    - Coverage gaps
    - Missing DPAs
  - id: '2'
    name: DPA Content Review
    description: Evaluate DPA terms against Article 28.
    duration_estimate: 2-4 hours
    expected_findings:
    - Term completeness
    - Amendment needs
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: dpa_coverage_matrix
    format: spreadsheet
    description: Vendors x DPA status
profiles:
  membership:
    security:
      included: true
      priority: 20
    full:
      included: true
      priority: 25
governance:
  compliance_frameworks:
  - framework: GDPR
    controls:
    - Art. 28
relationships:
  commonly_combined:
  - compliance-governance.third-party-compliance.vendor-compliance
  - compliance-governance.regulatory-compliance.gdpr-compliance
discovery:
  file_patterns:
  - glob: '**/COMPLIANCE*.md'
    purpose: Compliance documentation
  - glob: '**/audit*.yaml'
    purpose: Audit configuration
  - glob: '**/policy*.yaml'
    purpose: Policy configuration
  code_patterns:
  - pattern: audit|compliance|policy|regulation|soc2|iso27001|hipaa|pci
    type: regex
    scope: all
    purpose: Compliance references
