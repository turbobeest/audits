audit:
  id: compliance-governance.third-party-compliance.supply-chain-compliance
  name: Supply Chain Compliance Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: compliance-governance
  category_number: 24
  subcategory: third-party-compliance
  tier: expert
  estimated_duration: 4-8 hours  # median: 6h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
description:
  what: |
    Evaluates software supply chain security and compliance including
    dependency management, SBOM generation, vulnerability tracking in
    dependencies, and compliance with supply chain security requirements
    (SSDF, SLSA, etc.).
  why_it_matters: |
    Supply chain attacks are increasing:
    - SolarWinds, Log4j, and similar attacks highlight supply chain risk
    - Executive orders mandate supply chain security (EO 14028)
    - Customers require SBOMs and supply chain attestations
    - Vulnerabilities in dependencies affect your product

    Supply chain compliance is both security and regulatory necessity.
  when_to_run:
  - When establishing supply chain security program
  - During security compliance assessments
  - Before government contract bids
  - After supply chain security incidents
  - During annual security reviews
signals:
  critical:
  - id: SUPPLY-CRIT-001
    signal: No software bill of materials (SBOM)
    evidence_indicators:
    - Dependencies not inventoried
    - Cannot produce SBOM
    - Third-party components unknown
    - Customer requests unfulfillable
    explanation: |
      SBOMs are increasingly required. Without SBOM, you cannot
      demonstrate supply chain visibility or respond to vulnerabilities.
    remediation: |
      1. Implement SBOM generation
      2. Include all dependencies
      3. Use standard formats (CycloneDX, SPDX)
      4. Automate generation in build
  - id: SUPPLY-CRIT-002
    signal: No dependency vulnerability scanning
    evidence_indicators:
    - Dependencies not scanned
    - Known vulnerabilities in dependencies
    - No update process
    - Security issues undiscovered
    explanation: |
      Dependencies contain vulnerabilities. Without scanning, you
      inherit unknown security issues in your product.
    remediation: |
      1. Implement dependency scanning
      2. Integrate in CI/CD
      3. Define remediation SLAs
      4. Monitor continuously
  high:
  - id: SUPPLY-HIGH-001
    signal: No supply chain security attestation
    evidence_indicators:
    - Build provenance not captured
    - No SLSA level achieved
    - Cannot attest to build integrity
    - Supply chain undocumented
    explanation: |
      Customers and regulators increasingly require supply chain
      attestations. Cannot demonstrate supply chain security.
    remediation: |
      1. Implement provenance capture
      2. Work toward SLSA levels
      3. Document build process
      4. Generate attestations
  - id: SUPPLY-HIGH-002
    signal: Dependencies not reviewed for licensing
    evidence_indicators:
    - License compliance unknown
    - Copyleft licenses undetected
    - License obligations unmet
    - Legal risk unmanaged
    explanation: |
      Dependencies have license obligations. Unknown licenses
      create legal and compliance risk.
    remediation: |
      1. Scan for licenses
      2. Create license policy
      3. Review problematic licenses
      4. Track obligations
  medium:
  - id: SUPPLY-MED-001
    signal: No secure software development framework
    evidence_indicators:
    - SSDF not implemented
    - Development practices undocumented
    - Cannot demonstrate secure development
    remediation: |
      1. Adopt SSDF or similar framework
      2. Document practices
      3. Collect evidence
      4. Attest to compliance
  positive:
  - id: SUPPLY-POS-001
    signal: Mature supply chain security
    evidence_indicators:
    - SBOM generated automatically
    - Dependencies continuously scanned
    - SLSA compliance achieved
    - Attestations available
procedure:
  steps:
  - id: '1'
    name: SBOM Capability Assessment
    description: Evaluate SBOM generation capability.
    duration_estimate: 1-2 hours
    commands:
    - purpose: Check for SBOM tools
      command: find . -name 'sbom*' -o -name '*.spdx*' -o -name '*cyclonedx*' 2>/dev/null | head -20
    expected_findings:
    - SBOM capability status
    - Format and completeness
  - id: '2'
    name: Dependency Scanning Review
    description: Evaluate vulnerability scanning for dependencies.
    duration_estimate: 1-2 hours
    expected_findings:
    - Scanning coverage
    - Remediation process
  - id: '3'
    name: Attestation Capability Review
    description: Assess supply chain attestation capability.
    duration_estimate: 1-2 hours
    expected_findings:
    - Attestation maturity
    - SLSA level
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: supply_chain_assessment
    format: prose
    sections:
    - SBOM Assessment
    - Scanning Coverage
    - Attestation Capability
    - Recommendations
profiles:
  membership:
    security:
      included: true
      priority: 15
    full:
      included: true
      priority: 20
governance:
  compliance_frameworks:
  - framework: EO14028
    controls:
    - SBOM
    - SSDF
  - framework: SLSA
    controls:
    - All levels
relationships:
  commonly_combined:
  - dependency-supply-chain.dependency-health.vulnerability-scanning
  - security-trust.secure-development.build-integrity
discovery:
  file_patterns:
  - glob: '**/COMPLIANCE*.md'
    purpose: Compliance documentation
  - glob: '**/audit*.yaml'
    purpose: Audit configuration
  - glob: '**/policy*.yaml'
    purpose: Policy configuration
  code_patterns:
  - pattern: audit|compliance|policy|regulation|soc2|iso27001|hipaa|pci
    type: regex
    scope: all
    purpose: Compliance references
