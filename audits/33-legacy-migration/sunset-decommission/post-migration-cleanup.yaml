audit:
  id: legacy-migration.sunset-decommission.post-migration-cleanup
  name: Post-Migration Cleanup Assessment Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: legacy-migration
  category_number: 33
  subcategory: sunset-decommission
  tier: expert
  estimated_duration: 3-5 hours  # median: 4h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: system
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates the completeness of post-migration cleanup activities including
    removal of legacy code, deactivation of old infrastructure, cleanup of
    temporary migration artifacts, and updating of documentation. This audit
    ensures migration projects are fully completed without leaving technical
    debt behind.
  why_it_matters: |
    Incomplete cleanup leaves orphaned resources consuming cost, creates
    confusion about what is current, and can reintroduce technical debt.
    Thorough cleanup ensures the full benefits of migration are realized
    and no legacy artifacts remain.
  when_to_run:
  - After migration stabilization
  - Before migration project close
  - During technical debt review
  - When legacy artifacts are discovered
prerequisites:
  required_artifacts:
  - type: migration_plan
    description: Original migration scope
  - type: infrastructure_inventory
    description: Infrastructure to be cleaned
  - type: code_inventory
    description: Code to be removed
  access_requirements:
  - Code repository access
  - Infrastructure access
  - Documentation access
  - CI/CD configuration
discovery:
  file_patterns:
  - glob: '**/legacy/**'
    purpose: Find legacy code directories
  - glob: '**/deprecated/**'
    purpose: Find deprecated code
  - glob: '**/migration/**'
    purpose: Find migration artifacts
  - glob: '**/TODO*'
    purpose: Find cleanup TODOs
  interview_questions:
  - role: Tech Lead
    questions:
    - What legacy code remains?
    - What infrastructure is still running?
    - What cleanup is pending?
  - role: DevOps Engineer
    questions:
    - What old infrastructure is still provisioned?
    - What CI/CD configurations need updating?
    - What monitoring needs cleanup?
knowledge_sources:
  guides:
  - id: cleanup-guide
    name: Post-Migration Cleanup Best Practices
    url: https://docs.aws.amazon.com/prescriptive-guidance/latest/migration-cleanup
  standards:
  - id: project-closure
    name: Project Closure Practices
    relevance: Project completion standards
tooling:
  analysis_tools:
  - tool: AWS Cost Explorer
    purpose: Identify orphaned resources
  - tool: Azure Cost Management
    purpose: Cloud resource cleanup
  - tool: git log
    purpose: Find unused code
    command: git log --all --full-history -- '**/legacy/**'
  - tool: code-maat
    purpose: Identify dead code
signals:
  critical:
  - id: PMC-CRIT-001
    signal: Legacy systems still running post-migration
    evidence_indicators:
    - Old systems consuming resources
    - Maintenance still occurring
    - Cost continuing
    explanation: |
      Running legacy systems after migration wastes resources and
      creates confusion about which system is authoritative.
    remediation: Decommission legacy systems immediately
  - id: PMC-CRIT-002
    signal: Migration artifacts in production code
    evidence_indicators:
    - Dual-write code still active
    - Feature flags for migration not removed
    - Temporary bridges still in place
    explanation: |
      Migration artifacts left in code add complexity and potential
      for bugs without providing value.
    remediation: Remove migration artifacts from codebase
  high:
  - id: PMC-HIGH-001
    signal: Orphaned infrastructure running
    remediation: Decommission unused infrastructure
  - id: PMC-HIGH-002
    signal: Documentation still references legacy system
    remediation: Update all documentation
  - id: PMC-HIGH-003
    signal: CI/CD pipelines for legacy system active
    remediation: Disable or remove legacy pipelines
  medium:
  - id: PMC-MED-001
    signal: Dead code not yet removed
    remediation: Schedule code cleanup
  - id: PMC-MED-002
    signal: Temporary data stores not cleaned
    remediation: Clean up temporary data
  low:
  - id: PMC-LOW-001
    signal: Minor documentation updates needed
    remediation: Update documentation
  - id: PMC-LOW-002
    signal: Old configuration files present
    remediation: Remove obsolete configurations
  positive:
  - id: PMC-POS-001
    signal: Complete cleanup with no legacy artifacts
  - id: PMC-POS-002
    signal: Migration project properly closed
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Inventory Remaining Artifacts
    description: List all legacy artifacts
    duration_estimate: 1 hour
  - id: '2'
    name: Check Infrastructure
    description: Identify running legacy infrastructure
    duration_estimate: 1 hour
  - id: '3'
    name: Review Codebase
    description: Find legacy and migration code
    duration_estimate: 1 hour
  - id: '4'
    name: Check Documentation
    description: Review documentation currency
    duration_estimate: 30 minutes
  - id: '5'
    name: Assess CI/CD
    description: Review pipeline configurations
    duration_estimate: 30 minutes
  - id: '6'
    name: Document Cleanup Tasks
    description: Create cleanup task list
    duration_estimate: 30 minutes
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Artifact Inventory
    - Infrastructure Status
    - Code Review
    - Cleanup Task List
closeout_checklist:
- id: pmc-001
  item: Legacy infrastructure identified
  level: WARNING
  verification: manual
- id: pmc-002
  item: Code cleanup tasks listed
  level: WARNING
  verification: manual
- id: pmc-003
  item: Cleanup priorities assigned
  level: WARNING
  verification: manual
governance:
  applicable_to:
    archetypes:
    - completed-migrations
    - cost-optimization
  compliance_mappings:
  - framework: FinOps
    control: Cost Optimization
    description: Resource cleanup
relationships:
  commonly_combined:
  - cost-management.resource-optimization
  - code-quality.technical-debt
  depends_on:
  - legacy-migration.data-migration.migration-verification
  feeds_into:
  - legacy-migration.sunset-decommission.decommission-execution
  - project-management.project-closure
