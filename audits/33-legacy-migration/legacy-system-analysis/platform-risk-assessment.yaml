# ============================================================
# AUDIT: Platform Risk Assessment
# Category: 33 - Legacy & Migration
# Subcategory: legacy-system-analysis
# ============================================================

audit:
  id: "legacy-migration.legacy-system-analysis.platform-risk-assessment"
  name: "Platform Risk Assessment Audit"
  version: "1.0.0"
  last_updated: "2025-01-22"
  status: "active"

  category: "legacy-migration"
  category_number: 33
  subcategory: "legacy-system-analysis"

  tier: "expert"
  estimated_duration: "6-10 hours"  # median: 8h

  completeness: "requires_discovery"
  requires_runtime: false
  destructive: false

execution:
  automatable: "partial"
  severity: "critical"
  scope: "system"

  default_profiles:
    - "full"
    - "quick"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Evaluates the risk profile of legacy platforms including operating systems,
    frameworks, databases, and middleware. This audit assesses end-of-life status,
    vendor support availability, security patch coverage, talent availability,
    and business continuity risks associated with aging technology platforms.

  why_it_matters: |
    Unsupported platforms create security vulnerabilities, compliance risks, and
    operational fragility. As platforms age, finding skilled engineers becomes
    harder and vendor support diminishes. Organizations must understand platform
    risks to make informed decisions about migration timing and investment.

  when_to_run:
    - "Annually for all production systems"
    - "When vendors announce end-of-life"
    - "Before contract renewals"
    - "During risk assessment cycles"

prerequisites:
  required_artifacts:
    - type: "system_inventory"
      description: "Complete inventory of platforms and versions"
    - type: "vendor_contracts"
      description: "Support contracts and SLAs"
    - type: "eol_schedules"
      description: "Vendor end-of-life announcements"

  access_requirements:
    - "Access to system inventory"
    - "Vendor portal access for EOL information"
    - "Security advisory subscriptions"

discovery:
  file_patterns:
    - glob: "**/Dockerfile*"
      purpose: "Identify base images and versions"
    - glob: "**/docker-compose*.yml"
      purpose: "Find infrastructure versions"
    - glob: "**/*.csproj"
      purpose: "Find .NET framework versions"
    - glob: "**/pom.xml"
      purpose: "Find Java versions"

  interview_questions:
    - role: "Infrastructure Lead"
      questions:
        - "What platforms are approaching end-of-life?"
        - "What is our patch compliance status?"
        - "Are there any unsupported systems in production?"
    - role: "Engineering Manager"
      questions:
        - "How difficult is it to find developers for our legacy platforms?"
        - "What training is required for legacy systems?"

knowledge_sources:
  guides:
    - id: "ms-lifecycle"
      name: "Microsoft Product Lifecycle"
      url: "https://docs.microsoft.com/en-us/lifecycle/"
    - id: "java-roadmap"
      name: "Oracle Java SE Support Roadmap"
      url: "https://www.oracle.com/java/technologies/java-se-support-roadmap.html"

  standards:
    - id: "nist-vulnerability"
      name: "NIST Vulnerability Management"
      relevance: "Vulnerability and patch management guidelines"

tooling:
  analysis_tools:
    - tool: "endoflife.date"
      purpose: "EOL information aggregation"
      command: "curl https://endoflife.date/api/all.json"
    - tool: "Nessus"
      purpose: "Vulnerability scanning for legacy platforms"
    - tool: "SCCM"
      purpose: "Windows platform inventory and compliance"

signals:
  critical:
    - id: "PRA-CRIT-001"
      signal: "Production system on unsupported platform"
      evidence_indicators:
        - "Operating system past end-of-life date"
        - "Framework no longer receiving security patches"
        - "Database version without vendor support"
      explanation: |
        Unsupported platforms cannot receive security patches, creating
        unmitigated vulnerability exposure. This represents immediate
        security and compliance risk.
      remediation: "Implement migration plan immediately or deploy compensating controls"

    - id: "PRA-CRIT-002"
      signal: "Platform with known unpatched critical vulnerabilities"
      evidence_indicators:
        - "CVE with no available patch for platform version"
        - "Exploits actively used in the wild"
      explanation: |
        Known vulnerabilities without patches are open attack vectors
        that cannot be remediated without platform upgrade.
      remediation: "Emergency migration or network isolation required"

  high:
    - id: "PRA-HIGH-001"
      signal: "Platform reaching EOL within 12 months"
      remediation: "Initiate migration planning immediately"

    - id: "PRA-HIGH-002"
      signal: "Extended support only (no mainstream support)"
      remediation: "Plan migration to supported version"

    - id: "PRA-HIGH-003"
      signal: "Vendor stability concerns (acquisition, bankruptcy)"
      remediation: "Develop contingency plans and evaluate alternatives"

  medium:
    - id: "PRA-MED-001"
      signal: "Platform reaching EOL within 24 months"
      remediation: "Include migration in annual planning"

    - id: "PRA-MED-002"
      signal: "Limited talent pool for platform skills"
      remediation: "Invest in training or plan migration"

  low:
    - id: "PRA-LOW-001"
      signal: "Platform not on latest major version"
      remediation: "Plan upgrade during next maintenance window"

    - id: "PRA-LOW-002"
      signal: "Minor version behind current release"
      remediation: "Include in regular patching cycle"

  positive:
    - id: "PRA-POS-001"
      signal: "All platforms on supported versions with active patching"

    - id: "PRA-POS-002"
      signal: "Migration plans in place for all EOL platforms"

procedure:
  context:
    cognitive_mode: "evaluative"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Inventory Platforms"
      description: "Create comprehensive list of all platforms and versions"
      duration_estimate: "2 hours"

    - id: "2"
      name: "Check EOL Status"
      description: "Research end-of-life dates for all platforms"
      duration_estimate: "2 hours"

    - id: "3"
      name: "Assess Support Status"
      description: "Determine support level and patch availability"
      duration_estimate: "1 hour"

    - id: "4"
      name: "Evaluate Security Posture"
      description: "Identify known vulnerabilities and patch gaps"
      duration_estimate: "2 hours"

    - id: "5"
      name: "Assess Talent Availability"
      description: "Research market availability of platform skills"
      duration_estimate: "1 hour"

    - id: "6"
      name: "Calculate Risk Scores"
      description: "Assign risk ratings to each platform"
      duration_estimate: "1 hour"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Platform Inventory"
        - "EOL Analysis"
        - "Security Risk Assessment"
        - "Talent Availability Analysis"
        - "Prioritized Risk Register"

closeout_checklist:
  - id: "pra-001"
    item: "All platforms inventoried with versions"
    level: "WARNING"
    verification: "manual"
  - id: "pra-002"
    item: "EOL dates documented for all platforms"
    level: "WARNING"
    verification: "manual"
  - id: "pra-003"
    item: "Risk scores assigned and prioritized"
    level: "WARNING"
    verification: "manual"

governance:
  applicable_to:
    archetypes: ["enterprise-systems", "regulated-industries", "long-running-systems"]

  compliance_mappings:
    - framework: "ISO 27001"
      control: "A.12.6.1"
      description: "Management of technical vulnerabilities"
    - framework: "PCI DSS"
      control: "6.2"
      description: "Protect system components from known vulnerabilities"
    - framework: "SOC 2"
      control: "CC6.1"
      description: "Logical and physical access controls"

relationships:
  commonly_combined:
    - "security.vulnerability-management"
    - "compliance.regulatory-requirements"
  depends_on:
    - "inventory.system-inventory"
  feeds_into:
    - "legacy-migration.migration-planning.priority-assessment"
    - "risk-management.technology-risk-register"
