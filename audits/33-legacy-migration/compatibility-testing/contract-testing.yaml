audit:
  id: legacy-migration.compatibility-testing.contract-testing
  name: Contract Testing Assessment Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: legacy-migration
  category_number: 33
  subcategory: compatibility-testing
  tier: phd
  estimated_duration: 4-8 hours  # median: 6h
  completeness: requires_discovery
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: integration
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates the implementation and coverage of contract testing between services,
    particularly between legacy and modernized components. This audit examines
    consumer-driven contracts, provider verification, and contract versioning
    to ensure integrations remain compatible during migration.
  why_it_matters: |
    During migration, maintaining compatibility between old and new systems is
    critical. Contract tests provide automated verification that changes don't
    break integrations. Without contract testing, integration failures are only
    discovered in integrated environments or production.
  when_to_run:
  - During migration planning
  - Before service changes
  - When adding new integrations
  - During CI/CD review
prerequisites:
  required_artifacts:
  - type: service_contracts
    description: API contracts and specifications
  - type: integration_documentation
    description: Service integration documentation
  - type: test_infrastructure
    description: Contract testing setup
  access_requirements:
  - Contract test access
  - CI/CD pipeline access
  - Service endpoints for verification
discovery:
  file_patterns:
  - glob: '**/pacts/**'
    purpose: Find Pact contracts
  - glob: '**/*contract*test*'
    purpose: Find contract tests
  - glob: '**/openapi*.{yaml,json}'
    purpose: Find API specifications
  - glob: '**/consumer/**'
    purpose: Find consumer test code
  interview_questions:
  - role: Developer
    questions:
    - How do you verify API compatibility?
    - What contract testing tools are used?
    - How are contracts versioned?
  - role: QA Engineer
    questions:
    - What integration testing exists?
    - How are API changes validated?
    - What failures have contracts caught?
knowledge_sources:
  guides:
  - id: pact-docs
    name: Pact Documentation
    url: https://docs.pact.io/
  - id: consumer-driven-contracts
    name: Consumer-Driven Contracts
    url: https://martinfowler.com/articles/consumerDrivenContracts.html
  standards:
  - id: openapi
    name: OpenAPI Specification
    relevance: API contract specification
tooling:
  analysis_tools:
  - tool: Pact
    purpose: Consumer-driven contract testing
    command: pact-verifier --provider-base-url=http://api
  - tool: Spring Cloud Contract
    purpose: Java contract testing
  - tool: dredd
    purpose: API contract validation
    command: dredd openapi.yaml http://api
  - tool: Prism
    purpose: OpenAPI mock and validation
    command: prism mock openapi.yaml
signals:
  critical:
  - id: CTA-CRIT-001
    signal: No contract testing between migrating services
    evidence_indicators:
    - No contract tests exist
    - Integration verification manual only
    - Changes deployed without compatibility check
    explanation: |
      Without contract testing, integration breakage during migration
      will only be detected in production or late-stage testing.
    remediation: Implement contract testing before migration proceeds
  - id: CTA-CRIT-002
    signal: Contract tests not run in CI/CD
    evidence_indicators:
    - Contracts exist but not automated
    - Manual verification required
    - Contracts often outdated
    explanation: |
      Contract tests not in CI/CD provide little protection as they
      are often skipped or outdated.
    remediation: Integrate contract testing into CI/CD pipeline
  high:
  - id: CTA-HIGH-001
    signal: Contract coverage incomplete
    remediation: Add contracts for all critical integrations
  - id: CTA-HIGH-002
    signal: Consumer contracts not verified against provider
    remediation: Implement provider verification in CI/CD
  - id: CTA-HIGH-003
    signal: Contract versioning not managed
    remediation: Implement contract versioning strategy
  medium:
  - id: CTA-MED-001
    signal: Some integrations lack contracts
    remediation: Prioritize contract addition
  - id: CTA-MED-002
    signal: Contract test infrastructure fragile
    remediation: Improve contract test reliability
  low:
  - id: CTA-LOW-001
    signal: Contract documentation incomplete
    remediation: Improve contract documentation
  - id: CTA-LOW-002
    signal: Minor contract coverage gaps
    remediation: Add contracts during feature work
  positive:
  - id: CTA-POS-001
    signal: Comprehensive contract testing in CI/CD
  - id: CTA-POS-002
    signal: Consumer-driven contracts actively used
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Inventory Integrations
    description: List all service integrations
    duration_estimate: 1 hour
  - id: '2'
    name: Review Contract Coverage
    description: Map contracts to integrations
    duration_estimate: 1 hour
  - id: '3'
    name: Evaluate Test Infrastructure
    description: Assess contract testing setup
    duration_estimate: 1 hour
  - id: '4'
    name: Check CI/CD Integration
    description: Verify automated execution
    duration_estimate: 1 hour
  - id: '5'
    name: Run Contract Tests
    description: Execute existing contracts
    duration_estimate: 2 hours
  - id: '6'
    name: Document Gaps
    description: Identify coverage gaps
    duration_estimate: 1 hour
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Integration Inventory
    - Contract Coverage
    - Infrastructure Assessment
    - Gap Analysis
    - Recommendations
closeout_checklist:
- id: cta-001
  item: Integration contracts inventoried
  level: WARNING
  verification: manual
- id: cta-002
  item: Contract coverage assessed
  level: WARNING
  verification: tool_output
- id: cta-003
  item: CI/CD integration verified
  level: WARNING
  verification: manual
governance:
  applicable_to:
    archetypes:
    - microservices
    - api-integrations
    - service-migration
  compliance_mappings:
  - framework: ISO 25010
    control: Interoperability
    description: System interaction compatibility
relationships:
  commonly_combined:
  - legacy-migration.api-versioning.backward-compatibility
  - ci-cd.test-automation
  depends_on:
  - legacy-migration.legacy-system-analysis.integration-mapping
  feeds_into:
  - legacy-migration.migration-planning.migration-risk-assessment
  - quality-assurance.integration-testing
