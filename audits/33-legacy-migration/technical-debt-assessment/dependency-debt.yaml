audit:
  id: legacy-migration.technical-debt-assessment.dependency-debt
  name: Dependency Debt Analysis Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: legacy-migration
  category_number: 33
  subcategory: technical-debt-assessment
  tier: expert
  estimated_duration: 4-6 hours  # median: 5h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: full
  severity: high
  scope: system
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Analyzes the technical debt accumulated in project dependencies including
    outdated packages, deprecated libraries, unsupported versions, and security
    vulnerabilities. This audit inventories all dependencies, measures version lag,
    identifies end-of-life components, and assesses the effort required to update
    the dependency stack.
  why_it_matters: |
    Outdated dependencies create security risks, compatibility issues, and make
    future upgrades exponentially more difficult. Dependency debt compounds over
    time - the longer updates are deferred, the more breaking changes accumulate.
    Organizations face significant risk when critical dependencies lose support.
  when_to_run:
  - Monthly as part of regular maintenance
  - Before major version upgrades
  - After security advisories
  - During annual technical reviews
prerequisites:
  required_artifacts:
  - type: dependency_manifests
    description: Package.json, pom.xml, requirements.txt, etc.
  - type: lock_files
    description: Dependency lock files for exact versions
  access_requirements:
  - Read access to source repositories
  - Access to package registries
  - Security vulnerability databases
discovery:
  file_patterns:
  - glob: '**/package.json'
    purpose: Find Node.js dependencies
  - glob: '**/pom.xml'
    purpose: Find Maven dependencies
  - glob: '**/requirements*.txt'
    purpose: Find Python dependencies
  - glob: '**/Gemfile*'
    purpose: Find Ruby dependencies
  - glob: '**/go.mod'
    purpose: Find Go dependencies
  - glob: '**/Cargo.toml'
    purpose: Find Rust dependencies
  interview_questions:
  - role: Tech Lead
    questions:
    - Are there any dependencies you're afraid to update?
    - What's preventing framework version upgrades?
    - Have you experienced breaking changes from dependency updates?
knowledge_sources:
  guides:
  - id: dependabot
    name: GitHub Dependabot Documentation
    url: https://docs.github.com/en/code-security/dependabot
  - id: snyk-guides
    name: Snyk Dependency Management
    url: https://snyk.io/learn/dependency-management/
  standards:
  - id: cve-database
    name: CVE Vulnerability Database
    relevance: Known security vulnerabilities
tooling:
  analysis_tools:
  - tool: npm-check
    purpose: Node.js dependency analysis
    command: npm-check --skip-unused
  - tool: npm outdated
    purpose: List outdated packages
    command: npm outdated --json
  - tool: pip-audit
    purpose: Python dependency security audit
    command: pip-audit
  - tool: mvn versions
    purpose: Maven dependency updates
    command: mvn versions:display-dependency-updates
  - tool: Snyk
    purpose: Vulnerability scanning
    command: snyk test
  - tool: OWASP Dependency-Check
    purpose: Security vulnerability detection
    command: dependency-check --project project-name --scan .
signals:
  critical:
  - id: DDA-CRIT-001
    signal: Dependencies with known critical CVEs unpatched
    evidence_indicators:
    - CVSS score 9.0+ vulnerabilities present
    - Actively exploited vulnerabilities in dependencies
    - No patch available requiring dependency replacement
    explanation: |
      Critical vulnerabilities in dependencies expose the entire application
      to exploitation. These represent immediate security risks requiring
      urgent remediation.
    remediation: Apply patches immediately or implement compensating controls
  - id: DDA-CRIT-002
    signal: Major framework version 3+ generations behind
    evidence_indicators:
    - Using end-of-life framework versions
    - No security patches available for current version
    explanation: |
      Frameworks multiple major versions behind lack security support and
      accumulate compatibility debt that makes future migration extremely
      difficult.
    remediation: Plan major version upgrade project immediately
  high:
  - id: DDA-HIGH-001
    signal: Over 50% of dependencies outdated by 2+ major versions
    remediation: Implement systematic dependency update process
  - id: DDA-HIGH-002
    signal: Dependencies approaching end-of-life within 6 months
    remediation: Plan migration before support ends
  - id: DDA-HIGH-003
    signal: Deprecated packages with no replacement planned
    remediation: Identify and evaluate replacement packages
  medium:
  - id: DDA-MED-001
    signal: Dependencies 1-2 major versions behind
    remediation: Schedule updates in upcoming maintenance windows
  - id: DDA-MED-002
    signal: No automated dependency update process
    remediation: Implement Dependabot or similar automation
  low:
  - id: DDA-LOW-001
    signal: Minor version updates available
    remediation: Include in regular maintenance cycles
  - id: DDA-LOW-002
    signal: Unused dependencies in manifest files
    remediation: Remove unused dependencies to reduce surface area
  positive:
  - id: DDA-POS-001
    signal: Dependencies regularly updated with automation
  - id: DDA-POS-002
    signal: No known vulnerabilities in dependency tree
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Inventory Dependencies
    description: Catalog all direct and transitive dependencies
    duration_estimate: 1 hour
  - id: '2'
    name: Check Version Currency
    description: Compare installed versions against latest available
    duration_estimate: 1 hour
  - id: '3'
    name: Scan for Vulnerabilities
    description: Run security scanning tools against dependency tree
    duration_estimate: 1 hour
  - id: '4'
    name: Assess EOL Status
    description: Identify dependencies at or approaching end-of-life
    duration_estimate: 1 hour
  - id: '5'
    name: Calculate Update Effort
    description: Estimate effort to bring dependencies current
    duration_estimate: 1 hour
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Dependency Inventory
    - Version Analysis
    - Vulnerability Report
    - EOL Assessment
    - Update Roadmap
closeout_checklist:
- id: dda-001
  item: All dependency manifests analyzed
  level: WARNING
  verification: tool_output
- id: dda-002
  item: Security vulnerabilities catalogued
  level: WARNING
  verification: tool_output
- id: dda-003
  item: Update priority list created
  level: WARNING
  verification: manual
governance:
  applicable_to:
    archetypes:
    - any-software-project
    - security-conscious-organizations
  compliance_mappings:
  - framework: PCI DSS
    control: '6.2'
    description: System components protected with security patches
  - framework: OWASP ASVS
    control: '14.2'
    description: Dependency security verification
relationships:
  commonly_combined:
  - security.dependency-scanning
  - security.vulnerability-management
  depends_on:
  - inventory.software-bill-of-materials
  feeds_into:
  - legacy-migration.migration-planning.technology-upgrade-path
