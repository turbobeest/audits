# ============================================================
# AUDIT: Grouping and Chunking Assessment
# ============================================================
# Evaluates how information is grouped and chunked to support
# cognitive processing and reduce memory load.
# ============================================================

audit:
  id: "usability-interaction.cognitive-load.grouping-chunking"

  name: "Grouping and Chunking Assessment"

  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "usability-interaction"
  category_number: 14
  subcategory: "cognitive-load"

  tier: "expert"
  estimated_duration: "2-3 hours"  # median: 2h

  completeness: "complete"
  requires_runtime: true
  destructive: false

# ============================================================
# EXECUTION CLASSIFICATION
# ============================================================

execution:
  automatable: "partial"
  severity: "medium"
  scope: "codebase"

  default_profiles:
    - "full"

  blocks_phase: false
  parallelizable: true

# ============================================================
# DESCRIPTION & RATIONALE
# ============================================================

description:
  what: |
    This audit evaluates how information is grouped and chunked to
    support cognitive processing. Based on Gestalt principles and
    Miller's Law, it examines how related items are visually grouped,
    how information is broken into manageable chunks, and how structure
    supports user comprehension.

  why_it_matters: |
    Chunking transforms unmanageable amounts of information into
    digestible units. Gestalt principles of proximity, similarity,
    and common region help users understand relationships without
    conscious effort. Poor grouping increases cognitive load and
    makes information harder to process and remember.

  when_to_run:
    - "During information architecture design"
    - "When designing forms with many fields"
    - "During dashboard and reporting design"
    - "When users report comprehension difficulties"

# ============================================================
# PREREQUISITES
# ============================================================

prerequisites:
  required_artifacts:
    - type: "source_code"
      description: "UI component source code"
    - type: "running_application"
      description: "Access to view content structure"

  access_requirements:
    - "Access to layout components"
    - "Understanding of content relationships"

# ============================================================
# DISCOVERY SPECIFICATION
# ============================================================

discovery:
  code_patterns:
    - pattern: "fieldset|Fieldset|section|Section"
      type: "keyword"
      scope: "source"
      purpose: "Find grouping elements"
    - pattern: "Card|Panel|Box|Container"
      type: "keyword"
      scope: "source"
      purpose: "Find visual grouping components"
    - pattern: "Divider|Separator|hr"
      type: "keyword"
      scope: "source"
      purpose: "Find separation elements"
    - pattern: "group|Group|cluster|Cluster"
      type: "keyword"
      scope: "source"
      purpose: "Find explicit grouping"

  file_patterns:
    - glob: "**/*form*"
      purpose: "Find form components"
    - glob: "**/*section*"
      purpose: "Find section components"
    - glob: "**/*card*"
      purpose: "Find card components"

# ============================================================
# KNOWLEDGE SOURCES
# ============================================================

knowledge_sources:
  specifications:
    - id: "gestalt-principles"
      name: "Gestalt Principles of Perception"
      url: "https://lawsofux.com/gestalt-principles/"
      offline_cache: true
      priority: "required"
    - id: "miller-law"
      name: "Miller's Law"
      url: "https://lawsofux.com/millers-law/"
      offline_cache: true
      priority: "required"

  guides:
    - id: "nngroup-chunking"
      name: "Nielsen Norman Group - Chunking"
      url: "https://www.nngroup.com/articles/chunking/"
      offline_cache: true

# ============================================================
# TOOLING & AUTOMATION
# ============================================================

tooling:
  scripts:
    - id: "grouping-finder"
      language: "bash"
      purpose: "Find grouping patterns"
      source: "inline"
      code: |
        #!/bin/bash
        echo "=== Fieldset/Section Usage ==="
        grep -rn "fieldset\|<fieldset\|Section\|<section" --include="*.jsx" --include="*.tsx" | head -15

        echo "=== Card/Panel Components ==="
        grep -rn "Card\|Panel\|Box" --include="*.jsx" --include="*.tsx" | head -15

        echo "=== Divider Usage ==="
        grep -rn "Divider\|Separator\|<hr" --include="*.jsx" --include="*.tsx" | head -10

        echo "=== Legend/Label Groups ==="
        grep -rn "legend\|Legend\|FormGroup" --include="*.jsx" --include="*.tsx" | head -10

# ============================================================
# SIGNALS & FINDINGS TAXONOMY
# ============================================================

signals:
  critical:
    - id: "CHUNK-CRIT-001"
      signal: "Large unstructured list of items without grouping"
      evidence_indicators:
        - "Form with 15+ fields in single list"
        - "Navigation with 10+ items no categories"
        - "Settings as undifferentiated list"
      explanation: |
        Long ungrouped lists violate Miller's Law and make
        information difficult to scan and remember.
      remediation: "Group related items into labeled sections of 3-7 items"

  high:
    - id: "CHUNK-HIGH-001"
      signal: "Related items not visually grouped"
      evidence_pattern: "Semantically related items spread apart or mixed with unrelated"
      explanation: |
        Gestalt principle of proximity states items near each other
        are perceived as related. Separated related items force users
        to work harder to understand relationships.
      remediation: "Use proximity, borders, or backgrounds to group related items"
    - id: "CHUNK-HIGH-002"
      signal: "Groups too large to process easily"
      evidence_pattern: "Sections with >7 items"
      explanation: |
        Miller's Law suggests 7+/-2 as working memory limit.
        Groups exceeding this require subdivision.
      remediation: "Split large groups into sub-groups of 3-5 items"
    - id: "CHUNK-HIGH-003"
      signal: "No labels or headers for content groups"
      evidence_pattern: "Visual groups without explanatory headers"
      explanation: |
        Groups without labels force users to infer meaning,
        increasing cognitive effort.
      remediation: "Add clear labels/headers to all content groups"

  medium:
    - id: "CHUNK-MED-001"
      signal: "Inconsistent grouping patterns across similar screens"
      evidence_pattern: "Different grouping approaches for similar content"
      remediation: "Standardize grouping patterns for similar content types"
    - id: "CHUNK-MED-002"
      signal: "Visual grouping doesn't match semantic relationships"
      evidence_pattern: "Visual proximity doesn't reflect logical relationship"
      remediation: "Align visual grouping with content relationships"
    - id: "CHUNK-MED-003"
      signal: "Numbers not grouped for readability"
      evidence_pattern: "Phone numbers, credit cards without formatting"
      remediation: "Format long numbers with spaces or dashes (123-456-7890)"

  low:
    - id: "CHUNK-LOW-001"
      signal: "Grouping could be more visually distinct"
      remediation: "Increase visual separation between groups"
    - id: "CHUNK-LOW-002"
      signal: "Color coding could enhance grouping"
      remediation: "Consider subtle color differentiation for group types"

  positive:
    - id: "CHUNK-POS-001"
      signal: "Information clearly chunked into labeled groups"
    - id: "CHUNK-POS-002"
      signal: "Related items visually proximate"
    - id: "CHUNK-POS-003"
      signal: "Groups sized within Miller's Law limits"
    - id: "CHUNK-POS-004"
      signal: "Long numbers properly formatted"

# ============================================================
# EXECUTION PROCEDURE
# ============================================================

procedure:
  context:
    cognitive_mode: "evaluative"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Identify Grouping Mechanisms"
      description: |
        Search the codebase for grouping components and
        patterns in use.
      duration_estimate: "20 min"
      commands:
        - purpose: "Find fieldset/section usage"
          command: "grep -rn 'fieldset\\|<section\\|FormGroup' --include='*.jsx' --include='*.tsx' src/"
        - purpose: "Find card/panel components"
          command: "grep -rn 'Card\\|Panel\\|Box' --include='*.jsx' --include='*.tsx' src/"
      expected_findings:
        - "Grouping components in use"
        - "Grouping patterns"

    - id: "2"
      name: "Evaluate Form Grouping"
      description: |
        Analyze form structures to see how fields are grouped
        and whether grouping follows logical relationships.
      duration_estimate: "30 min"
      questions:
        - "Are form fields grouped logically?"
        - "Do groups have clear labels?"
        - "Are groups appropriately sized (3-7 items)?"
      expected_findings:
        - "Form grouping assessment"
        - "Field count per group"

    - id: "3"
      name: "Assess Visual Grouping"
      description: |
        Review screens to evaluate how visual elements create
        perceptual groups through Gestalt principles.
      duration_estimate: "25 min"
      questions:
        - "Does proximity create appropriate groups?"
        - "Do borders/backgrounds define groups clearly?"
        - "Is there adequate separation between groups?"
      expected_findings:
        - "Visual grouping effectiveness"
        - "Gestalt principle application"

    - id: "4"
      name: "Review Number Formatting"
      description: |
        Check formatting of long numbers (phone, credit card,
        IDs) for chunking.
      duration_estimate: "15 min"
      questions:
        - "Are phone numbers formatted with separators?"
        - "Are credit card numbers grouped?"
        - "Are long ID numbers chunked for readability?"
      expected_findings:
        - "Number formatting patterns"
        - "Readability issues"

# ============================================================
# OUTPUT SPECIFICATION
# ============================================================

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Grouping Mechanism Analysis"
        - "Form Grouping Assessment"
        - "Visual Grouping Review"
        - "Number Formatting Check"
        - "Recommendations"

  confidence_guidance:
    high: "Issues verified through structure analysis and visual review"
    medium: "Issues identified through code or visual review alone"
    low: "Potential issues requiring user testing"

# ============================================================
# OFFLINE SUPPORT
# ============================================================

offline:
  capability: "full"

  cache_manifest:
    knowledge:
      - source_id: "gestalt-principles"
        priority: "required"
      - source_id: "miller-law"
        priority: "required"

# ============================================================
# PROFILES
# ============================================================

profiles:
  membership:
    quick:
      included: false
      reason: "Requires detailed structural analysis"
    full:
      included: true
      priority: 2

# ============================================================
# CLOSEOUT CHECKLIST
# ============================================================

closeout_checklist:
  - id: "chunk-001"
    item: "Forms use labeled field groups"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Form fields grouped with clear section labels"
    expected: "Confirmed by reviewer"

  - id: "chunk-002"
    item: "Groups sized appropriately"
    level: "WARNING"
    verification: "manual"
    verification_notes: "Most groups contain 3-7 items"
    expected: "Confirmed by reviewer"

  - id: "chunk-003"
    item: "Long numbers formatted with separators"
    level: "WARNING"
    verification: "manual"
    verification_notes: "Phone, credit cards use chunked formatting"
    expected: "Confirmed by reviewer"

# ============================================================
# GOVERNANCE
# ============================================================

governance:
  applicable_to:
    archetypes: ["web-application", "form-heavy-application", "saas"]

# ============================================================
# RELATIONSHIPS
# ============================================================

relationships:
  commonly_combined:
    - "usability-interaction.forms-input.form-layout"
    - "usability-interaction.cognitive-load.information-density"
    - "usability-interaction.cognitive-load.visual-hierarchy"
