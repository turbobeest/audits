audit:
  id: usability-interaction.consistency.visual-consistency
  name: Visual Consistency Assessment
  version: 1.0.0
  last_updated: '2026-01-19'
  status: active
  category: usability-interaction
  category_number: 14
  subcategory: consistency
  tier: phd
  estimated_duration: 3-4 hours  # median: 3h
  completeness: complete
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: codebase
  default_profiles:
  - full
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit evaluates visual design consistency across the application.
    It examines use of design tokens, color palettes, typography scales,
    spacing systems, and component styling to identify inconsistencies
    that may confuse users or indicate design system fragmentation.
  why_it_matters: |
    Visual consistency is fundamental to usability. Inconsistent design
    increases cognitive load as users must relearn interface patterns.
    It also damages brand perception and suggests lack of attention to
    quality. Nielsen's heuristic #4 (Consistency and Standards) identifies
    this as a core usability principle.
  when_to_run:
  - During design system audits
  - After major feature additions
  - When onboarding new designers or developers
  - During brand refresh projects
prerequisites:
  required_artifacts:
  - type: source_code
    description: Component and styling source code
  - type: design_system
    description: Design system documentation or tokens (if available)
  access_requirements:
  - Access to CSS/SCSS/styled-components source
  - Access to design token definitions
  - Running application for visual inspection
discovery:
  code_patterns:
  - pattern: '#[0-9a-fA-F]{3,6}|rgb\(|rgba\('
    type: regex
    scope: source
    purpose: Find hardcoded color values
  - pattern: 'font-size:|fontSize:'
    type: regex
    scope: source
    purpose: Find font size declarations
  - pattern: 'margin:|padding:|gap:'
    type: regex
    scope: source
    purpose: Find spacing declarations
  - pattern: var\(--
    type: regex
    scope: source
    purpose: Find CSS custom property usage
  file_patterns:
  - glob: '**/*.css'
    purpose: Find stylesheets
  - glob: '**/*.scss'
    purpose: Find SCSS files
  - glob: '**/theme*'
    purpose: Find theme configuration
  - glob: '**/tokens*'
    purpose: Find design token files
knowledge_sources:
  specifications:
  - id: nielsen-consistency
    name: Nielsen Norman Group - Consistency Heuristic
    url: https://www.nngroup.com/articles/consistency-and-standards/
    offline_cache: true
    priority: required
  guides:
  - id: design-tokens
    name: Design Tokens Community Group
    url: https://www.designtokens.org/
    offline_cache: true
  - id: material-design
    name: Material Design - Applying Color
    url: https://m3.material.io/styles/color/applying-color
    offline_cache: true
  learning_resources:
  - id: atomic-design
    title: Atomic Design by Brad Frost
    type: book
    reference: https://atomicdesign.bradfrost.com/
tooling:
  static_analysis:
  - tool: stylelint
    purpose: Enforce CSS consistency rules
    offline_capable: true
  - tool: color-contrast-checker
    purpose: Verify color contrast consistency
    offline_capable: true
  scripts:
  - id: color-inventory
    language: bash
    purpose: Extract all colors used in the codebase
    source: inline
    code: |
      #!/bin/bash
      echo "=== Hex Colors ==="
      grep -roh '#[0-9a-fA-F]\{3,6\}' --include="*.css" --include="*.scss" --include="*.ts" --include="*.tsx" | \
        sort | uniq -c | sort -rn | head -30

      echo "=== Font Sizes ==="
      grep -roh 'font-size:\s*[^;]*' --include="*.css" --include="*.scss" | \
        sort | uniq -c | sort -rn | head -20

      echo "=== Spacing Values ==="
      grep -roh '\(margin\|padding\):\s*[^;]*' --include="*.css" --include="*.scss" | \
        grep -oh '[0-9]*px\|[0-9]*rem\|[0-9]*em' | sort | uniq -c | sort -rn | head -20
signals:
  critical:
  - id: VISUAL-CRIT-001
    signal: No design system or token system in use
    evidence_indicators:
    - All colors hardcoded throughout codebase
    - No theme or token files present
    - No CSS custom properties for design values
    explanation: |
      Without a design system, inconsistency is inevitable and
      maintaining visual coherence becomes increasingly difficult
      as the application grows.
    remediation: Implement design tokens for colors, typography, and spacing
  high:
  - id: VISUAL-HIGH-001
    signal: Excessive color variations not matching design system
    evidence_pattern: '>20 distinct color values found outside token system'
    explanation: |
      Too many colors create visual chaos and suggest designers and
      developers are making ad-hoc decisions rather than following
      a system.
    remediation: Consolidate to design system colors; remove or map non-compliant colors
  - id: VISUAL-HIGH-002
    signal: Typography scale not followed consistently
    evidence_indicators:
    - Arbitrary font sizes like 13px, 17px, 19px
    - No defined type scale (e.g., modular scale)
    - Different fonts for same semantic purpose
    explanation: |
      Inconsistent typography creates visual noise and makes
      establishing hierarchy difficult.
    remediation: Define and enforce a typography scale with limited, named sizes
  - id: VISUAL-HIGH-003
    signal: Spacing values arbitrary rather than systematic
    evidence_pattern: Many different pixel values for spacing (4px, 7px, 13px, etc.)
    explanation: |
      Arbitrary spacing creates uneven layouts and makes alignment
      difficult across different components.
    remediation: Implement spacing scale (4, 8, 16, 24, 32, etc.) and use consistently
  medium:
  - id: VISUAL-MED-001
    signal: Component styling varies across instances
    evidence_indicators:
    - Buttons with different padding in different areas
    - Cards with inconsistent border radius
    - Input fields with varying heights
    remediation: Create and use consistent component variants from design system
  - id: VISUAL-MED-002
    signal: Design tokens exist but not used consistently
    evidence_pattern: Hardcoded values alongside token usage
    remediation: Migrate all hardcoded values to design tokens
  - id: VISUAL-MED-003
    signal: Icon style inconsistency
    evidence_indicators:
    - Mix of outlined and filled icons
    - Different icon libraries in use
    - Inconsistent icon sizes
    remediation: Standardize on single icon style and library
  low:
  - id: VISUAL-LOW-001
    signal: Minor spacing inconsistencies in edge cases
    remediation: Audit and fix spacing in non-standard layouts
  - id: VISUAL-LOW-002
    signal: Design tokens need documentation
    remediation: Document token purposes and usage guidelines
  positive:
  - id: VISUAL-POS-001
    signal: Comprehensive design token system in use
  - id: VISUAL-POS-002
    signal: Consistent typography scale implemented
  - id: VISUAL-POS-003
    signal: Spacing system follows defined scale
  - id: VISUAL-POS-004
    signal: Component library enforces consistency
procedure:
  context:
    cognitive_mode: evaluative
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Inventory Design Tokens
    description: |
      Identify whether a design token system exists and catalog
      its contents.
    duration_estimate: 25 min
    commands:
    - purpose: Find theme/token files
      command: find src/ -name '*theme*' -o -name '*token*' -o -name '*variables*' 2>/dev/null
    - purpose: Check for CSS custom properties
      command: grep -rn 'var(--' --include='*.css' --include='*.scss' --include='*.tsx' src/ | head -20
    expected_findings:
    - Design token file locations
    - Token coverage
  - id: '2'
    name: Extract Color Inventory
    description: |
      Catalog all colors used in the application to identify
      inconsistencies and unauthorized colors.
    duration_estimate: 30 min
    commands:
    - purpose: Find all hex colors
      command: grep -roh '#[0-9a-fA-F]\{3,6\}' --include='*.css' --include='*.scss' --include='*.tsx'
        src/ | sort | uniq -c | sort -rn | head -30
    expected_findings:
    - Total unique colors
    - Colors outside design system
  - id: '3'
    name: Analyze Typography Usage
    description: |
      Review font sizes, weights, and families for consistency
      with design system.
    duration_estimate: 25 min
    commands:
    - purpose: Find font size declarations
      command: grep -roh 'font-size:[^;]*' --include='*.css' --include='*.scss' src/ | sort | uniq -c
        | sort -rn | head -20
    questions:
    - Is there a defined type scale?
    - Are font sizes consistent with the scale?
    - Is font family consistent?
    expected_findings:
    - Typography scale adherence
    - Font size variations
  - id: '4'
    name: Review Spacing System
    description: |
      Analyze spacing values to determine if a consistent
      spacing scale is in use.
    duration_estimate: 25 min
    commands:
    - purpose: Extract spacing values
      command: grep -roh '\(margin\|padding\|gap\):[^;]*' --include='*.css' --include='*.scss' src/ |
        grep -oh '[0-9]*px\|[0-9]*rem' | sort | uniq -c | sort -rn | head -20
    expected_findings:
    - Spacing scale adherence
    - Non-standard spacing values
  - id: '5'
    name: Visual Inspection
    description: |
      Manually inspect the application to identify visual
      inconsistencies not detectable through code analysis.
    duration_estimate: 30 min
    questions:
    - Do buttons look consistent across the application?
    - Are cards and containers styled consistently?
    - Is color usage consistent for similar elements?
    - Are icons consistent in style and size?
    expected_findings:
    - Component visual consistency
    - Page-to-page consistency
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Design Token Assessment
    - Color Inventory
    - Typography Analysis
    - Spacing Analysis
    - Recommendations
  confidence_guidance:
    high: Issues verified through code analysis and visual inspection
    medium: Issues identified through code analysis only
    low: Potential issues requiring designer confirmation
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: nielsen-consistency
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires comprehensive analysis and visual inspection
    full:
      included: true
      priority: 2
closeout_checklist:
- id: visual-001
  item: Design token system assessed
  level: BLOCKING
  verification: manual
  verification_notes: Document existence and coverage of design tokens
  expected: Confirmed by reviewer
- id: visual-002
  item: Color inventory completed
  level: BLOCKING
  verification: manual
  verification_notes: All colors cataloged and compared to design system
  expected: Confirmed by reviewer
- id: visual-003
  item: Typography consistency assessed
  level: WARNING
  verification: manual
  verification_notes: Font sizes and families reviewed for consistency
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - web-application
    - mobile-application
    - saas
relationships:
  commonly_combined:
  - usability-interaction.consistency.component-reuse
  - usability-interaction.cognitive-load.visual-hierarchy
  - usability-interaction.consistency.cross-platform-consistency
