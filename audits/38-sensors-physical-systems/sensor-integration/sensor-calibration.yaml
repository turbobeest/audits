# ============================================================
# AUDIT: Sensor Calibration
# Category: 38 - Sensors & Physical Systems
# Subcategory: sensor-integration
# ============================================================

audit:
  id: "sensors-physical-systems.sensor-integration.sensor-calibration"
  name: "Sensor Calibration Audit"
  version: "1.0.0"
  last_updated: "2025-01-22"
  status: "active"

  category: "sensors-physical-systems"
  category_number: 38
  subcategory: "sensor-integration"

  tier: "expert"
  estimated_duration: "4-6 hours"  # median: 5h

  completeness: "requires_discovery"
  requires_runtime: true
  destructive: false

execution:
  automatable: "partial"
  requires_physical_access: true
  severity: "high"
  scope: "physical-systems"

  default_profiles:
    - "full"
    - "quick"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Examines sensor calibration procedures, accuracy verification, and calibration
    management practices. Reviews calibration schedules, reference standards used,
    calibration certificates, traceability to national/international standards,
    and drift compensation mechanisms.

  why_it_matters: |
    Uncalibrated or improperly calibrated sensors produce inaccurate data that can
    lead to incorrect decisions, safety hazards, quality issues in manufacturing,
    and regulatory non-compliance. In safety-critical applications, calibration
    errors can result in equipment damage or personal injury.

  when_to_run:
    - "Before initial system deployment"
    - "After sensor replacement or repair"
    - "During periodic calibration reviews"
    - "After environmental changes affecting sensors"
    - "Before regulatory audits"

prerequisites:
  required_artifacts:
    - type: "calibration_records"
      description: "Historical calibration data and certificates"
    - type: "sensor_specifications"
      description: "Manufacturer datasheets and accuracy specs"
    - type: "calibration_procedures"
      description: "Documented calibration procedures"

  access_requirements:
    - "Physical access to sensors"
    - "Access to calibration equipment"
    - "Access to calibration management system"
    - "Reference standards availability"

discovery:
  file_patterns:
    - glob: "**/calibration/**"
      purpose: "Find calibration configuration files"
    - glob: "**/*calib*.c"
      purpose: "Find calibration firmware code"
    - glob: "**/sensors/*.yaml"
      purpose: "Find sensor configuration files"
    - glob: "**/config/sensors/**"
      purpose: "Find sensor settings"

knowledge_sources:
  guides:
    - id: "iso-17025"
      name: "ISO/IEC 17025 Testing and Calibration"
      url: "https://www.iso.org/standard/66912.html"
    - id: "nist-calibration"
      name: "NIST Calibration Services"
      url: "https://www.nist.gov/calibrations"

  standards:
    - id: "iso-9001"
      name: "ISO 9001 Quality Management"
      relevance: "Calibration requirements in quality systems"
    - id: "iec-61508"
      name: "IEC 61508 Functional Safety"
      relevance: "Safety-related sensor accuracy requirements"

tooling:
  analysis_tools:
    - tool: "calibration-management-system"
      purpose: "Track calibration schedules and records"
    - tool: "reference-multimeter"
      purpose: "Verify electrical sensor accuracy"
    - tool: "precision-thermometer"
      purpose: "Temperature sensor verification"
    - tool: "pressure-calibrator"
      purpose: "Pressure sensor calibration"

signals:
  critical:
    - id: "SPS-CAL-CRIT-001"
      signal: "Safety-critical sensors operating without valid calibration"
      evidence_indicators:
        - "Expired calibration certificates for safety sensors"
        - "No calibration records for critical measurement points"
        - "Sensors used beyond specified calibration interval"
      explanation: |
        Safety-critical sensors require valid calibration to ensure accurate
        readings that protect personnel and equipment. Operating without valid
        calibration violates safety regulations and standards.
      remediation: "Immediately calibrate or replace affected sensors before continued operation"

    - id: "SPS-CAL-CRIT-002"
      signal: "Calibration traceability chain broken"
      evidence_indicators:
        - "Reference standards not traceable to national standards"
        - "Missing calibration certificates for reference equipment"
        - "Unverified calibration sources"
      explanation: |
        Calibration traceability ensures measurements can be traced through an
        unbroken chain to national or international standards. Without traceability,
        calibration validity cannot be assured.
      remediation: "Establish traceable calibration using certified reference standards"

  high:
    - id: "SPS-CAL-HIGH-001"
      signal: "Calibration drift exceeds specification limits"
      evidence_indicators:
        - "Historical calibration data shows increasing deviation"
        - "As-found calibration values outside tolerance"
        - "Drift rate exceeds manufacturer specifications"
      remediation: "Reduce calibration interval or replace sensor"

    - id: "SPS-CAL-HIGH-002"
      signal: "Calibration procedure does not match sensor requirements"
      evidence_indicators:
        - "Procedure omits required calibration points"
        - "Environmental conditions not controlled"
        - "Insufficient settling time between measurements"
      remediation: "Update calibration procedure to match manufacturer requirements"

  medium:
    - id: "SPS-CAL-MED-001"
      signal: "Calibration intervals not optimized"
      evidence_indicators:
        - "All sensors calibrated on same schedule regardless of drift"
        - "No analysis of calibration history"
        - "Intervals based solely on time, not usage"
      remediation: "Implement reliability-centered calibration scheduling"

    - id: "SPS-CAL-MED-002"
      signal: "Calibration environment not controlled"
      evidence_indicators:
        - "Temperature/humidity not recorded during calibration"
        - "Calibration performed in uncontrolled environment"
        - "Environmental effects not compensated"
      remediation: "Establish controlled calibration environment with monitoring"

  low:
    - id: "SPS-CAL-LOW-001"
      signal: "Calibration documentation incomplete"
      evidence_indicators:
        - "Missing calibration technician signatures"
        - "Incomplete uncertainty calculations"
        - "Reference standard serial numbers not recorded"
      remediation: "Update calibration records with complete documentation"

    - id: "SPS-CAL-LOW-002"
      signal: "Calibration labels not applied or outdated"
      evidence_indicators:
        - "Physical sensors missing calibration stickers"
        - "Calibration due dates not visible"
        - "Labels illegible or damaged"
      remediation: "Apply clear calibration status labels to all sensors"

  positive:
    - id: "SPS-CAL-POS-001"
      signal: "Comprehensive calibration management system in place"
      evidence_indicators:
        - "Automated calibration reminders"
        - "Complete traceability documentation"
        - "Historical trend analysis performed"

    - id: "SPS-CAL-POS-002"
      signal: "Calibration uncertainty properly calculated and applied"
      evidence_indicators:
        - "Measurement uncertainty budgets documented"
        - "Guard bands applied appropriately"
        - "Uncertainty propagation considered"

procedure:
  context:
    cognitive_mode: "analytical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Review Calibration Records"
      description: "Examine all sensor calibration certificates and historical data"
      duration_estimate: "45 min"

    - id: "2"
      name: "Verify Traceability Chain"
      description: "Confirm calibration traceability to national/international standards"
      duration_estimate: "30 min"

    - id: "3"
      name: "Assess Calibration Procedures"
      description: "Review calibration procedures against manufacturer requirements"
      duration_estimate: "45 min"

    - id: "4"
      name: "Analyze Drift Trends"
      description: "Review historical calibration data for drift patterns"
      duration_estimate: "30 min"

    - id: "5"
      name: "Verify Calibration Environment"
      description: "Assess environmental controls during calibration"
      duration_estimate: "20 min"

    - id: "6"
      name: "Spot-Check Calibration"
      description: "Perform verification measurements on sample sensors"
      duration_estimate: "60 min"

    - id: "7"
      name: "Document Findings"
      description: "Compile findings and recommendations"
      duration_estimate: "30 min"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Calibration Status Overview"
        - "Traceability Assessment"
        - "Drift Analysis"
        - "Recommendations"

closeout_checklist:
  - id: "sps-cal-001"
    item: "All critical sensors have valid calibration"
    level: "CRITICAL"
    verification: "manual"

  - id: "sps-cal-002"
    item: "Traceability chain documented and verified"
    level: "WARNING"
    verification: "manual"

  - id: "sps-cal-003"
    item: "Calibration procedures reviewed and updated"
    level: "WARNING"
    verification: "manual"

governance:
  applicable_to:
    archetypes: ["iot-systems", "industrial-automation", "medical-devices", "laboratory-systems"]

  compliance_mappings:
    - framework: "ISO 9001"
      control: "7.1.5"
      description: "Monitoring and measuring resources"
    - framework: "ISO/IEC 17025"
      control: "6.4"
      description: "Equipment calibration"
    - framework: "FDA 21 CFR Part 820"
      control: "820.72"
      description: "Inspection, measuring, and test equipment"

relationships:
  commonly_combined:
    - "sensors-physical-systems.sensor-integration.sensor-health-monitoring"
    - "sensors-physical-systems.safety-systems.fail-safe-modes"
  depends_on:
    - "documentation.calibration-procedures"
  feeds_into:
    - "quality.measurement-accuracy"
    - "compliance.regulatory-requirements"
