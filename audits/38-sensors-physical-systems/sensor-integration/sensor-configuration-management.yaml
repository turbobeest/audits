audit:
  id: sensors-physical-systems.sensor-integration.sensor-configuration-management
  name: Sensor Configuration Management Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: sensors-physical-systems
  category_number: 38
  subcategory: sensor-integration
  tier: expert
  estimated_duration: 3-5 hours  # median: 4h
  completeness: requires_discovery
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  requires_physical_access: true
  severity: medium
  scope: physical-systems
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Reviews sensor configuration management practices including parameter storage,
    version control, change management, configuration validation, and deployment
    procedures. Examines how sensor settings are documented, protected, backed up,
    and synchronized across redundant systems.
  why_it_matters: |
    Incorrect sensor configuration can lead to measurement errors, safety hazards,
    or system failures. Proper configuration management ensures consistent settings,
    enables recovery from errors, supports troubleshooting, and maintains audit
    trails for regulatory compliance.
  when_to_run:
  - During system commissioning
  - Before configuration changes
  - During configuration audits
  - After system restoration
  - When onboarding new personnel
prerequisites:
  required_artifacts:
  - type: configuration_specs
    description: Sensor configuration specifications
  - type: config_files
    description: Current sensor configuration files
  - type: change_procedures
    description: Configuration change procedures
  access_requirements:
  - Access to configuration management system
  - Access to sensor configuration interfaces
  - Access to version control system
  - Configuration change authorization
discovery:
  file_patterns:
  - glob: '**/config/sensors/**'
    purpose: Find sensor configuration files
  - glob: '**/*.sensor.yaml'
    purpose: Find sensor YAML configs
  - glob: '**/parameters/**'
    purpose: Find parameter files
  - glob: '**/settings/*.json'
    purpose: Find JSON settings files
knowledge_sources:
  guides:
  - id: isa-95
    name: ISA-95 Enterprise Integration
    url: https://www.isa.org/isa95/
  - id: configuration-management
    name: ITIL Configuration Management
    url: https://www.axelos.com/itil
  standards:
  - id: iec-62443
    name: IEC 62443 Industrial Security
    relevance: Configuration security requirements
  - id: iso-27001
    name: ISO 27001 Information Security
    relevance: Configuration management controls
tooling:
  analysis_tools:
  - tool: version-control
    purpose: Configuration version tracking
  - tool: configuration-validator
    purpose: Validate configuration correctness
  - tool: diff-tool
    purpose: Compare configurations
  - tool: backup-system
    purpose: Configuration backup management
signals:
  critical:
  - id: SPS-CFG-CRIT-001
    signal: Safety-critical sensor configuration not protected
    evidence_indicators:
    - Configuration can be changed without authorization
    - No validation of configuration changes
    - Safety parameters unprotected
    explanation: |
      Unauthorized or incorrect changes to safety-critical sensor configuration
      can create hazardous conditions. Configuration protection is required by
      safety standards.
    remediation: Implement configuration protection with access control and validation
  - id: SPS-CFG-CRIT-002
    signal: Configuration mismatch between redundant sensors
    evidence_indicators:
    - Redundant sensors have different settings
    - No synchronization mechanism
    - Configuration divergence undetected
    explanation: |
      Configuration mismatches between redundant sensors can cause voting failures
      or inconsistent system behavior, potentially compromising safety functions.
    remediation: Implement configuration synchronization and consistency checking
  high:
  - id: SPS-CFG-HIGH-001
    signal: No configuration backup or recovery procedure
    evidence_indicators:
    - Configurations not backed up
    - No restore procedure documented
    - Unable to recover from misconfiguration
    remediation: Implement configuration backup and restore procedures
  - id: SPS-CFG-HIGH-002
    signal: Configuration changes not tracked
    evidence_indicators:
    - No version history
    - Changes not logged
    - Unable to determine who made changes
    remediation: Implement configuration change tracking and audit trail
  medium:
  - id: SPS-CFG-MED-001
    signal: Configuration validation incomplete
    evidence_indicators:
    - No range checking on parameters
    - Incompatible settings allowed
    - Invalid configurations accepted
    remediation: Implement comprehensive configuration validation
  - id: SPS-CFG-MED-002
    signal: Configuration documentation outdated
    evidence_indicators:
    - Documentation doesn't match actual settings
    - Parameter meanings not explained
    - Default values not documented
    remediation: Update configuration documentation
  low:
  - id: SPS-CFG-LOW-001
    signal: Configuration format inconsistent
    evidence_indicators:
    - Mixed configuration formats
    - No standard naming conventions
    - Hard to compare configurations
    remediation: Standardize configuration formats
  - id: SPS-CFG-LOW-002
    signal: No configuration baseline defined
    evidence_indicators:
    - No known-good configuration
    - Unable to reset to baseline
    - No reference for comparison
    remediation: Establish and document configuration baselines
  positive:
  - id: SPS-CFG-POS-001
    signal: Comprehensive configuration management system in place
    evidence_indicators:
    - Full version control
    - Change approval workflow
    - Complete audit trail
  - id: SPS-CFG-POS-002
    signal: Automated configuration validation and deployment
    evidence_indicators:
    - Configuration validated before deployment
    - Automated deployment process
    - Rollback capability tested
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Inventory Configurations
    description: Catalog all sensor configuration items
    duration_estimate: 30 min
  - id: '2'
    name: Review Storage and Protection
    description: Assess how configurations are stored and protected
    duration_estimate: 30 min
  - id: '3'
    name: Evaluate Change Management
    description: Review configuration change procedures
    duration_estimate: 30 min
  - id: '4'
    name: Check Version Control
    description: Verify configuration version tracking
    duration_estimate: 20 min
  - id: '5'
    name: Test Backup and Recovery
    description: Verify backup and restore procedures
    duration_estimate: 30 min
  - id: '6'
    name: Verify Consistency
    description: Check consistency across redundant systems
    duration_estimate: 30 min
  - id: '7'
    name: Document Findings
    description: Compile findings and recommendations
    duration_estimate: 20 min
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Configuration Inventory
    - Change Management Assessment
    - Protection Review
    - Recommendations
closeout_checklist:
- id: sps-cfg-001
  item: Safety-critical configurations protected
  level: CRITICAL
  verification: manual
- id: sps-cfg-002
  item: Configuration backup verified
  level: WARNING
  verification: manual
- id: sps-cfg-003
  item: Change management procedures documented
  level: WARNING
  verification: manual
governance:
  applicable_to:
    archetypes:
    - iot-systems
    - industrial-automation
    - scada-systems
    - medical-devices
  compliance_mappings:
  - framework: IEC 62443
    control: SR 7.6
    description: Configuration management
  - framework: ISO 27001
    control: A.12.1.2
    description: Change management
  - framework: FDA 21 CFR Part 11
    control: '11.10'
    description: Controls for electronic records
relationships:
  commonly_combined:
  - sensors-physical-systems.sensor-integration.sensor-calibration
  - security.configuration-security
  depends_on:
  - infrastructure.version-control
  feeds_into:
  - compliance.audit-trail
  - operations.change-management
