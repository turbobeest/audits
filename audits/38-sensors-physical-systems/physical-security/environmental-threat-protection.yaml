audit:
  id: sensors-physical-systems.physical-security.environmental-threat-protection
  name: Environmental Threat Protection Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: sensors-physical-systems
  category_number: 38
  subcategory: physical-security
  tier: expert
  estimated_duration: 4-5 hours  # median: 4h
  completeness: requires_discovery
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: physical-systems
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates protection against environmental threats including fire, water/flood,
    temperature extremes, lightning, and seismic events. Reviews detection systems,
    suppression capabilities, protective barriers, and integration with control
    system safe shutdown.
  why_it_matters: |
    Environmental threats can cause extensive damage to equipment, data loss,
    and extended downtime. Proper detection and protection minimizes impact
    and enables rapid recovery from environmental events.
  when_to_run:
  - During facility design
  - After environmental incidents
  - During safety audits
  - Before seasonal weather changes
  - After system modifications
prerequisites:
  required_artifacts:
  - type: threat_assessment
    description: Environmental threat assessment
  - type: protection_design
    description: Protection system design
  - type: emergency_procedures
    description: Emergency response procedures
  access_requirements:
  - Fire alarm system access
  - Environmental monitoring access
  - Physical access for inspection
  - Emergency shutdown access
discovery:
  file_patterns:
  - glob: '**/*fire*.c'
    purpose: Find fire detection code
  - glob: '**/*flood*.c'
    purpose: Find flood detection code
  - glob: '**/*environmental*.c'
    purpose: Find environmental code
  - glob: '**/config/*protection*.yaml'
    purpose: Find protection configuration
knowledge_sources:
  guides:
  - id: nfpa-standards
    name: NFPA Fire Protection
    url: https://www.nfpa.org/
  - id: data-center-protection
    name: Data Center Protection
    url: https://www.uptimeinstitute.com/
  standards:
  - id: nfpa-72
    name: NFPA 72 Fire Alarm Code
    relevance: Fire detection requirements
  - id: nfpa-75
    name: NFPA 75 IT Equipment
    relevance: IT equipment protection
  - id: en-1047
    name: EN 1047 Data Protection
    relevance: Fire-resistant enclosures
tooling:
  analysis_tools:
  - tool: fire-alarm-tester
    purpose: Fire system testing
  - tool: leak-detector
    purpose: Water detection testing
  - tool: surge-tester
    purpose: Lightning protection
  - tool: environmental-logger
    purpose: Condition monitoring
signals:
  critical:
  - id: SPS-ENV-CRIT-001
    signal: Fire protection inadequate for equipment
    evidence_indicators:
    - No fire detection in equipment area
    - Suppression inappropriate
    - Egress blocked by equipment
    explanation: |
      Fire in equipment areas can cause total loss of systems and data.
      Inadequate protection allows small fires to become major incidents.
    remediation: Implement appropriate fire protection
  - id: SPS-ENV-CRIT-002
    signal: Water threat not detected
    evidence_indicators:
    - No leak detection
    - Equipment below flood level
    - No automatic shutdown on water
    explanation: |
      Water damage can destroy electronic equipment instantly. Without
      detection and shutdown, water intrusion causes maximum damage.
    remediation: Implement water detection and response
  high:
  - id: SPS-ENV-HIGH-001
    signal: Emergency shutdown not integrated
    evidence_indicators:
    - Fire alarm doesn't trigger shutdown
    - No controlled power-off
    - Equipment continues in emergency
    remediation: Integrate emergency shutdown with detection
  - id: SPS-ENV-HIGH-002
    signal: Lightning/surge protection inadequate
    evidence_indicators:
    - No surge suppression
    - Grounding inadequate
    - Previous surge damage
    remediation: Implement proper surge protection
  medium:
  - id: SPS-ENV-MED-001
    signal: Detection coverage incomplete
    evidence_indicators:
    - Gaps in fire detection
    - Water detection too sparse
    - Some areas unmonitored
    remediation: Complete detection coverage
  - id: SPS-ENV-MED-002
    signal: Environmental monitoring limited
    evidence_indicators:
    - Temperature extremes not detected
    - Humidity not monitored
    - No early warning
    remediation: Implement comprehensive monitoring
  low:
  - id: SPS-ENV-LOW-001
    signal: Environmental protection not documented
    evidence_indicators:
    - System design not recorded
    - Detection locations unknown
    - Response procedures missing
    remediation: Document environmental protection
  - id: SPS-ENV-LOW-002
    signal: Testing program inadequate
    evidence_indicators:
    - Detection not regularly tested
    - Suppression not verified
    - No test records
    remediation: Implement testing program
  positive:
  - id: SPS-ENV-POS-001
    signal: Comprehensive environmental protection
    evidence_indicators:
    - All threats addressed
    - Detection coverage complete
    - Suppression appropriate
  - id: SPS-ENV-POS-002
    signal: Integrated emergency response
    evidence_indicators:
    - Automatic shutdown working
    - Clear procedures
    - Regular drills
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Review Threat Assessment
    description: Understand environmental risks
    duration_estimate: 30 min
  - id: '2'
    name: Verify Fire Protection
    description: Test fire detection and suppression
    duration_estimate: 45 min
  - id: '3'
    name: Verify Water Protection
    description: Test leak detection and drainage
    duration_estimate: 30 min
  - id: '4'
    name: Check Surge Protection
    description: Verify lightning/surge protection
    duration_estimate: 30 min
  - id: '5'
    name: Test Emergency Shutdown
    description: Verify control integration
    duration_estimate: 30 min
  - id: '6'
    name: Review Response Procedures
    description: Assess emergency procedures
    duration_estimate: 20 min
  - id: '7'
    name: Document Findings
    description: Compile findings and recommendations
    duration_estimate: 20 min
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Threat Assessment
    - Protection Review
    - Integration Testing
    - Recommendations
closeout_checklist:
- id: sps-env-001
  item: Fire protection verified
  level: CRITICAL
  verification: manual
- id: sps-env-002
  item: Water protection verified
  level: WARNING
  verification: manual
- id: sps-env-003
  item: Emergency shutdown working
  level: WARNING
  verification: manual
governance:
  applicable_to:
    archetypes:
    - data-centers
    - control-rooms
    - critical-infrastructure
    - manufacturing
  compliance_mappings:
  - framework: NFPA 72
    control: Fire Alarm Code
    description: Fire detection requirements
  - framework: NFPA 75
    control: IT Equipment Protection
    description: Electronic equipment fire protection
  - framework: Uptime Institute
    control: Tier Standards
    description: Data center protection
relationships:
  commonly_combined:
  - sensors-physical-systems.environmental-monitoring.temperature-sensing
  - sensors-physical-systems.physical-security.enclosure-security
  depends_on:
  - facilities.fire-suppression
  feeds_into:
  - business-continuity.disaster-recovery
  - safety.emergency-response
