audit:
  id: sensors-physical-systems.physical-security.enclosure-security
  name: Enclosure Security Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: sensors-physical-systems
  category_number: 38
  subcategory: physical-security
  tier: expert
  estimated_duration: 3-5 hours  # median: 4h
  completeness: requires_discovery
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: physical-systems
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates physical enclosure security including NEMA/IP ratings, lock mechanisms,
    hinge security, cable entry protection, and environmental sealing. Reviews
    enclosure placement, access procedures, and protection against environmental
    and security threats.
  why_it_matters: |
    Equipment enclosures protect critical components from environmental damage,
    unauthorized access, and tampering. Inadequate enclosure security can lead
    to equipment failures, safety system compromise, or security breaches.
  when_to_run:
  - During installation planning
  - After enclosure modifications
  - During security audits
  - When environmental issues occur
  - After weather events
prerequisites:
  required_artifacts:
  - type: enclosure_specs
    description: Enclosure specifications and ratings
  - type: installation_docs
    description: Installation documentation
  - type: key_management
    description: Lock and key management procedures
  access_requirements:
  - Physical access to enclosures
  - Key access for inspection
  - IP rating test equipment
  - Lock assessment tools
discovery:
  file_patterns:
  - glob: '**/enclosure/**'
    purpose: Find enclosure documentation
  - glob: '**/cabinet/**'
    purpose: Find cabinet documentation
  - glob: '**/installation/**'
    purpose: Find installation docs
  - glob: '**/physical_security/**'
    purpose: Find security docs
knowledge_sources:
  guides:
  - id: nema-ratings
    name: NEMA Enclosure Types
    url: https://www.nema.org/
  - id: ip-ratings
    name: IEC 60529 IP Ratings
    url: https://www.iec.ch/
  standards:
  - id: nema-250
    name: NEMA 250 Enclosures
    relevance: Enclosure type ratings
  - id: iec-60529
    name: IEC 60529 IP Codes
    relevance: Ingress protection ratings
  - id: iec-62443
    name: IEC 62443 Physical Security
    relevance: Industrial security requirements
tooling:
  analysis_tools:
  - tool: ip-tester
    purpose: Test ingress protection
  - tool: lock-pick-set
    purpose: Lock assessment
  - tool: thermal-camera
    purpose: Seal integrity check
  - tool: inspection-camera
    purpose: Internal inspection
signals:
  critical:
  - id: SPS-ENC-CRIT-001
    signal: Enclosure compromised allowing hazard access
    evidence_indicators:
    - Damaged enclosure exposing energized parts
    - Safety equipment accessible
    - Hazardous materials exposed
    explanation: |
      A compromised enclosure can expose personnel to electrical shock,
      hazardous materials, or allow unauthorized modification of safety
      systems.
    remediation: Repair or replace enclosure immediately
  - id: SPS-ENC-CRIT-002
    signal: Security enclosure easily bypassed
    evidence_indicators:
    - Weak or missing locks
    - Hinges can be removed externally
    - Enclosure can be forced open
    explanation: |
      Security enclosures must resist unauthorized access. Easily bypassed
      enclosures provide no real protection for critical equipment.
    remediation: Upgrade enclosure security features
  high:
  - id: SPS-ENC-HIGH-001
    signal: Environmental rating inadequate
    evidence_indicators:
    - Water ingress observed
    - Dust contamination inside
    - Rating below requirements
    remediation: Upgrade to appropriate rated enclosure
  - id: SPS-ENC-HIGH-002
    signal: Cable entries not properly sealed
    evidence_indicators:
    - Open cable entries
    - Damaged glands
    - Unsealed conduit
    remediation: Properly seal all cable entries
  medium:
  - id: SPS-ENC-MED-001
    signal: Key management inadequate
    evidence_indicators:
    - Master keys widely distributed
    - Keys not controlled
    - Lock combinations shared
    remediation: Implement proper key management
  - id: SPS-ENC-MED-002
    signal: Enclosure placement creates hazards
    evidence_indicators:
    - Blocks egress path
    - Exposed to traffic damage
    - Creates trip hazard
    remediation: Relocate or protect enclosure
  low:
  - id: SPS-ENC-LOW-001
    signal: Enclosure inventory incomplete
    evidence_indicators:
    - Enclosures not cataloged
    - Ratings not documented
    - Locations not mapped
    remediation: Complete enclosure inventory
  - id: SPS-ENC-LOW-002
    signal: No enclosure inspection program
    evidence_indicators:
    - Enclosures not regularly checked
    - Damage not detected
    - Seal condition unknown
    remediation: Implement regular inspections
  positive:
  - id: SPS-ENC-POS-001
    signal: Appropriate enclosure ratings
    evidence_indicators:
    - Ratings match environment
    - Seals in good condition
    - No ingress observed
  - id: SPS-ENC-POS-002
    signal: Proper access control
    evidence_indicators:
    - Quality locks installed
    - Key management effective
    - Access logged
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Inventory Enclosures
    description: Catalog all critical enclosures
    duration_estimate: 30 min
  - id: '2'
    name: Verify Ratings
    description: Check NEMA/IP ratings against requirements
    duration_estimate: 30 min
  - id: '3'
    name: Inspect Physical Condition
    description: Check seals, locks, and integrity
    duration_estimate: 60 min
  - id: '4'
    name: Assess Lock Security
    description: Evaluate lock mechanisms
    duration_estimate: 30 min
  - id: '5'
    name: Check Cable Entries
    description: Verify cable entry sealing
    duration_estimate: 20 min
  - id: '6'
    name: Review Key Management
    description: Assess key control procedures
    duration_estimate: 20 min
  - id: '7'
    name: Document Findings
    description: Compile findings and recommendations
    duration_estimate: 20 min
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Enclosure Inventory
    - Condition Assessment
    - Security Assessment
    - Recommendations
closeout_checklist:
- id: sps-enc-001
  item: Critical enclosures secure
  level: WARNING
  verification: manual
- id: sps-enc-002
  item: Environmental ratings adequate
  level: WARNING
  verification: manual
- id: sps-enc-003
  item: Key management implemented
  level: INFO
  verification: manual
governance:
  applicable_to:
    archetypes:
    - industrial-automation
    - outdoor-installations
    - hazardous-areas
    - critical-infrastructure
  compliance_mappings:
  - framework: NEMA 250
    control: Enclosure Types
    description: Enclosure rating requirements
  - framework: IEC 60529
    control: IP Codes
    description: Ingress protection
  - framework: IEC 62443
    control: SR 4.3
    description: Physical access control
relationships:
  commonly_combined:
  - sensors-physical-systems.physical-security.tamper-detection
  - sensors-physical-systems.physical-security.access-control-integration
  depends_on:
  - facilities.environmental-conditions
  feeds_into:
  - reliability.environmental-protection
  - security.physical-security
