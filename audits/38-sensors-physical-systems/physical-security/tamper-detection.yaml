# ============================================================
# AUDIT: Tamper Detection
# Category: 38 - Sensors & Physical Systems
# Subcategory: physical-security
# ============================================================

audit:
  id: "sensors-physical-systems.physical-security.tamper-detection"
  name: "Tamper Detection Audit"
  version: "1.0.0"
  last_updated: "2025-01-22"
  status: "active"

  category: "sensors-physical-systems"
  category_number: 38
  subcategory: "physical-security"

  tier: "expert"
  estimated_duration: "4-6 hours"  # median: 5h

  completeness: "requires_discovery"
  requires_runtime: true
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "physical-systems"

  default_profiles:
    - "full"
    - "quick"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Evaluates tamper detection mechanisms for sensors, controllers, and communication
    equipment. Reviews enclosure tamper switches, cable tamper detection, seal
    verification, firmware integrity checking, and tamper event logging.

  why_it_matters: |
    Physical tampering can compromise sensor accuracy, bypass safety systems, or
    enable unauthorized access. Tamper detection provides early warning of
    unauthorized modifications that could affect safety, security, or measurement
    integrity.

  when_to_run:
    - "During security design"
    - "After security incidents"
    - "During security audits"
    - "When adding new equipment"
    - "After facility changes"

prerequisites:
  required_artifacts:
    - type: "equipment_inventory"
      description: "List of protected equipment"
    - type: "security_design"
      description: "Security system design documentation"
    - type: "tamper_procedures"
      description: "Tamper response procedures"

  access_requirements:
    - "Physical access to equipment"
    - "Security system access"
    - "Event log access"
    - "Tamper testing capability"

discovery:
  file_patterns:
    - glob: "**/*tamper*.c"
      purpose: "Find tamper detection code"
    - glob: "**/*intrusion*.c"
      purpose: "Find intrusion detection code"
    - glob: "**/*seal*.c"
      purpose: "Find seal verification code"
    - glob: "**/config/*security*.yaml"
      purpose: "Find security configuration"

knowledge_sources:
  guides:
    - id: "iec-62443"
      name: "IEC 62443 Physical Security"
      url: "https://www.iec.ch/"
    - id: "tamper-design"
      name: "Tamper Detection Design"
      url: "https://www.nist.gov/"

  standards:
    - id: "iec-62443"
      name: "IEC 62443 Industrial Security"
      relevance: "Physical security requirements"
    - id: "fips-140"
      name: "FIPS 140 Cryptographic Modules"
      relevance: "Tamper evidence requirements"
    - id: "ul-2900"
      name: "UL 2900 Software Security"
      relevance: "Connected device security"

tooling:
  analysis_tools:
    - tool: "tamper-tester"
      purpose: "Test tamper detection"
    - tool: "event-analyzer"
      purpose: "Analyze tamper events"
    - tool: "seal-verification"
      purpose: "Verify tamper seals"
    - tool: "integrity-checker"
      purpose: "Firmware integrity"

signals:
  critical:
    - id: "SPS-TMP-CRIT-001"
      signal: "Tamper evidence on critical equipment"
      evidence_indicators:
        - "Broken tamper seals"
        - "Enclosure breach detected"
        - "Unauthorized modifications found"
      explanation: |
        Evidence of tampering on critical equipment indicates potential
        compromise of safety or security systems. The equipment may no
        longer function as intended.
      remediation: "Investigate, assess impact, and remediate immediately"

    - id: "SPS-TMP-CRIT-002"
      signal: "Tamper detection system disabled"
      evidence_indicators:
        - "Tamper switches bypassed"
        - "Monitoring disconnected"
        - "Alerts suppressed"
      explanation: |
        Disabled tamper detection allows unauthorized modifications to go
        undetected, potentially compromising safety or security without
        any warning.
      remediation: "Restore tamper detection and investigate reason for disabling"

  high:
    - id: "SPS-TMP-HIGH-001"
      signal: "Critical equipment lacks tamper detection"
      evidence_indicators:
        - "No tamper switches on enclosures"
        - "No cable tamper detection"
        - "No seal program"
      remediation: "Implement tamper detection for critical equipment"

    - id: "SPS-TMP-HIGH-002"
      signal: "Tamper events not generating alerts"
      evidence_indicators:
        - "Tamper switches not monitored"
        - "Events logged but not alarmed"
        - "No response to test tampering"
      remediation: "Implement proper tamper alerting"

  medium:
    - id: "SPS-TMP-MED-001"
      signal: "Tamper seals not regularly verified"
      evidence_indicators:
        - "No seal inspection program"
        - "Seal status unknown"
        - "Broken seals not investigated"
      remediation: "Implement seal verification program"

    - id: "SPS-TMP-MED-002"
      signal: "Tamper detection coverage incomplete"
      evidence_indicators:
        - "Some equipment unprotected"
        - "Access points not monitored"
        - "Gaps in detection"
      remediation: "Extend tamper detection coverage"

  low:
    - id: "SPS-TMP-LOW-001"
      signal: "Tamper detection not documented"
      evidence_indicators:
        - "Protected equipment not listed"
        - "Detection methods not documented"
        - "Response procedures missing"
      remediation: "Document tamper detection system"

    - id: "SPS-TMP-LOW-002"
      signal: "No tamper event trending"
      evidence_indicators:
        - "Events not analyzed"
        - "Patterns not identified"
        - "No metrics tracked"
      remediation: "Implement tamper event analysis"

  positive:
    - id: "SPS-TMP-POS-001"
      signal: "Comprehensive tamper detection"
      evidence_indicators:
        - "All critical equipment protected"
        - "Multiple detection methods"
        - "Effective alerting"

    - id: "SPS-TMP-POS-002"
      signal: "Robust tamper response program"
      evidence_indicators:
        - "Clear response procedures"
        - "Rapid investigation"
        - "Documented outcomes"

procedure:
  context:
    cognitive_mode: "analytical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Inventory Protected Equipment"
      description: "Catalog equipment with tamper detection"
      duration_estimate: "30 min"

    - id: "2"
      name: "Verify Detection Mechanisms"
      description: "Test tamper switches and seals"
      duration_estimate: "60 min"

    - id: "3"
      name: "Test Alert Generation"
      description: "Verify tamper alerts are generated"
      duration_estimate: "30 min"

    - id: "4"
      name: "Review Event Logs"
      description: "Analyze tamper event history"
      duration_estimate: "30 min"

    - id: "5"
      name: "Assess Response Procedures"
      description: "Review tamper response process"
      duration_estimate: "30 min"

    - id: "6"
      name: "Check Coverage Gaps"
      description: "Identify unprotected equipment"
      duration_estimate: "30 min"

    - id: "7"
      name: "Document Findings"
      description: "Compile findings and recommendations"
      duration_estimate: "30 min"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Detection Coverage"
        - "Testing Results"
        - "Event Analysis"
        - "Recommendations"

closeout_checklist:
  - id: "sps-tmp-001"
    item: "Critical equipment has tamper detection"
    level: "WARNING"
    verification: "manual"

  - id: "sps-tmp-002"
    item: "Tamper alerts functional"
    level: "WARNING"
    verification: "manual"

  - id: "sps-tmp-003"
    item: "Response procedures defined"
    level: "INFO"
    verification: "manual"

governance:
  applicable_to:
    archetypes: ["critical-infrastructure", "industrial-automation", "utilities", "process-control"]

  compliance_mappings:
    - framework: "IEC 62443"
      control: "SR 4.3"
      description: "Physical access control"
    - framework: "NERC CIP"
      control: "CIP-006"
      description: "Physical security"
    - framework: "FIPS 140-2"
      control: "Physical Security"
      description: "Tamper evidence"

relationships:
  commonly_combined:
    - "sensors-physical-systems.physical-security.enclosure-security"
    - "sensors-physical-systems.physical-security.access-control-integration"
  depends_on:
    - "security.security-monitoring"
  feeds_into:
    - "security.incident-response"
    - "compliance.security-compliance"
