# ============================================================
# AUDIT: Safety Instrumented Functions
# Category: 38 - Sensors & Physical Systems
# Subcategory: safety-systems
# ============================================================

audit:
  id: "sensors-physical-systems.safety-systems.safety-instrumented-functions"
  name: "Safety Instrumented Functions Audit"
  version: "1.0.0"
  last_updated: "2025-01-22"
  status: "active"

  category: "sensors-physical-systems"
  category_number: 38
  subcategory: "safety-systems"

  tier: "expert"
  estimated_duration: "6-8 hours"  # median: 7h

  completeness: "requires_discovery"
  requires_runtime: true
  destructive: false

execution:
  automatable: "partial"
  severity: "critical"
  scope: "physical-systems"

  default_profiles:
    - "full"
    - "quick"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Evaluates Safety Instrumented Functions (SIFs) and Safety Instrumented Systems
    (SIS) including SIL determination, architecture verification, proof testing,
    and lifecycle management. Reviews sensor selection, logic solver configuration,
    final element specification, and overall SIF integrity.

  why_it_matters: |
    SIFs are the last layer of protection against hazardous events in process
    industries. Inadequate SIF design or maintenance can lead to catastrophic
    incidents with potential for multiple fatalities, environmental disasters,
    and massive property damage.

  when_to_run:
    - "During SIS design"
    - "Before SIF commissioning"
    - "During SIL verification"
    - "After SIS modifications"
    - "During regulatory audits"

prerequisites:
  required_artifacts:
    - type: "sil_documentation"
      description: "SIL determination documentation"
    - type: "srs"
      description: "Safety Requirements Specification"
    - type: "proof_test_procedures"
      description: "Proof test procedures"

  access_requirements:
    - "Safety PLC access"
    - "SIS engineering documentation"
    - "Physical access for proof testing"
    - "LOPA and HAZOP records"

discovery:
  file_patterns:
    - glob: "**/*sif*.c"
      purpose: "Find SIF code"
    - glob: "**/*sis*.c"
      purpose: "Find SIS code"
    - glob: "**/*safety_logic*.c"
      purpose: "Find safety logic code"
    - glob: "**/config/*sil*.yaml"
      purpose: "Find SIL configuration"

knowledge_sources:
  guides:
    - id: "iec-61511"
      name: "IEC 61511 Process Safety"
      url: "https://www.iec.ch/"
    - id: "isa-84"
      name: "ISA 84 SIS Design"
      url: "https://www.isa.org/"

  standards:
    - id: "iec-61511"
      name: "IEC 61511 Process Safety"
      relevance: "SIS requirements"
    - id: "iec-61508"
      name: "IEC 61508 Functional Safety"
      relevance: "Functional safety framework"
    - id: "isa-84"
      name: "ANSI/ISA 84"
      relevance: "SIS implementation"

tooling:
  analysis_tools:
    - tool: "sil-verification"
      purpose: "SIL calculation and verification"
    - tool: "fault-tree-analysis"
      purpose: "Reliability analysis"
    - tool: "safety-plc-diagnostic"
      purpose: "Logic solver diagnostics"
    - tool: "proof-test-tool"
      purpose: "Proof test execution"

signals:
  critical:
    - id: "SPS-SIF-CRIT-001"
      signal: "SIF cannot achieve required SIL"
      evidence_indicators:
        - "PFDavg exceeds SIL limit"
        - "Diagnostic coverage insufficient"
        - "Architecture doesn't support SIL"
      explanation: |
        A SIF that cannot achieve its required SIL provides less risk reduction
        than assumed, leaving unacceptable residual risk. The risk of a
        hazardous event is higher than documented.
      remediation: "Redesign SIF to achieve required SIL"

    - id: "SPS-SIF-CRIT-002"
      signal: "SIF bypassed during operation"
      evidence_indicators:
        - "SIF in bypass without MOC"
        - "Bypass exceeded time limit"
        - "No compensating measures"
      explanation: |
        An bypassed SIF provides no protection. Without proper management of
        change and compensating measures, the facility operates at unacceptable
        risk levels.
      remediation: "Restore SIF or implement approved compensating measures"

  high:
    - id: "SPS-SIF-HIGH-001"
      signal: "Proof testing overdue"
      evidence_indicators:
        - "Proof test interval exceeded"
        - "PFDavg assumptions invalid"
        - "Degraded dangerous failures undetected"
      remediation: "Perform proof testing immediately"

    - id: "SPS-SIF-HIGH-002"
      signal: "SIF demand rate exceeds design basis"
      evidence_indicators:
        - "Frequent SIF activations"
        - "Process control ineffective"
        - "SIF operating as process control"
      remediation: "Improve process control to reduce SIF demands"

  medium:
    - id: "SPS-SIF-MED-001"
      signal: "SIF device failure rate data outdated"
      evidence_indicators:
        - "Generic failure rates used"
        - "No field failure data collection"
        - "Actual reliability unknown"
      remediation: "Collect and analyze actual failure data"

    - id: "SPS-SIF-MED-002"
      signal: "Proof test coverage incomplete"
      evidence_indicators:
        - "Not all failure modes tested"
        - "Partial stroke test only"
        - "Test doesn't verify SIF function"
      remediation: "Expand proof test coverage"

  low:
    - id: "SPS-SIF-LOW-001"
      signal: "SIF documentation incomplete"
      evidence_indicators:
        - "SRS not current"
        - "SIL determination not documented"
        - "Changes not recorded"
      remediation: "Complete and update SIF documentation"

    - id: "SPS-SIF-LOW-002"
      signal: "SIF activation trending not performed"
      evidence_indicators:
        - "Activations not recorded"
        - "Trends not analyzed"
        - "Root causes not investigated"
      remediation: "Implement SIF activation analysis"

  positive:
    - id: "SPS-SIF-POS-001"
      signal: "SIF achieves verified SIL"
      evidence_indicators:
        - "SIL verification complete"
        - "PFDavg within limits"
        - "Architecture validated"

    - id: "SPS-SIF-POS-002"
      signal: "Comprehensive SIF lifecycle management"
      evidence_indicators:
        - "Proof testing current"
        - "Bypass management effective"
        - "MOC properly implemented"

procedure:
  context:
    cognitive_mode: "analytical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Review SIL Determination"
      description: "Verify SIL assignment and documentation"
      duration_estimate: "45 min"

    - id: "2"
      name: "Verify SIF Architecture"
      description: "Confirm architecture meets SIL requirements"
      duration_estimate: "60 min"

    - id: "3"
      name: "Review SIL Verification"
      description: "Check PFDavg calculations and assumptions"
      duration_estimate: "60 min"

    - id: "4"
      name: "Assess Proof Testing"
      description: "Review proof test procedures and records"
      duration_estimate: "45 min"

    - id: "5"
      name: "Review Bypass Management"
      description: "Check bypass procedures and current status"
      duration_estimate: "30 min"

    - id: "6"
      name: "Verify Demand History"
      description: "Analyze SIF activation records"
      duration_estimate: "30 min"

    - id: "7"
      name: "Document Findings"
      description: "Compile findings and recommendations"
      duration_estimate: "30 min"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "SIL Verification Status"
        - "Proof Testing Assessment"
        - "Bypass Management Review"
        - "Recommendations"

closeout_checklist:
  - id: "sps-sif-001"
    item: "All SIFs achieve required SIL"
    level: "CRITICAL"
    verification: "manual"

  - id: "sps-sif-002"
    item: "Proof testing current"
    level: "CRITICAL"
    verification: "manual"

  - id: "sps-sif-003"
    item: "Bypasses properly managed"
    level: "CRITICAL"
    verification: "manual"

governance:
  applicable_to:
    archetypes: ["process-industries", "oil-gas", "chemical-processing", "power-generation"]

  compliance_mappings:
    - framework: "IEC 61511"
      control: "SIS Requirements"
      description: "Process industry SIS"
    - framework: "OSHA PSM"
      control: "Process Safety"
      description: "Process safety management"
    - framework: "EPA RMP"
      control: "Risk Management"
      description: "Risk management program"

relationships:
  commonly_combined:
    - "sensors-physical-systems.safety-systems.fail-safe-modes"
    - "sensors-physical-systems.actuator-control.valve-control"
  depends_on:
    - "safety.hazop-lopa"
  feeds_into:
    - "compliance.functional-safety"
    - "risk.risk-management"
