# ============================================================
# AUDIT: Signal Processing
# Category: 38 - Sensors & Physical Systems
# Subcategory: data-acquisition
# ============================================================

audit:
  id: "sensors-physical-systems.data-acquisition.signal-processing"
  name: "Signal Processing Audit"
  version: "1.0.0"
  last_updated: "2025-01-22"
  status: "active"

  category: "sensors-physical-systems"
  category_number: 38
  subcategory: "data-acquisition"

  tier: "expert"
  estimated_duration: "5-7 hours"  # median: 6h

  completeness: "requires_discovery"
  requires_runtime: true
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "physical-systems"

  default_profiles:
    - "full"
    - "quick"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Evaluates signal processing implementations including filtering (low-pass,
    high-pass, band-pass, notch), noise reduction, signal conditioning, decimation,
    interpolation, and transformation algorithms. Reviews filter design parameters,
    phase characteristics, stability, and computational efficiency.

  why_it_matters: |
    Incorrect signal processing can introduce errors, phase distortion, aliasing,
    or excessive latency into sensor data. Proper signal conditioning ensures
    data quality while preserving essential signal characteristics needed for
    accurate measurement and control.

  when_to_run:
    - "During signal chain design"
    - "After filter parameter changes"
    - "When signal quality issues occur"
    - "Before system validation"
    - "During algorithm optimization"

prerequisites:
  required_artifacts:
    - type: "signal_specs"
      description: "Signal characteristics and requirements"
    - type: "filter_design"
      description: "Filter design documentation"
    - type: "source_code"
      description: "Signal processing implementation code"

  access_requirements:
    - "Access to signal processing code"
    - "Access to raw and processed signal data"
    - "Signal analysis equipment"
    - "Test signal generation capability"

discovery:
  file_patterns:
    - glob: "**/*filter*.c"
      purpose: "Find filter implementation code"
    - glob: "**/*dsp*.c"
      purpose: "Find DSP code"
    - glob: "**/signal/**"
      purpose: "Find signal processing code"
    - glob: "**/*fft*.c"
      purpose: "Find FFT implementations"

knowledge_sources:
  guides:
    - id: "dsp-guide"
      name: "The Scientist and Engineer's Guide to DSP"
      url: "https://www.dspguide.com/"
    - id: "oppenheim-schafer"
      name: "Discrete-Time Signal Processing"
      url: "https://www.pearson.com/"

  standards:
    - id: "ieee-1057"
      name: "IEEE 1057 Digitizing Waveform Recorders"
      relevance: "Measurement standards"
    - id: "iec-61672"
      name: "IEC 61672 Sound Level Meters"
      relevance: "Acoustic signal processing"

tooling:
  analysis_tools:
    - tool: "spectrum-analyzer"
      purpose: "Frequency domain analysis"
    - tool: "oscilloscope"
      purpose: "Time domain analysis"
    - tool: "signal-generator"
      purpose: "Test signal generation"
    - tool: "matlab-simulink"
      purpose: "Algorithm simulation"

signals:
  critical:
    - id: "SPS-SIG-CRIT-001"
      signal: "Filter causing aliasing of critical signal components"
      evidence_indicators:
        - "Anti-aliasing filter insufficient"
        - "Decimation without proper filtering"
        - "Nyquist criterion violated"
      explanation: |
        Aliasing folds high-frequency content into the measurement band,
        creating false signals that cannot be distinguished from real data.
        This can cause completely incorrect measurements or control responses.
      remediation: "Implement proper anti-aliasing filtering before sampling/decimation"

    - id: "SPS-SIG-CRIT-002"
      signal: "Safety-critical signal processing not validated"
      evidence_indicators:
        - "Filter response not characterized"
        - "Processing delays not documented"
        - "Accuracy not verified against requirements"
      explanation: |
        Safety-critical signal processing must be validated to ensure it meets
        accuracy and timing requirements. Unvalidated processing can introduce
        undetected errors into safety functions.
      remediation: "Validate signal processing against requirements with documented evidence"

  high:
    - id: "SPS-SIG-HIGH-001"
      signal: "Filter introduces excessive phase delay"
      evidence_indicators:
        - "Phase delay affects control stability"
        - "Non-linear phase distortion"
        - "Group delay varies with frequency"
      remediation: "Redesign filter for acceptable phase characteristics"

    - id: "SPS-SIG-HIGH-002"
      signal: "Filter numerical stability issues"
      evidence_indicators:
        - "Coefficient quantization errors"
        - "Accumulator overflow possible"
        - "Filter output oscillates or diverges"
      remediation: "Implement numerically stable filter structure"

  medium:
    - id: "SPS-SIG-MED-001"
      signal: "Signal processing latency not characterized"
      evidence_indicators:
        - "Processing delay unknown"
        - "Latency varies with conditions"
        - "Unable to compensate for delay"
      remediation: "Characterize and document processing latency"

    - id: "SPS-SIG-MED-002"
      signal: "Filter parameters not optimized for application"
      evidence_indicators:
        - "Excessive attenuation of desired signals"
        - "Insufficient noise rejection"
        - "Filter cutoff inappropriate"
      remediation: "Optimize filter parameters for application requirements"

  low:
    - id: "SPS-SIG-LOW-001"
      signal: "Signal processing not documented"
      evidence_indicators:
        - "Algorithm choices not explained"
        - "Parameters not documented"
        - "Transfer functions not provided"
      remediation: "Document signal processing design and parameters"

    - id: "SPS-SIG-LOW-002"
      signal: "No signal quality monitoring"
      evidence_indicators:
        - "Signal quality not measured"
        - "Degradation not detected"
        - "No quality metrics available"
      remediation: "Implement signal quality monitoring"

  positive:
    - id: "SPS-SIG-POS-001"
      signal: "Signal processing fully characterized and validated"
      evidence_indicators:
        - "Transfer functions documented"
        - "Phase response characterized"
        - "Performance verified against specs"

    - id: "SPS-SIG-POS-002"
      signal: "Adaptive signal processing for varying conditions"
      evidence_indicators:
        - "Parameters adjust to conditions"
        - "Quality maintained across operating range"
        - "Adaptation validated"

procedure:
  context:
    cognitive_mode: "analytical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Inventory Signal Processing"
      description: "Catalog all signal processing in the system"
      duration_estimate: "30 min"

    - id: "2"
      name: "Review Filter Designs"
      description: "Analyze filter designs and parameters"
      duration_estimate: "60 min"

    - id: "3"
      name: "Verify Anti-Aliasing"
      description: "Check anti-aliasing filter adequacy"
      duration_estimate: "45 min"

    - id: "4"
      name: "Analyze Phase Response"
      description: "Characterize phase and group delay"
      duration_estimate: "45 min"

    - id: "5"
      name: "Test Numerical Stability"
      description: "Verify numerical stability of implementations"
      duration_estimate: "30 min"

    - id: "6"
      name: "Measure Latency"
      description: "Characterize processing delays"
      duration_estimate: "30 min"

    - id: "7"
      name: "Document Findings"
      description: "Compile findings and recommendations"
      duration_estimate: "30 min"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Signal Processing Inventory"
        - "Filter Analysis"
        - "Performance Characterization"
        - "Recommendations"

closeout_checklist:
  - id: "sps-sig-001"
    item: "Anti-aliasing verified adequate"
    level: "CRITICAL"
    verification: "manual"

  - id: "sps-sig-002"
    item: "Filter stability verified"
    level: "WARNING"
    verification: "manual"

  - id: "sps-sig-003"
    item: "Processing latency documented"
    level: "INFO"
    verification: "manual"

governance:
  applicable_to:
    archetypes: ["iot-systems", "industrial-automation", "audio-systems", "instrumentation"]

  compliance_mappings:
    - framework: "IEC 61508"
      control: "7.4.7"
      description: "Data acquisition requirements"
    - framework: "IEEE 1057"
      control: "Signal Processing"
      description: "Waveform digitizing standards"
    - framework: "ISO 26262"
      control: "Part 5"
      description: "Hardware signal processing"

relationships:
  commonly_combined:
    - "sensors-physical-systems.data-acquisition.sampling-rate-optimization"
    - "sensors-physical-systems.data-acquisition.data-quality-validation"
  depends_on:
    - "sensors-physical-systems.sensor-integration.sensor-protocol-compliance"
  feeds_into:
    - "sensors-physical-systems.sensor-integration.data-fusion"
    - "control-systems.measurement-accuracy"
