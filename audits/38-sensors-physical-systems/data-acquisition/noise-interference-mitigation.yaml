# ============================================================
# AUDIT: Noise and Interference Mitigation
# Category: 38 - Sensors & Physical Systems
# Subcategory: data-acquisition
# ============================================================

audit:
  id: "sensors-physical-systems.data-acquisition.noise-interference-mitigation"
  name: "Noise and Interference Mitigation Audit"
  version: "1.0.0"
  last_updated: "2025-01-22"
  status: "active"

  category: "sensors-physical-systems"
  category_number: 38
  subcategory: "data-acquisition"

  tier: "expert"
  estimated_duration: "5-7 hours"  # median: 6h

  completeness: "requires_discovery"
  requires_runtime: true
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "physical-systems"

  default_profiles:
    - "full"
    - "quick"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Evaluates noise and interference mitigation strategies in data acquisition
    systems. Reviews electromagnetic interference (EMI) shielding, grounding
    practices, common-mode rejection, differential signaling, filtering,
    isolation techniques, and layout considerations. Assesses noise performance
    against measurement requirements.

  why_it_matters: |
    Electrical noise and interference degrade measurement accuracy, create spurious
    readings, and can mask real signals. Effective mitigation ensures reliable
    sensor data quality, especially in industrial environments with motors,
    switching power supplies, and other noise sources.

  when_to_run:
    - "During hardware design reviews"
    - "When noise issues observed"
    - "After installation in new environment"
    - "During EMC compliance testing"
    - "When adding sensitive measurements"

prerequisites:
  required_artifacts:
    - type: "schematic"
      description: "Circuit schematic showing signal paths"
    - type: "layout"
      description: "PCB layout documentation"
    - type: "installation_docs"
      description: "Installation and wiring documentation"

  access_requirements:
    - "Physical access to hardware"
    - "Spectrum analyzer access"
    - "Oscilloscope with probes"
    - "Ability to test with noise sources"

discovery:
  file_patterns:
    - glob: "**/hardware/**"
      purpose: "Find hardware documentation"
    - glob: "**/analog/**"
      purpose: "Find analog circuit code"
    - glob: "**/*filter*.c"
      purpose: "Find filter implementations"
    - glob: "**/grounding/**"
      purpose: "Find grounding documentation"

knowledge_sources:
  guides:
    - id: "emc-design"
      name: "EMC Design Guidelines"
      url: "https://www.analog.com/en/education.html"
    - id: "grounding"
      name: "Grounding and Shielding Techniques"
      url: "https://www.ti.com/"

  standards:
    - id: "iec-61326"
      name: "IEC 61326 EMC for Measurement Equipment"
      relevance: "EMC requirements"
    - id: "iec-61000"
      name: "IEC 61000 EMC Standards"
      relevance: "General EMC requirements"
    - id: "cispr-11"
      name: "CISPR 11 Industrial EMC"
      relevance: "Industrial emissions and immunity"

tooling:
  analysis_tools:
    - tool: "spectrum-analyzer"
      purpose: "Noise spectrum analysis"
    - tool: "oscilloscope"
      purpose: "Time domain noise measurement"
    - tool: "current-probe"
      purpose: "Common-mode current measurement"
    - tool: "near-field-probe"
      purpose: "EMI source location"

signals:
  critical:
    - id: "SPS-NIM-CRIT-001"
      signal: "Noise exceeds measurement signal levels"
      evidence_indicators:
        - "SNR below acceptable threshold"
        - "Measurements dominated by noise"
        - "Cannot achieve required accuracy"
      explanation: |
        When noise amplitude approaches or exceeds signal levels, accurate
        measurement becomes impossible. This is especially critical for
        low-level sensor signals and high-precision measurements.
      remediation: "Implement comprehensive noise mitigation to achieve required SNR"

    - id: "SPS-NIM-CRIT-002"
      signal: "Interference causing false safety signals"
      evidence_indicators:
        - "Spurious safety triggers from noise"
        - "Safety signals masked by interference"
        - "Unpredictable safety system behavior"
      explanation: |
        Interference affecting safety signals can cause false trips disrupting
        operations, or worse, mask real safety conditions leading to hazards.
      remediation: "Implement robust interference rejection for all safety signals"

  high:
    - id: "SPS-NIM-HIGH-001"
      signal: "Grounding scheme creating noise issues"
      evidence_indicators:
        - "Ground loops present"
        - "Shield grounding incorrect"
        - "Star ground not implemented"
      remediation: "Correct grounding according to best practices"

    - id: "SPS-NIM-HIGH-002"
      signal: "Insufficient common-mode rejection"
      evidence_indicators:
        - "Common-mode noise on differential inputs"
        - "CMRR below requirements"
        - "Imbalanced differential inputs"
      remediation: "Improve common-mode rejection through design improvements"

  medium:
    - id: "SPS-NIM-MED-001"
      signal: "Shielding effectiveness inadequate"
      evidence_indicators:
        - "Radiated interference entering"
        - "Shield connections poor"
        - "Shield coverage incomplete"
      remediation: "Improve shielding design and implementation"

    - id: "SPS-NIM-MED-002"
      signal: "Power supply noise affecting measurements"
      evidence_indicators:
        - "Supply ripple in measurements"
        - "PSRR insufficient"
        - "Switching noise coupling"
      remediation: "Improve power supply filtering and isolation"

  low:
    - id: "SPS-NIM-LOW-001"
      signal: "Noise characterization incomplete"
      evidence_indicators:
        - "Noise sources not identified"
        - "Noise spectrum not analyzed"
        - "Baseline not established"
      remediation: "Complete noise characterization"

    - id: "SPS-NIM-LOW-002"
      signal: "Installation guidelines incomplete"
      evidence_indicators:
        - "Wiring practices not specified"
        - "Cable routing not defined"
        - "Separation requirements missing"
      remediation: "Document installation requirements for noise control"

  positive:
    - id: "SPS-NIM-POS-001"
      signal: "Comprehensive EMI protection implemented"
      evidence_indicators:
        - "Proper shielding and grounding"
        - "Differential signaling used"
        - "EMC testing passed"

    - id: "SPS-NIM-POS-002"
      signal: "Noise monitoring and trending in place"
      evidence_indicators:
        - "Baseline noise documented"
        - "Changes detected and alarmed"
        - "Historical analysis enabled"

procedure:
  context:
    cognitive_mode: "analytical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Identify Noise Sources"
      description: "Catalog potential noise and interference sources"
      duration_estimate: "45 min"

    - id: "2"
      name: "Review Grounding Design"
      description: "Assess grounding scheme and implementation"
      duration_estimate: "45 min"

    - id: "3"
      name: "Evaluate Shielding"
      description: "Review shielding effectiveness"
      duration_estimate: "30 min"

    - id: "4"
      name: "Measure Noise Performance"
      description: "Characterize noise in frequency and time domains"
      duration_estimate: "60 min"

    - id: "5"
      name: "Test Immunity"
      description: "Verify immunity to expected interference"
      duration_estimate: "45 min"

    - id: "6"
      name: "Review Filtering"
      description: "Assess filtering effectiveness"
      duration_estimate: "30 min"

    - id: "7"
      name: "Document Findings"
      description: "Compile findings and recommendations"
      duration_estimate: "30 min"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Noise Source Analysis"
        - "Mitigation Assessment"
        - "Performance Measurements"
        - "Recommendations"

closeout_checklist:
  - id: "sps-nim-001"
    item: "Noise levels meet measurement requirements"
    level: "CRITICAL"
    verification: "manual"

  - id: "sps-nim-002"
    item: "Grounding scheme verified correct"
    level: "WARNING"
    verification: "manual"

  - id: "sps-nim-003"
    item: "EMC requirements met"
    level: "WARNING"
    verification: "manual"

governance:
  applicable_to:
    archetypes: ["industrial-automation", "medical-devices", "instrumentation", "automotive-systems"]

  compliance_mappings:
    - framework: "IEC 61326"
      control: "Immunity Requirements"
      description: "Measurement equipment EMC"
    - framework: "IEC 61000-4"
      control: "Testing Techniques"
      description: "EMC immunity testing"
    - framework: "CISPR 11"
      control: "Industrial EMC"
      description: "Industrial emissions/immunity"

relationships:
  commonly_combined:
    - "sensors-physical-systems.data-acquisition.adc-resolution-accuracy"
    - "sensors-physical-systems.data-acquisition.signal-processing"
  depends_on:
    - "hardware.pcb-design"
    - "installation.wiring-practices"
  feeds_into:
    - "sensors-physical-systems.data-acquisition.data-quality-validation"
    - "compliance.emc-compliance"
