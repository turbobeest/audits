audit:
  id: sensors-physical-systems.hardware-interfaces.uart-integrity
  name: UART Integrity Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: sensors-physical-systems
  category_number: 38
  subcategory: hardware-interfaces
  tier: expert
  estimated_duration: 3-4 hours  # median: 3h
  completeness: requires_discovery
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: physical-systems
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Reviews UART/serial communication implementation including baud rate accuracy,
    flow control, buffer management, framing error handling, parity configuration,
    and electrical interface standards (RS-232, RS-485, TTL). Assesses driver
    robustness and data integrity mechanisms.
  why_it_matters: |
    UART communication issues cause data loss, corruption, or buffer overflows.
    Proper implementation ensures reliable serial communication with sensors,
    modems, and other peripherals, especially in noisy industrial environments.
  when_to_run:
  - During serial interface design
  - When communication errors occur
  - After baud rate changes
  - When adding serial devices
  - During EMC testing
prerequisites:
  required_artifacts:
  - type: schematic
    description: Serial interface schematic
  - type: driver_source
    description: UART driver source code
  - type: device_specs
    description: Connected device specifications
  access_requirements:
  - Access to serial signals
  - Protocol analyzer access
  - Oscilloscope for timing
  - Driver source code access
discovery:
  file_patterns:
  - glob: '**/*uart*.c'
    purpose: Find UART driver code
  - glob: '**/*serial*.c'
    purpose: Find serial driver code
  - glob: '**/drivers/tty/**'
    purpose: Find TTY drivers
  - glob: '**/config/*serial*.yaml'
    purpose: Find serial configuration
knowledge_sources:
  guides:
  - id: rs232-standard
    name: RS-232 Standard
    url: https://www.eia.org/
  - id: rs485-guide
    name: RS-485 Design Guide
    url: https://www.ti.com/
  standards:
  - id: tia-232
    name: TIA-232 Serial Interface
    relevance: RS-232 standard
  - id: tia-485
    name: TIA-485 Multipoint Interface
    relevance: RS-485 standard
  - id: modbus-rtu
    name: Modbus RTU
    relevance: Industrial serial protocol
tooling:
  analysis_tools:
  - tool: serial-analyzer
    purpose: Protocol analysis
  - tool: oscilloscope
    purpose: Signal quality and timing
  - tool: baud-rate-tester
    purpose: Baud rate accuracy
  - tool: bit-error-tester
    purpose: Error rate measurement
signals:
  critical:
  - id: SPS-URT-CRIT-001
    signal: Data loss due to buffer overflow
    evidence_indicators:
    - Receive buffer overflow
    - Data dropped without notification
    - Flow control not implemented
    explanation: |
      Buffer overflow causes permanent data loss. Without flow control or
      adequate buffering, high-speed or bursty data streams will lose
      characters, corrupting sensor data streams.
    remediation: Implement flow control or increase buffer size
  - id: SPS-URT-CRIT-002
    signal: Framing errors not detected or handled
    evidence_indicators:
    - Framing errors ignored
    - Corrupted data passed to application
    - No error statistics
    explanation: |
      Framing errors indicate data corruption or synchronization loss.
      Ignoring these errors allows corrupted data into the system, potentially
      causing incorrect sensor readings.
    remediation: Implement framing error detection and handling
  high:
  - id: SPS-URT-HIGH-001
    signal: Baud rate mismatch or drift
    evidence_indicators:
    - Baud rate error exceeds tolerance
    - Crystal accuracy insufficient
    - Intermittent framing errors
    remediation: Verify and correct baud rate accuracy
  - id: SPS-URT-HIGH-002
    signal: RS-485 bus contention possible
    evidence_indicators:
    - Direction control timing issues
    - Multiple drivers enabled
    - Bus contention errors
    remediation: Correct RS-485 direction control timing
  medium:
  - id: SPS-URT-MED-001
    signal: No message framing or delimiting
    evidence_indicators:
    - Raw byte stream only
    - Message boundaries unclear
    - Sync recovery difficult
    remediation: Implement message framing protocol
  - id: SPS-URT-MED-002
    signal: No data integrity verification
    evidence_indicators:
    - No checksum or CRC
    - Corrupted data not detected
    - Silent data corruption possible
    remediation: Implement checksum or CRC verification
  low:
  - id: SPS-URT-LOW-001
    signal: Serial configuration not documented
    evidence_indicators:
    - Baud rate not recorded
    - Flow control settings unknown
    - Cable pinout not documented
    remediation: Document serial configuration
  - id: SPS-URT-LOW-002
    signal: No serial communication statistics
    evidence_indicators:
    - Error rates unknown
    - No traffic metrics
    - Performance not tracked
    remediation: Implement communication statistics
  positive:
  - id: SPS-URT-POS-001
    signal: Robust serial protocol with error recovery
    evidence_indicators:
    - Message framing implemented
    - CRC verification
    - Automatic retransmission
  - id: SPS-URT-POS-002
    signal: Flow control properly implemented
    evidence_indicators:
    - Hardware or software flow control
    - No buffer overflows
    - Backpressure handled
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Review Configuration
    description: Verify serial port configuration
    duration_estimate: 20 min
  - id: '2'
    name: Verify Baud Rate
    description: Measure actual baud rate accuracy
    duration_estimate: 30 min
  - id: '3'
    name: Test Signal Quality
    description: Verify signal levels and timing
    duration_estimate: 30 min
  - id: '4'
    name: Test Error Handling
    description: Verify framing/parity error handling
    duration_estimate: 30 min
  - id: '5'
    name: Test Flow Control
    description: Verify flow control effectiveness
    duration_estimate: 30 min
  - id: '6'
    name: Review Driver Code
    description: Assess driver implementation
    duration_estimate: 30 min
  - id: '7'
    name: Document Findings
    description: Compile findings and recommendations
    duration_estimate: 15 min
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Configuration Review
    - Signal Analysis
    - Error Handling Assessment
    - Recommendations
closeout_checklist:
- id: sps-urt-001
  item: Baud rate accuracy verified
  level: WARNING
  verification: manual
- id: sps-urt-002
  item: Flow control tested
  level: WARNING
  verification: manual
- id: sps-urt-003
  item: Error handling verified
  level: INFO
  verification: manual
governance:
  applicable_to:
    archetypes:
    - embedded-systems
    - industrial-automation
    - iot-systems
    - instrumentation
  compliance_mappings:
  - framework: TIA-232
    control: Serial Interface
    description: RS-232 compliance
  - framework: TIA-485
    control: Multipoint Interface
    description: RS-485 compliance
  - framework: Modbus
    control: RTU Mode
    description: Industrial serial protocol
relationships:
  commonly_combined:
  - sensors-physical-systems.sensor-integration.sensor-protocol-compliance
  - sensors-physical-systems.hardware-interfaces.gpio-management
  depends_on:
  - hardware.serial-interface
  feeds_into:
  - sensors-physical-systems.sensor-integration.sensor-health-monitoring
  - reliability.communication-reliability
