# ============================================================
# AUDIT: Hydraulic Systems
# Category: 38 - Sensors & Physical Systems
# Subcategory: actuator-control
# ============================================================

audit:
  id: "sensors-physical-systems.actuator-control.hydraulic-systems"
  name: "Hydraulic Systems Audit"
  version: "1.0.0"
  last_updated: "2025-01-22"
  status: "active"

  category: "sensors-physical-systems"
  category_number: 38
  subcategory: "actuator-control"

  tier: "expert"
  estimated_duration: "5-7 hours"  # median: 6h

  completeness: "requires_discovery"
  requires_runtime: true
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "physical-systems"

  default_profiles:
    - "full"
    - "quick"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Evaluates hydraulic actuation systems including pump and reservoir condition,
    fluid quality, pressure control, valve operation, cylinder performance, and
    safety features. Reviews proportional/servo valve control, accumulator
    precharge, and emergency dump functions.

  why_it_matters: |
    Hydraulic systems provide high-force actuation for heavy machinery and
    equipment. System failures can cause equipment damage, product quality
    issues, and serious safety hazards from sudden motion or pressure release.
    Proper maintenance ensures safe, reliable operation.

  when_to_run:
    - "During system commissioning"
    - "When hydraulic issues occur"
    - "During scheduled maintenance"
    - "After component replacement"
    - "During safety reviews"

prerequisites:
  required_artifacts:
    - type: "hydraulic_diagrams"
      description: "Hydraulic circuit diagrams"
    - type: "component_specs"
      description: "Component specifications"
    - type: "fluid_specs"
      description: "Hydraulic fluid requirements"

  access_requirements:
    - "Physical access to hydraulic system"
    - "Fluid analysis capability"
    - "Pressure measurement"
    - "Temperature measurement"

discovery:
  file_patterns:
    - glob: "**/*hydraulic*.c"
      purpose: "Find hydraulic code"
    - glob: "**/*proportional*.c"
      purpose: "Find proportional valve code"
    - glob: "**/*accumulator*.c"
      purpose: "Find accumulator code"
    - glob: "**/config/*hydraulic*.yaml"
      purpose: "Find hydraulic configuration"

knowledge_sources:
  guides:
    - id: "hydraulic-handbook"
      name: "Hydraulic Engineering Handbook"
      url: "https://www.boschrexroth.com/"
    - id: "fluid-power"
      name: "Fluid Power Design Guide"
      url: "https://www.ifps.org/"

  standards:
    - id: "iso-4413"
      name: "ISO 4413 Hydraulic Systems"
      relevance: "Hydraulic system design"
    - id: "iso-4406"
      name: "ISO 4406 Fluid Cleanliness"
      relevance: "Contamination classification"
    - id: "nfpa-t2"
      name: "NFPA T2 Hydraulic Reservoirs"
      relevance: "Reservoir design"

tooling:
  analysis_tools:
    - tool: "particle-counter"
      purpose: "Fluid cleanliness"
    - tool: "pressure-gauge"
      purpose: "System pressure"
    - tool: "flow-meter"
      purpose: "Flow rate measurement"
    - tool: "thermal-camera"
      purpose: "Heat detection"

signals:
  critical:
    - id: "SPS-HYD-CRIT-001"
      signal: "Emergency dump function failure"
      evidence_indicators:
        - "Accumulators not dumping"
        - "Pressure not relieved on E-stop"
        - "Dump valve stuck"
      explanation: |
        Emergency dump functions remove stored hydraulic energy during emergencies.
        Failure leaves high-pressure fluid and compressed gas in accumulators,
        creating potential energy hazards.
      remediation: "Repair emergency dump function immediately"

    - id: "SPS-HYD-CRIT-002"
      signal: "Pressure relief failure"
      evidence_indicators:
        - "Relief valve stuck"
        - "Pressure exceeds safe limit"
        - "Potential for component rupture"
      explanation: |
        Pressure relief valves protect against overpressure. Failure can lead
        to catastrophic component failure, hydraulic line rupture, and serious
        injury from high-pressure fluid spray.
      remediation: "Replace relief valve and test immediately"

  high:
    - id: "SPS-HYD-HIGH-001"
      signal: "Fluid contamination severe"
      evidence_indicators:
        - "Particle count exceeds limits"
        - "Water contamination"
        - "Component failures increasing"
      remediation: "Filter system and identify contamination source"

    - id: "SPS-HYD-HIGH-002"
      signal: "Accumulator precharge incorrect"
      evidence_indicators:
        - "Precharge too low or too high"
        - "Bladder damage possible"
        - "System response affected"
      remediation: "Set correct precharge pressure"

  medium:
    - id: "SPS-HYD-MED-001"
      signal: "Fluid temperature excessive"
      evidence_indicators:
        - "Oil overheating"
        - "Cooler inadequate"
        - "Viscosity affected"
      remediation: "Improve cooling or reduce heat generation"

    - id: "SPS-HYD-MED-002"
      signal: "Leakage significant"
      evidence_indicators:
        - "External leaks visible"
        - "Fluid consumption high"
        - "Environmental contamination"
      remediation: "Locate and repair leaks"

  low:
    - id: "SPS-HYD-LOW-001"
      signal: "Hydraulic system not documented"
      evidence_indicators:
        - "Circuits not drawn"
        - "Pressure settings not recorded"
        - "Maintenance history missing"
      remediation: "Document hydraulic system"

    - id: "SPS-HYD-LOW-002"
      signal: "No fluid analysis program"
      evidence_indicators:
        - "Oil not regularly sampled"
        - "Contamination levels unknown"
        - "Degradation not tracked"
      remediation: "Implement fluid analysis program"

  positive:
    - id: "SPS-HYD-POS-001"
      signal: "Clean, well-maintained hydraulic system"
      evidence_indicators:
        - "Fluid cleanliness verified"
        - "Components in good condition"
        - "No significant leaks"

    - id: "SPS-HYD-POS-002"
      signal: "Comprehensive safety features"
      evidence_indicators:
        - "Emergency dump tested"
        - "Relief valves verified"
        - "Interlocks functional"

procedure:
  context:
    cognitive_mode: "analytical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Review System Design"
      description: "Understand hydraulic circuit design"
      duration_estimate: "30 min"

    - id: "2"
      name: "Test Fluid Quality"
      description: "Sample and analyze hydraulic fluid"
      duration_estimate: "45 min"

    - id: "3"
      name: "Check Pressure Settings"
      description: "Verify system and relief pressures"
      duration_estimate: "45 min"

    - id: "4"
      name: "Test Safety Functions"
      description: "Verify dump and relief operation"
      duration_estimate: "45 min"

    - id: "5"
      name: "Inspect for Leaks"
      description: "Survey system for leakage"
      duration_estimate: "30 min"

    - id: "6"
      name: "Check Accumulator Precharge"
      description: "Verify accumulator nitrogen precharge"
      duration_estimate: "30 min"

    - id: "7"
      name: "Document Findings"
      description: "Compile findings and recommendations"
      duration_estimate: "30 min"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "System Condition"
        - "Fluid Analysis"
        - "Safety Assessment"
        - "Recommendations"

closeout_checklist:
  - id: "sps-hyd-001"
    item: "Emergency dump verified"
    level: "CRITICAL"
    verification: "manual"

  - id: "sps-hyd-002"
    item: "Relief valves functional"
    level: "CRITICAL"
    verification: "manual"

  - id: "sps-hyd-003"
    item: "Fluid quality acceptable"
    level: "WARNING"
    verification: "manual"

governance:
  applicable_to:
    archetypes: ["heavy-machinery", "manufacturing", "mobile-equipment", "press-systems"]

  compliance_mappings:
    - framework: "ISO 4413"
      control: "Hydraulic Systems"
      description: "System design rules"
    - framework: "NFPA 79"
      control: "Hydraulic Safety"
      description: "Industrial machinery"
    - framework: "OSHA 1910"
      control: "Machine Guarding"
      description: "Hydraulic safety requirements"

relationships:
  commonly_combined:
    - "sensors-physical-systems.safety-systems.emergency-stop-coverage"
    - "sensors-physical-systems.actuator-control.valve-control"
  depends_on:
    - "utilities.hydraulic-power-unit"
  feeds_into:
    - "reliability.hydraulic-reliability"
    - "maintenance.fluid-analysis"
