# ============================================================
# AUDIT: Motor Control
# Category: 38 - Sensors & Physical Systems
# Subcategory: actuator-control
# ============================================================

audit:
  id: "sensors-physical-systems.actuator-control.motor-control"
  name: "Motor Control Audit"
  version: "1.0.0"
  last_updated: "2025-01-22"
  status: "active"

  category: "sensors-physical-systems"
  category_number: 38
  subcategory: "actuator-control"

  tier: "expert"
  estimated_duration: "5-7 hours"  # median: 6h

  completeness: "requires_discovery"
  requires_runtime: true
  destructive: false

execution:
  automatable: "partial"
  requires_physical_access: true
  severity: "high"
  scope: "physical-systems"

  default_profiles:
    - "full"
    - "quick"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Evaluates motor control systems including drive configuration (VFD, soft start,
    DOL), protection settings, speed/torque control, feedback systems, and safety
    interlocks. Reviews motor parameter settings, thermal protection, overcurrent
    protection, and diagnostic capabilities.

  why_it_matters: |
    Motor control systems drive critical processes and machinery. Improper
    configuration can cause equipment damage, process upsets, safety hazards,
    and energy waste. Proper motor control ensures reliable operation, protects
    equipment, and optimizes energy efficiency.

  when_to_run:
    - "During motor control design"
    - "After motor replacement"
    - "When motor issues arise"
    - "During energy audits"
    - "Before critical startups"

prerequisites:
  required_artifacts:
    - type: "motor_specs"
      description: "Motor nameplate and specifications"
    - type: "drive_config"
      description: "VFD/drive configuration"
    - type: "protection_settings"
      description: "Motor protection relay settings"

  access_requirements:
    - "Physical access to motors"
    - "Drive parameter access"
    - "Protection relay access"
    - "Control system access"

discovery:
  file_patterns:
    - glob: "**/*motor*.c"
      purpose: "Find motor control code"
    - glob: "**/*vfd*.c"
      purpose: "Find VFD code"
    - glob: "**/*drive*.c"
      purpose: "Find drive code"
    - glob: "**/config/*motor*.yaml"
      purpose: "Find motor configuration"

knowledge_sources:
  guides:
    - id: "nema-mg1"
      name: "NEMA MG 1 Motors"
      url: "https://www.nema.org/"
    - id: "vfd-application"
      name: "VFD Application Guide"
      url: "https://www.abb.com/"

  standards:
    - id: "iec-60034"
      name: "IEC 60034 Rotating Machines"
      relevance: "Motor specifications"
    - id: "nema-mg1"
      name: "NEMA MG 1 Motors"
      relevance: "Motor standards"
    - id: "ieee-841"
      name: "IEEE 841 Premium Motors"
      relevance: "Premium efficiency motors"

tooling:
  analysis_tools:
    - tool: "drive-diagnostic"
      purpose: "VFD diagnostics"
    - tool: "power-analyzer"
      purpose: "Power quality analysis"
    - tool: "vibration-analyzer"
      purpose: "Motor vibration analysis"
    - tool: "thermal-camera"
      purpose: "Thermal inspection"

signals:
  critical:
    - id: "SPS-MTR-CRIT-001"
      signal: "Motor protection inadequate for application"
      evidence_indicators:
        - "Thermal overload set too high"
        - "No ground fault protection"
        - "Protection not coordinated"
      explanation: |
        Inadequate motor protection can allow motors to operate in damaging
        conditions, leading to premature failure, fire hazards, or safety
        incidents from unexpected motor behavior.
      remediation: "Configure proper motor protection per NEC and motor specs"

    - id: "SPS-MTR-CRIT-002"
      signal: "Safety interlock bypassed or defeated"
      evidence_indicators:
        - "E-stop not wired correctly"
        - "Interlock jumpered out"
        - "Safety monitoring disabled"
      explanation: |
        Motor safety interlocks protect personnel from injury during maintenance
        or abnormal conditions. Bypassed interlocks create immediate safety
        hazards.
      remediation: "Restore all safety interlocks to proper operation"

  high:
    - id: "SPS-MTR-HIGH-001"
      signal: "VFD parameters not matched to motor"
      evidence_indicators:
        - "Motor parameters incorrect"
        - "V/Hz curve not optimized"
        - "Auto-tune not performed"
      remediation: "Configure VFD parameters to match motor nameplate"

    - id: "SPS-MTR-HIGH-002"
      signal: "Motor running above thermal limits"
      evidence_indicators:
        - "Operating temperature high"
        - "Service factor exceeded"
        - "Cooling inadequate"
      remediation: "Address thermal issues through load reduction or cooling"

  medium:
    - id: "SPS-MTR-MED-001"
      signal: "VFD carrier frequency causing issues"
      evidence_indicators:
        - "Motor noise excessive"
        - "Bearing currents detected"
        - "Cable heating issues"
      remediation: "Optimize carrier frequency and add mitigation if needed"

    - id: "SPS-MTR-MED-002"
      signal: "No motor diagnostic data collection"
      evidence_indicators:
        - "Run hours not tracked"
        - "Start counts unknown"
        - "No fault history"
      remediation: "Enable and collect motor diagnostic data"

  low:
    - id: "SPS-MTR-LOW-001"
      signal: "Motor control documentation incomplete"
      evidence_indicators:
        - "Protection settings not recorded"
        - "VFD parameters not documented"
        - "Wiring diagrams outdated"
      remediation: "Document motor control configuration"

    - id: "SPS-MTR-LOW-002"
      signal: "Spare parts not identified"
      evidence_indicators:
        - "No spare motor identified"
        - "No spare drive available"
        - "Long lead time for replacement"
      remediation: "Identify and procure critical spare parts"

  positive:
    - id: "SPS-MTR-POS-001"
      signal: "Comprehensive motor protection"
      evidence_indicators:
        - "Thermal, overcurrent, ground fault"
        - "Protection coordinated"
        - "Monitoring enabled"

    - id: "SPS-MTR-POS-002"
      signal: "Energy-efficient motor control"
      evidence_indicators:
        - "VFD properly applied"
        - "Energy savings verified"
        - "Power factor corrected"

procedure:
  context:
    cognitive_mode: "analytical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Inventory Motor Systems"
      description: "Catalog all motor control systems"
      duration_estimate: "30 min"

    - id: "2"
      name: "Review Protection Settings"
      description: "Verify motor protection configuration"
      duration_estimate: "60 min"

    - id: "3"
      name: "Check VFD Configuration"
      description: "Verify drive parameter settings"
      duration_estimate: "60 min"

    - id: "4"
      name: "Test Safety Interlocks"
      description: "Verify E-stop and interlocks"
      duration_estimate: "45 min"

    - id: "5"
      name: "Assess Thermal Performance"
      description: "Check motor operating temperatures"
      duration_estimate: "30 min"

    - id: "6"
      name: "Review Diagnostics"
      description: "Check diagnostic capabilities"
      duration_estimate: "30 min"

    - id: "7"
      name: "Document Findings"
      description: "Compile findings and recommendations"
      duration_estimate: "30 min"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Motor Inventory"
        - "Protection Assessment"
        - "Safety Review"
        - "Recommendations"

closeout_checklist:
  - id: "sps-mtr-001"
    item: "Motor protection properly configured"
    level: "CRITICAL"
    verification: "manual"

  - id: "sps-mtr-002"
    item: "Safety interlocks verified"
    level: "CRITICAL"
    verification: "manual"

  - id: "sps-mtr-003"
    item: "VFD parameters matched to motor"
    level: "WARNING"
    verification: "manual"

governance:
  applicable_to:
    archetypes: ["industrial-automation", "manufacturing", "hvac-systems", "pumping-systems"]

  compliance_mappings:
    - framework: "NEC"
      control: "Article 430"
      description: "Motor circuits"
    - framework: "NFPA 79"
      control: "Motor Safety"
      description: "Industrial machinery"
    - framework: "IEC 60204"
      control: "Electrical Equipment"
      description: "Machinery electrical safety"

relationships:
  commonly_combined:
    - "sensors-physical-systems.actuator-control.feedback-loop-tuning"
    - "sensors-physical-systems.safety-systems.emergency-stop-coverage"
  depends_on:
    - "electrical.power-distribution"
  feeds_into:
    - "energy.motor-efficiency"
    - "reliability.motor-reliability"
