# ============================================================
# AUDIT: Expectations Management
# Category: 28 - Requirements & Specification
# Subcategory: stakeholder-management
# ============================================================

audit:
  id: "requirements-specification.stakeholder-management.expectations-management"
  name: "Expectations Management Audit"
  version: "1.0.0"
  last_updated: "2025-01-22"
  status: "active"

  category: "requirements-specification"
  category_number: 28
  subcategory: "stakeholder-management"

  tier: "focused"
  estimated_duration: "2-3 hours"  # median: 2h

  completeness: "requires_discovery"
  requires_runtime: false
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "documentation"
  default_profiles:
    - "full"
    - "requirements"

description:
  what: |
    This audit examines how stakeholder expectations are managed throughout
    the requirements process. It evaluates:
    - Expectations capture
    - Expectations alignment with scope
    - Gap identification and management
    - Expectation setting communications
    - Conflict resolution
    - Reality alignment

  why_it_matters: |
    Expectations management prevents disappointment:
    - Unmanaged expectations lead to dissatisfaction
    - Stakeholders may expect more than scope includes
    - Early expectation alignment prevents conflict
    - Gaps between expectations and delivery cause failure perception
    - Proactive management builds trust
    - Requirements must align with realistic expectations

prerequisites:
  required_artifacts:
    - type: "expectations_documentation"
      description: "Stakeholder expectations documentation"
    - type: "scope_documentation"
      description: "Scope documentation"

  access_requirements:
    - "Read access to expectations documentation"
    - "Access to scope documentation"

discovery:
  code_patterns:
    - pattern: "(expectation|expect|assume|assumption)"
      type: "regex"
      scope: "documentation"
      purpose: "Detect expectation references"

  file_patterns:
    - glob: "**/expectation*.{md,yaml}"
      purpose: "Expectations documentation"
    - glob: "**/assumption*.{md,yaml}"
      purpose: "Assumptions documentation"

knowledge_sources:
  specifications:
    - id: "pmbok-expectations"
      name: "PMBOK - Stakeholder Expectations"
      url: "https://www.pmi.org/"
      offline_cache: true
      priority: "required"

signals:
  critical:
    - id: "EXPECT-CRIT-001"
      signal: "Stakeholder expectations not captured"
      evidence_indicators:
        - "No expectations documentation"
        - "Expectations unknown"
        - "Surprises at delivery"
      remediation: |
        - Capture stakeholder expectations
        - Document expectations explicitly
        - Compare expectations to scope
        - Identify and address gaps
        - Communicate alignment

  high:
    - id: "EXPECT-HIGH-001"
      signal: "Expectations exceed scope"
      evidence_indicators:
        - "Expectations beyond documented scope"
        - "Stakeholders expect features not in scope"
        - "Gap not communicated"
      remediation: |
        - Identify expectation-scope gaps
        - Communicate gaps to stakeholders
        - Adjust expectations or scope
        - Document agreed alignment

procedure:
  steps:
    - id: "1"
      name: "Expectations Documentation Check"
      commands:
        - purpose: "Find expectations documentation"
          command: |
            find . -type f \( -name "*expectation*" -o -name "*assumption*" \) \
              \( -name "*.md" -o -name "*.yaml" \) 2>/dev/null | head -15

    - id: "2"
      name: "Expectations Management Check"
      commands:
        - purpose: "Check for expectations references"
          command: |
            grep -rniE "(expectation|expect|assume|assumption)" \
              --include="*.md" --include="*.yaml" . 2>/dev/null | head -25

output:
  deliverables:
    - type: "expectations_assessment"
      format: "prose"

closeout_checklist:
  - id: "expect-001"
    item: "Stakeholder expectations documented"
    level: "CRITICAL"
    verification: "manual"
    expected: "Confirmed"

governance:
  applicable_to:
    archetypes: ["all"]

relationships:
  commonly_combined:
    - "requirements-specification.stakeholder-management.stakeholder-analysis"
    - "requirements-specification.change-control.scope-creep-control"
