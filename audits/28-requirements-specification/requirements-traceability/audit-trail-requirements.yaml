audit:
  id: requirements-specification.requirements-traceability.audit-trail-requirements
  name: Audit Trail Requirements Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: requirements-specification
  category_number: 28
  subcategory: requirements-traceability
  tier: expert
  estimated_duration: 2-3 hours  # median: 2h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: documentation
  default_profiles:
  - full
  - requirements
  - compliance
description:
  what: |
    This audit examines the audit trail capabilities for requirements,
    tracking who made changes, when, and why. It evaluates:
    - Change attribution (who made changes)
    - Timestamp tracking (when changes occurred)
    - Change rationale documentation (why changes were made)
    - Approval tracking
    - Historical query capability
  why_it_matters: |
    Audit trails support governance and compliance:
    - Regulatory compliance often requires audit trails
    - Accountability for requirements decisions
    - Ability to investigate issues back to requirements
    - Support for audits and assessments
    - Historical record for lessons learned
    - ISO 9001 requires documented information control
prerequisites:
  required_artifacts:
  - type: requirements
    description: Requirements documentation
  - type: change_records
    description: Change history records
  access_requirements:
  - Read access to requirements
  - Access to version control history
  - Access to change management records
discovery:
  code_patterns:
  - pattern: (author|modified by|approved by|changed by)
    type: regex
    scope: documentation
    purpose: Detect attribution
  - pattern: (date|timestamp|created|modified|approved)
    type: regex
    scope: documentation
    purpose: Detect timestamps
  file_patterns:
  - glob: '**/requirements/**'
    purpose: Requirements with history
  - glob: '**/changelog*.{md,yaml}'
    purpose: Change logs
  - glob: '**/audit*.{md,yaml}'
    purpose: Audit documentation
knowledge_sources:
  specifications:
  - id: iso-9001-docs
    name: ISO 9001 - Documented Information
    url: https://www.iso.org/standard/62085.html
    offline_cache: true
    priority: required
signals:
  critical:
  - id: AUDIT-CRIT-001
    signal: No audit trail for requirements changes
    evidence_indicators:
    - Changes not attributed to individuals
    - No timestamps on changes
    - Cannot determine who approved changes
    remediation: |
      - Implement change tracking
      - Require attribution for all changes
      - Timestamp all modifications
      - Track approvals
      - Maintain audit logs
  high:
  - id: AUDIT-HIGH-001
    signal: Change rationale not documented
    evidence_indicators:
    - Changes made without explanation
    - Cannot determine why requirements changed
    - No decision records
    remediation: |
      - Require rationale for changes
      - Link changes to requests
      - Document decision rationale
      - Maintain decision log
procedure:
  steps:
  - id: '1'
    name: Audit Trail Assessment
    commands:
    - purpose: Check for audit trail elements
      command: |
        grep -rniE "(author|created|modified|approved|changed by)" \
          --include="*.yaml" --include="*.md" . 2>/dev/null | head -30
  - id: '2'
    name: Version History Check
    commands:
    - purpose: Check git history for requirements
      command: |
        git log --format="%h %an %ad %s" --date=short -- "**/requirements/**" 2>/dev/null | head -20 || echo "Not in git"
output:
  deliverables:
  - type: audit_trail_assessment
    format: prose
closeout_checklist:
- id: audit-001
  item: Audit trail exists for requirements
  level: CRITICAL
  verification: manual
  expected: Confirmed
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: ISO 9001
    controls:
    - '7.5'
  - framework: SOX
    controls:
    - Section 404
relationships:
  commonly_combined:
  - requirements-specification.requirements-traceability.requirements-versioning
  - requirements-specification.change-control.change-approval-workflow
