audit:
  id: requirements-specification.acceptance-criteria.negative-scenarios
  name: Negative Scenarios Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: requirements-specification
  category_number: 28
  subcategory: acceptance-criteria
  tier: expert
  estimated_duration: 2-3 hours  # median: 2h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: documentation
  default_profiles:
  - full
  - requirements
  - testing
description:
  what: |
    This audit examines coverage of negative scenarios and error cases
    in acceptance criteria. It evaluates:
    - Invalid input handling
    - Error message specifications
    - Failure scenario coverage
    - Recovery behavior requirements
    - Security violation scenarios
  why_it_matters: |
    Negative scenarios ensure robustness:
    - Users make mistakes; systems must handle them
    - Security depends on rejecting invalid input
    - Error handling affects user experience
    - Negative testing finds vulnerabilities
    - Missing error handling causes support issues
prerequisites:
  required_artifacts:
  - type: acceptance_criteria
    description: Acceptance criteria including negative cases
  - type: error_specifications
    description: Error handling specifications
  access_requirements:
  - Read access to acceptance criteria
  - Access to error specifications
discovery:
  code_patterns:
  - pattern: (invalid|error|fail|reject|deny|unauthorized)
    type: regex
    scope: documentation
    purpose: Detect negative scenarios
  - pattern: (should not|must not|cannot|forbidden|prohibited)
    type: regex
    scope: documentation
    purpose: Detect prohibition requirements
  file_patterns:
  - glob: '**/*.feature'
    purpose: BDD features
  - glob: '**/error*.{md,yaml}'
    purpose: Error documentation
  - glob: '**/negative*.{md,yaml}'
    purpose: Negative scenario documentation
knowledge_sources:
  specifications:
  - id: negative-testing
    name: Negative Testing Techniques
    url: https://www.istqb.org/
    offline_cache: true
    priority: required
signals:
  critical:
  - id: NEG-CRIT-001
    signal: No negative scenarios in acceptance criteria
    evidence_indicators:
    - Only positive/happy path scenarios
    - Error handling not specified
    - Invalid input behavior undefined
    remediation: |
      - Add negative scenarios for each feature
      - Specify invalid input handling
      - Document error messages
      - Include security violation scenarios
      - Add recovery requirements
  high:
  - id: NEG-HIGH-001
    signal: Error messages not specified
    evidence_indicators:
    - Errors without user messages
    - Generic error handling
    - Error content undefined
    remediation: |
      - Define specific error messages
      - Include user-facing text
      - Specify error codes
      - Document recovery guidance
procedure:
  steps:
  - id: '1'
    name: Negative Scenario Discovery
    commands:
    - purpose: Find negative scenarios
      command: |
        grep -rniE "(invalid|error|fail|reject|deny|should not|must not)" \
          --include="*.md" --include="*.yaml" --include="*.feature" . 2>/dev/null | head -40
  - id: '2'
    name: Error Specification Check
    commands:
    - purpose: Check error documentation
      command: |
        grep -rniE "(error message|error code|validation error|when.*invalid)" \
          --include="*.md" --include="*.yaml" --include="*.feature" . 2>/dev/null | head -30
output:
  deliverables:
  - type: negative_scenario_assessment
    format: prose
closeout_checklist:
- id: neg-001
  item: Negative scenarios documented
  level: CRITICAL
  verification: manual
  expected: Confirmed
governance:
  applicable_to:
    archetypes:
    - all
relationships:
  commonly_combined:
  - requirements-specification.acceptance-criteria.edge-case-coverage
  - requirements-specification.requirements-documentation.functional-requirements
