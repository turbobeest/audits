audit:
  id: requirements-specification.requirements-elicitation.domain-analysis
  name: Domain Analysis Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: requirements-specification
  category_number: 28
  subcategory: requirements-elicitation
  tier: phd
  estimated_duration: 3-5 hours  # median: 4h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: documentation
  default_profiles:
  - full
  - requirements
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines the depth and quality of domain analysis performed
    during requirements elicitation. It evaluates:
    - Domain model completeness and accuracy
    - Ubiquitous language definition and usage
    - Business rules capture and documentation
    - Domain expert involvement
    - Entity relationship documentation
    - Domain constraints and invariants
  why_it_matters: |
    Domain analysis is foundational to correct requirements:
    - Eric Evans' Domain-Driven Design emphasizes deep domain understanding
    - Ubiquitous language prevents translation errors between business and technical teams
    - Business rules often represent non-functional requirements in disguise
    - Domain models drive data architecture and API design
    - Poor domain understanding leads to misaligned solutions
    - Domain analysis reveals implicit requirements stakeholders assume

    Studies show that projects with strong domain modeling have significantly
    fewer requirements-related defects and better stakeholder satisfaction.
  when_to_run:
  - Early in project discovery phase
  - When entering unfamiliar domain
  - When domain model inconsistencies emerge
  - During architecture reviews
  - When business rules are unclear
prerequisites:
  required_artifacts:
  - type: domain_models
    description: Domain models, entity diagrams, or bounded context maps
  - type: glossary
    description: Domain glossary or ubiquitous language documentation
  - type: business_rules
    description: Business rules documentation
  access_requirements:
  - Access to domain documentation
  - Access to domain experts for clarification
  - Read access to existing system models
  - Access to business process documentation
discovery:
  code_patterns:
  - pattern: (domain|entity|aggregate|value.?object|bounded.?context)
    type: regex
    scope: documentation
    purpose: Detect DDD patterns
  - pattern: (business.?rule|invariant|constraint|validation)
    type: regex
    scope: source
    purpose: Detect business rule implementations
  - pattern: (glossary|terminology|definition|ubiquitous)
    type: regex
    scope: documentation
    purpose: Detect language documentation
  file_patterns:
  - glob: '**/domain/**'
    purpose: Domain model directories
  - glob: '**/glossary*.{md,yaml,json}'
    purpose: Glossary files
  - glob: '**/business-rules*.{md,yaml}'
    purpose: Business rules documentation
  - glob: '**/models/**'
    purpose: Model definitions
  - glob: '**/*.entity.{ts,java,py}'
    purpose: Entity files
knowledge_sources:
  specifications:
  - id: ddd-eric-evans
    name: Domain-Driven Design - Eric Evans
    url: https://domainlanguage.com/ddd/
    offline_cache: true
    priority: required
  - id: ireb-domain-modeling
    name: IREB CPRE - Domain Modeling
    url: https://www.ireb.org/
    offline_cache: true
    priority: required
  guides:
  - id: ddd-reference
    name: DDD Reference - Eric Evans
    url: https://domainlanguage.com/ddd/reference/
    offline_cache: true
  - id: event-storming-domain
    name: Event Storming for Domain Discovery
    url: https://www.eventstorming.com/
    offline_cache: true
tooling:
  static_analysis:
  - tool: domain-model-analyzer
    purpose: Analyze domain model consistency
    offline_capable: true
  infrastructure_tools:
  - tool: lucidchart
    purpose: Domain diagram review
  - tool: miro
    purpose: Event storming and domain mapping
  scripts:
  - id: domain-scanner
    language: bash
    purpose: Scan for domain modeling artifacts
    source: inline
    code: |
      #!/bin/bash
      echo "=== Domain Analysis Scan ==="
      echo "Looking for domain documentation..."
      find . -type f \( -name "*domain*" -o -name "*entity*" \
        -o -name "*glossary*" -o -name "*business-rule*" \) 2>/dev/null | head -30
      echo ""
      echo "Searching for DDD patterns..."
      grep -rniE "(aggregate|bounded.?context|value.?object|domain.?event)" \
        --include="*.md" --include="*.yaml" --include="*.ts" \
        --include="*.java" . 2>/dev/null | head -30
signals:
  critical:
  - id: DOMAIN-CRIT-001
    signal: No domain model documented
    evidence_indicators:
    - No entity diagrams or domain models exist
    - Data structures designed without domain analysis
    - No bounded context identification
    explanation: |
      Without a domain model, development proceeds without shared understanding
      of the problem space. Eric Evans emphasizes that the model IS the code's
      foundation. Missing domain models lead to technical solutions that
      don't match business reality, causing extensive rework.
    remediation: |
      - Conduct domain modeling sessions with domain experts
      - Create entity-relationship or UML diagrams
      - Identify bounded contexts and their relationships
      - Document aggregates and value objects
      - Validate model with domain experts
  - id: DOMAIN-CRIT-002
    signal: No ubiquitous language defined
    evidence_indicators:
    - No glossary or terminology documentation
    - Same concepts called different names
    - Technical and business terms inconsistent
    explanation: |
      Ubiquitous language is central to DDD. Without shared terminology,
      every conversation risks misunderstanding. Different names for the
      same concept in code vs. requirements create translation errors.
      Eric Evans notes this is a primary cause of misaligned systems.
    remediation: |
      - Create domain glossary with expert input
      - Define each term precisely
      - Enforce glossary terms in code, documentation, and conversation
      - Resolve synonyms and homonyms explicitly
      - Update glossary as understanding evolves
  high:
  - id: DOMAIN-HIGH-001
    signal: Business rules not systematically captured
    evidence_indicators:
    - Business rules scattered in code without documentation
    - No business rules catalog
    - Rules discovered during development, not requirements
    explanation: |
      Business rules represent domain constraints that must be enforced.
      Without systematic capture, rules are discovered ad-hoc during
      development, leading to incomplete implementations and defects.
      IREB emphasizes business rules as critical requirements input.
    remediation: |
      - Create business rules catalog
      - Elicit rules from domain experts systematically
      - Categorize rules (constraints, calculations, workflows)
      - Link rules to requirements and test cases
      - Validate rules with business stakeholders
  - id: DOMAIN-HIGH-002
    signal: Domain experts not involved in modeling
    evidence_indicators:
    - Domain model created by developers only
    - No evidence of domain expert review
    - Model uses technical rather than domain terms
    explanation: |
      Domain models require domain expert input to be accurate.
      Developer-only models often miss nuances and use technical
      rather than business terminology. Eric Evans emphasizes
      continuous collaboration with domain experts.
    remediation: |
      - Involve domain experts in modeling sessions
      - Use techniques like Event Storming for collaboration
      - Have domain experts review and validate models
      - Iterate models based on expert feedback
      - Document expert contributions
  - id: DOMAIN-HIGH-003
    signal: Domain model not reflected in code
    evidence_indicators:
    - Code structure doesn't match domain model
    - Technical layers obscure domain concepts
    - Different terminology in code vs. model
    explanation: |
      If the domain model isn't reflected in code, it becomes shelfware.
      DDD emphasizes that the model should drive code structure.
      Divergence between model and code leads to maintenance difficulties
      and accumulated technical debt.
    remediation: |
      - Align code structure with domain model
      - Use domain terms for class and method names
      - Refactor technical layers to expose domain concepts
      - Keep model and code synchronized
      - Review code against model in code reviews
  medium:
  - id: DOMAIN-MED-001
    signal: Bounded contexts not identified
    evidence_indicators:
    - Single model spans entire system
    - Same terms mean different things in different areas
    - No context mapping documented
    explanation: |
      Large systems have multiple bounded contexts with different models.
      Without context identification, models become bloated and
      inconsistent. Context mapping clarifies where models apply
      and how they integrate.
    remediation: |
      - Identify natural context boundaries
      - Create context map showing relationships
      - Allow different models per context
      - Define integration patterns between contexts
      - Document context ownership
  - id: DOMAIN-MED-002
    signal: Domain invariants not documented
    evidence_indicators:
    - Aggregate boundaries not defined
    - Consistency rules not explicit
    - Invariants enforced inconsistently
    explanation: |
      Domain invariants are rules that must always be true.
      Aggregates exist to enforce invariants within consistency
      boundaries. Without documentation, invariants are enforced
      inconsistently or violated.
    remediation: |
      - Document domain invariants explicitly
      - Define aggregate boundaries based on invariants
      - Link invariants to validation code
      - Test invariant enforcement
      - Review new features for invariant impact
  - id: DOMAIN-MED-003
    signal: Domain model not evolved with understanding
    evidence_indicators:
    - Initial model unchanged despite learnings
    - Workarounds for model limitations
    - No model versioning
    explanation: |
      Domain understanding deepens over time. Models must evolve
      to reflect improved understanding. Static models accumulate
      technical debt as the gap between model and reality grows.
    remediation: |
      - Schedule regular model review sessions
      - Update model based on learnings
      - Version control domain models
      - Refactor code when model changes
      - Document model evolution rationale
  low:
  - id: DOMAIN-LOW-001
    signal: Domain model not accessible to team
    evidence_indicators:
    - Model exists only in modeling tool
    - Team members unaware of model
    - Model not referenced in discussions
    explanation: |
      Domain models must be accessible to drive shared understanding.
      If only modelers can access or understand the model, its value
      for communication is lost.
    remediation: |
      - Export models to accessible formats
      - Display models in team areas
      - Reference models in requirements and design
      - Train team on model reading
  positive:
  - id: DOMAIN-POS-001
    signal: Comprehensive domain model maintained
    evidence_indicators:
    - Entities, relationships, and constraints documented
    - Model aligned with code structure
    - Regular expert validation
  - id: DOMAIN-POS-002
    signal: Ubiquitous language consistently used
    evidence_indicators:
    - Glossary terms in code, docs, and conversation
    - No translation needed between business and technical
    - Glossary actively maintained
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Domain Model Discovery
    description: |
      Locate and review domain modeling artifacts including
      entity diagrams, bounded contexts, and domain documentation.
    duration_estimate: 45 min
    commands:
    - purpose: Find domain documentation
      command: |
        find . -type f \( -name "*domain*" -o -name "*entity*" \
          -o -name "*model*" -o -name "*context*" \) 2>/dev/null | head -40
    - purpose: Search for DDD patterns
      command: |
        grep -rniE "(aggregate|bounded.?context|value.?object|entity|domain)" \
          --include="*.md" --include="*.yaml" --include="*.ts" \
          --include="*.java" --include="*.py" . 2>/dev/null | head -50
    expected_findings:
    - Domain model documentation
    - Entity definitions
    - Bounded context maps
  - id: '2'
    name: Ubiquitous Language Review
    description: |
      Assess the presence and consistency of ubiquitous language
      documentation and usage.
    duration_estimate: 30 min
    commands:
    - purpose: Find glossary documentation
      command: |
        find . -type f \( -name "*glossary*" -o -name "*terminology*" \
          -o -name "*dictionary*" \) 2>/dev/null | head -20
    - purpose: Search for term definitions
      command: |
        grep -rniE "(definition:|term:|means:|refers to:)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -30
    expected_findings:
    - Glossary files
    - Term definitions
    - Terminology standards
  - id: '3'
    name: Business Rules Analysis
    description: |
      Identify and assess business rules documentation and
      their connection to requirements.
    duration_estimate: 45 min
    commands:
    - purpose: Find business rules
      command: |
        find . -type f \( -name "*business-rule*" -o -name "*rule*" \
          -o -name "*constraint*" \) 2>/dev/null | head -20
    - purpose: Search for rule implementations
      command: |
        grep -rniE "(business.?rule|validate|constraint|invariant)" \
          --include="*.ts" --include="*.java" --include="*.py" \
          --include="*.yaml" . 2>/dev/null | head -40
    expected_findings:
    - Business rules documentation
    - Rule implementations in code
    - Constraint definitions
  - id: '4'
    name: Model-Code Alignment
    description: |
      Verify that domain models are reflected in code structure
      and terminology.
    duration_estimate: 45 min
    commands:
    - purpose: Find entity implementations
      command: |
        find . -type f \( -name "*.entity.*" -o -name "*Entity.*" \
          -o -name "*Aggregate.*" \) 2>/dev/null | head -20
    - purpose: Check for domain-driven structure
      command: |
        find . -type d \( -name "domain" -o -name "entities" \
          -o -name "aggregates" -o -name "valueobjects" \) 2>/dev/null | head -20
    expected_findings:
    - Domain-driven code structure
    - Entity implementations
    - Model-aligned naming
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Domain Model Assessment
    - Ubiquitous Language Status
    - Business Rules Coverage
    - Recommendations
  - type: domain_model_review
    format: structured
    description: Domain model completeness and accuracy assessment
  confidence_guidance:
    high: Domain documentation directly reviewed with expert validation
    medium: Domain artifacts found but completeness uncertain
    low: Domain analysis status unclear, requires domain expert input
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: ddd-eric-evans
      priority: required
    - source_id: ireb-domain-modeling
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Domain analysis requires thorough review
    full:
      included: true
      priority: 2
    requirements:
      included: true
      priority: 1
closeout_checklist:
- id: domain-001
  item: Domain model documented
  level: CRITICAL
  verification: |
    find . -type f \( -name "*domain*" -o -name "*entity*" \) \
      -name "*.md" -o -name "*.yaml" 2>/dev/null | \
      wc -l | xargs -I{} test {} -gt 0 && echo "PASS" || echo "FAIL"
  expected: PASS
- id: domain-002
  item: Ubiquitous language glossary exists
  level: BLOCKING
  verification: |
    find . -type f -name "*glossary*" 2>/dev/null | \
      wc -l | xargs -I{} test {} -gt 0 && echo "PASS" || echo "FAIL"
  expected: PASS
- id: domain-003
  item: Business rules documented
  level: BLOCKING
  verification: |
    grep -rniE "business.?rule" --include="*.md" --include="*.yaml" . \
      2>/dev/null | wc -l | xargs -I{} test {} -gt 0 && echo "PASS" || echo "FAIL"
  expected: PASS
- id: domain-004
  item: Domain expert involvement documented
  level: WARNING
  verification: manual
  verification_notes: Confirm domain experts participated in modeling
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: IREB
    controls:
    - EL4
  - framework: BABOK
    controls:
    - '5.1'
    - '5.2'
  - framework: CMMI
    controls:
    - RD SP 1.1
relationships:
  commonly_combined:
  - requirements-specification.requirements-elicitation.elicitation-techniques
  - requirements-specification.specification-quality.data-specification
  - requirements-specification.requirements-documentation.requirements-clarity
  - requirements-specification.acceptance-criteria.business-rules-validation
