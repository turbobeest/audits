audit:
  id: requirements-specification.requirements-elicitation.user-story-mapping
  name: User Story Mapping Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: requirements-specification
  category_number: 28
  subcategory: requirements-elicitation
  tier: expert
  estimated_duration: 2-3 hours  # median: 2h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: documentation
  default_profiles:
  - full
  - requirements
  - agile
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines the use of user story mapping for requirements discovery
    and release planning. It evaluates:
    - Story map structure (backbone, walking skeleton, slices)
    - Coverage of user activities and tasks
    - Story decomposition and granularity
    - Release planning alignment with story maps
    - Map maintenance and evolution
    - Integration with backlog management
  why_it_matters: |
    User story mapping provides visual requirements context:
    - Jeff Patton's technique connects stories to user goals and activities
    - Flat backlogs lose context; story maps preserve the big picture
    - Story maps enable incremental delivery planning (walking skeleton)
    - INVEST criteria (Independent, Negotiable, Valuable, etc.) apply well with maps
    - Maps reveal gaps that flat backlog lists obscure
    - Release planning becomes visual and stakeholder-accessible

    Organizations using story mapping report better stakeholder alignment
    and fewer missed requirements compared to flat backlog approaches.
  when_to_run:
  - During sprint 0 or project inception
  - Before release planning sessions
  - When backlog organization issues arise
  - During Agile practice assessments
  - When requirements gaps are discovered late
prerequisites:
  required_artifacts:
  - type: story_maps
    description: User story map artifacts (physical or digital)
  - type: backlog
    description: Product backlog items
  - type: release_plans
    description: Release planning documentation
  access_requirements:
  - Access to story mapping tools (Miro, Mural, StoriesOnBoard)
  - Read access to product backlog
  - Access to release planning documentation
  - Access to user persona definitions
discovery:
  code_patterns:
  - pattern: (story.?map|user.?map|backbone|walking.?skeleton)
    type: regex
    scope: documentation
    purpose: Detect story mapping references
  - pattern: (epic|feature|user.?story|task)
    type: regex
    scope: documentation
    purpose: Detect story hierarchy elements
  - pattern: (release|slice|MVP|increment)
    type: regex
    scope: documentation
    purpose: Detect release planning elements
  file_patterns:
  - glob: '**/story-map*.{md,yaml,json,miro}'
    purpose: Story map documentation
  - glob: '**/user-map*.{md,yaml}'
    purpose: User mapping artifacts
  - glob: '**/backlog/**'
    purpose: Backlog documentation
  - glob: '**/epics/**'
    purpose: Epic documentation
  - glob: '**/features/**'
    purpose: Feature documentation
knowledge_sources:
  specifications:
  - id: patton-story-mapping
    name: User Story Mapping - Jeff Patton
    url: https://www.jpattonassociates.com/user-story-mapping/
    offline_cache: true
    priority: required
  - id: invest-criteria
    name: INVEST User Story Criteria
    url: https://www.agilealliance.org/glossary/invest/
    offline_cache: true
    priority: required
  guides:
  - id: agile-alliance-stories
    name: Agile Alliance - User Stories
    url: https://www.agilealliance.org/glossary/user-stories/
    offline_cache: true
  - id: scrumguides
    name: Scrum Guide - Product Backlog
    url: https://scrumguides.org/
    offline_cache: true
tooling:
  static_analysis:
  - tool: backlog-analyzer
    purpose: Analyze backlog structure and coverage
    offline_capable: true
  infrastructure_tools:
  - tool: miro
    purpose: Access story map boards
  - tool: storiesonboard
    purpose: Dedicated story mapping tool
  - tool: jira
    purpose: Analyze backlog structure
    command: jira search --jql 'project = PROJECT' --fields epic,labels
  scripts:
  - id: story-map-scanner
    language: bash
    purpose: Scan for story mapping artifacts
    source: inline
    code: |
      #!/bin/bash
      echo "=== User Story Mapping Scan ==="
      echo "Looking for story mapping documentation..."
      find . -type f \( -name "*story-map*" -o -name "*user-map*" \
        -o -name "*backbone*" \) 2>/dev/null | head -20
      echo ""
      echo "Searching for story mapping references..."
      grep -rniE "(story.?map|backbone|walking.?skeleton|user.?activity)" \
        --include="*.md" --include="*.yaml" . 2>/dev/null | head -30
signals:
  critical:
  - id: SMAP-CRIT-001
    signal: No user story mapping performed
    evidence_indicators:
    - No story map artifacts exist
    - Backlog is flat list without hierarchy
    - No visual representation of user journey
    explanation: |
      Without story mapping, the backlog lacks context. Individual stories
      become disconnected from user goals and activities. Jeff Patton notes
      that flat backlogs cause teams to lose sight of the whole while
      building parts. Requirements gaps go unnoticed until late in development.
    remediation: |
      - Conduct story mapping workshop with stakeholders
      - Create backbone from user activities
      - Decompose activities into tasks and stories
      - Slice horizontally for release planning
      - Link backlog items to story map positions
  - id: SMAP-CRIT-002
    signal: Story map disconnected from backlog
    evidence_indicators:
    - Story map exists but backlog items not linked
    - Map and backlog have different story sets
    - Map not updated as backlog evolves
    explanation: |
      A story map provides value only when it stays connected to the
      working backlog. Disconnection means the map becomes a historical
      artifact rather than a living planning tool. Teams lose the
      big picture benefits that story mapping provides.
    remediation: |
      - Establish bidirectional links between map and backlog
      - Update map when stories are added or refined
      - Use story map as primary backlog organization
      - Review map alignment in refinement sessions
      - Archive old map versions with backlog snapshots
  high:
  - id: SMAP-HIGH-001
    signal: Story map lacks user activity backbone
    evidence_indicators:
    - Map organized by system features, not user activities
    - No persona-based rows in map
    - Technical tasks without user context
    explanation: |
      The backbone (top row) should represent user activities in their
      natural sequence. Without this, the map becomes a feature list
      rather than a user journey visualization. The user-centric
      organization is what reveals gaps and enables stakeholder discussion.
    remediation: |
      - Reorganize map around user activities
      - Start with persona goals and activities
      - Arrange activities in logical user sequence
      - Decompose activities into tasks before stories
      - Validate backbone with user representatives
  - id: SMAP-HIGH-002
    signal: No release slicing in story map
    evidence_indicators:
    - Map shows all stories without release boundaries
    - Walking skeleton not identified
    - Releases planned without map reference
    explanation: |
      Horizontal slicing of the story map enables incremental delivery
      planning. The walking skeleton (minimum path through activities)
      should be visible. Without slicing, the map doesn't support
      release planning, which is a primary story mapping benefit.
    remediation: |
      - Identify walking skeleton (thinnest slice through all activities)
      - Draw release boundaries as horizontal lines
      - Prioritize within slices, not globally
      - Align release goals with slice contents
      - Review slices with stakeholders for viability
  - id: SMAP-HIGH-003
    signal: Stories not meeting INVEST criteria
    evidence_indicators:
    - Stories without clear user value
    - Technical implementation stories without user context
    - Stories too large to complete in sprint
    explanation: |
      INVEST criteria ensure story quality: Independent, Negotiable,
      Valuable, Estimable, Small, Testable. Stories failing these
      criteria indicate poor decomposition or technical focus
      rather than user focus in the story mapping process.
    remediation: |
      - Review stories against INVEST criteria
      - Split large stories into smaller, valuable increments
      - Rewrite technical stories with user value focus
      - Ensure each story has clear acceptance criteria
      - Use "As a... I want... So that..." format
  medium:
  - id: SMAP-MED-001
    signal: Story map not visualized or accessible
    evidence_indicators:
    - Map exists only in spreadsheets
    - Map not visible to team or stakeholders
    - No shared access to map
    explanation: |
      Story map value comes from visual accessibility. If the map
      isn't visible, it can't facilitate discussions or reveal gaps.
      Maps should be large-format and visible during planning sessions.
    remediation: |
      - Create visual map (physical wall or digital tool)
      - Ensure stakeholder access to digital maps
      - Display map in team area
      - Use map in planning and refinement sessions
      - Keep map updated and current
  - id: SMAP-MED-002
    signal: Story map granularity inconsistent
    evidence_indicators:
    - Some areas highly detailed, others sparse
    - Different decomposition levels across activities
    - Stories range from hours to weeks
    explanation: |
      Inconsistent granularity makes estimation and planning difficult.
      All stories should be at comparable size for sprint planning.
      Inconsistent decomposition often indicates uneven understanding
      of different areas.
    remediation: |
      - Establish target story size guidelines
      - Decompose large stories in refinement
      - Review granularity across map areas
      - Apply consistent decomposition patterns
      - Flag areas needing more elicitation
  - id: SMAP-MED-003
    signal: Story map not updated during project
    evidence_indicators:
    - Map created once and not maintained
    - New stories not added to map
    - Completed stories not marked
    explanation: |
      Story maps are living documents. Without updates, they become
      historical artifacts that don't reflect current understanding
      or progress. The map should evolve with the product.
    remediation: |
      - Include map updates in refinement sessions
      - Mark completed stories on map
      - Add new stories to appropriate map positions
      - Version map at release boundaries
      - Review map freshness periodically
  low:
  - id: SMAP-LOW-001
    signal: Story map history not preserved
    evidence_indicators:
    - No version history for map
    - Cannot see how map evolved
    - Original map structure lost
    explanation: |
      Map evolution tells a story of requirement discovery. Preserving
      history supports retrospectives and understanding of how
      scope evolved over time.
    remediation: |
      - Version control map artifacts
      - Snapshot map at key milestones
      - Document significant map changes
      - Preserve original map for comparison
  positive:
  - id: SMAP-POS-001
    signal: Comprehensive story map maintained
    evidence_indicators:
    - User activity backbone complete
    - Clear release slices visible
    - Map synchronized with backlog
  - id: SMAP-POS-002
    signal: Story map actively used in planning
    evidence_indicators:
    - Map referenced in sprint planning
    - Release planning uses map slices
    - Stakeholders engage with map
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Story Map Discovery
    description: |
      Locate story mapping artifacts and assess their presence
      and accessibility.
    duration_estimate: 30 min
    commands:
    - purpose: Find story mapping documentation
      command: |
        find . -type f \( -name "*story-map*" -o -name "*user-map*" \
          -o -name "*backbone*" -o -name "*journey*" \) 2>/dev/null | head -30
    - purpose: Search for story mapping references
      command: |
        grep -rniE "(story.?map|backbone|walking.?skeleton|user.?activity)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -40
    expected_findings:
    - Story map artifacts
    - Backbone documentation
    - Release slice definitions
  - id: '2'
    name: Story Map Structure Analysis
    description: |
      Assess the structure and completeness of story maps,
      including backbone, activities, and stories.
    duration_estimate: 45 min
    commands:
    - purpose: Find epic and feature definitions
      command: |
        find . -type f \( -name "*epic*" -o -name "*feature*" \) \
          2>/dev/null | head -20
    - purpose: Search for story hierarchy
      command: |
        grep -rniE "(epic:|feature:|activity:|theme:)" \
          --include="*.yaml" --include="*.json" . 2>/dev/null | head -30
    expected_findings:
    - Epic/feature hierarchy
    - User activities identified
    - Story decomposition documented
  - id: '3'
    name: Release Planning Alignment
    description: |
      Verify that story maps support release planning with
      clear slicing and prioritization.
    duration_estimate: 30 min
    commands:
    - purpose: Search for release planning references
      command: |
        grep -rniE "(release|slice|MVP|increment|milestone)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -30
    - purpose: Find priority assignments
      command: |
        grep -rniE "(priority|MoSCoW|must.?have|should.?have)" \
          --include="*.yaml" --include="*.md" . 2>/dev/null | head -30
    expected_findings:
    - Release definitions
    - Story prioritization
    - Slice boundaries
  - id: '4'
    name: Backlog Synchronization Check
    description: |
      Verify that story map is synchronized with the working
      backlog and remains current.
    duration_estimate: 30 min
    commands:
    - purpose: Check for backlog references
      command: |
        grep -rniE "(backlog|JIRA|ticket|issue)" \
          --include="*story*" --include="*.yaml" . 2>/dev/null | head -20
    - purpose: Find story status tracking
      command: |
        grep -rniE "(status:|state:|done|complete|in.?progress)" \
          --include="*.yaml" --include="*.json" . 2>/dev/null | head -20
    expected_findings:
    - Backlog integration
    - Story status tracking
    - Map currency indicators
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Story Map Assessment
    - Structure Analysis
    - Release Planning Alignment
    - Recommendations
  confidence_guidance:
    high: Story map artifacts directly reviewed
    medium: Story map references found but incomplete artifacts
    low: Story mapping status unclear, requires team interview
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: patton-story-mapping
      priority: required
    - source_id: invest-criteria
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Story mapping audit requires artifact review
    full:
      included: true
      priority: 3
    requirements:
      included: true
      priority: 2
    agile:
      included: true
      priority: 1
closeout_checklist:
- id: smap-001
  item: Story map exists and is current
  level: CRITICAL
  verification: |
    find . -type f -name "*story-map*" -mtime -90 2>/dev/null | \
      wc -l | xargs -I{} test {} -gt 0 && echo "PASS" || echo "FAIL"
  expected: PASS
- id: smap-002
  item: User activity backbone documented
  level: BLOCKING
  verification: manual
  verification_notes: Verify story map has user-centric backbone
  expected: Confirmed by reviewer
- id: smap-003
  item: Release slices defined
  level: BLOCKING
  verification: |
    grep -rniE "(release|slice|MVP)" --include="*.md" --include="*.yaml" . \
      2>/dev/null | wc -l | xargs -I{} test {} -gt 0 && echo "PASS" || echo "FAIL"
  expected: PASS
- id: smap-004
  item: Story map synchronized with backlog
  level: WARNING
  verification: manual
  verification_notes: Confirm bidirectional links between map and backlog
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - agile
    - startup
    - enterprise
  compliance_frameworks:
  - framework: Scrum Guide
    controls:
    - Product Backlog
  - framework: SAFe
    controls:
    - PI Planning
    - Story Maps
  - framework: BABOK
    controls:
    - '7.5'
relationships:
  commonly_combined:
  - requirements-specification.requirements-elicitation.elicitation-techniques
  - requirements-specification.requirements-elicitation.requirements-prioritization
  - requirements-specification.acceptance-criteria.acceptance-criteria-definition
  - requirements-specification.requirements-documentation.requirements-completeness
