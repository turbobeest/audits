audit:
  id: requirements-specification.specification-quality.behavior-specification
  name: Behavior Specification Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: requirements-specification
  category_number: 28
  subcategory: specification-quality
  tier: expert
  estimated_duration: 2-3 hours  # median: 2h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: documentation
  default_profiles:
  - full
  - requirements
description:
  what: |
    This audit examines how system behavior is specified using scenarios,
    state machines, or formal methods. It evaluates:
    - Behavior-Driven Development (BDD) usage
    - State machine specifications
    - Sequence diagram documentation
    - Event-response specifications
    - Temporal behavior constraints
  why_it_matters: |
    Behavior specifications clarify dynamic requirements:
    - Static requirements miss behavioral nuances
    - BDD links requirements to executable tests
    - State machines clarify valid states and transitions
    - Sequence diagrams show interaction patterns
    - Temporal requirements need explicit specification
prerequisites:
  required_artifacts:
  - type: behavior_specs
    description: Behavior specifications
  - type: bdd_features
    description: BDD feature files
  - type: diagrams
    description: State machines, sequence diagrams
  access_requirements:
  - Read access to behavior specifications
  - Access to BDD feature files
  - Access to diagrams
discovery:
  code_patterns:
  - pattern: (Given|When|Then|Scenario)
    type: regex
    scope: documentation
    purpose: Detect BDD specifications
  - pattern: (state|transition|event|trigger)
    type: regex
    scope: documentation
    purpose: Detect state machine elements
  file_patterns:
  - glob: '**/*.feature'
    purpose: Gherkin/BDD feature files
  - glob: '**/state*machine*.{md,yaml,puml}'
    purpose: State machine specifications
  - glob: '**/sequence*.{md,puml}'
    purpose: Sequence diagrams
  - glob: '**/behavior*.{md,yaml}'
    purpose: Behavior specifications
knowledge_sources:
  specifications:
  - id: bdd-cucumber
    name: Behavior-Driven Development
    url: https://cucumber.io/docs/bdd/
    offline_cache: true
    priority: required
signals:
  critical:
  - id: BEHSPEC-CRIT-001
    signal: Complex behavior not specified
    evidence_indicators:
    - State-dependent behavior undocumented
    - Event sequences unclear
    - Temporal constraints missing
    remediation: |
      - Identify complex behaviors
      - Create BDD scenarios
      - Document state machines
      - Specify temporal constraints
      - Add sequence diagrams
  high:
  - id: BEHSPEC-HIGH-001
    signal: BDD specifications not connected to tests
    evidence_indicators:
    - Feature files without step definitions
    - Scenarios not automated
    - BDD as documentation only
    remediation: |
      - Implement step definitions
      - Automate BDD scenarios
      - Run scenarios in CI/CD
      - Keep scenarios executable
procedure:
  steps:
  - id: '1'
    name: Behavior Specification Discovery
    commands:
    - purpose: Find BDD feature files
      command: |
        find . -type f -name "*.feature" 2>/dev/null | head -20
    - purpose: Find behavior specifications
      command: |
        find . -type f \( -name "*state*" -o -name "*behavior*" \
          -o -name "*sequence*" \) \( -name "*.md" -o -name "*.puml" \) 2>/dev/null | head -20
  - id: '2'
    name: Specification Coverage Check
    commands:
    - purpose: Count BDD scenarios
      command: |
        grep -rnoE "Scenario:" --include="*.feature" . 2>/dev/null | wc -l
output:
  deliverables:
  - type: behavior_assessment
    format: prose
closeout_checklist:
- id: behspec-001
  item: Complex behaviors specified
  level: CRITICAL
  verification: manual
  expected: Confirmed
governance:
  applicable_to:
    archetypes:
    - all
relationships:
  commonly_combined:
  - requirements-specification.acceptance-criteria.acceptance-criteria-definition
  - requirements-specification.requirements-documentation.functional-requirements
