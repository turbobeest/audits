audit:
  id: documentation-knowledge.decision-records.adr-traceability
  name: ADR Traceability Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: documentation-knowledge
  category_number: 27
  subcategory: decision-records
  tier: expert
  estimated_duration: 2-3 hours  # median: 2h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: low
  scope: documentation
  default_profiles:
  - full
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit evaluates how well ADRs are linked to their implementation
    in code, related documents, and superseding decisions. The audit examines
    traceability from requirements to decisions to code, and from decisions
    to their consequences.
  why_it_matters: |
    Traceability enables understanding of why code exists as it does and
    what decisions led to current implementation. Without traceability,
    ADRs become disconnected documents that don't inform development or
    help understand the codebase.
  when_to_run:
  - During ADR process maturity reviews
  - When improving decision documentation
  - When code archaeology is difficult
  - During compliance documentation preparation
prerequisites:
  required_artifacts:
  - type: adr_repository
    description: Access to ADR files
  - type: codebase
    description: Access to implementation
  access_requirements:
  - Read access to ADR files
  - Read access to source code
discovery:
  file_patterns:
  - glob: '**/adr/**/*.md'
    purpose: Find ADR files
  - glob: '**/ADR-*.md'
    purpose: Find numbered ADRs
knowledge_sources:
  guides:
  - id: adr-linking
    name: ADR Linking Practices
    relevance: How to connect ADRs to implementation
tooling:
  analysis_commands:
  - purpose: Find ADR references in code
    command: grep -rn 'ADR-\|adr/' --include='*.py' --include='*.java' --include='*.ts' src/
  - purpose: Find links in ADRs
    command: grep -h 'http\|#\|ADR-' adr/*.md 2>/dev/null
  - purpose: Find superseded ADRs
    command: grep -l 'Superseded\|supersedes' adr/*.md 2>/dev/null
signals:
  critical:
  - id: ADRTRACE-CRIT-001
    signal: ADRs completely disconnected from code
    evidence_indicators:
    - No ADR references in codebase
    - No implementation links in ADRs
    - Cannot trace decision to code
    explanation: |
      Disconnected ADRs provide historical record but don't help
      understand current code or guide future changes.
    remediation: Add bidirectional links between ADRs and code
  high:
  - id: ADRTRACE-HIGH-001
    signal: ADRs don't reference related ADRs
    evidence_indicators:
    - Related decisions not linked
    - Superseding not indicated
    - Decision chains unclear
    explanation: |
      Without inter-ADR links, understanding how decisions relate
      and evolved is difficult.
    remediation: Add related and superseded links to ADRs
  - id: ADRTRACE-HIGH-002
    signal: ADRs don't link to requirements
    evidence_indicators:
    - No requirement references
    - Decision drivers disconnected
    - Business context lost
    explanation: |
      Without requirement links, understanding why decisions were
      needed is lost.
    remediation: Link ADRs to driving requirements or tickets
  medium:
  - id: ADRTRACE-MED-001
    signal: Code doesn't reference ADRs
    explanation: |
      Code comments linking to ADRs help future maintainers understand
      why code is structured as it is.
    remediation: Add ADR references in relevant code comments
  - id: ADRTRACE-MED-002
    signal: Superseded ADRs not clearly marked
    remediation: Update superseded ADRs with clear status and links
  - id: ADRTRACE-MED-003
    signal: ADRs don't reference affected components
    remediation: List affected components in ADRs
  low:
  - id: ADRTRACE-LOW-001
    signal: No ADR index with categorization
    remediation: Create categorized ADR index
  - id: ADRTRACE-LOW-002
    signal: ADR search/discovery difficult
    remediation: Improve ADR discoverability
  positive:
  - id: ADRTRACE-POS-001
    signal: Bidirectional linking between ADRs and code
  - id: ADRTRACE-POS-002
    signal: ADR supersession chains clear
  - id: ADRTRACE-POS-003
    signal: ADRs linked to requirements
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Assess ADR Internal Links
    description: |
      Check how ADRs link to each other.
    duration_estimate: 30 min
    commands:
    - purpose: Find ADR cross-references
      command: grep -h 'ADR-[0-9]' adr/*.md 2>/dev/null | wc -l
    - purpose: Find superseded links
      command: grep -l 'supersedes\|superseded by' adr/*.md 2>/dev/null
    expected_findings:
    - Inter-ADR linking status
    - Supersession tracking
  - id: '2'
    name: Check Code References to ADRs
    description: |
      Search codebase for ADR references.
    duration_estimate: 30 min
    commands:
    - purpose: Find ADR references in code
      command: grep -rn 'ADR-\|adr/' --include='*.py' --include='*.java' --include='*.ts' src/ | wc -l
    - purpose: Sample references
      command: grep -rn 'ADR-' --include='*.py' --include='*.java' src/ | head -10
    expected_findings:
    - Code-to-ADR reference count
    - Reference patterns
  - id: '3'
    name: Review ADR External Links
    description: |
      Check links from ADRs to external artifacts.
    duration_estimate: 30 min
    link_types:
    - Requirement/ticket links
    - Documentation links
    - Code links
    - External resource links
    expected_findings:
    - External link coverage
    - Link quality
  - id: '4'
    name: Evaluate Supersession Tracking
    description: |
      Review how superseded decisions are tracked.
    duration_estimate: 25 min
    commands:
    - purpose: Find status in ADRs
      command: grep -h 'Status:' adr/*.md 2>/dev/null | sort | uniq -c
    expected_findings:
    - Supersession tracking quality
    - Stale/ambiguous statuses
  - id: '5'
    name: Assess Discoverability
    description: |
      Evaluate how easily ADRs can be found.
    duration_estimate: 25 min
    discoverability_checks:
    - ADR index exists
    - ADRs categorized
    - Search capability
    - Links from main docs
    expected_findings:
    - Discoverability status
    - Improvements needed
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Internal Linking Review
    - Code Traceability
    - External Linking
    - Recommendations
  confidence_guidance:
    high: Comprehensive traceability analysis
    medium: Sample-based traceability review
    low: High-level link assessment
closeout_checklist:
- id: adrtrace-001
  item: ADRs link to related ADRs
  level: CRITICAL
  verification: grep -l 'ADR-[0-9]\|Related' adr/*.md 2>/dev/null | wc -l
  expected: Inter-ADR links present
- id: adrtrace-002
  item: Code references ADRs
  level: BLOCKING
  verification: grep -rn 'ADR-' src/ 2>/dev/null | wc -l
  expected: Code references present
- id: adrtrace-003
  item: Superseded ADRs clearly marked
  level: WARNING
  verification: grep -l 'Superseded' adr/*.md 2>/dev/null | wc -l
  expected: Supersession tracked
- id: adrtrace-004
  item: ADR index exists
  level: WARNING
  verification: find . -name '*adr*index*' -o -name '*README*' -path '*/adr/*' | head -1
  expected: Index present
governance:
  applicable_to:
    archetypes:
    - all-projects
relationships:
  commonly_combined:
  - documentation-knowledge.decision-records.adr-completeness
  - code-documentation.comment-quality
  feeds_into:
  - code-archaeology.decision-understanding
  - compliance.decision-audit-trail
