audit:
  id: documentation-knowledge.decision-records.rationale-capture
  name: Rationale Capture Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: documentation-knowledge
  category_number: 27
  subcategory: decision-records
  tier: expert
  estimated_duration: 2-3 hours  # median: 2h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: documentation
  default_profiles:
  - full
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit evaluates how well the "why" behind decisions is captured
    and preserved. Beyond documenting what was decided, this audit examines
    whether the context, drivers, constraints, and reasoning are recorded
    in a way that enables future understanding.
  why_it_matters: |
    Understanding why decisions were made is often more valuable than knowing
    what was decided. Without captured rationale, future developers may
    undo good decisions, repeat past mistakes, or spend time investigating
    decisions that were thoroughly considered. Rationale preservation is
    essential for long-lived systems.
  when_to_run:
  - During decision documentation reviews
  - When decisions are being questioned
  - When system archaeology reveals unclear history
  - During knowledge transfer activities
prerequisites:
  required_artifacts:
  - type: decision_docs
    description: Access to decision documentation
  - type: git_history
    description: Access to commit history
  access_requirements:
  - Read access to documentation
  - Read access to git history
discovery:
  file_patterns:
  - glob: '**/adr/**/*.md'
    purpose: Find ADR files
  - glob: '**/docs/design/**/*.md'
    purpose: Find design documents
  - glob: '**/docs/decisions/**/*.md'
    purpose: Find decision documents
  commit_patterns:
  - pattern: because\|rationale\|reason
    purpose: Find commits with rationale
knowledge_sources:
  guides:
  - id: adr-context
    name: ADR Context Section Best Practices
    relevance: How to capture decision context
tooling:
  analysis_commands:
  - purpose: Find rationale sections
    command: grep -ri 'rationale\|reason\|because\|why\|context' adr/*.md | head -20
  - purpose: Check ADR context sections
    command: grep -A5 'Context' adr/*.md 2>/dev/null | head -30
  - purpose: Check commit messages for rationale
    command: git log --oneline --grep='because\|reason' | head -10
signals:
  critical:
  - id: RATIONALE-CRIT-001
    signal: Decision rationale never captured
    evidence_indicators:
    - ADRs state decisions without why
    - Design docs describe what, not why
    - Context completely missing
    explanation: |
      Without rationale, decisions become arbitrary from future
      perspective, leading to confusion and poor follow-on decisions.
    remediation: Establish practice of capturing why for all decisions
  high:
  - id: RATIONALE-HIGH-001
    signal: ADR context sections empty or superficial
    evidence_indicators:
    - Context sections one sentence
    - Business drivers not mentioned
    - Constraints not documented
    explanation: |
      Superficial context fails to explain why the decision was
      needed or what options were available.
    remediation: Expand context sections with meaningful rationale
  - id: RATIONALE-HIGH-002
    signal: Constraints and drivers not documented
    evidence_indicators:
    - Time constraints not mentioned
    - Budget constraints invisible
    - Technical constraints not listed
    explanation: |
      Without documented constraints, future reviewers don't
      understand what limited the decision space.
    remediation: Document constraints affecting decisions
  medium:
  - id: RATIONALE-MED-001
    signal: Business rationale not connected to technical decisions
    explanation: |
      Technical decisions often stem from business needs. Without
      this connection, decisions seem arbitrary.
    remediation: Link technical decisions to business drivers
  - id: RATIONALE-MED-002
    signal: Alternative rationale not captured
    remediation: Explain why alternatives were rejected
  - id: RATIONALE-MED-003
    signal: Commit messages lack rationale
    remediation: Encourage explanatory commit messages
  low:
  - id: RATIONALE-LOW-001
    signal: Code comments don't explain why
    remediation: Add explanatory comments for non-obvious code
  - id: RATIONALE-LOW-002
    signal: Historical context hard to find
    remediation: Link decisions to original discussions or tickets
  positive:
  - id: RATIONALE-POS-001
    signal: Rich context in all ADRs
  - id: RATIONALE-POS-002
    signal: Business drivers linked to technical decisions
  - id: RATIONALE-POS-003
    signal: Alternative rejection rationale documented
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Assess ADR Context Sections
    description: |
      Review context sections for rationale quality.
    duration_estimate: 35 min
    commands:
    - purpose: Extract context sections
      command: grep -A10 '## Context' adr/*.md 2>/dev/null | head -50
    evaluation_criteria:
    - Problem clearly stated
    - Business drivers mentioned
    - Technical constraints listed
    - Timeline/urgency noted
    expected_findings:
    - Context quality assessment
    - Common gaps
  - id: '2'
    name: Review Decision Rationale
    description: |
      Check how well decisions are explained.
    duration_estimate: 30 min
    commands:
    - purpose: Find rationale mentions
      command: grep -ri 'because\|reason\|chose\|selected' adr/*.md | head -20
    expected_findings:
    - Rationale presence
    - Explanation quality
  - id: '3'
    name: Check Alternative Documentation
    description: |
      Verify rejected alternatives are explained.
    duration_estimate: 25 min
    checks:
    - Alternatives listed
    - Rejection reasons given
    - Comparison criteria noted
    expected_findings:
    - Alternative documentation status
    - Missing explanations
  - id: '4'
    name: Review Commit History
    description: |
      Check commit messages for rationale capture.
    duration_estimate: 25 min
    commands:
    - purpose: Sample commit messages
      command: git log --format='%s' | head -50 | grep -c 'because\|reason\|fix\|add'
    expected_findings:
    - Commit message quality
    - Rationale in commits
  - id: '5'
    name: Interview for Lost Rationale
    description: |
      Identify important rationale known but not documented.
    duration_estimate: 25 min
    interview_questions:
    - Why was this technology chosen?
    - What drove this architecture decision?
    - Why wasn't X approach used?
    expected_findings:
    - Undocumented rationale
    - Documentation priorities
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Context Section Review
    - Rationale Quality Assessment
    - Alternative Documentation
    - Recommendations
  confidence_guidance:
    high: Comprehensive review with team interviews
    medium: Documentation review only
    low: Keyword search assessment
closeout_checklist:
- id: rationale-001
  item: ADRs have meaningful context sections
  level: CRITICAL
  verification: manual
  verification_notes: Review context sections for substance
  expected: Rich context documented
- id: rationale-002
  item: Decision rationale clearly stated
  level: BLOCKING
  verification: grep -ri 'because\|reason' adr/*.md 2>/dev/null | wc -l
  expected: Rationale present
- id: rationale-003
  item: Constraints documented
  level: WARNING
  verification: grep -ri 'constraint\|limitation\|requirement' adr/*.md | head -1
  expected: Constraints noted
- id: rationale-004
  item: Alternative rejection explained
  level: WARNING
  verification: grep -ri 'alternative\|option\|considered' adr/*.md | head -1
  expected: Alternatives discussed
governance:
  applicable_to:
    archetypes:
    - all-projects
relationships:
  commonly_combined:
  - documentation-knowledge.decision-records.adr-completeness
  - documentation-knowledge.decision-records.trade-off-documentation
  feeds_into:
  - knowledge-management.institutional-knowledge
  - onboarding.decision-understanding
