audit:
  id: documentation-knowledge.api-documentation.authentication-docs
  name: Authentication Documentation Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: documentation-knowledge
  category_number: 27
  subcategory: api-documentation
  tier: expert
  estimated_duration: 2-3 hours  # median: 2h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: documentation
  default_profiles:
  - full
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit evaluates documentation of API authentication mechanisms,
    including credential management, OAuth flows, API key usage, token
    handling, and security best practices. The audit ensures consumers
    can securely authenticate without confusion or insecure practices.
  why_it_matters: |
    Authentication is the first barrier to API usage. Poor authentication
    documentation leads to failed integration attempts, insecure credential
    handling, and support burden. Clear authentication docs enable secure,
    self-service API access and prevent security incidents from improper
    credential management.
  when_to_run:
  - When onboarding new API consumers
  - After authentication mechanism changes
  - During security documentation reviews
  - When support tickets indicate auth confusion
prerequisites:
  required_artifacts:
  - type: api_documentation
    description: Access to API authentication documentation
  - type: auth_implementation
    description: Understanding of authentication mechanisms
  access_requirements:
  - Read access to API documentation
  - Read access to OpenAPI security definitions
discovery:
  file_patterns:
  - glob: '**/docs/auth*.md'
    purpose: Find authentication documentation
  - glob: '**/docs/security*.md'
    purpose: Find security documentation
  - glob: '**/authentication/**/*.md'
    purpose: Find auth docs directory
  - glob: '**/getting-started*.md'
    purpose: Find initial setup docs
  documentation_sections:
  - Authentication overview
  - API key management
  - OAuth flow documentation
  - Token handling
  - Security best practices
knowledge_sources:
  guides:
  - id: oauth2-spec
    name: OAuth 2.0 Specification
    url: https://oauth.net/2/
    offline_cache: true
  - id: api-key-security
    name: API Key Security Best Practices
    url: https://owasp.org/www-project-api-security/
    offline_cache: true
tooling:
  analysis_commands:
  - purpose: Find auth documentation
    command: find . -name '*.md' | xargs grep -l -i 'authentication\|authorization\|api.key\|oauth' |
      head -10
  - purpose: Check OpenAPI security schemes
    command: yq '.components.securitySchemes' openapi.yaml
  - purpose: Find credential examples
    command: grep -rn 'Bearer\|Authorization\|api-key\|x-api-key' --include='*.md' docs/
signals:
  critical:
  - id: AUTH-CRIT-001
    signal: No authentication documentation
    evidence_indicators:
    - No auth docs found
    - Consumers cannot determine how to authenticate
    - Support tickets about authentication
    explanation: |
      Without authentication documentation, consumers cannot use
      protected API endpoints at all.
    remediation: Create comprehensive authentication documentation
  - id: AUTH-CRIT-002
    signal: Documentation shows insecure practices
    evidence_indicators:
    - Examples with hardcoded credentials
    - Credentials in query parameters
    - No mention of credential security
    explanation: |
      Documentation demonstrating insecure practices leads consumers
      to implement authentication incorrectly, creating security risks.
    remediation: Update examples to show secure credential handling
  high:
  - id: AUTH-HIGH-001
    signal: Credential acquisition process undocumented
    evidence_indicators:
    - No instructions for getting API keys
    - OAuth app registration not explained
    - Consumers unclear how to start
    explanation: |
      If consumers cannot figure out how to get credentials, they
      cannot use the API.
    remediation: Document complete credential acquisition workflow
  - id: AUTH-HIGH-002
    signal: OAuth flow documentation incomplete
    evidence_indicators:
    - Authorization URL not provided
    - Scope definitions missing
    - Token refresh not explained
    explanation: |
      OAuth implementations are complex. Incomplete documentation
      leads to incorrect implementations.
    remediation: Document complete OAuth flow with all parameters
  - id: AUTH-HIGH-003
    signal: Token/key rotation not documented
    evidence_indicators:
    - No rotation guidance
    - Consumers don't know when to rotate
    - No revocation instructions
    explanation: |
      Credential rotation is essential for security. Without guidance,
      consumers may never rotate credentials.
    remediation: Document credential lifecycle including rotation
  medium:
  - id: AUTH-MED-001
    signal: Multiple auth methods without guidance
    explanation: |
      When multiple auth methods exist, consumers need guidance on
      which to use for different scenarios.
    remediation: Add decision guide for authentication method selection
  - id: AUTH-MED-002
    signal: Error messages for auth failures not documented
    remediation: Document authentication error codes and responses
  - id: AUTH-MED-003
    signal: Rate limits for auth endpoints not documented
    remediation: Document rate limits and lockout policies
  low:
  - id: AUTH-LOW-001
    signal: No troubleshooting section for auth issues
    remediation: Add common authentication problems and solutions
  - id: AUTH-LOW-002
    signal: SDK authentication not documented
    remediation: Add SDK-specific authentication examples
  positive:
  - id: AUTH-POS-001
    signal: Complete authentication documentation with examples
  - id: AUTH-POS-002
    signal: Security best practices clearly documented
  - id: AUTH-POS-003
    signal: Authentication troubleshooting guide available
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Inventory Authentication Methods
    description: |
      Identify all authentication methods supported by the API.
    duration_estimate: 20 min
    commands:
    - purpose: Check OpenAPI security schemes
      command: yq '.components.securitySchemes | keys' openapi.yaml
    - purpose: Find auth headers in code
      command: grep -rn 'Authorization\|x-api-key' --include='*.py' --include='*.java' src/
    expected_findings:
    - List of authentication methods
    - Security scheme types
  - id: '2'
    name: Locate Authentication Documentation
    description: |
      Find all authentication-related documentation.
    duration_estimate: 20 min
    commands:
    - purpose: Find auth docs
      command: find . -name '*.md' -exec grep -l -i 'authentication\|api.key\|oauth' {} \;
    expected_findings:
    - Documentation inventory
    - Coverage assessment
  - id: '3'
    name: Evaluate Documentation Completeness
    description: |
      Review authentication documentation for completeness.
    duration_estimate: 45 min
    quality_checklist:
    - Authentication overview
    - Credential acquisition steps
    - Request authentication syntax
    - Working examples
    - Error handling
    - Token/key lifecycle
    - Security best practices
    - Troubleshooting
    expected_findings:
    - Completeness assessment
    - Missing sections
  - id: '4'
    name: Review Security Practices
    description: |
      Verify documentation promotes secure practices.
    duration_estimate: 30 min
    security_checklist:
    - No hardcoded credentials in examples
    - HTTPS usage emphasized
    - Credential storage guidance
    - Scope minimization recommended
    - Rotation guidance provided
    expected_findings:
    - Security guidance assessment
    - Insecure patterns identified
  - id: '5'
    name: Test Example Authentication
    description: |
      Verify authentication examples work correctly.
    duration_estimate: 25 min
    expected_findings:
    - Example validation results
    - Broken examples identified
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Authentication Methods Overview
    - Documentation Completeness
    - Security Practices Review
    - Recommendations
  confidence_guidance:
    high: All auth methods documented and examples tested
    medium: Primary auth methods documented
    low: Basic documentation review only
closeout_checklist:
- id: auth-001
  item: All authentication methods documented
  level: CRITICAL
  verification: manual
  verification_notes: Compare implementation with documentation
  expected: 100% coverage
- id: auth-002
  item: Credential acquisition documented
  level: CRITICAL
  verification: grep -r 'create\|register\|obtain' docs/auth*.md
  expected: Clear acquisition instructions
- id: auth-003
  item: Security best practices documented
  level: BLOCKING
  verification: grep -r 'security\|best.practice\|recommended' docs/auth*.md
  expected: Security guidance present
- id: auth-004
  item: Working authentication examples
  level: WARNING
  verification: manual
  verification_notes: Test examples against API
  expected: All examples work
governance:
  applicable_to:
    archetypes:
    - api-service
    - public-api
    - authenticated-service
relationships:
  commonly_combined:
  - documentation-knowledge.api-documentation.api-reference-completeness
  - security.authentication-review
  feeds_into:
  - developer-experience.time-to-first-call
  - security.api-security-posture
