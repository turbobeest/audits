audit:
  id: documentation-knowledge.api-documentation.api-versioning-docs
  name: API Versioning Documentation Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: documentation-knowledge
  category_number: 27
  subcategory: api-documentation
  tier: expert
  estimated_duration: 2-3 hours  # median: 2h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: documentation
  default_profiles:
  - full
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit evaluates documentation of API versioning strategy, including
    version lifecycle policies, migration guides, deprecation notices,
    breaking change documentation, and version-specific documentation
    management. The audit ensures consumers understand how to work with
    API versions.
  why_it_matters: |
    API versioning affects all consumers and requires clear communication.
    Poor versioning documentation leads to unexpected breaking changes,
    failed migrations, and support burden. Clear versioning documentation
    enables consumers to plan migrations, understand compatibility, and
    use appropriate API versions.
  when_to_run:
  - When releasing new API versions
  - When deprecating API versions
  - During API governance reviews
  - When consumers report version confusion
prerequisites:
  required_artifacts:
  - type: api_documentation
    description: Access to API documentation
  - type: version_history
    description: API version release history
  access_requirements:
  - Read access to API documentation
  - Access to API versioning policies
discovery:
  file_patterns:
  - glob: '**/api/v*/**'
    purpose: Find versioned API paths
  - glob: '**/docs/versioning*.md'
    purpose: Find versioning documentation
  - glob: '**/CHANGELOG*.md'
    purpose: Find changelogs
  - glob: '**/migration*.md'
    purpose: Find migration guides
  - glob: '**/docs/deprecation*.md'
    purpose: Find deprecation notices
  documentation_sections:
  - Versioning policy
  - Version lifecycle
  - Migration guides
  - Breaking changes
  - Deprecation schedule
knowledge_sources:
  guides:
  - id: semver
    name: Semantic Versioning
    url: https://semver.org/
    offline_cache: true
  - id: api-versioning-stripe
    name: Stripe API Versioning
    url: https://stripe.com/docs/api/versioning
    offline_cache: true
  - id: google-api-versioning
    name: Google API Design - Versioning
    url: https://cloud.google.com/apis/design/versioning
    offline_cache: true
tooling:
  analysis_commands:
  - purpose: Find API version patterns
    command: grep -rn '/v[0-9]\+/' --include='*.yaml' --include='*.md'
  - purpose: Find deprecation notices
    command: grep -ri 'deprecated\|sunset\|end-of-life' --include='*.md' docs/
  - purpose: Check for migration documentation
    command: find . -name '*migration*' -type f | head -10
signals:
  critical:
  - id: VERSION-CRIT-001
    signal: No versioning strategy documented
    evidence_indicators:
    - No versioning policy documentation
    - Consumers unaware of version strategy
    - Breaking changes without version bumps
    explanation: |
      Without a documented versioning strategy, consumers cannot plan
      for changes or understand compatibility expectations.
    remediation: Document and publish API versioning strategy
  - id: VERSION-CRIT-002
    signal: Breaking changes undocumented
    evidence_indicators:
    - No breaking change documentation
    - Consumers report unexpected breaking changes
    - No migration path provided
    explanation: |
      Undocumented breaking changes cause integration failures and
      erode consumer trust in the API.
    remediation: Document all breaking changes with migration guidance
  high:
  - id: VERSION-HIGH-001
    signal: No migration guides for version upgrades
    evidence_indicators:
    - Missing migration documentation
    - Consumers stuck on old versions
    - Support tickets about migration
    explanation: |
      Without migration guides, consumers face significant effort to
      upgrade versions, leading to version fragmentation.
    remediation: Create migration guides for all version upgrades
  - id: VERSION-HIGH-002
    signal: Deprecation timeline not communicated
    evidence_indicators:
    - No sunset dates published
    - Deprecation notices missing timeline
    - Consumers surprised by version removal
    explanation: |
      Consumers need adequate time to migrate from deprecated versions.
      Unclear timelines lead to forced emergency migrations.
    remediation: Publish deprecation schedules with ample notice
  - id: VERSION-HIGH-003
    signal: Documentation not version-specific
    evidence_indicators:
    - Single documentation for multiple versions
    - Version differences not highlighted
    - Consumers use wrong version docs
    explanation: |
      When documentation doesn't match the API version in use,
      consumers make errors based on incorrect information.
    remediation: Maintain version-specific documentation
  medium:
  - id: VERSION-MED-001
    signal: Changelog not maintained
    explanation: |
      Changelogs help consumers understand what changed between versions
      and assess upgrade impact.
    remediation: Maintain comprehensive changelog for all versions
  - id: VERSION-MED-002
    signal: Version lifecycle stages undefined
    remediation: Define and document version lifecycle (beta, stable, deprecated)
  - id: VERSION-MED-003
    signal: Compatibility matrix not provided
    remediation: Document version compatibility with SDKs and tools
  low:
  - id: VERSION-LOW-001
    signal: Version selection guidance missing
    remediation: Provide guidance on which version to use
  - id: VERSION-LOW-002
    signal: Historical version documentation not preserved
    remediation: Maintain archived documentation for supported versions
  positive:
  - id: VERSION-POS-001
    signal: Clear versioning policy documented
  - id: VERSION-POS-002
    signal: Migration guides available for all versions
  - id: VERSION-POS-003
    signal: Deprecation notices with adequate timeline
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Identify API Versions
    description: |
      Inventory all API versions and their current lifecycle status.
    duration_estimate: 20 min
    commands:
    - purpose: Find version patterns in paths
      command: grep -rh '/v[0-9]' --include='*.yaml' | sort -u
    - purpose: Check API specification versions
      command: yq '.info.version' openapi*.yaml
    expected_findings:
    - List of API versions
    - Current/deprecated status
  - id: '2'
    name: Review Versioning Policy
    description: |
      Evaluate the documented versioning strategy and policy.
    duration_estimate: 30 min
    quality_checklist:
    - Versioning scheme explained (URL, header, etc.)
    - Version numbering convention
    - Breaking change policy
    - Deprecation policy
    - Support timeline per version
    expected_findings:
    - Policy completeness assessment
    - Missing policy elements
  - id: '3'
    name: Assess Migration Documentation
    description: |
      Review migration guides for version transitions.
    duration_estimate: 30 min
    quality_checklist:
    - Step-by-step migration instructions
    - Breaking changes listed
    - Code examples for changes
    - Rollback guidance
    - Testing recommendations
    expected_findings:
    - Migration guide coverage
    - Quality assessment
  - id: '4'
    name: Review Deprecation Communication
    description: |
      Evaluate how deprecations are communicated to consumers.
    duration_estimate: 30 min
    checks:
    - Deprecation notices in documentation
    - Sunset headers in API responses
    - Email/announcement communication
    - Timeline clarity
    expected_findings:
    - Deprecation communication status
    - Consumer awareness assessment
  - id: '5'
    name: Verify Version-Specific Docs
    description: |
      Check that documentation is appropriately versioned.
    duration_estimate: 30 min
    expected_findings:
    - Documentation versioning status
    - Version-doc alignment
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Versioning Policy Review
    - Migration Documentation
    - Deprecation Communication
    - Recommendations
  confidence_guidance:
    high: Comprehensive policy and documentation review
    medium: Policy review with spot-check of migrations
    low: Basic documentation existence check
closeout_checklist:
- id: version-001
  item: Versioning strategy documented
  level: CRITICAL
  verification: manual
  verification_notes: Check for versioning policy documentation
  expected: Clear policy accessible to consumers
- id: version-002
  item: Migration guides for active versions
  level: BLOCKING
  verification: find . -name '*migration*' -type f | wc -l
  expected: Migration guide per version transition
- id: version-003
  item: Deprecation timeline published
  level: WARNING
  verification: grep -r 'sunset\|deprecat' docs/
  expected: Clear deprecation schedule
- id: version-004
  item: Changelog maintained
  level: WARNING
  verification: test -f CHANGELOG.md && echo 'exists'
  expected: Changelog file present and current
governance:
  applicable_to:
    archetypes:
    - api-service
    - public-api
relationships:
  commonly_combined:
  - documentation-knowledge.api-documentation.api-reference-completeness
  - api-management.lifecycle-management
  feeds_into:
  - api-governance.breaking-change-policy
  - consumer-experience.migration-friction
