# ============================================================
# AUDIT: System Architecture Documentation
# Category: 27 - Documentation & Knowledge
# Subcategory: architecture-docs
# ============================================================

audit:
  id: "documentation-knowledge.architecture-docs.system-architecture-docs"
  name: "System Architecture Documentation Audit"
  version: "1.0.0"
  last_updated: "2025-01-22"
  status: "active"

  category: "documentation-knowledge"
  category_number: 27
  subcategory: "architecture-docs"

  tier: "expert"
  estimated_duration: "4-6 hours"  # median: 5h

  completeness: "complete"
  requires_runtime: false
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "documentation"

  default_profiles:
    - "full"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    This audit evaluates system architecture documentation including high-level
    architecture overviews, system context, container diagrams, technology
    choices, and architectural principles. The audit assesses whether
    architecture documentation provides sufficient understanding of system
    design for various stakeholders.

  why_it_matters: |
    Architecture documentation enables informed decision-making, efficient
    onboarding, and consistent evolution of systems. Without it, teams make
    decisions without understanding impacts, new members take longer to
    become productive, and systems drift toward inconsistency and accidental
    complexity.

  when_to_run:
    - "During architecture reviews"
    - "When onboarding architects or senior developers"
    - "Before major system changes"
    - "Annually as part of architecture governance"

prerequisites:
  required_artifacts:
    - type: "architecture_docs"
      description: "Access to architecture documentation"
    - type: "system_overview"
      description: "Understanding of system scope"

  access_requirements:
    - "Read access to architecture documentation"
    - "Access to architects for clarification"

discovery:
  file_patterns:
    - glob: "**/docs/architecture/**/*.md"
      purpose: "Find architecture documentation"
    - glob: "**/ARCHITECTURE.md"
      purpose: "Find architecture readme"
    - glob: "**/docs/design/**/*.md"
      purpose: "Find design documentation"
    - glob: "**/diagrams/**/*.puml"
      purpose: "Find PlantUML diagrams"
    - glob: "**/diagrams/**/*.drawio"
      purpose: "Find draw.io diagrams"
    - glob: "**/*.c4"
      purpose: "Find C4 model files"

knowledge_sources:
  guides:
    - id: "c4-model"
      name: "The C4 Model for Software Architecture"
      url: "https://c4model.com/"
      offline_cache: true

    - id: "arc42"
      name: "arc42 Architecture Documentation"
      url: "https://arc42.org/"
      offline_cache: true

    - id: "documenting-software"
      name: "Documenting Software Architectures (SEI)"
      url: "https://resources.sei.cmu.edu/library/asset-view.cfm?assetid=30386"
      offline_cache: true

tooling:
  analysis_commands:
    - purpose: "Find architecture documentation"
      command: "find . -name '*architecture*' -o -name '*design*' | grep -E '\\.(md|txt)$' | head -15"

    - purpose: "Find diagrams"
      command: "find . -name '*.puml' -o -name '*.drawio' -o -name '*.svg' -path '*/diagrams/*' | head -10"

    - purpose: "Check for C4 model usage"
      command: "grep -r 'Context\\|Container\\|Component\\|Code' --include='*.md' docs/architecture/ 2>/dev/null"

signals:
  critical:
    - id: "SYSARCH-CRIT-001"
      signal: "No system architecture documentation exists"
      evidence_indicators:
        - "No architecture docs found"
        - "New team members cannot understand system"
        - "Architecture decisions undocumented"
      explanation: |
        Without architecture documentation, understanding the system
        requires extensive code reading or expert consultation.
        This creates bottlenecks and risks inconsistent decisions.
      remediation: "Create system architecture documentation immediately"

    - id: "SYSARCH-CRIT-002"
      signal: "Architecture documentation severely outdated"
      evidence_indicators:
        - "Documentation doesn't reflect current state"
        - "Major components missing"
        - "Technology stack incorrect"
      explanation: |
        Outdated architecture docs are misleading and can lead to
        incorrect assumptions and decisions.
      remediation: "Update architecture documentation to reflect current state"

  high:
    - id: "SYSARCH-HIGH-001"
      signal: "No high-level system overview"
      evidence_indicators:
        - "No context diagram"
        - "System boundaries unclear"
        - "External integrations not shown"
      explanation: |
        Without a high-level overview, stakeholders cannot quickly
        understand what the system is and how it fits in the landscape.
      remediation: "Create system context diagram and overview"

    - id: "SYSARCH-HIGH-002"
      signal: "Technology choices undocumented"
      evidence_indicators:
        - "No technology stack documentation"
        - "Framework choices unclear"
        - "Infrastructure not documented"
      explanation: |
        Understanding technology choices is essential for maintenance,
        capacity planning, and future evolution.
      remediation: "Document technology stack with rationale"

    - id: "SYSARCH-HIGH-003"
      signal: "Major components not documented"
      evidence_indicators:
        - "Services/modules not described"
        - "Component responsibilities unclear"
        - "No container-level view"
      explanation: |
        Without component documentation, understanding system structure
        requires reading code.
      remediation: "Document all major system components"

  medium:
    - id: "SYSARCH-MED-001"
      signal: "Diagrams missing or unclear"
      explanation: |
        Diagrams communicate architecture more effectively than text
        alone. Missing diagrams reduce comprehension.
      remediation: "Add clear diagrams at multiple abstraction levels"

    - id: "SYSARCH-MED-002"
      signal: "Architecture principles not documented"
      remediation: "Document guiding architecture principles"

    - id: "SYSARCH-MED-003"
      signal: "Non-functional requirements not addressed"
      remediation: "Document how architecture addresses NFRs"

  low:
    - id: "SYSARCH-LOW-001"
      signal: "Architecture docs not version controlled"
      remediation: "Keep architecture docs in repository"

    - id: "SYSARCH-LOW-002"
      signal: "No architecture documentation standard"
      remediation: "Adopt standard like C4 or arc42"

  positive:
    - id: "SYSARCH-POS-001"
      signal: "Comprehensive architecture documentation"
    - id: "SYSARCH-POS-002"
      signal: "C4 or arc42 model consistently used"
    - id: "SYSARCH-POS-003"
      signal: "Architecture diagrams as code maintained"

procedure:
  context:
    cognitive_mode: "analytical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Locate Architecture Documentation"
      description: |
        Find all architecture-related documentation.
      duration_estimate: "30 min"
      commands:
        - purpose: "Find architecture docs"
          command: "find . -name '*architecture*' -o -name '*design*' | grep -E '\\.(md|txt|puml)$'"
        - purpose: "Find diagrams"
          command: "find . -type f \\( -name '*.png' -o -name '*.svg' -o -name '*.drawio' \\) -path '*/diagrams/*'"
      expected_findings:
        - "Documentation inventory"
        - "Diagram inventory"

    - id: "2"
      name: "Evaluate C4 Model Coverage"
      description: |
        Assess documentation against C4 model levels.
      duration_estimate: "45 min"
      c4_levels:
        - level: "Context"
          checks: ["System context documented", "External actors identified", "External systems shown"]
        - level: "Container"
          checks: ["Containers identified", "Technologies specified", "Responsibilities clear"]
        - level: "Component"
          checks: ["Major components documented", "Component interactions shown"]
        - level: "Code"
          checks: ["Key classes/modules documented if needed"]
      expected_findings:
        - "C4 coverage assessment"
        - "Missing levels"

    - id: "3"
      name: "Review Content Quality"
      description: |
        Evaluate the quality and completeness of documentation content.
      duration_estimate: "60 min"
      quality_checklist:
        - "Clear and understandable"
        - "Appropriate detail level"
        - "Diagrams complement text"
        - "Assumptions documented"
        - "Constraints documented"
        - "Technology choices explained"
        - "Cross-cutting concerns addressed"
      expected_findings:
        - "Quality assessment"
        - "Content gaps"

    - id: "4"
      name: "Verify Currency"
      description: |
        Check that documentation reflects current system state.
      duration_estimate: "45 min"
      commands:
        - purpose: "Check documentation dates"
          command: "find docs/architecture -name '*.md' -exec ls -la {} \\; 2>/dev/null"
      verification_methods:
        - "Compare documented components with deployed services"
        - "Verify technology versions"
        - "Check external integration list"
      expected_findings:
        - "Currency assessment"
        - "Outdated sections"

    - id: "5"
      name: "Assess Stakeholder Coverage"
      description: |
        Evaluate whether documentation serves different audiences.
      duration_estimate: "30 min"
      audiences:
        - "New team members"
        - "Architects"
        - "Operations"
        - "Business stakeholders"
      expected_findings:
        - "Audience coverage"
        - "Accessibility for different roles"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "C4 Model Coverage"
        - "Content Quality"
        - "Currency Assessment"
        - "Recommendations"

  confidence_guidance:
    high: "Documentation validated against deployed system"
    medium: "Documentation reviewed with architect interview"
    low: "Documentation existence review"

closeout_checklist:
  - id: "sysarch-001"
    item: "System architecture documentation exists"
    level: "CRITICAL"
    verification: "find . -name '*architecture*' | grep -E '\\.md$' | head -1"
    expected: "Documentation present"

  - id: "sysarch-002"
    item: "System context documented"
    level: "CRITICAL"
    verification: "grep -i 'context\\|overview\\|landscape' docs/architecture/*.md 2>/dev/null"
    expected: "Context documented"

  - id: "sysarch-003"
    item: "Architecture diagrams included"
    level: "BLOCKING"
    verification: "find . -name '*.png' -o -name '*.svg' -path '*/architecture/*' | head -1"
    expected: "Diagrams present"

  - id: "sysarch-004"
    item: "Documentation reflects current state"
    level: "WARNING"
    verification: "manual"
    verification_notes: "Compare with deployed system"
    expected: "No major discrepancies"

governance:
  applicable_to:
    archetypes: ["all-systems"]

  compliance_mappings:
    - framework: "ISO 27001"
      control: "A.14.2.5"
      description: "Secure system engineering principles documented"

relationships:
  commonly_combined:
    - "documentation-knowledge.architecture-docs.component-diagrams"
    - "documentation-knowledge.architecture-docs.integration-documentation"

  feeds_into:
    - "architecture-governance.compliance"
    - "onboarding.architect-ramp-up"
