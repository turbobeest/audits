audit:
  id: documentation-knowledge.architecture-docs.component-diagrams
  name: Component Diagrams Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: documentation-knowledge
  category_number: 27
  subcategory: architecture-docs
  tier: expert
  estimated_duration: 2-4 hours  # median: 3h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: documentation
  default_profiles:
  - full
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit evaluates component and container diagrams that visualize
    system structure. The audit examines diagram completeness, clarity,
    consistency with the C4 model or other standards, and accuracy
    relative to the actual system implementation.
  why_it_matters: |
    Diagrams communicate system structure more effectively than text alone.
    Good diagrams accelerate understanding, facilitate discussions, and
    serve as reference points for decision-making. Poor or missing diagrams
    force reliance on code exploration and tribal knowledge.
  when_to_run:
  - During architecture documentation reviews
  - After significant system changes
  - When onboarding new team members
  - Before architecture decision meetings
prerequisites:
  required_artifacts:
  - type: architecture_diagrams
    description: Access to system diagrams
  - type: system_knowledge
    description: Understanding of actual system structure
  access_requirements:
  - Read access to diagram files
  - Read access to architecture documentation
discovery:
  file_patterns:
  - glob: '**/diagrams/**/*.puml'
    purpose: Find PlantUML diagrams
  - glob: '**/diagrams/**/*.drawio'
    purpose: Find draw.io diagrams
  - glob: '**/docs/**/*.png'
    purpose: Find diagram images
  - glob: '**/docs/**/*.svg'
    purpose: Find SVG diagrams
  - glob: '**/*.mmd'
    purpose: Find Mermaid diagrams
  - glob: '**/c4/**/*'
    purpose: Find C4 model files
knowledge_sources:
  guides:
  - id: c4-model
    name: C4 Model Diagrams
    url: https://c4model.com/
    offline_cache: true
  - id: plantuml
    name: PlantUML Documentation
    url: https://plantuml.com/
    offline_cache: true
  - id: mermaid
    name: Mermaid Diagram Syntax
    url: https://mermaid.js.org/
    offline_cache: true
tooling:
  analysis_commands:
  - purpose: Find diagram files
    command: find . -name '*.puml' -o -name '*.drawio' -o -name '*.mmd' | head -20
  - purpose: Find diagram images
    command: find . \( -name '*.png' -o -name '*.svg' \) -path '*/diagram*' | head -20
  - purpose: Check for diagram source files
    command: find . -type f \( -name '*.puml' -o -name '*.drawio' \) | wc -l
signals:
  critical:
  - id: DIAGRAMS-CRIT-001
    signal: No architecture diagrams exist
    evidence_indicators:
    - No diagram files found
    - No visual representations
    - Architecture described only in text
    explanation: |
      Without diagrams, understanding system structure requires
      reading extensive text or exploring code.
    remediation: Create system diagrams at multiple abstraction levels
  high:
  - id: DIAGRAMS-HIGH-001
    signal: Diagrams significantly outdated
    evidence_indicators:
    - Components missing from diagrams
    - Deprecated components still shown
    - New services not included
    explanation: |
      Outdated diagrams are misleading and may cause incorrect
      assumptions about system structure.
    remediation: Update diagrams to reflect current system state
  - id: DIAGRAMS-HIGH-002
    signal: Diagrams lack context and legend
    evidence_indicators:
    - Shapes undefined
    - Lines and arrows unexplained
    - Diagram purpose unclear
    explanation: |
      Diagrams without context require interpretation, leading to
      misunderstanding and inconsistent interpretation.
    remediation: Add title, legend, and context to all diagrams
  - id: DIAGRAMS-HIGH-003
    signal: Key abstraction levels missing
    evidence_indicators:
    - No context diagram
    - No container diagram
    - Only code-level diagrams exist
    explanation: |
      Different abstraction levels serve different audiences and
      purposes. Missing levels leave gaps in understanding.
    remediation: Create diagrams at C4 context, container, and component levels
  medium:
  - id: DIAGRAMS-MED-001
    signal: Diagram source files not maintained
    evidence_indicators:
    - Only image files, no source
    - Diagrams not reproducible
    - Cannot update diagrams easily
    explanation: |
      Without source files, updating diagrams requires recreation
      from scratch, making them likely to become stale.
    remediation: Maintain diagram sources (PlantUML, Mermaid, etc.)
  - id: DIAGRAMS-MED-002
    signal: Inconsistent diagram style
    explanation: |
      Inconsistent styling makes diagrams harder to read and
      suggests lack of standards.
    remediation: Adopt consistent diagram style guide
  - id: DIAGRAMS-MED-003
    signal: Diagrams not version controlled
    remediation: Keep diagram sources in version control
  low:
  - id: DIAGRAMS-LOW-001
    signal: No automated diagram generation
    remediation: Consider generating diagrams from code or config
  - id: DIAGRAMS-LOW-002
    signal: Diagrams scattered across locations
    remediation: Consolidate diagrams in standard location
  positive:
  - id: DIAGRAMS-POS-001
    signal: Comprehensive C4 model diagrams maintained
  - id: DIAGRAMS-POS-002
    signal: Diagrams as code with automated rendering
  - id: DIAGRAMS-POS-003
    signal: Consistent diagram style throughout
procedure:
  context:
    cognitive_mode: visual
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Inventory Diagrams
    description: |
      Find all architecture diagrams in the repository.
    duration_estimate: 20 min
    commands:
    - purpose: Find diagram sources
      command: find . -name '*.puml' -o -name '*.drawio' -o -name '*.mmd'
    - purpose: Find diagram images
      command: find . \( -name '*.png' -o -name '*.svg' \) -path '*/docs/*'
    expected_findings:
    - Diagram inventory
    - Source availability
  - id: '2'
    name: Assess Abstraction Level Coverage
    description: |
      Evaluate C4 model level coverage.
    duration_estimate: 30 min
    c4_levels:
    - 'Context: System in environment'
    - 'Container: High-level technology containers'
    - 'Component: Components within containers'
    - 'Code: Class/module level (if needed)'
    expected_findings:
    - Level coverage
    - Missing levels
  - id: '3'
    name: Evaluate Diagram Quality
    description: |
      Review diagrams for clarity and completeness.
    duration_estimate: 45 min
    quality_checklist:
    - Clear title and purpose
    - Legend explains symbols
    - Appropriate level of detail
    - Relationships labeled
    - Technologies indicated
    - Consistent styling
    expected_findings:
    - Quality assessment
    - Improvement areas
  - id: '4'
    name: Verify Accuracy
    description: |
      Compare diagrams against actual system.
    duration_estimate: 45 min
    verification_methods:
    - Compare containers with deployed services
    - Verify integration points
    - Check technology labels
    expected_findings:
    - Accuracy assessment
    - Discrepancies
  - id: '5'
    name: Review Maintenance Approach
    description: |
      Assess how diagrams are maintained.
    duration_estimate: 20 min
    questions:
    - Are diagram sources version controlled?
    - Who owns diagram updates?
    - When are diagrams updated?
    expected_findings:
    - Maintenance practices
    - Improvement opportunities
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Diagram Inventory
    - Coverage Assessment
    - Quality Review
    - Recommendations
  confidence_guidance:
    high: Diagrams validated against deployed infrastructure
    medium: Diagrams reviewed with architect input
    low: Diagram inventory only
closeout_checklist:
- id: diagrams-001
  item: Architecture diagrams exist
  level: CRITICAL
  verification: find . -name '*.puml' -o -name '*.drawio' -o -name '*.svg' -path '*/docs/*' | head -1
  expected: Diagrams present
- id: diagrams-002
  item: Context diagram exists
  level: BLOCKING
  verification: find . -name '*context*' | grep -E '\.(puml|png|svg)$' | head -1
  expected: Context diagram present
- id: diagrams-003
  item: Container diagram exists
  level: BLOCKING
  verification: find . -name '*container*' | grep -E '\.(puml|png|svg)$' | head -1
  expected: Container diagram present
- id: diagrams-004
  item: Diagram sources maintained
  level: WARNING
  verification: find . -name '*.puml' -o -name '*.drawio' | head -1
  expected: Source files present
governance:
  applicable_to:
    archetypes:
    - all-systems
relationships:
  commonly_combined:
  - documentation-knowledge.architecture-docs.system-architecture-docs
  - documentation-knowledge.architecture-docs.data-flow-documentation
  feeds_into:
  - architecture-review.comprehension
  - onboarding.system-understanding
