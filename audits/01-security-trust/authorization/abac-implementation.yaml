audit:
  id: security-trust.authorization.abac-implementation
  name: Attribute-Based Access Control (ABAC) Implementation Audit
  version: 1.0.0
  last_updated: '2026-01-18'
  status: active
  category: security-trust
  category_number: 1
  subcategory: authorization
  tier: phd
  estimated_duration: 2.5 hours
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: critical
  scope: codebase
  default_profiles:
  - full
  - security
  blocks_phase: true
  parallelizable: true
description:
  what: |
    Examines the implementation of Attribute-Based Access Control (ABAC) as defined
    in NIST SP 800-162. Evaluates policy decision points (PDP), policy enforcement
    points (PEP), attribute sources, policy definitions, and environment conditions.
    Verifies that access decisions consider user attributes, resource attributes,
    action attributes, and contextual conditions.
  why_it_matters: |
    ABAC provides fine-grained, dynamic access control essential for Zero Trust
    architectures and complex authorization requirements. OWASP reports 94% of
    applications have access control weaknesses. Misconfigured ABAC can lead to
    data breaches, privilege escalation, and compliance violations. ABAC is
    critical for multi-tenancy, context-aware security, and regulatory compliance.
  when_to_run:
  - Initial security assessment
  - After policy changes
  - Before production deployment
  - During Zero Trust implementation
prerequisites:
  required_artifacts:
  - type: source_code
    description: Application source code with ABAC logic
  - type: configuration
    description: ABAC policy files (XACML, ALFA, JSON policies)
  access_requirements:
  - Read access to source code repository
  - Access to policy definition files
  - Access to attribute source configurations
discovery:
  code_patterns:
  - pattern: (attribute|Attribute|ATTRIBUTE)\s*[=:,\[]
    type: regex
    scope: source
    purpose: Identify attribute definitions and assignments
  - pattern: '@(PreAuthorize|PostAuthorize|Secured)\s*\(.*#'
    type: regex
    scope: source
    purpose: Find Spring Security SpEL expressions with attribute checks
  - pattern: (policy|Policy|POLICY)\.(evaluate|check|authorize|permit|deny)
    type: regex
    scope: source
    purpose: Locate policy evaluation points
  - pattern: (subject|resource|action|environment)\.(get|has)Attribute
    type: regex
    scope: source
    purpose: Find attribute access patterns
  - pattern: xacml|XACML|alfa|ALFA|PolicySet|PolicyCombining
    type: regex
    scope: source
    purpose: Identify XACML/ALFA policy implementations
  - pattern: (context|ctx)\.(user|resource|action|time|location)
    type: regex
    scope: source
    purpose: Find context-based attribute access
  file_patterns:
  - glob: '**/*.xacml'
    purpose: XACML policy files
  - glob: '**/*.alfa'
    purpose: ALFA policy files
  - glob: '**/policies/**'
    purpose: Policy definition directories
  - glob: '**/abac/**'
    purpose: ABAC implementation modules
  - glob: '**/attribute*/**'
    purpose: Attribute provider configurations
knowledge_sources:
  specifications:
  - id: nist-sp-800-162
    name: 'NIST SP 800-162: ABAC Definition and Considerations'
    url: https://csrc.nist.gov/publications/detail/sp/800-162/final
    offline_cache: true
    priority: required
  - id: xacml-spec
    name: OASIS XACML 3.0 Standard
    url: https://docs.oasis-open.org/xacml/3.0/xacml-3.0-core-spec-os-en.html
    offline_cache: true
    priority: recommended
  - id: nist-800-53
    name: NIST SP 800-53 Security and Privacy Controls
    url: https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
    offline_cache: true
    priority: required
  - id: nist-800-207
    name: NIST SP 800-207 Zero Trust Architecture
    url: https://csrc.nist.gov/publications/detail/sp/800-207/final
    offline_cache: true
    priority: required
  - id: nsa-zero-trust
    name: NSA Embracing a Zero Trust Security Model
    url: https://media.defense.gov/2021/Feb/25/2002588479/-1/-1/0/CSI_EMBRACING_ZT_SECURITY_MODEL_UOO115131-21.PDF
    offline_cache: true
    priority: required
  - id: owasp-asvs
    name: OWASP Application Security Verification Standard
    url: https://owasp.org/www-project-application-security-verification-standard/
    offline_cache: true
    priority: required
  guides:
  - id: owasp-authz
    name: OWASP Authorization Cheat Sheet
    url: https://cheatsheetseries.owasp.org/cheatsheets/Authorization_Cheat_Sheet.html
    offline_cache: true
  - id: owasp-proactive-c1
    name: 'OWASP Top 10 Proactive Controls - C1: Implement Access Control'
    url: https://top10proactive.owasp.org/the-top-10/c1-accesscontrol/
    offline_cache: true
tooling:
  static_analysis:
  - tool: semgrep
    purpose: Detect missing attribute validation
    offline_capable: true
  - tool: OPA (Open Policy Agent)
    purpose: Validate policy definitions
    offline_capable: true
  scripts:
  - id: abac-pattern-search
    language: bash
    purpose: Find ABAC implementation patterns
    source: inline
    code: |
      # Search for attribute-based patterns
      grep -rn --include="*.{js,ts,py,java,rb,go,cs}" \
        -E "(attribute|policy|permit|deny|subject|resource)\..*\(" .
signals:
  critical:
  - id: ABAC-CRIT-001
    signal: Policy bypass through attribute manipulation
    evidence_pattern: (attribute|attr)\s*=\s*(req|request|input|params|body)
    cwe: CWE-639
    explanation: |
      User-controlled input directly sets authorization attributes, allowing
      attackers to manipulate policy decisions by injecting attribute values.
      Attributes should come from trusted identity providers and verified sources.
    remediation: Validate all attributes against trusted sources; never accept user input as attributes
  - id: ABAC-CRIT-002
    signal: Missing policy enforcement point
    evidence_pattern: '@(Get|Post|Put|Delete).*(?!@PreAuthorize)(?!policy\.check)'
    cwe: CWE-862
    explanation: |
      Endpoints lack policy enforcement, allowing access without attribute-based
      authorization checks. All access decisions must flow through a PEP.
    remediation: Implement PEP at all access boundaries with consistent policy evaluation
  - id: ABAC-CRIT-003
    signal: Default permit policy without explicit deny
    evidence_pattern: (permit|allow|grant).*default|default.*(permit|allow|true)
    cwe: CWE-276
    explanation: |
      ABAC policies default to permit, violating the principle of least privilege.
      This allows unauthorized access when policies are incomplete or misconfigured.
    remediation: Implement default-deny policies; require explicit permits
  high:
  - id: ABAC-HIGH-001
    signal: Attribute source not validated
    evidence_pattern: getAttribute\(.*\)(?!.*validate|verify|check)
    cwe: CWE-346
    explanation: |
      Attributes are retrieved without validation of their source authenticity.
      Attackers could inject spoofed attributes from untrusted sources.
    remediation: Validate attribute sources; use signed claims or verified identity tokens
  - id: ABAC-HIGH-002
    signal: Policy decision caching without invalidation
    evidence_pattern: cache\.put\(.*policy|policy.*cache(?!.*invalidat|.*expir)
    cwe: CWE-613
    explanation: |
      Policy decisions are cached without proper invalidation, allowing
      stale permissions after attribute or policy changes.
    remediation: Implement cache invalidation on attribute/policy changes with TTL limits
  - id: ABAC-HIGH-003
    signal: Inconsistent policy evaluation across services
    evidence_pattern: if\s*\(.*attribute|policy\.evaluate(?!.*PDP)
    cwe: CWE-863
    explanation: |
      Policy evaluation logic is scattered across services rather than
      centralized in a PDP, leading to inconsistent authorization decisions.
    remediation: Centralize policy evaluation in a single PDP service
  medium:
  - id: ABAC-MED-001
    signal: Environment attributes not considered
    evidence_pattern: evaluate\(.*user.*resource(?!.*context|env|time)
    cwe: CWE-285
    remediation: Include environment attributes (time, location, device) in policy evaluation
  - id: ABAC-MED-002
    signal: Policy versioning not implemented
    evidence_pattern: policy.*=.*(?!.*version|.*v[0-9])
    cwe: CWE-1188
    remediation: Implement policy versioning for audit and rollback capabilities
  low:
  - id: ABAC-LOW-001
    signal: Missing policy documentation
    evidence_pattern: policy.*(?!.*comment|description|doc)
    remediation: Document all policies with business justification
  positive:
  - id: ABAC-POS-001
    signal: Centralized PDP implementation
    evidence_pattern: (class|interface).*(PDP|PolicyDecisionPoint|PolicyEngine)
  - id: ABAC-POS-002
    signal: XACML/ALFA policy format used
    evidence_pattern: \.xacml|\.alfa|PolicySet|PolicyCombining
procedure:
  context:
    cognitive_mode: critical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Identify ABAC Architecture
    description: |
      Map the ABAC implementation including Policy Decision Points (PDP),
      Policy Enforcement Points (PEP), Policy Administration Points (PAP),
      and Policy Information Points (PIP).
    duration_estimate: 25 min
    commands:
    - purpose: Find PDP implementations
      command: |
        grep -rn --include="*.{js,ts,py,java,go,rb,cs}" -E \
          "(PDP|PolicyDecisionPoint|PolicyEngine|evaluate.*policy)" .
    - purpose: Find PEP implementations
      command: |
        grep -rn --include="*.{js,ts,py,java,go,rb,cs}" -E \
          "(PEP|PolicyEnforcement|enforce.*policy|checkPolicy)" .
    expected_findings:
    - Centralized policy evaluation component
    - Enforcement points at service boundaries
  - id: '2'
    name: Analyze Attribute Sources
    description: |
      Identify all attribute sources and verify they are trusted and
      properly validated.
    duration_estimate: 30 min
    commands:
    - purpose: Find attribute retrieval patterns
      command: |
        grep -rn --include="*.{js,ts,py,java,go,rb,cs}" -E \
          "(getAttribute|getSubjectAttribute|getResourceAttribute|getContext)" .
    - purpose: Check for user-controlled attributes
      command: |
        grep -rn --include="*.{js,ts,py,java,go,rb,cs}" -E \
          "attribute.*(req\.|request\.|body\.|params\.)" .
    expected_findings:
    - Trusted identity sources for user attributes
    - Validated resource metadata sources
  - id: '3'
    name: Review Policy Definitions
    description: |
      Analyze policy definitions for completeness, security, and
      alignment with least privilege principle.
    duration_estimate: 35 min
    commands:
    - purpose: Find policy definition files
      command: |
        find . -type f \( -name "*.xacml" -o -name "*.alfa" -o -name "*policy*.json" -o -name "*policy*.yaml" \) 2>/dev/null
    - purpose: Check for default-permit policies
      command: |
        grep -rn --include="*.{json,yaml,yml,xacml}" -E \
          "(default.*permit|permit.*default|effect.*permit)" .
    expected_findings:
    - Explicit deny policies
    - Least privilege policy design
  - id: '4'
    name: Verify Policy Enforcement Consistency
    description: |
      Ensure PEP is consistently applied across all access paths
      and service boundaries.
    duration_estimate: 30 min
    commands:
    - purpose: Find unprotected endpoints
      command: |
        grep -rn --include="*.{js,ts,py,java}" -B3 -A2 \
          "@(Get|Post|Put|Delete|RequestMapping)" . | \
          grep -v "policy\|authorize\|PreAuthorize"
    - purpose: Check middleware enforcement
      command: |
        grep -rn --include="*.{js,ts,py,java,go,rb,cs}" -E \
          "(middleware|interceptor|filter).*policy" .
    expected_findings:
    - PEP applied at all access points
    - Consistent authorization middleware
  - id: '5'
    name: Audit Policy Administration
    description: |
      Verify that policy changes are properly controlled, versioned,
      and audited.
    duration_estimate: 20 min
    commands:
    - purpose: Find policy modification patterns
      command: |
        grep -rn --include="*.{js,ts,py,java,go,rb,cs}" -E \
          "(updatePolicy|createPolicy|deletePolicy|modifyPolicy)" .
    - purpose: Check for policy audit logging
      command: |
        grep -rn --include="*.{js,ts,py,java,go,rb,cs}" -E \
          "(log|audit).*(policy|rule|permission)" .
    expected_findings:
    - Controlled policy modification
    - Audit trail for policy changes
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - ABAC Architecture Analysis
    - Policy Evaluation Results
    - Critical Findings
    - Recommendations
  confidence_guidance:
    high: Complete ABAC architecture verified with centralized PDP and consistent PEPs
    medium: ABAC patterns present but architecture not fully consistent
    low: Attribute-based patterns found but ABAC implementation unclear
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: nist-sp-800-162
      priority: required
    - source_id: owasp-authz
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: ABAC audit requires thorough policy analysis
    full:
      included: true
      priority: 1
    security:
      included: true
      priority: 1
closeout_checklist:
- id: abac-001
  item: Centralized PDP exists
  level: CRITICAL
  verification: |
    grep -rn --include="*.{js,ts,py,java,go}" -E "(PDP|PolicyDecisionPoint|PolicyEngine)" . | wc -l
  expected: Greater than 0
- id: abac-002
  item: No user-controlled attribute injection
  level: CRITICAL
  verification: |
    grep -rn --include="*.{js,ts,py,java,go}" -E "attribute.*=.*(req|request|body|params)" . | wc -l
  expected: '0'
- id: abac-003
  item: Default-deny policy implemented
  level: BLOCKING
  verification: |
    grep -rn --include="*.{json,yaml,yml,xacml}" -E "default.*deny|deny.*default" . | wc -l
  expected: Greater than 0
- id: abac-004
  item: Policy audit logging exists
  level: WARNING
  verification: |
    grep -rn --include="*.{js,ts,py,java,go}" -E "(log|audit).*policy" . | wc -l
  expected: Greater than 0
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: NIST SP 800-162
    controls:
    - ABAC Definition
  - framework: NIST SP 800-53
    controls:
    - AC-3
    - AC-2
  - framework: OWASP Top 10 2021
    controls:
    - A01:2021
relationships:
  commonly_combined:
  - security-trust.authorization.rbac-implementation
  - security-trust.authorization.resource-permission
  - security-trust.authorization.cross-tenant-isolation
