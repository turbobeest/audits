audit:
  id: security-trust.data-protection.cross-border-data-transfer
  name: Cross-Border Data Transfer Audit
  version: 1.0.0
  last_updated: '2026-01-18'
  status: active
  category: security-trust
  category_number: 1
  subcategory: data-protection
  tier: phd
  estimated_duration: 4-6 hours  # median: 5h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: critical
  scope: data
  default_profiles:
  - full
  - security
  - production
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines the organization's compliance with international
    data transfer regulations, focusing on five critical areas:

    1. GDPR Chapter V Compliance: Verifies that personal data transfers
       outside the EEA comply with GDPR requirements through appropriate
       transfer mechanisms.

    2. Standard Contractual Clauses (SCCs): Reviews implementation of
       EU-approved standard contractual clauses for data transfers,
       including proper module selection and supplementary measures.

    3. Binding Corporate Rules (BCRs): Assesses intra-group transfer
       mechanisms for multinational organizations, including BCR
       documentation and supervisory authority approval.

    4. Adequacy Decisions: Evaluates reliance on EU adequacy decisions
       for third-country transfers, including monitoring of decision
       validity and changes.

    5. Data Localization: Reviews compliance with data residency
       requirements in jurisdictions mandating local data storage.
  why_it_matters: |
    Cross-border data transfers are highly regulated and non-compliance
    can result in severe consequences:

    - GDPR fines up to 20 million EUR or 4% of global annual turnover
    - Injunctions halting data transfers and business operations
    - Reputational damage from regulatory enforcement actions
    - Invalid legal basis for processing transferred data
    - Contractual breaches with customers requiring data localization

    Major enforcement cases (Schrems I, Schrems II) have invalidated
    transfer mechanisms affecting millions of organizations. Ongoing
    compliance monitoring is essential.
  when_to_run:
  - Initial GDPR compliance assessment
  - When selecting new cloud providers or SaaS vendors
  - After regulatory changes affecting transfer mechanisms
  - During due diligence for international expansions
  - Annual compliance audits
  - Following data protection authority guidance updates
prerequisites:
  required_artifacts:
  - type: documentation
    description: Data flow maps showing international data transfers
  - type: legal
    description: Executed SCCs, BCRs, or other transfer agreements
  - type: inventory
    description: Vendor and processor inventory with locations
  access_requirements:
  - Access to data processing agreements and SCCs
  - Data flow documentation and mapping
  - Vendor management records
  - Infrastructure configuration showing data storage locations
  - Legal team input on transfer mechanisms
discovery:
  code_patterns:
  - pattern: (?i)region\s*[=:]\s*['"]?(us-|eu-|ap-|sa-|af-|me-|cn-)
    type: regex
    scope: config
    purpose: Identify cloud region configurations indicating data locations
  - pattern: (?i)(aws|gcp|azure).*region|location.*datacenter
    type: regex
    scope: config
    purpose: Find cloud provider region specifications
  - pattern: (?i)transfer.*country|cross.*border|international.*data
    type: regex
    scope: docs
    purpose: Locate data transfer documentation
  - pattern: (?i)scc|standard.*contractual|bcr|binding.*corporate|adequacy
    type: regex
    scope: docs
    purpose: Find transfer mechanism documentation
  file_patterns:
  - glob: '**/*scc*.{pdf,docx,doc}'
    purpose: Standard Contractual Clauses documents
  - glob: '**/*dpa*.{pdf,docx,doc}'
    purpose: Data Processing Agreements
  - glob: '**/terraform/**/*.tf'
    purpose: Infrastructure-as-code with region configurations
  - glob: '**/cloudformation/**/*.yaml'
    purpose: AWS CloudFormation templates with region settings
  - glob: '**/privacy/*.{md,txt,pdf}'
    purpose: Privacy documentation and policies
  documents_to_review:
  - type: Data Flow Maps
    purpose: Understand all cross-border data flows
  - type: Vendor Agreements
    purpose: Review data processing and transfer terms
  - type: Privacy Impact Assessments
    purpose: Assess transfer risk evaluations
  - type: Transfer Impact Assessments (TIAs)
    purpose: Review Schrems II supplementary measures
  interviews:
  - role: Data Protection Officer
    questions:
    - What transfer mechanisms are in place for each third-country transfer?
    - Have Transfer Impact Assessments been conducted?
    - How are changes in adequacy decisions monitored?
    purpose: Understand transfer governance and compliance approach
  - role: Legal/Privacy Team
    questions:
    - Are SCCs executed with all relevant third-country processors?
    - What supplementary measures have been implemented?
    - How are new vendor transfers evaluated?
    purpose: Assess legal compliance of transfer mechanisms
knowledge_sources:
  specifications:
  - id: gdpr-chapter-v
    name: GDPR Chapter V - Transfers of Personal Data
    url: https://gdpr-info.eu/chapter-5/
    offline_cache: true
    priority: required
  - id: eu-sccs-2021
    name: EU Standard Contractual Clauses (2021)
    url: https://ec.europa.eu/info/law/law-topic/data-protection/international-dimension-data-protection/standard-contractual-clauses-scc_en
    offline_cache: true
    priority: required
  - id: edpb-transfer-guidance
    name: EDPB Recommendations 01/2020 on Transfer Measures
    url: https://edpb.europa.eu/our-work-tools/our-documents/recommendations/recommendations-012020-measures-supplement-transfer_en
    offline_cache: true
    priority: required
  guides:
  - id: adequacy-decisions-list
    name: EU Adequacy Decisions List
    url: https://ec.europa.eu/info/law/law-topic/data-protection/international-dimension-data-protection/adequacy-decisions_en
    offline_cache: true
  - id: nist-800-47
    name: NIST SP 800-47 Rev 1 - Managing Security of Information Exchanges
    url: https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-47r1.pdf
    offline_cache: true
tooling:
  static_analysis:
  - tool: grep/ripgrep
    purpose: Search for region configurations and transfer documentation
    offline_capable: true
  infrastructure_tools:
  - tool: aws-cli
    purpose: Identify AWS resource regions
    command: aws resourcegroupstaggingapi get-resources --output json | jq '.ResourceTagMappingList[].ResourceARN'
      | grep -oE 'us-|eu-|ap-|sa-'
  - tool: az-cli
    purpose: List Azure resource locations
    command: az resource list --query '[].location' -o tsv | sort | uniq
  - tool: gcloud
    purpose: List GCP resource regions
    command: gcloud compute instances list --format='value(zone)' | sort | uniq
signals:
  critical:
  - id: TRANSFER-CRIT-001
    signal: Personal data transferred to third country without legal basis
    evidence_indicators:
    - Data flowing to non-adequate country without SCCs
    - No BCRs in place for intra-group transfers
    - No documented transfer mechanism for processor
    explanation: |
      Transferring personal data outside the EEA without a valid legal
      mechanism violates GDPR Article 44. This exposes the organization
      to enforcement action and potential data transfer injunctions.
    remediation: |
      Establish valid transfer mechanism immediately:
      - Execute appropriate SCC modules with recipients
      - Evaluate adequacy decision coverage for the destination
      - Implement supplementary technical measures
      - Document legal basis in records of processing
  - id: TRANSFER-CRIT-002
    signal: SCCs not properly executed or outdated version in use
    evidence_indicators:
    - Using pre-2021 SCC versions after transition period
    - SCCs not signed by both parties
    - Wrong SCC module selected for transfer scenario
    explanation: |
      The EU adopted new SCCs in June 2021, with old SCCs invalid after
      December 27, 2022. Using outdated or improperly executed SCCs
      means transfers have no valid legal basis.
    remediation: |
      Update to current EU SCCs immediately:
      - Execute new 2021 SCCs with all third-country processors
      - Select correct module (C2C, C2P, P2P, P2C) for each transfer
      - Complete Annex I (parties) and Annex II (technical measures)
      - Conduct Transfer Impact Assessment per EDPB guidance
  - id: TRANSFER-CRIT-003
    signal: Transfer to high-risk jurisdiction without supplementary measures
    evidence_indicators:
    - Transfers to countries with surveillance laws
    - No encryption or pseudonymization implemented
    - No Transfer Impact Assessment conducted
    explanation: |
      Following Schrems II, transfers to countries with problematic
      surveillance laws require supplementary technical measures.
      Without these, the transfer may not provide adequate protection.
    remediation: |
      Implement supplementary measures per EDPB Recommendations 01/2020:
      - Conduct Transfer Impact Assessment (TIA)
      - Implement end-to-end encryption with EU-held keys
      - Apply pseudonymization where feasible
      - Document assessment and measures in TIA report
  high:
  - id: TRANSFER-HIGH-001
    signal: No Transfer Impact Assessment conducted
    evidence_indicators:
    - TIA documentation missing for third-country transfers
    - No risk assessment for surveillance law impact
    - Supplementary measures not documented
    explanation: |
      Post-Schrems II, exporters must assess whether the destination
      country's laws allow authorities to access data in ways incompatible
      with EU standards. Without TIA, transfers may be challenged.
    remediation: |
      Conduct Transfer Impact Assessment:
      - Document destination country legal framework analysis
      - Assess likelihood of government access to transferred data
      - Evaluate whether SCCs can be complied with in practice
      - Document supplementary measures and effectiveness
  - id: TRANSFER-HIGH-002
    signal: Data localization requirement violated
    evidence_indicators:
    - Data stored outside required jurisdiction
    - Infrastructure region doesn't match contractual requirements
    - Regulatory data residency mandate not met
    explanation: |
      Some jurisdictions and contracts require data to remain within
      specific geographic boundaries. Violations can result in regulatory
      penalties and contractual breaches.
    remediation: |
      Ensure data residency compliance:
      - Configure cloud resources in required regions
      - Implement data residency controls and monitoring
      - Review customer contracts for localization requirements
      - Document compliance with jurisdictional requirements
  - id: TRANSFER-HIGH-003
    signal: Vendor transfers not documented in records of processing
    evidence_indicators:
    - Third-party processors not listed in Article 30 records
    - Transfer destinations not documented
    - Legal basis for transfers not recorded
    explanation: |
      GDPR Article 30 requires documentation of transfers to third
      countries including the destination and transfer safeguards.
      Incomplete records indicate governance gaps.
    remediation: |
      Update records of processing activities:
      - Document all third-country transfers
      - Record transfer mechanism for each transfer
      - Include supplementary measures where applicable
      - Maintain current vendor inventory with locations
  - id: TRANSFER-HIGH-004
    signal: Adequacy decision reliance not monitored
    evidence_indicators:
    - No process to track adequacy decision validity
    - Reliance on potentially invalid framework
    - No contingency plan for adequacy revocation
    explanation: |
      Adequacy decisions can be challenged (like Privacy Shield) or
      expire. Organizations relying on adequacy must monitor for
      changes and have contingency plans.
    remediation: |
      Implement adequacy monitoring:
      - Track EU Commission adequacy decision announcements
      - Subscribe to EDPB and DPA guidance updates
      - Develop contingency plans (SCC fallback) for key transfers
      - Review adequacy reliance in annual compliance review
  medium:
  - id: TRANSFER-MED-001
    signal: Sub-processor transfers not properly governed
    evidence_indicators:
    - Processor using sub-processors without authorization
    - Sub-processor locations not disclosed
    - No flow-down of transfer obligations to sub-processors
    explanation: |
      When processors engage sub-processors in third countries,
      the same transfer requirements apply. Lack of visibility
      into sub-processor transfers creates compliance gaps.
    remediation: |
      Strengthen sub-processor governance:
      - Require processor disclosure of all sub-processors
      - Ensure SCCs flow down to sub-processor agreements
      - Implement sub-processor change notification procedures
      - Audit sub-processor transfer compliance
  - id: TRANSFER-MED-002
    signal: Derogation reliance without proper documentation
    evidence_indicators:
    - Using consent derogation for systematic transfers
    - Necessary for contract derogation over-applied
    - Derogation conditions not documented
    explanation: |
      GDPR Article 49 derogations are intended for occasional
      transfers, not systematic data flows. Over-reliance on
      derogations without meeting conditions creates risk.
    remediation: |
      Review derogation usage:
      - Reserve derogations for truly occasional transfers
      - Document specific conditions met for each derogation
      - Implement proper transfer mechanisms for systematic transfers
      - Obtain explicit consent where consent derogation is used
  - id: TRANSFER-MED-003
    signal: No data transfer governance process
    evidence_indicators:
    - New vendors onboarded without transfer assessment
    - No approval workflow for third-country transfers
    - Transfer decisions made without privacy team input
    explanation: |
      Without governance processes, transfers may be established
      without proper legal basis, creating ongoing compliance
      debt and risk.
    remediation: |
      Implement transfer governance:
      - Require privacy team review for new third-country transfers
      - Include transfer assessment in vendor onboarding
      - Establish approval workflow for international data flows
      - Conduct periodic transfer inventory reviews
  low:
  - id: TRANSFER-LOW-001
    signal: Transfer documentation not centrally maintained
    evidence_indicators:
    - SCCs scattered across different systems
    - No central register of transfer mechanisms
    - Difficulty locating transfer documentation
    remediation: |
      Centralize transfer documentation in a single repository
      with clear ownership and regular review cadence.
  - id: TRANSFER-LOW-002
    signal: Privacy notices incomplete regarding transfers
    evidence_indicators:
    - Transfer destinations not disclosed to data subjects
    - Transfer safeguards not described in notices
    remediation: |
      Update privacy notices to include information about
      international transfers, destinations, and safeguards
      per GDPR Article 13/14 requirements.
  positive:
  - id: TRANSFER-POS-001
    signal: Comprehensive transfer governance in place
    evidence_indicators:
    - All transfers documented with legal mechanisms
    - TIAs conducted for relevant transfers
    - Governance process for new transfers
  - id: TRANSFER-POS-002
    signal: Current SCCs properly implemented
    evidence_indicators:
    - 2021 SCCs executed with all third-country processors
    - Correct modules selected for each scenario
    - Annexes completed with specific measures
  - id: TRANSFER-POS-003
    signal: Robust supplementary measures implemented
    evidence_indicators:
    - End-to-end encryption for transferred data
    - EU-based key management for encrypted transfers
    - Pseudonymization applied where feasible
procedure:
  context:
    cognitive_mode: critical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Map Data Flows
    description: |
      Identify all personal data flows crossing international boundaries,
      including flows to cloud providers, SaaS vendors, and intra-group
      transfers.
    duration_estimate: 60 min
    commands:
    - purpose: Find cloud region configurations
      command: grep -r -n -i 'region.*=\|location.*=' --include='*.tf' --include='*.yaml' --include='*.yml'
        --include='*.json' . 2>/dev/null | head -50
    - purpose: Search for transfer-related documentation
      command: find . -type f \( -name '*transfer*' -o -name '*scc*' -o -name '*dpa*' \) 2>/dev/null |
        head -30
    expected_findings:
    - List of services with data stored outside EEA
    - Cloud resource regions and locations
    - Existing transfer documentation
  - id: '2'
    name: Review Transfer Mechanisms
    description: |
      For each identified cross-border transfer, verify that appropriate
      legal mechanisms are in place (adequacy, SCCs, BCRs, or derogations).
    duration_estimate: 90 min
    questions:
    - Is there an adequacy decision for the destination country?
    - Are current (2021) SCCs executed with the recipient?
    - Is the correct SCC module selected for the transfer scenario?
    - Are BCRs approved for intra-group transfers?
    expected_findings:
    - Transfer mechanism status for each flow
    - Gaps in legal basis coverage
    - Outdated or incomplete documentation
  - id: '3'
    name: Assess Transfer Impact
    description: |
      Review Transfer Impact Assessments for transfers to countries
      with potentially problematic legal frameworks.
    duration_estimate: 60 min
    questions:
    - Has a TIA been conducted for high-risk transfers?
    - What supplementary measures have been implemented?
    - Is the assessment documented and current?
    expected_findings:
    - TIA documentation status
    - Supplementary measures in place
    - Risk assessment quality
  - id: '4'
    name: Verify Supplementary Measures
    description: |
      Assess technical and organizational supplementary measures
      implemented to protect transferred data.
    duration_estimate: 45 min
    commands:
    - purpose: Check for encryption configurations
      command: grep -r -n -i 'encrypt.*transit\|tls\|ssl\|kms\|key.*management' --include='*.tf' --include='*.yaml'
        . 2>/dev/null | head -30
    expected_findings:
    - Encryption in transit status
    - Key management arrangements
    - Pseudonymization implementation
  - id: '5'
    name: Review Governance Processes
    description: |
      Evaluate organizational processes for managing data transfers
      including new vendor assessment and ongoing compliance.
    duration_estimate: 45 min
    questions:
    - Is there a process for assessing new third-country transfers?
    - How are changes in adequacy decisions monitored?
    - Is transfer compliance included in vendor management?
    expected_findings:
    - Governance process maturity
    - Ongoing compliance monitoring
    - Vendor management integration
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Data Flow Inventory
    - Transfer Mechanism Assessment
    - Transfer Impact Assessment Review
    - Supplementary Measures Evaluation
    - Governance Assessment
    - Recommendations
  confidence_guidance:
    high: Documentation reviewed, legal team confirmed, technical measures verified
    medium: Documentation exists but incomplete verification, some gaps identified
    low: Limited documentation available, assessment based on inference
offline:
  capability: partial
  cache_manifest:
    knowledge:
    - source_id: gdpr-chapter-v
      priority: required
    - source_id: eu-sccs-2021
      priority: required
    - source_id: edpb-transfer-guidance
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Transfer compliance requires comprehensive documentation review
    full:
      included: true
      priority: 1
    security:
      included: true
      priority: 2
    production:
      included: true
      priority: 1
closeout_checklist:
- id: transfer-001
  item: All cross-border data flows identified and documented
  level: CRITICAL
  verification: manual
  verification_notes: Reviewer should confirm data flow mapping is complete and current
  expected: Confirmed by reviewer
- id: transfer-002
  item: Valid transfer mechanism in place for each third-country transfer
  level: CRITICAL
  verification: manual
  verification_notes: Reviewer should verify SCCs, adequacy, or BCRs for each transfer
  expected: Confirmed by reviewer
- id: transfer-003
  item: 2021 SCCs executed where applicable
  level: CRITICAL
  verification: manual
  verification_notes: Reviewer should verify current SCC version and proper module selection
  expected: Confirmed by reviewer
- id: transfer-004
  item: Transfer Impact Assessments conducted for high-risk transfers
  level: BLOCKING
  verification: manual
  verification_notes: Reviewer should confirm TIA documentation exists for transfers to surveillance-risk
    countries
  expected: Confirmed by reviewer
- id: transfer-005
  item: Supplementary technical measures implemented
  level: BLOCKING
  verification: |
    grep -r -i 'encrypt\|tls\|ssl' --include='*.tf' --include='*.yaml' . 2>/dev/null | wc -l | xargs -I {} sh -c '[ {} -gt 0 ] && echo PASS || echo FAIL'
  expected: PASS
- id: transfer-006
  item: Data residency requirements met
  level: WARNING
  verification: manual
  verification_notes: Reviewer should verify data is stored in required jurisdictions per contractual
    and regulatory requirements
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: GDPR
    controls:
    - Article 44
    - Article 45
    - Article 46
    - Article 47
    - Article 49
  - framework: UK GDPR
    controls:
    - Chapter V
  - framework: ISO 27001:2022
    controls:
    - A.5.14
    - A.8.11
  - framework: NIST Privacy Framework
    controls:
    - CT.DM-P
    - GV.MT-P
  - framework: NIST SP 800-53
    controls:
    - SA-9
    - PS-7
relationships:
  commonly_combined:
  - security-trust.data-protection.encryption-at-rest
  - security-trust.data-protection.encryption-in-transit
  - security-trust.cryptography.key-management
