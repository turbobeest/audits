audit:
  id: observability-instrumentation.observability-operations.observability-as-code
  name: Observability as Code Audit
  version: 1.0.0
  last_updated: '2026-01-18'
  status: active
  category: observability-instrumentation
  category_number: 5
  subcategory: observability-operations
  tier: phd
  estimated_duration: 3-5 hours  # median: 4h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: config
  default_profiles:
  - full
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates the extent to which observability configuration is managed as code
    including dashboards, alerts, SLOs, recording rules, and pipeline configurations.
    Assesses version control practices, CI/CD integration, environment promotion,
    and drift detection for observability artifacts.
  why_it_matters: |
    Manual observability configuration leads to inconsistency between environments,
    undocumented changes, and difficulty recovering from failures. Observability
    as Code enables reproducibility, review processes, audit trails, and disaster
    recovery. It reduces the bus factor and enables self-service observability.
  when_to_run:
  - When establishing observability standards
  - After observability platform migrations
  - During platform maturity assessments
  - When experiencing configuration drift issues
  - Before scaling observability infrastructure
prerequisites:
  required_artifacts:
  - type: observability_configs
    description: Dashboard definitions, alert rules, SLO configurations
  - type: git_repositories
    description: Repositories where observability configs might be stored
  - type: cicd_pipelines
    description: CI/CD pipelines that might deploy observability configs
  access_requirements:
  - Read access to observability configuration repositories
  - Access to observability platform APIs (Grafana, Prometheus, etc.)
  - Access to CI/CD pipeline configurations
  - Access to Terraform/Pulumi state if used
discovery:
  code_patterns:
  - pattern: grafana_dashboard|grafana_alert
    type: keyword
    scope: config
    purpose: Find Terraform Grafana provider usage
  - pattern: PrometheusRule|AlertmanagerConfig
    type: keyword
    scope: config
    purpose: Find Prometheus Operator CRDs
  - pattern: recording_rules|alerting_rules
    type: keyword
    scope: config
    purpose: Find Prometheus rule files
  - pattern: jsonnet|grafonnet
    type: keyword
    scope: source
    purpose: Find Jsonnet-based dashboard generation
  file_patterns:
  - glob: '**/dashboards/**/*.json'
    purpose: Grafana dashboard JSON files
  - glob: '**/alerts/**/*.yaml'
    purpose: Alert rule definitions
  - glob: '**/*rules*.yaml'
    purpose: Prometheus recording and alerting rules
  - glob: '**/grafana*.tf'
    purpose: Terraform Grafana configurations
  - glob: '**/*.jsonnet'
    purpose: Jsonnet dashboard definitions
  - glob: '**/slo*.yaml'
    purpose: SLO configurations
knowledge_sources:
  guides:
  - id: grafana-provisioning
    name: Grafana Provisioning Documentation
    url: https://grafana.com/docs/grafana/latest/administration/provisioning/
    offline_cache: true
  - id: prometheus-operator
    name: Prometheus Operator Documentation
    url: https://prometheus-operator.dev/docs/user-guides/alerting/
    offline_cache: true
  - id: terraform-grafana
    name: Terraform Grafana Provider
    url: https://registry.terraform.io/providers/grafana/grafana/latest/docs
    offline_cache: true
  learning_resources:
  - id: grafonnet
    title: Grafonnet Library for Jsonnet Dashboards
    type: article
    reference: https://github.com/grafana/grafonnet
tooling:
  static_analysis:
  - tool: jsonnet
    purpose: Validate Jsonnet dashboard definitions
    offline_capable: true
  - tool: promtool
    purpose: Validate Prometheus rules
    offline_capable: true
  infrastructure_tools:
  - tool: terraform
    purpose: Manage observability infrastructure as code
    command: terraform plan -target=module.observability
  - tool: kubectl
    purpose: Apply Prometheus Operator CRDs
    command: kubectl apply -f prometheus-rules/
  - tool: grr
    purpose: Grafana resource management
    command: grr apply dashboards/
  scripts:
  - id: oac-coverage-scanner
    language: bash
    purpose: Assess observability-as-code coverage
    source: inline
    code: |
      #!/bin/bash
      # Scan for observability-as-code patterns

      echo "=== Observability as Code Coverage ==="

      echo -e "\n--- Dashboard definitions in Git ---"
      find . -path "*dashboards*" -name "*.json" | wc -l

      echo -e "\n--- Alert rules in Git ---"
      find . -name "*alert*" -name "*.yaml" | wc -l

      echo -e "\n--- Prometheus rules ---"
      find . -name "*rules*.yaml" | wc -l

      echo -e "\n--- Terraform observability resources ---"
      grep -r "grafana_" --include="*.tf" . | wc -l

      echo -e "\n--- Jsonnet dashboards ---"
      find . -name "*.jsonnet" | wc -l
signals:
  critical:
  - id: OAC-CRIT-001
    signal: Zero observability configurations in version control
    evidence_indicators:
    - All dashboards created manually in UI
    - Alert rules only in platform, not in Git
    - No IaC for observability infrastructure
    explanation: |
      Without version control, there is no audit trail, no review process,
      and no disaster recovery capability. Configuration loss or corruption
      could result in total loss of observability setup.
    remediation: Export existing configs; establish Git-based workflow
  high:
  - id: OAC-HIGH-001
    signal: Critical alerts not managed as code
    explanation: Alert changes bypass review; incident risk from misconfiguration
    remediation: Migrate alert rules to version control with CI/CD deployment
  - id: OAC-HIGH-002
    signal: No CI/CD pipeline for observability configs
    explanation: Manual deployment leads to drift and inconsistency
    remediation: Implement CI/CD for observability configuration deployment
  - id: OAC-HIGH-003
    signal: Configuration drift between environments
    explanation: Dev/staging/prod have inconsistent observability setup
    remediation: Implement environment promotion workflow for observability
  medium:
  - id: OAC-MED-001
    signal: Dashboards in version control but alerts are not
    remediation: Extend as-code practices to all observability artifacts
  - id: OAC-MED-002
    signal: No validation in CI for observability configs
    remediation: Add promtool check, jsonnet validation to CI pipelines
  - id: OAC-MED-003
    signal: Mixed manual and as-code configuration management
    remediation: Consolidate on as-code approach; prevent manual UI changes
  low:
  - id: OAC-LOW-001
    signal: Observability configs lack documentation
  positive:
  - id: OAC-POS-001
    signal: All observability configs in version control
  - id: OAC-POS-002
    signal: CI/CD deployment for observability changes
  - id: OAC-POS-003
    signal: Drift detection implemented
  - id: OAC-POS-004
    signal: Templated dashboards using Jsonnet or similar
procedure:
  context:
    cognitive_mode: evaluative
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Inventory observability artifacts
    description: |
      Catalog all observability configuration artifacts including dashboards,
      alerts, recording rules, SLOs, and pipeline configurations.
    duration_estimate: 45 min
    questions:
    - How many dashboards exist in the platform?
    - How many alert rules are configured?
    - What SLOs are defined?
    - What recording rules exist?
    expected_findings:
    - Complete inventory of observability artifacts
    - Artifact counts by type and location
  - id: '2'
    name: Assess version control coverage
    description: |
      Determine what percentage of observability artifacts are managed
      in version control versus created manually in platform UIs.
    duration_estimate: 45 min
    commands:
    - purpose: Find dashboard definitions in Git
      command: find . -path '*dashboard*' -name '*.json' -o -name '*.jsonnet'
    - purpose: Find alert rules in Git
      command: find . -name '*alert*' -name '*.yaml'
    - purpose: Find Terraform observability configs
      command: grep -r 'grafana_' --include='*.tf' .
    expected_findings:
    - Percentage of artifacts in version control
    - Gap analysis between platform and Git
  - id: '3'
    name: Review CI/CD integration
    description: |
      Evaluate how observability configurations are deployed.
      Check for automated pipelines, validation, and promotion workflows.
    duration_estimate: 30 min
    questions:
    - Is there a CI/CD pipeline for observability configs?
    - Are configurations validated before deployment?
    - Is there an environment promotion workflow?
    expected_findings:
    - CI/CD maturity assessment
    - Validation and deployment patterns
  - id: '4'
    name: Check for configuration drift
    description: |
      Assess whether drift exists between version-controlled configurations
      and what is actually deployed in platforms.
    duration_estimate: 30 min
    commands:
    - purpose: Export current Grafana dashboards
      command: grr pull dashboards/ --directory=./exported
    - purpose: Compare with Git versions
      command: diff -r dashboards/ exported/
    expected_findings:
    - Drift identification between Git and deployed state
    - Unauthorized changes detection
  - id: '5'
    name: Develop improvement recommendations
    description: |
      Based on findings, develop a roadmap for improving
      observability-as-code practices.
    duration_estimate: 30 min
    expected_findings:
    - Priority recommendations for OaC adoption
    - Tool and workflow recommendations
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: coverage_report
    format: structured
    sections:
    - Artifact Inventory
    - Version Control Coverage
    - CI/CD Maturity
    - Drift Analysis
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Current State Assessment
    - Key Findings
    - Recommendations
  confidence_guidance:
    high: Verified through repository and platform analysis
    medium: Based on partial access or sampling
    low: Inferred from interviews or documentation
offline:
  capability: partial
  cache_manifest:
    knowledge:
    - source_id: grafana-provisioning
      priority: recommended
    - source_id: prometheus-operator
      priority: recommended
  offline_notes: |
    Repository analysis can be done offline. Platform comparison
    requires access to running observability platforms.
profiles:
  membership:
    quick:
      included: false
      reason: Requires comprehensive configuration analysis
    full:
      included: true
      priority: 2
closeout_checklist:
- id: observability-as-code-001
  item: Observability artifact inventory completed
  level: CRITICAL
  verification: manual
  verification_notes: All dashboards, alerts, and rules cataloged
  expected: Confirmed by reviewer
- id: observability-as-code-002
  item: Version control coverage assessed
  level: CRITICAL
  verification: manual
  verification_notes: Percentage of artifacts in Git documented
  expected: Confirmed by reviewer
- id: observability-as-code-003
  item: CI/CD integration evaluated
  level: BLOCKING
  verification: manual
  verification_notes: Deployment automation maturity assessed
  expected: Confirmed by reviewer
- id: observability-as-code-004
  item: Configuration drift checked
  level: WARNING
  verification: manual
  verification_notes: Drift between Git and deployed state identified
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: SOC 2
    controls:
    - CC8.1
relationships:
  commonly_combined:
  - observability-instrumentation.observability-operations.observability-onboarding
  - observability-instrumentation.observability-operations.cross-team-observability
