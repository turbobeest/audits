# ============================================================
# AUDIT: Internal Linking Strategy
# ============================================================
# Evaluates internal link architecture for SEO optimization,
# user navigation, and PageRank distribution.
# ============================================================

audit:
  id: "seo-discoverability.on-page-seo.internal-linking"

  name: "Internal Linking Strategy Audit"

  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "seo-discoverability"
  category_number: 16
  subcategory: "on-page-seo"

  tier: "expert"
  estimated_duration: "2-3 hours"  # median: 2h

  completeness: "complete"
  requires_runtime: true
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "codebase"

  default_profiles:
    - "full"
    - "production"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    This audit examines the internal linking structure across the website.
    It evaluates link distribution (orphaned pages, over-linked pages),
    anchor text optimization, contextual linking practices, navigation
    structure, PageRank flow patterns, link depth to important pages,
    and broken internal links.

  why_it_matters: |
    Internal links distribute PageRank throughout the site, help search
    engines discover content, establish content hierarchy, and guide
    users to related content. Poor internal linking can result in orphaned
    pages that never get indexed, important pages that don't rank due to
    insufficient internal link equity, and poor user navigation experience.

  when_to_run:
    - "When planning site architecture"
    - "After adding significant new content"
    - "During content reorganization"
    - "When important pages aren't ranking"
    - "Quarterly SEO audits"

prerequisites:
  required_artifacts:
    - type: "website"
      description: "Live website with multiple pages"
    - type: "crawl_data"
      description: "Complete site crawl with link analysis"

  access_requirements:
    - "Ability to crawl the website fully"
    - "Access to internal link data"

discovery:
  code_patterns:
    - pattern: "<a\\s+href=[\"'][^\"']+[\"']"
      type: "regex"
      scope: "source"
      purpose: "Find all anchor links"
    - pattern: "rel=[\"']nofollow[\"']"
      type: "regex"
      scope: "source"
      purpose: "Find nofollow internal links"

  file_patterns:
    - glob: "**/*.html"
      purpose: "Analyze page links"
    - glob: "**/nav*.{html,jsx,tsx}"
      purpose: "Find navigation components"
    - glob: "**/sidebar*.{html,jsx,tsx}"
      purpose: "Find sidebar navigation"

knowledge_sources:
  guides:
    - id: "google-internal-links"
      name: "Google: Links Best Practices"
      url: "https://developers.google.com/search/docs/crawling-indexing/links-crawlable"
      offline_cache: true
    - id: "moz-internal-linking"
      name: "Moz: Internal Links"
      url: "https://moz.com/learn/seo/internal-link"
      offline_cache: true
    - id: "ahrefs-internal-linking"
      name: "Ahrefs: Internal Linking for SEO"
      url: "https://ahrefs.com/blog/internal-links-for-seo/"
      offline_cache: true

tooling:
  static_analysis:
    - tool: "Screaming Frog SEO Spider"
      purpose: "Complete internal link analysis"
      offline_capable: true
    - tool: "Sitebulb"
      purpose: "Internal link visualization"
      offline_capable: true
    - tool: "Ahrefs Site Audit"
      purpose: "Internal linking issues detection"
      offline_capable: false

  scripts:
    - id: "internal-link-analyzer"
      language: "bash"
      purpose: "Basic internal link analysis"
      source: "inline"
      code: |
        #!/bin/bash
        URL=$1
        DOMAIN=$(echo "$URL" | sed -E 's|^https?://([^/]+).*|\1|')

        echo "=== Internal Links on: $URL ==="

        # Count internal links
        LINKS=$(curl -s "$URL" | grep -oP 'href="[^"]*"' | grep -E "href=\"(https?://$DOMAIN|/)" | wc -l)
        echo "Internal links found: $LINKS"

        # Show anchor text distribution
        echo ""
        echo "=== Sample Anchor Texts ==="
        curl -s "$URL" | grep -oP '<a[^>]+href="[^"]*"[^>]*>[^<]+</a>' | \
          grep -E "href=\"(https?://$DOMAIN|/)" | head -10

signals:
  critical:
    - id: "LINK-CRIT-001"
      signal: "Orphaned pages with no internal links pointing to them"
      evidence_indicators:
        - "Pages with 0 internal inlinks"
        - "Pages only accessible via sitemap"
      explanation: |
        Orphaned pages are difficult for search engines to discover
        and receive no internal PageRank, severely limiting their
        ranking potential.
      remediation: "Add internal links from relevant pages"

    - id: "LINK-CRIT-002"
      signal: "Broken internal links (404 targets)"
      evidence_indicators:
        - "Internal links to non-existent pages"
        - "High 404 error count from internal sources"
      explanation: |
        Broken links waste crawl budget, break user experience,
        and leak PageRank to 404 pages.
      remediation: "Fix or remove broken internal links"

  high:
    - id: "LINK-HIGH-001"
      signal: "Important pages more than 3 clicks from homepage"
      explanation: |
        Pages deep in the site structure receive less PageRank
        and are crawled less frequently by search engines.
      remediation: "Add internal links to reduce click depth for important pages"

    - id: "LINK-HIGH-002"
      signal: "Unoptimized anchor text (generic: 'click here', 'read more')"
      explanation: |
        Anchor text provides context about the linked page. Generic
        anchors waste this ranking signal opportunity.
      remediation: "Use descriptive, keyword-relevant anchor text"

    - id: "LINK-HIGH-003"
      signal: "Internal links using nofollow"
      explanation: |
        Nofollow on internal links prevents PageRank flow and is
        rarely appropriate for internal linking.
      remediation: "Remove nofollow from internal links"

  medium:
    - id: "LINK-MED-001"
      signal: "Uneven link distribution (some pages over-linked)"
      remediation: "Balance internal links across pages"

    - id: "LINK-MED-002"
      signal: "No contextual internal links in content"
      remediation: "Add relevant internal links within page content"

    - id: "LINK-MED-003"
      signal: "Footer/header links dominate internal link profile"
      remediation: "Add more contextual body content links"

  low:
    - id: "LINK-LOW-001"
      signal: "Same anchor text used for different destinations"

    - id: "LINK-LOW-002"
      signal: "Excessive internal links per page (>100)"

  positive:
    - id: "LINK-POS-001"
      signal: "All important pages within 3 clicks of homepage"
    - id: "LINK-POS-002"
      signal: "Descriptive anchor text throughout site"
    - id: "LINK-POS-003"
      signal: "Contextual links embedded in content"

procedure:
  context:
    cognitive_mode: "critical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Crawl and Map Internal Links"
      description: |
        Perform a complete site crawl to map all internal links,
        their sources, destinations, and anchor text.
      duration_estimate: "30 min"
      commands:
        - purpose: "Complete site crawl with link analysis"
          command: "Screaming Frog crawl with internal link extraction"
      expected_findings:
        - "Complete link map"
        - "Link counts per page"
        - "Anchor text inventory"

    - id: "2"
      name: "Identify Orphaned Pages"
      description: |
        Find pages that have no internal links pointing to them
        (zero inlinks).
      duration_estimate: "20 min"
      expected_findings:
        - "Orphaned page list"
        - "Pages only in sitemap"
        - "Linking recommendations"

    - id: "3"
      name: "Analyze Click Depth"
      description: |
        Assess how many clicks it takes to reach important pages
        from the homepage.
      duration_estimate: "20 min"
      expected_findings:
        - "Click depth distribution"
        - "Deep important pages"
        - "Architecture recommendations"

    - id: "4"
      name: "Audit Anchor Text Usage"
      description: |
        Review anchor text distribution for optimization and
        identify generic or over-optimized anchors.
      duration_estimate: "30 min"
      expected_findings:
        - "Generic anchor usage"
        - "Keyword-rich anchors"
        - "Over-optimization patterns"

    - id: "5"
      name: "Check for Broken Links"
      description: |
        Identify internal links that lead to 404 pages or
        non-existent resources.
      duration_estimate: "20 min"
      expected_findings:
        - "Broken link list"
        - "404 sources"
        - "Fix priorities"

    - id: "6"
      name: "Evaluate Link Distribution"
      description: |
        Analyze how PageRank flows through the site and identify
        pages that are over or under-linked.
      duration_estimate: "30 min"
      expected_findings:
        - "Link equity distribution"
        - "Over-linked pages"
        - "Under-linked important pages"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "summary"
      format: "prose"
      sections:
        - "Internal Linking Overview"
        - "Orphaned Page Report"
        - "Click Depth Analysis"
        - "Anchor Text Assessment"
        - "Recommendations"

  confidence_guidance:
    high: "Issues verified via complete site crawl"
    medium: "Issues identified via sample analysis"
    low: "Potential issues based on pattern detection"

offline:
  capability: "partial"

  cache_manifest:
    knowledge:
      - source_id: "google-internal-links"
        priority: "required"
      - source_id: "moz-internal-linking"
        priority: "recommended"

profiles:
  membership:
    quick:
      included: false
      reason: "Requires complete site crawl and link analysis"
    full:
      included: true
      priority: 1
    production:
      included: true
      priority: 1

closeout_checklist:
  - id: "linking-001"
    item: "No orphaned pages (all pages have internal links)"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Review crawl data for pages with 0 inlinks"
    expected: "Confirmed by reviewer"

  - id: "linking-002"
    item: "No broken internal links"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Check crawl report for 404 internal link targets"
    expected: "Confirmed by reviewer"

  - id: "linking-003"
    item: "Important pages within 3 clicks of homepage"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Verify click depth for priority pages"
    expected: "Confirmed by reviewer"

  - id: "linking-004"
    item: "Anchor text is descriptive (not generic)"
    level: "WARNING"
    verification: "manual"
    verification_notes: "Sample anchor text for quality"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["web-application", "marketing-site", "ecommerce", "content-site"]

  compliance_frameworks:
    - framework: "SEO Best Practices"
      controls: ["Site Architecture", "PageRank Flow"]

relationships:
  commonly_combined:
    - "seo-discoverability.technical-seo.crawlability"
    - "seo-discoverability.on-page-seo.content-quality"
    - "seo-discoverability.technical-seo.url-structure"
