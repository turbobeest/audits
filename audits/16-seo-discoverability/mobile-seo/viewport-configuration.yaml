audit:
  id: seo-discoverability.mobile-seo.viewport-configuration
  name: Viewport Configuration Audit
  version: 1.0.0
  last_updated: '2026-01-19'
  status: active
  category: seo-discoverability
  category_number: 16
  subcategory: mobile-seo
  tier: expert
  estimated_duration: 45 minutes
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: 'yes'
  severity: critical
  scope: codebase
  default_profiles:
  - quick
  - full
  - production
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines viewport meta tag configuration across all HTML
    pages to ensure proper mobile rendering. It validates the viewport
    meta tag syntax, settings (width, initial-scale, user-scalable), and
    consistency across the site. Proper viewport configuration is fundamental
    to mobile-first indexing and responsive design.
  why_it_matters: |
    The viewport meta tag controls how mobile browsers render pages. Without
    it, or with incorrect configuration, browsers assume a desktop-width
    viewport and scale down, making content unreadable. This is a primary
    mobile-friendliness signal - pages without proper viewport configuration
    will fail Google's mobile-friendly test and face ranking penalties in
    mobile search results.
  when_to_run:
  - During initial site development
  - When adding new page templates
  - When mobile rendering issues are reported
  - As part of regular SEO audits
prerequisites:
  required_artifacts:
  - type: source_code
    description: HTML source files for viewport meta tag analysis
  access_requirements:
  - Source code repository access
discovery:
  code_patterns:
  - pattern: <meta\s+name=["']viewport["'][^>]*>
    type: regex
    scope: source
    purpose: Detect viewport meta tag
  - pattern: width=device-width
    type: regex
    scope: source
    purpose: Verify responsive width setting
  - pattern: initial-scale=1
    type: regex
    scope: source
    purpose: Verify initial scale setting
  - pattern: user-scalable\s*=\s*["']?no
    type: regex
    scope: source
    purpose: Detect disabled zoom (accessibility issue)
  - pattern: maximum-scale\s*=\s*1
    type: regex
    scope: source
    purpose: Detect restricted zoom
  file_patterns:
  - glob: '**/*.html'
    purpose: HTML files for viewport analysis
  - glob: '**/head.html'
    purpose: Common head partial templates
  - glob: '**/base.html'
    purpose: Base template files
  - glob: '**/layout.html'
    purpose: Layout template files
knowledge_sources:
  specifications:
  - id: css-device-adaptation
    name: CSS Device Adaptation Module
    url: https://www.w3.org/TR/css-device-adapt-1/
    offline_cache: true
    priority: recommended
  - id: mdn-viewport
    name: MDN Viewport Meta Tag Documentation
    url: https://developer.mozilla.org/en-US/docs/Web/HTML/Viewport_meta_tag
    offline_cache: true
    priority: required
  guides:
  - id: google-viewport
    name: Google Viewport Best Practices
    url: https://developers.google.com/search/docs/crawling-indexing/mobile/mobile-sites-mobile-first-indexing
    offline_cache: true
  - id: web-dev-viewport
    name: web.dev Viewport Guide
    url: https://web.dev/responsive-web-design-basics/#viewport
    offline_cache: true
tooling:
  static_analysis:
  - tool: HTMLHint
    purpose: Lint HTML for viewport configuration
    offline_capable: true
  - tool: Lighthouse
    purpose: Audit viewport configuration
    offline_capable: false
  scripts:
  - id: viewport-checker
    language: bash
    purpose: Check all HTML files for viewport meta tag
    source: inline
    code: |
      #!/bin/bash
      # Find HTML files missing viewport meta tag
      for file in $(find . -name "*.html"); do
        if ! grep -q 'name="viewport"' "$file"; then
          echo "MISSING: $file"
        fi
      done
  - id: viewport-validator
    language: bash
    purpose: Validate viewport meta tag values
    source: inline
    code: |
      #!/bin/bash
      # Check for recommended viewport configuration
      grep -r 'name="viewport"' --include='*.html' . | \
      grep -v 'width=device-width' && echo "WARN: Missing width=device-width"
signals:
  critical:
  - id: SEO-VIEW-CRIT-001
    signal: Missing viewport meta tag
    evidence_pattern: No <meta name="viewport"> in HTML head
    explanation: |
      Pages without a viewport meta tag render at desktop width on
      mobile devices and are scaled down. This causes the page to fail
      Google's mobile-friendly test and severely impacts mobile usability.
    remediation: Add <meta name="viewport" content="width=device-width, initial-scale=1">
  - id: SEO-VIEW-CRIT-002
    signal: Fixed viewport width specified
    evidence_pattern: width=[0-9]+ instead of width=device-width
    explanation: |
      A fixed pixel width viewport (e.g., width=980) prevents responsive
      behavior and forces the browser to scale content.
    remediation: Change to width=device-width for responsive behavior
  high:
  - id: SEO-VIEW-HIGH-001
    signal: Zoom disabled with user-scalable=no
    explanation: |
      Disabling zoom creates accessibility barriers for users who need
      to enlarge content. While not directly a ranking factor, it fails
      accessibility audits and may indirectly impact SEO.
    remediation: Remove user-scalable=no to allow accessibility zoom
  - id: SEO-VIEW-HIGH-002
    signal: Maximum-scale set to 1.0
    explanation: |
      Setting maximum-scale=1.0 prevents users from zooming in, which
      is an accessibility issue similar to user-scalable=no.
    remediation: Remove maximum-scale restriction or set to higher value
  medium:
  - id: SEO-VIEW-MED-001
    signal: Inconsistent viewport configuration across pages
    remediation: Standardize viewport meta tag in shared template
  - id: SEO-VIEW-MED-002
    signal: Viewport meta tag not in head section
    remediation: Move viewport meta tag to <head> section
  low:
  - id: SEO-VIEW-LOW-001
    signal: Additional viewport properties not commonly needed
  positive:
  - id: SEO-VIEW-POS-001
    signal: Correct viewport configuration with width=device-width, initial-scale=1
  - id: SEO-VIEW-POS-002
    signal: Consistent viewport across all pages via shared template
procedure:
  context:
    cognitive_mode: critical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Viewport Presence Check
    description: |
      Scan all HTML files to verify viewport meta tag is present.
      Identify any pages missing the viewport configuration.
    duration_estimate: 10 min
    commands:
    - purpose: Find HTML files with viewport
      command: grep -l 'name="viewport"' $(find . -name '*.html')
    - purpose: Find HTML files missing viewport
      command: 'for f in $(find . -name ''*.html''); do grep -q ''viewport'' "$f" || echo "MISSING: $f";
        done'
    expected_findings:
    - List of pages with viewport meta tag
    - List of pages missing viewport meta tag
  - id: '2'
    name: Viewport Value Analysis
    description: |
      Extract and analyze viewport meta tag values across all pages.
      Verify correct settings are used.
    duration_estimate: 10 min
    commands:
    - purpose: Extract viewport values
      command: grep -oh 'content="[^"]*"' $(grep -l 'name="viewport"' $(find . -name '*.html'))
    - purpose: Check for device-width
      command: grep -r 'viewport' --include='*.html' . | grep -v 'device-width'
    expected_findings:
    - Viewport configuration values
    - Pages with non-standard viewport settings
  - id: '3'
    name: Zoom Restriction Check
    description: |
      Identify pages that restrict user zoom capability through
      user-scalable=no or maximum-scale=1.0.
    duration_estimate: 10 min
    commands:
    - purpose: Find zoom restrictions
      command: grep -rE 'user-scalable\s*=\s*["']?no|maximum-scale\s*=\s*1[^0-9]' --include='*.html' .
    expected_findings:
    - Pages with zoom restrictions
    - Accessibility impact assessment
  - id: '4'
    name: Template Analysis
    description: |
      Identify where viewport configuration is defined (individual
      pages vs shared templates) to ensure consistency.
    duration_estimate: 10 min
    commands:
    - purpose: Find base/layout templates
      command: find . -name '*.html' | xargs grep -l 'viewport' | grep -iE 'base|layout|head|template'
    expected_findings:
    - Template structure for viewport configuration
    - Consistency assessment
  - id: '5'
    name: Lighthouse Verification
    description: |
      Run Lighthouse viewport audit to verify configuration
      passes Google's requirements.
    duration_estimate: 5 min
    commands:
    - purpose: Run Lighthouse viewport audit
      command: lighthouse --only-audits=viewport --output=json URL
    expected_findings:
    - Lighthouse viewport audit pass/fail
    - Any specific issues flagged
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Viewport Configuration Status
    - Pages Requiring Updates
    - Accessibility Concerns
    - Recommendations
  confidence_guidance:
    high: Direct code analysis with Lighthouse verification
    medium: Code analysis without runtime verification
    low: Partial file coverage
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: mdn-viewport
      priority: required
    - source_id: google-viewport
      priority: required
profiles:
  membership:
    quick:
      included: true
      reason: Critical mobile-friendliness requirement, fast to audit
    full:
      included: true
      priority: 1
closeout_checklist:
- id: viewport-configuration-001
  item: Viewport meta tag present on all HTML pages
  level: CRITICAL
  verification: 'for f in $(find . -name ''*.html''); do grep -q ''viewport'' "$f" || echo "FAIL: $f";
    done'
  expected: No output (all files have viewport)
- id: viewport-configuration-002
  item: Viewport uses width=device-width
  level: CRITICAL
  verification: grep -r 'viewport' --include='*.html' . | grep -v 'device-width' | wc -l
  expected: '0'
- id: viewport-configuration-003
  item: No zoom restrictions (user-scalable=no)
  level: BLOCKING
  verification: grep -r 'user-scalable.*no' --include='*.html' . | wc -l
  expected: '0'
- id: viewport-configuration-004
  item: Lighthouse viewport audit passes
  level: WARNING
  verification: lighthouse --only-audits=viewport --output=json URL | jq '.audits.viewport.score'
  expected: '1'
governance:
  applicable_to:
    archetypes:
    - web-application
    - marketing-site
    - e-commerce
    - saas
  compliance_frameworks:
  - framework: WCAG 2.1
    controls:
    - 1.4.4
    - 1.4.10
relationships:
  commonly_combined:
  - seo-discoverability.mobile-seo.mobile-friendliness
  - seo-discoverability.mobile-seo.responsive-design
  - accessibility.zoom.pinch-zoom
