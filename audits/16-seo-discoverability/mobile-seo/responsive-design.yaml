# ============================================================
# AUDIT: Responsive Design
# ============================================================
# Evaluates responsive web design implementation for optimal
# display across all device sizes and screen resolutions.

audit:
  id: "seo-discoverability.mobile-seo.responsive-design"

  name: "Responsive Design Implementation Audit"

  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "seo-discoverability"
  category_number: 16
  subcategory: "mobile-seo"

  tier: "expert"
  estimated_duration: "3 hours"

  completeness: "complete"
  requires_runtime: true
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "codebase"

  default_profiles:
    - "full"
    - "production"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    This audit comprehensively evaluates responsive web design implementation,
    including CSS media queries, fluid grids, flexible images, breakpoint
    strategy, and layout adaptability. It examines how content reflows and
    adapts across mobile, tablet, and desktop viewports to ensure consistent
    user experience and SEO performance.

  why_it_matters: |
    Responsive design is fundamental to mobile-first indexing success. Google
    evaluates how well content adapts to different screen sizes when determining
    rankings. Poorly implemented responsive design leads to layout shifts,
    content clipping, and user frustration. Sites with broken responsive
    layouts see higher bounce rates on mobile and lower engagement metrics
    that negatively impact SEO rankings.

  when_to_run:
    - "During frontend development and code review"
    - "Before major design or layout changes"
    - "When Core Web Vitals CLS scores are poor"
    - "When mobile engagement metrics decline"

prerequisites:
  required_artifacts:
    - type: "source_code"
      description: "HTML/CSS/JS source code for responsive pattern analysis"
    - type: "deployed_website"
      description: "Live site for visual responsive testing"

  access_requirements:
    - "Source code repository access"
    - "Staging or production URL access"
    - "Chrome DevTools or similar for device simulation"

discovery:
  code_patterns:
    - pattern: "@media\\s*\\(\\s*(min|max)-width\\s*:"
      type: "regex"
      scope: "source"
      purpose: "Identify breakpoint definitions"
    - pattern: "display:\\s*(flex|grid)"
      type: "regex"
      scope: "source"
      purpose: "Detect modern layout systems"
    - pattern: "(width|height):\\s*[0-9]+px"
      type: "regex"
      scope: "source"
      purpose: "Find fixed dimensions that may break responsiveness"
    - pattern: "vw|vh|%|rem|em"
      type: "regex"
      scope: "source"
      purpose: "Identify relative/fluid units"
    - pattern: "srcset|sizes"
      type: "regex"
      scope: "source"
      purpose: "Detect responsive image implementations"

  file_patterns:
    - glob: "**/*.css"
      purpose: "CSS files for media query and layout analysis"
    - glob: "**/*.scss"
      purpose: "SCSS source files for preprocessor patterns"
    - glob: "**/*.less"
      purpose: "LESS source files for preprocessor patterns"
    - glob: "**/tailwind.config.*"
      purpose: "Tailwind CSS configuration for breakpoint analysis"

knowledge_sources:
  specifications:
    - id: "css-media-queries"
      name: "CSS Media Queries Level 4"
      url: "https://www.w3.org/TR/mediaqueries-4/"
      offline_cache: true
      priority: "required"
    - id: "css-flexbox"
      name: "CSS Flexible Box Layout"
      url: "https://www.w3.org/TR/css-flexbox-1/"
      offline_cache: true
      priority: "recommended"

  guides:
    - id: "web-dev-responsive"
      name: "Responsive Web Design Basics"
      url: "https://web.dev/responsive-web-design-basics/"
      offline_cache: true
    - id: "mdn-responsive"
      name: "MDN Responsive Design Guide"
      url: "https://developer.mozilla.org/en-US/docs/Learn/CSS/CSS_layout/Responsive_Design"
      offline_cache: true

tooling:
  static_analysis:
    - tool: "Stylelint"
      purpose: "CSS linting for responsive patterns"
      offline_capable: true
    - tool: "PurgeCSS"
      purpose: "Identify unused CSS including dead media queries"
      offline_capable: true

  infrastructure_tools:
    - tool: "Chrome DevTools Device Mode"
      purpose: "Simulate various device viewports"
      command: "Open DevTools > Toggle Device Toolbar (Ctrl+Shift+M)"
    - tool: "Responsively App"
      purpose: "View multiple viewports simultaneously"
      command: "responsively https://example.com"

  scripts:
    - id: "breakpoint-analyzer"
      language: "bash"
      purpose: "Extract and list all breakpoint definitions"
      source: "inline"
      code: |
        #!/bin/bash
        grep -rhoE '@media[^{]+' --include='*.css' . | \
        grep -oE '(min|max)-width:\s*[0-9]+px' | \
        sort | uniq -c | sort -rn

signals:
  critical:
    - id: "SEO-RESP-CRIT-001"
      signal: "No responsive breakpoints defined"
      evidence_pattern: "No @media queries found in CSS"
      explanation: |
        Without media queries, the site cannot adapt to different screen
        sizes. This is a fundamental responsive design failure that will
        cause mobile rendering issues.
      remediation: "Implement mobile-first media queries at standard breakpoints (576px, 768px, 992px, 1200px)"
    - id: "SEO-RESP-CRIT-002"
      signal: "Layout breaks at common viewport widths"
      evidence_pattern: "Content overflow or horizontal scroll at 320px-768px widths"
      explanation: |
        Broken layouts on mobile devices directly impact user experience
        and trigger Google's mobile usability errors, harming rankings.
      remediation: "Test and fix layouts at all common breakpoints"

  high:
    - id: "SEO-RESP-HIGH-001"
      signal: "Inconsistent breakpoint strategy"
      explanation: |
        Using inconsistent breakpoints across the codebase creates
        layout inconsistencies and maintenance difficulties.
      remediation: "Standardize on a consistent breakpoint system (e.g., Bootstrap, Tailwind)"
    - id: "SEO-RESP-HIGH-002"
      signal: "Images not responsive"
      explanation: |
        Fixed-width images cause layout issues and waste bandwidth
        on mobile devices, impacting both UX and page speed.
      remediation: "Use srcset/sizes attributes and max-width: 100% for images"

  medium:
    - id: "SEO-RESP-MED-001"
      signal: "Excessive breakpoint proliferation"
      remediation: "Consolidate breakpoints to 4-6 standard widths"
    - id: "SEO-RESP-MED-002"
      signal: "Desktop-first instead of mobile-first approach"
      remediation: "Refactor to mobile-first using min-width media queries"

  low:
    - id: "SEO-RESP-LOW-001"
      signal: "No container queries for component-level responsiveness"

  positive:
    - id: "SEO-RESP-POS-001"
      signal: "Modern CSS Grid and Flexbox layout patterns detected"
    - id: "SEO-RESP-POS-002"
      signal: "Mobile-first approach with min-width media queries"

procedure:
  context:
    cognitive_mode: "evaluative"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Breakpoint Inventory"
      description: |
        Catalog all media query breakpoints used across the codebase.
        Identify the breakpoint strategy and any inconsistencies.
      duration_estimate: "30 min"

      commands:
        - purpose: "Extract all breakpoint definitions"
          command: "grep -rhoE '@media[^{]+' --include='*.css' --include='*.scss' . | sort | uniq -c | sort -rn"
        - purpose: "Check for Tailwind/Bootstrap configuration"
          command: "cat tailwind.config.js 2>/dev/null || cat bootstrap.scss 2>/dev/null"

      expected_findings:
        - "Complete list of breakpoints in use"
        - "Breakpoint consistency assessment"

    - id: "2"
      name: "Layout System Analysis"
      description: |
        Analyze the CSS layout systems in use (Flexbox, Grid, floats).
        Identify modern vs. legacy layout patterns.
      duration_estimate: "30 min"

      commands:
        - purpose: "Find flexbox usage"
          command: "grep -rc 'display:\\s*flex' --include='*.css' . | grep -v ':0$'"
        - purpose: "Find grid usage"
          command: "grep -rc 'display:\\s*grid' --include='*.css' . | grep -v ':0$'"
        - purpose: "Find legacy float layouts"
          command: "grep -rc 'float:\\s*(left|right)' --include='*.css' . | grep -v ':0$'"

      expected_findings:
        - "Layout system distribution"
        - "Legacy patterns requiring modernization"

    - id: "3"
      name: "Fixed Dimension Audit"
      description: |
        Identify elements with fixed pixel dimensions that may
        break responsive layouts on smaller screens.
      duration_estimate: "30 min"

      commands:
        - purpose: "Find fixed widths over 300px"
          command: "grep -rE 'width:\\s*[3-9][0-9]{2,}px|width:\\s*[0-9]{4,}px' --include='*.css' ."
        - purpose: "Find fixed heights"
          command: "grep -rE 'height:\\s*[0-9]+px' --include='*.css' . | head -30"

      expected_findings:
        - "Fixed dimensions requiring conversion to relative units"
        - "Container width constraints"

    - id: "4"
      name: "Responsive Image Analysis"
      description: |
        Verify images implement responsive patterns using srcset,
        sizes attributes, or CSS-based responsive techniques.
      duration_estimate: "25 min"

      commands:
        - purpose: "Find img tags without srcset"
          command: "grep -rE '<img[^>]+src=' --include='*.html' . | grep -v srcset | head -20"
        - purpose: "Find responsive image patterns"
          command: "grep -r 'srcset' --include='*.html' . | head -10"

      expected_findings:
        - "Image responsiveness coverage"
        - "Images requiring srcset implementation"

    - id: "5"
      name: "Visual Viewport Testing"
      description: |
        Test the site visually at key breakpoints to identify
        layout issues not detectable through code analysis.
      duration_estimate: "45 min"

      questions:
        - "Does layout adapt properly at 320px (small mobile)?"
        - "Does layout adapt properly at 768px (tablet)?"
        - "Does layout adapt properly at 1024px (small desktop)?"
        - "Are there any content overlaps or clipping issues?"
        - "Does navigation work well at all breakpoints?"

      expected_findings:
        - "Visual breakpoint issues"
        - "Navigation and interactive element adaptation"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Breakpoint Analysis"
        - "Layout System Assessment"
        - "Critical Layout Issues"
        - "Recommendations"

  confidence_guidance:
    high: "Visual testing confirms layout behavior at all breakpoints"
    medium: "Code analysis indicates patterns without visual verification"
    low: "Inference based on limited code samples"

offline:
  capability: "partial"

  cache_manifest:
    knowledge:
      - source_id: "css-media-queries"
        priority: "required"
      - source_id: "web-dev-responsive"
        priority: "recommended"

profiles:
  membership:
    quick:
      included: false
      reason: "Requires comprehensive visual testing"
    full:
      included: true
      priority: 2

closeout_checklist:
  - id: "responsive-design-001"
    item: "Media queries present for mobile, tablet, and desktop"
    level: "CRITICAL"
    verification: "grep -qE '@media.*min-width|@media.*max-width' styles.css && echo PASS || echo FAIL"
    expected: "PASS"

  - id: "responsive-design-002"
    item: "No horizontal scroll at mobile viewport widths"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Test at 320px, 375px, 414px viewport widths"
    expected: "Confirmed by reviewer"

  - id: "responsive-design-003"
    item: "Images use responsive techniques"
    level: "BLOCKING"
    verification: "grep -qE 'srcset|max-width:\\s*100%' index.html && echo PASS || echo FAIL"
    expected: "PASS"

  - id: "responsive-design-004"
    item: "Consistent breakpoint strategy across codebase"
    level: "WARNING"
    verification: "manual"
    verification_notes: "Review breakpoint definitions for consistency"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["web-application", "marketing-site", "e-commerce", "saas"]

  compliance_frameworks:
    - framework: "WCAG 2.1"
      controls: ["1.4.10"]

relationships:
  commonly_combined:
    - "seo-discoverability.mobile-seo.mobile-friendliness"
    - "seo-discoverability.mobile-seo.viewport-configuration"
    - "performance.core-web-vitals.cls"
