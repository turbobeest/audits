# ============================================================
# AUDIT: Orphan Page Detection
# ============================================================
# Evaluates pages without internal links that are difficult
# for search engines and users to discover.

audit:
  id: "seo-discoverability.content-discovery.orphan-page"

  name: "Orphan Page Detection Audit"

  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "seo-discoverability"
  category_number: 16
  subcategory: "content-discovery"

  tier: "expert"
  estimated_duration: "2 hours"

  completeness: "complete"
  requires_runtime: true
  destructive: false

execution:
  automatable: "yes"
  severity: "high"
  scope: "codebase"

  default_profiles:
    - "full"
    - "production"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    This audit identifies orphan pages - pages that exist on the site but
    have no internal links pointing to them. It compares crawl data with
    sitemap URLs, log file analysis, and analytics data to find pages that
    are discoverable only via direct URL or external links, not through
    normal site navigation.

  why_it_matters: |
    Orphan pages are difficult for search engines to discover and crawl
    efficiently. Without internal links, these pages receive no link equity
    from the rest of the site and are often deprioritized in Google's crawl
    and index. Users cannot find orphan pages through navigation, meaning
    valuable content may be effectively hidden. Orphan pages also indicate
    poor information architecture.

  when_to_run:
    - "After site migrations or restructuring"
    - "When content is not being indexed"
    - "During information architecture audits"
    - "After large content additions"

prerequisites:
  required_artifacts:
    - type: "deployed_website"
      description: "Live site for crawl analysis"
    - type: "sitemap"
      description: "XML sitemap for URL inventory"
    - type: "server_logs"
      description: "Server logs for discovered URLs (optional)"

  access_requirements:
    - "Full site crawl access"
    - "XML sitemap access"
    - "Server log access (optional but recommended)"
    - "Google Analytics access (optional)"

discovery:
  file_patterns:
    - glob: "**/sitemap*.xml"
      purpose: "URL inventory from sitemaps"
    - glob: "**/access*.log"
      purpose: "Server logs for URL discovery"

  metrics_queries:
    - system: "Google Analytics"
      query: "All pages report"
      purpose: "Find pages with traffic but no internal links"
      threshold: "Pages with sessions but not in crawl"

knowledge_sources:
  specifications:
    - id: "google-crawl"
      name: "Google Crawl Budget Documentation"
      url: "https://developers.google.com/search/docs/crawling-indexing/large-site-managing-crawl-budget"
      offline_cache: true
      priority: "required"

  guides:
    - id: "orphan-pages"
      name: "Orphan Pages SEO Guide"
      url: "https://www.semrush.com/blog/orphan-pages/"
      offline_cache: true
    - id: "internal-linking"
      name: "Internal Linking Best Practices"
      url: "https://ahrefs.com/blog/internal-links-for-seo/"
      offline_cache: true

tooling:
  static_analysis:
    - tool: "Screaming Frog"
      purpose: "Crawl and compare with sitemap for orphans"
      offline_capable: false
    - tool: "Sitebulb"
      purpose: "Orphan page visualization"
      offline_capable: false

  infrastructure_tools:
    - tool: "Log analyzer"
      purpose: "Find URLs accessed but not in crawl"
      command: "grep -oE 'GET /[^ ]+' access.log | sort | uniq"

  scripts:
    - id: "orphan-finder"
      language: "bash"
      purpose: "Compare sitemap URLs with crawled URLs"
      source: "inline"
      code: |
        #!/bin/bash
        # Extract URLs from sitemap
        curl -s $SITEMAP_URL | \
        grep -oE '<loc>[^<]+</loc>' | \
        sed 's/<[^>]*>//g' | \
        sort > sitemap_urls.txt

        echo "Sitemap URLs: $(wc -l < sitemap_urls.txt)"
        # Compare with crawl data to find orphans

signals:
  critical:
    - id: "SEO-ORPH-CRIT-001"
      signal: "High-value pages with zero internal links"
      evidence_indicators:
        - "Pages targeting important keywords with no inlinks"
        - "Landing pages only accessible via external links"
      explanation: |
        Valuable pages without internal links cannot benefit from site
        authority and are unlikely to rank well despite quality content.
        This represents significant missed opportunity.
      remediation: "Add internal links from relevant pages throughout the site"
    - id: "SEO-ORPH-CRIT-002"
      signal: "Large percentage of indexed pages are orphans"
      evidence_threshold: "More than 20% of pages are orphans"
      explanation: |
        A high orphan rate indicates systemic information architecture
        problems that affect site-wide crawling and ranking ability.
      remediation: "Restructure navigation and implement comprehensive internal linking"

  high:
    - id: "SEO-ORPH-HIGH-001"
      signal: "Sitemap URLs not discovered through crawl"
      explanation: |
        URLs in the sitemap that cannot be reached through crawling
        are effectively orphans relying solely on sitemap for discovery.
      remediation: "Add internal links to make pages crawlable"
    - id: "SEO-ORPH-HIGH-002"
      signal: "Pages receiving traffic but not in navigation"
      explanation: |
        Pages receiving traffic from search or external links but not
        linked internally are missing optimization opportunities.
      remediation: "Integrate pages into site structure with relevant links"

  medium:
    - id: "SEO-ORPH-MED-001"
      signal: "Blog posts with only single category link"
      remediation: "Add related posts links and contextual links within content"
    - id: "SEO-ORPH-MED-002"
      signal: "Product pages only linked from category listing"
      remediation: "Add related products, recently viewed, and cross-sell links"

  low:
    - id: "SEO-ORPH-LOW-001"
      signal: "Utility pages (terms, privacy) with minimal links"

  positive:
    - id: "SEO-ORPH-POS-001"
      signal: "All important pages have multiple internal links"
    - id: "SEO-ORPH-POS-002"
      signal: "Comprehensive related content linking throughout site"

procedure:
  context:
    cognitive_mode: "critical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "URL Inventory Collection"
      description: |
        Gather complete URL inventory from sitemap, crawl,
        analytics, and server logs.
      duration_estimate: "25 min"

      commands:
        - purpose: "Extract sitemap URLs"
          command: "curl -s $SITEMAP_URL | grep -oE '<loc>[^<]+</loc>' | sed 's/<[^>]*>//g' > sitemap_urls.txt"

      expected_findings:
        - "Complete URL inventory"
        - "URL source comparison"

    - id: "2"
      name: "Crawl vs Sitemap Comparison"
      description: |
        Compare URLs found through crawling with sitemap
        URLs to identify orphans.
      duration_estimate: "25 min"

      questions:
        - "Which sitemap URLs were not discovered through crawl?"
        - "How many pages are only accessible via sitemap?"

      expected_findings:
        - "Orphan page list"
        - "Orphan rate calculation"

    - id: "3"
      name: "Internal Link Analysis"
      description: |
        Analyze internal link distribution to identify pages
        with low or no inbound internal links.
      duration_estimate: "30 min"

      questions:
        - "How many internal links point to each page?"
        - "Which pages have zero internal links?"
        - "Is there a correlation between inlinks and rankings?"

      expected_findings:
        - "Internal link distribution"
        - "Pages needing more internal links"

    - id: "4"
      name: "Traffic Analysis for Orphans"
      description: |
        Check analytics to see if orphan pages receive
        any traffic (indicating external discovery).
      duration_estimate: "20 min"

      questions:
        - "Do orphan pages receive organic traffic?"
        - "What are the traffic sources for orphan pages?"
        - "Are orphan pages converting despite isolation?"

      expected_findings:
        - "Orphan page traffic assessment"
        - "Value prioritization"

    - id: "5"
      name: "Remediation Planning"
      description: |
        Develop linking strategy to integrate orphan pages
        into site structure.
      duration_estimate: "20 min"

      questions:
        - "Where should links to orphan pages be added?"
        - "Are there opportunities for related content modules?"
        - "Should any orphan pages be removed/redirected?"

      expected_findings:
        - "Linking strategy for each orphan"
        - "Implementation priority"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Orphan Page Inventory"
        - "Internal Link Analysis"
        - "Traffic Impact Assessment"
        - "Linking Recommendations"

  confidence_guidance:
    high: "Complete crawl/sitemap/analytics comparison"
    medium: "Crawl and sitemap comparison only"
    low: "Partial URL analysis"

offline:
  capability: "partial"

  cache_manifest:
    knowledge:
      - source_id: "google-crawl"
        priority: "required"

profiles:
  membership:
    quick:
      included: false
      reason: "Requires comprehensive crawl comparison"
    full:
      included: true
      priority: 2

closeout_checklist:
  - id: "orphan-page-001"
    item: "All sitemap URLs discovered through crawl"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Compare crawl data with sitemap URLs"
    expected: "100% coverage"

  - id: "orphan-page-002"
    item: "High-value orphan pages integrated into navigation"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Verify internal links added to priority orphans"
    expected: "Confirmed by reviewer"

  - id: "orphan-page-003"
    item: "Orphan rate below 10%"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Calculate percentage of orphan pages"
    expected: "< 10%"

  - id: "orphan-page-004"
    item: "Related content linking implemented"
    level: "WARNING"
    verification: "manual"
    verification_notes: "Verify related posts/products modules exist"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["web-application", "marketing-site", "e-commerce", "blog"]

  compliance_frameworks:
    - framework: "Google Webmaster Guidelines"
      controls: ["Crawlability", "Internal Linking"]

relationships:
  commonly_combined:
    - "seo-discoverability.content-discovery.thin-content"
    - "seo-discoverability.link-authority.internal-link-equity"
    - "seo-discoverability.technical-seo.sitemap"
