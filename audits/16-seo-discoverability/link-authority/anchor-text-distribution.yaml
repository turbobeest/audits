# ============================================================
# AUDIT: Anchor Text Distribution
# ============================================================
# Evaluates anchor text patterns in internal and external links
# for SEO optimization and natural link profile.

audit:
  id: "seo-discoverability.link-authority.anchor-text-distribution"

  name: "Anchor Text Distribution Audit"

  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "seo-discoverability"
  category_number: 16
  subcategory: "link-authority"

  tier: "expert"
  estimated_duration: "2 hours"

  completeness: "complete"
  requires_runtime: true
  destructive: false

execution:
  automatable: "partial"
  severity: "medium"
  scope: "codebase"

  default_profiles:
    - "full"
    - "production"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    This audit analyzes anchor text distribution across internal and external
    links to ensure a natural, diverse pattern that supports SEO without
    triggering manipulation signals. It examines exact-match vs branded vs
    natural anchor ratios, over-optimization patterns, and anchor text
    relevance to target pages.

  why_it_matters: |
    Anchor text provides context to search engines about the content of
    linked pages. Over-optimized anchor text (excessive exact-match keyword
    anchors) can trigger algorithmic penalties as it signals manipulation.
    Conversely, descriptive anchor text helps pages rank for relevant terms.
    A natural anchor text profile includes branded, generic, naked URL, and
    contextually varied anchors alongside targeted keywords.

  when_to_run:
    - "During link building strategy reviews"
    - "When rankings drop after algorithm updates"
    - "During backlink profile audits"
    - "When implementing internal linking strategies"

prerequisites:
  required_artifacts:
    - type: "deployed_website"
      description: "Live site for anchor text extraction"
    - type: "backlink_data"
      description: "External backlink data with anchor text"

  access_requirements:
    - "Full site crawl access"
    - "SEO tool access for backlink anchor data"
    - "Google Search Console access"

discovery:
  code_patterns:
    - pattern: "<a[^>]*>([^<]+)</a>"
      type: "regex"
      scope: "source"
      purpose: "Extract anchor text content"
    - pattern: "<a[^>]*href=[\"']([^\"']+)[\"'][^>]*>([^<]+)</a>"
      type: "regex"
      scope: "source"
      purpose: "Extract anchor text with destination"

  file_patterns:
    - glob: "**/*.html"
      purpose: "HTML files for anchor text extraction"

knowledge_sources:
  specifications:
    - id: "google-anchor"
      name: "Google Anchor Text Guidance"
      url: "https://developers.google.com/search/docs/crawling-indexing/links-crawlable"
      offline_cache: true
      priority: "required"

  guides:
    - id: "anchor-text-seo"
      name: "Anchor Text Optimization Guide"
      url: "https://ahrefs.com/blog/anchor-text/"
      offline_cache: true
    - id: "natural-anchor"
      name: "Natural Anchor Text Distribution"
      url: "https://moz.com/blog/anchor-text-optimization"
      offline_cache: true

tooling:
  static_analysis:
    - tool: "Screaming Frog"
      purpose: "Extract and categorize anchor text"
      offline_capable: false
    - tool: "Ahrefs"
      purpose: "External anchor text analysis"
      offline_capable: false

  scripts:
    - id: "anchor-extractor"
      language: "bash"
      purpose: "Extract anchor text from page"
      source: "inline"
      code: |
        #!/bin/bash
        # Extract anchor text
        curl -s $URL | \
        grep -oE '<a[^>]*>[^<]+</a>' | \
        sed 's/<[^>]*>//g' | \
        sort | uniq -c | sort -rn | head -30

signals:
  critical:
    - id: "SEO-ANCH-CRIT-001"
      signal: "Excessive exact-match keyword anchor text"
      evidence_threshold: "> 30% exact-match keyword anchors"
      explanation: |
        Over-optimization of anchor text with exact-match keywords is a
        strong manipulation signal that can trigger Penguin-style algorithmic
        penalties, causing significant ranking drops.
      remediation: "Diversify anchor text with branded, generic, and natural variations"
    - id: "SEO-ANCH-CRIT-002"
      signal: "Sudden spike in specific anchor text pattern"
      evidence_pattern: "Unnatural concentration of similar anchors"
      explanation: |
        A sudden increase in specific anchor text patterns (especially
        exact-match keywords) signals artificial link building and can
        trigger penalties.
      remediation: "Diversify anchor text in new link building, disavow manipulative links"

  high:
    - id: "SEO-ANCH-HIGH-001"
      signal: "Generic anchor text dominating internal links"
      explanation: |
        Using \"click here\", \"learn more\", or \"read more\" as anchor
        text wastes the opportunity to provide context about linked content.
      remediation: "Use descriptive anchor text that includes relevant keywords naturally"
    - id: "SEO-ANCH-HIGH-002"
      signal: "No branded anchor text in backlink profile"
      explanation: |
        Natural link profiles include branded anchors (company name, product
        names). Lack of branded anchors suggests unnatural link patterns.
      remediation: "Include branded terms in anchor text strategy"

  medium:
    - id: "SEO-ANCH-MED-001"
      signal: "Image links without alt text (empty anchor)"
      remediation: "Add descriptive alt text to linked images"
    - id: "SEO-ANCH-MED-002"
      signal: "Inconsistent anchor text for same target page"
      remediation: "Develop consistent but varied anchor text patterns for key pages"

  low:
    - id: "SEO-ANCH-LOW-001"
      signal: "Anchor text longer than reasonable length"

  positive:
    - id: "SEO-ANCH-POS-001"
      signal: "Natural anchor text distribution with appropriate diversity"
    - id: "SEO-ANCH-POS-002"
      signal: "Descriptive, contextual internal link anchors"

procedure:
  context:
    cognitive_mode: "evaluative"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Internal Anchor Text Extraction"
      description: |
        Extract and categorize anchor text from internal links
        across the site.
      duration_estimate: "30 min"

      commands:
        - purpose: "Extract internal anchors"
          command: "curl -s $URL | grep -oE '<a[^>]*href=\"/[^\"]*\"[^>]*>[^<]+</a>' | sed 's/<[^>]*>//g'"

      expected_findings:
        - "Internal anchor text inventory"
        - "Pattern identification"

    - id: "2"
      name: "Anchor Text Categorization"
      description: |
        Categorize anchor text into types: branded, exact-match,
        partial-match, generic, naked URL, and compound.
      duration_estimate: "25 min"

      questions:
        - "What percentage is branded anchor text?"
        - "What percentage is exact-match keyword?"
        - "What percentage is generic (click here, etc.)?"
        - "What percentage is naked URL?"

      expected_findings:
        - "Anchor type distribution"
        - "Over-optimization assessment"

    - id: "3"
      name: "External Backlink Anchor Analysis"
      description: |
        Analyze anchor text distribution from external
        backlinks using SEO tools.
      duration_estimate: "30 min"

      questions:
        - "What are the top anchor texts from backlinks?"
        - "Is there over-concentration on specific terms?"
        - "How does distribution compare to competitors?"

      expected_findings:
        - "External anchor distribution"
        - "Risk assessment"

    - id: "4"
      name: "Page-Level Anchor Analysis"
      description: |
        Examine anchor text pointing to key target pages
        for optimization balance.
      duration_estimate: "20 min"

      questions:
        - "What anchors point to homepage?"
        - "What anchors point to money pages?"
        - "Are target keywords represented appropriately?"

      expected_findings:
        - "Page-level anchor analysis"
        - "Optimization opportunities"

    - id: "5"
      name: "Recommendations Development"
      description: |
        Develop anchor text strategy recommendations based
        on findings.
      duration_estimate: "15 min"

      questions:
        - "What anchors should be diversified?"
        - "What internal linking improvements are needed?"
        - "Are there manipulation risks to address?"

      expected_findings:
        - "Strategic recommendations"
        - "Implementation guidance"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Anchor Text Distribution Analysis"
        - "Internal Link Anchor Review"
        - "External Backlink Anchor Review"
        - "Optimization Recommendations"

  confidence_guidance:
    high: "Complete internal crawl and external backlink data analysis"
    medium: "Internal analysis with limited external data"
    low: "Sample page analysis only"

offline:
  capability: "partial"

  cache_manifest:
    knowledge:
      - source_id: "google-anchor"
        priority: "required"

profiles:
  membership:
    quick:
      included: false
      reason: "Requires comprehensive anchor text analysis"
    full:
      included: true
      priority: 2

closeout_checklist:
  - id: "anchor-text-distribution-001"
    item: "Exact-match anchor text below 25%"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Calculate exact-match percentage from backlink data"
    expected: "< 25%"

  - id: "anchor-text-distribution-002"
    item: "Natural anchor text diversity"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Verify mix of branded, generic, and natural anchors"
    expected: "Confirmed by reviewer"

  - id: "anchor-text-distribution-003"
    item: "Internal links use descriptive anchors"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Review internal link anchor text for generic patterns"
    expected: "< 20% generic anchors"

  - id: "anchor-text-distribution-004"
    item: "Image links have alt text"
    level: "WARNING"
    verification: "manual"
    verification_notes: "Verify linked images have descriptive alt attributes"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["marketing-site", "e-commerce", "blog", "saas"]

  compliance_frameworks:
    - framework: "Google Webmaster Guidelines"
      controls: ["Link Schemes"]

relationships:
  commonly_combined:
    - "seo-discoverability.link-authority.backlink-quality"
    - "seo-discoverability.link-authority.internal-link-equity"
    - "seo-discoverability.on-page.keyword-optimization"
