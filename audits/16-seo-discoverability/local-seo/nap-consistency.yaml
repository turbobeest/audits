# ============================================================
# AUDIT: NAP Consistency
# ============================================================
# Evaluates Name, Address, Phone consistency across all
# platforms for local SEO optimization.

audit:
  id: "seo-discoverability.local-seo.nap-consistency"

  name: "NAP Consistency Audit"

  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "seo-discoverability"
  category_number: 16
  subcategory: "local-seo"

  tier: "expert"
  estimated_duration: "2 hours"

  completeness: "complete"
  requires_runtime: true
  destructive: false

execution:
  automatable: "partial"
  severity: "critical"
  scope: "qualitative"

  default_profiles:
    - "full"
    - "production"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    This audit evaluates Name, Address, and Phone (NAP) consistency across
    the website, Google Business Profile, social media, directories, and
    all online mentions. It examines formatting consistency, abbreviation
    usage, phone number formatting, and address standardization to ensure
    search engines can confidently connect all mentions to the same business.

  why_it_matters: |
    NAP consistency is a fundamental local ranking factor. Search engines
    use NAP matching to validate business legitimacy and connect citations.
    Inconsistent NAP creates confusion - Google may not recognize mentions
    as the same business, diluting local ranking signals. Even minor
    variations (St vs Street, LLC vs not) can impact citation recognition.

  when_to_run:
    - "After any business information changes"
    - "When local rankings decline"
    - "Before citation building campaigns"
    - "Monthly consistency checks"

prerequisites:
  required_artifacts:
    - type: "canonical_nap"
      description: "Authoritative business name, address, and phone"
    - type: "website"
      description: "Business website for NAP verification"

  access_requirements:
    - "Website access"
    - "Google Business Profile access"
    - "Citation tracking tool (optional)"

discovery:
  code_patterns:
    - pattern: "\\+?1?[-\\s.]?\\(?\\d{3}\\)?[-\\s.]?\\d{3}[-\\s.]?\\d{4}"
      type: "regex"
      scope: "source"
      purpose: "Detect phone number formats"
    - pattern: "LocalBusiness|Organization"
      type: "keyword"
      scope: "source"
      purpose: "Detect schema markup with NAP"

  file_patterns:
    - glob: "**/contact*"
      purpose: "Contact pages with NAP"
    - glob: "**/footer*"
      purpose: "Footer with NAP"
    - glob: "**/about*"
      purpose: "About pages with NAP"

knowledge_sources:
  specifications:
    - id: "usps-addressing"
      name: "USPS Addressing Standards"
      url: "https://pe.usps.com/text/pub28/welcome.htm"
      offline_cache: true
      priority: "required"
    - id: "schema-local"
      name: "Schema.org LocalBusiness"
      url: "https://schema.org/LocalBusiness"
      offline_cache: true
      priority: "required"

  guides:
    - id: "nap-consistency"
      name: "NAP Consistency Guide"
      url: "https://www.brightlocal.com/learn/nap-consistency/"
      offline_cache: true
    - id: "local-seo-guide"
      name: "Local SEO NAP Best Practices"
      url: "https://moz.com/blog/the-importance-of-nap-consistency"
      offline_cache: true

tooling:
  assessment_tools:
    - tool: "BrightLocal"
      purpose: "NAP consistency checking"
    - tool: "Moz Local"
      purpose: "Citation and NAP verification"

  scripts:
    - id: "nap-extractor"
      language: "bash"
      purpose: "Extract NAP from website pages"
      source: "inline"
      code: |
        #!/bin/bash
        # Extract potential phone numbers
        curl -s $URL | grep -oE '\+?1?[-\s.]?\(?[0-9]{3}\)?[-\s.]?[0-9]{3}[-\s.]?[0-9]{4}'

        # Extract schema LocalBusiness data
        curl -s $URL | grep -oE '"LocalBusiness"[^}]*}'

signals:
  critical:
    - id: "SEO-NAP-CRIT-001"
      signal: "Business name varies across platforms"
      evidence_indicators:
        - "\"ABC Company\" vs \"ABC Company LLC\" vs \"ABC Co.\""
        - "DBA name used inconsistently"
      explanation: |
        Business name inconsistencies are the most damaging NAP issue.
        Search engines may not connect listings with different names,
        splitting local ranking signals.
      remediation: "Standardize business name exactly across all platforms"
    - id: "SEO-NAP-CRIT-002"
      signal: "Address formats significantly different"
      evidence_pattern: "Street vs St, Suite vs Ste, or missing/extra address elements"
      explanation: |
        Address inconsistencies make it harder for search engines to
        match citations and can confuse users and navigation systems.
      remediation: "Standardize on USPS formatting for all addresses"

  high:
    - id: "SEO-NAP-HIGH-001"
      signal: "Phone number format varies"
      explanation: |
        Phone number format variations (parentheses, dashes, dots) create
        matching issues and reduce professional appearance.
      remediation: "Choose one phone format and use consistently"
    - id: "SEO-NAP-HIGH-002"
      signal: "Website NAP differs from GBP"
      explanation: |
        Google specifically compares website NAP with GBP. Differences
        between these two sources are particularly harmful.
      remediation: "Ensure website and GBP NAP are identical"

  medium:
    - id: "SEO-NAP-MED-001"
      signal: "Multiple locations without clear differentiation"
      remediation: "Use location-specific pages with unique NAP for each"
    - id: "SEO-NAP-MED-002"
      signal: "NAP not in structured data"
      remediation: "Add LocalBusiness schema with NAP information"

  low:
    - id: "SEO-NAP-LOW-001"
      signal: "Minor capitalization inconsistencies"

  positive:
    - id: "SEO-NAP-POS-001"
      signal: "100% NAP consistency across all platforms"
    - id: "SEO-NAP-POS-002"
      signal: "LocalBusiness schema with verified NAP"

procedure:
  context:
    cognitive_mode: "critical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Canonical NAP Establishment"
      description: |
        Define the canonical (official) NAP format that all
        platforms should match.
      duration_estimate: "15 min"

      questions:
        - "What is the exact legal business name?"
        - "What is the USPS-standardized address?"
        - "What is the primary phone number?"
        - "Should tracking phone numbers be used?"

      expected_findings:
        - "Canonical NAP definition"
        - "Format standards"

    - id: "2"
      name: "Website NAP Extraction"
      description: |
        Find and document NAP as it appears across all
        website pages (header, footer, contact, about, etc.).
      duration_estimate: "20 min"

      commands:
        - purpose: "Find NAP mentions on website"
          command: "curl -s $URL | grep -iE 'address|phone|tel:|\\+1'"

      expected_findings:
        - "Website NAP instances"
        - "Internal consistency"

    - id: "3"
      name: "GBP NAP Verification"
      description: |
        Compare Google Business Profile NAP with canonical
        and website NAP.
      duration_estimate: "15 min"

      questions:
        - "Does GBP business name match exactly?"
        - "Is GBP address formatted identically?"
        - "Is GBP phone number identical?"

      expected_findings:
        - "GBP alignment status"
        - "Discrepancies identified"

    - id: "4"
      name: "Citation NAP Audit"
      description: |
        Check NAP consistency across major citations and
        directories.
      duration_estimate: "45 min"

      questions:
        - "Is Facebook NAP consistent?"
        - "Is Yelp NAP consistent?"
        - "Are industry directory NAPs consistent?"
        - "What percentage of citations are consistent?"

      expected_findings:
        - "Citation consistency score"
        - "Platforms requiring updates"

    - id: "5"
      name: "Schema Markup Verification"
      description: |
        Verify LocalBusiness schema contains accurate NAP
        matching canonical format.
      duration_estimate: "15 min"

      commands:
        - purpose: "Extract LocalBusiness schema"
          command: "curl -s $URL | grep -oE '\"LocalBusiness\"[^}]*}' || echo 'No schema found'"

      expected_findings:
        - "Schema NAP accuracy"
        - "Schema implementation status"

    - id: "6"
      name: "Consistency Score Calculation"
      description: |
        Calculate overall NAP consistency score and
        prioritize corrections.
      duration_estimate: "10 min"

      questions:
        - "What percentage of citations are 100% consistent?"
        - "Which platforms have the most traffic/authority?"
        - "What is the correction priority order?"

      expected_findings:
        - "Overall consistency score"
        - "Prioritized correction list"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Canonical NAP Definition"
        - "Consistency Analysis"
        - "Platform-by-Platform Status"
        - "Correction Priority List"

  confidence_guidance:
    high: "Complete citation scan with manual verification"
    medium: "Core platform verification without full scan"
    low: "Spot-check only"

offline:
  capability: "partial"

  cache_manifest:
    knowledge:
      - source_id: "usps-addressing"
        priority: "required"

profiles:
  membership:
    quick:
      included: true
      reason: "NAP consistency is fundamental to local SEO"
    full:
      included: true
      priority: 1

closeout_checklist:
  - id: "nap-consistency-001"
    item: "Canonical NAP defined and documented"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Document exact name, address, and phone format"
    expected: "Documented"

  - id: "nap-consistency-002"
    item: "Website NAP matches canonical exactly"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Compare all website NAP instances to canonical"
    expected: "100% match"

  - id: "nap-consistency-003"
    item: "GBP NAP matches canonical exactly"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Compare GBP NAP to canonical"
    expected: "100% match"

  - id: "nap-consistency-004"
    item: "LocalBusiness schema includes accurate NAP"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Verify schema NAP matches canonical"
    expected: "Schema present and accurate"

governance:
  applicable_to:
    archetypes: ["local-business", "retail", "restaurant", "service-business"]

  compliance_frameworks:
    - framework: "Local SEO Best Practices"
      controls: ["NAP Consistency"]

relationships:
  commonly_combined:
    - "seo-discoverability.local-seo.local-citation"
    - "seo-discoverability.local-seo.google-business-profile"
    - "seo-discoverability.local-seo.local-schema"
