audit:
  id: reliability-resilience.error-handling.error-logging
  name: Error Logging Audit
  version: 1.0.0
  last_updated: '2026-01-18'
  status: active
  category: reliability-resilience
  category_number: 3
  subcategory: error-handling
  tier: phd
  estimated_duration: 2-4 hours  # median: 3h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: codebase
  default_profiles:
  - full
  - production
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Examines error logging practices across the codebase including
    appropriate use of log levels, inclusion of contextual information,
    structured logging formats, sensitive data handling in logs,
    and log aggregation readiness. Reviews how exceptions and errors
    are captured for operational debugging and analysis.
  why_it_matters: |
    Effective error logging is the foundation of operational visibility
    and incident response. Without proper error logs, debugging production
    issues becomes guesswork. Poor logging can also create security risks
    through sensitive data exposure or compliance violations. Well-structured
    logs enable fast root cause analysis and proactive issue detection.
  when_to_run:
  - Before production deployment
  - After significant code changes
  - Security and compliance reviews
  - When improving observability
prerequisites:
  required_artifacts:
  - type: source_code
    description: Application source code
  - type: logging_config
    description: Logging framework configuration files
  access_requirements:
  - Read access to source code repository
  - Access to logging configuration
  - 'Optional: access to log aggregation system for verification'
discovery:
  code_patterns:
  - pattern: log\.(error|Error|ERROR)\s*\(
    type: regex
    scope: source
    purpose: Find error-level logging statements
  - pattern: logger\.(error|exception|critical)
    type: regex
    scope: source
    purpose: Find logger error calls
  - pattern: console\.(error|log)\s*\(
    type: regex
    scope: source
    purpose: Find console logging (often inappropriate in production)
  - pattern: password|secret|token|apiKey|api_key|credential
    type: regex
    scope: source
    purpose: Find potential sensitive data logging
  - pattern: printStackTrace|print_exc|traceback
    type: regex
    scope: source
    purpose: Find stack trace printing patterns
  file_patterns:
  - glob: '**/logback*.xml'
    purpose: Java logging configuration
  - glob: '**/log4j*.{xml,properties}'
    purpose: Log4j configuration
  - glob: '**/logging.{yaml,yml,json,conf}'
    purpose: Generic logging configuration
  - glob: '**/*logger*.{ts,js}'
    purpose: JavaScript/TypeScript logger setup
knowledge_sources:
  guides:
  - id: owasp-logging
    name: OWASP Logging Cheat Sheet
    url: https://cheatsheetseries.owasp.org/cheatsheets/Logging_Cheat_Sheet.html
    offline_cache: true
  - id: 12-factor-logs
    name: 12-Factor App - Logs
    url: https://12factor.net/logs
    offline_cache: true
  - id: release-it
    name: Michael Nygard - Release It!
    url: https://pragprog.com/titles/mnee2/release-it-second-edition/
    offline_cache: true
  learning_resources:
  - id: observability-eng
    title: Observability Engineering
    type: book
    reference: 'ISBN: 978-1492076445'
tooling:
  static_analysis:
  - tool: SonarQube
    purpose: Detect logging anti-patterns
    offline_capable: false
  - tool: Semgrep
    purpose: Custom rules for sensitive data in logs
    offline_capable: true
  scripts:
  - id: analyze-logging
    language: bash
    purpose: Analyze logging patterns across codebase
    source: inline
    code: |
      #!/bin/bash
      echo "=== Error Level Logging ==="
      grep -rn "log.*error\|logger.*error\|LOG.*ERROR" --include="*.java" --include="*.py" --include="*.ts" --include="*.go" . 2>/dev/null | wc -l
      echo ""
      echo "=== Console Logging (may need removal) ==="
      grep -rn "console\\.log\\|console\\.error\\|print(" --include="*.ts" --include="*.js" --include="*.py" . 2>/dev/null | head -20
      echo ""
      echo "=== Potential Sensitive Data in Logs ==="
      grep -rn "log.*password\\|log.*secret\\|log.*token\\|log.*key" --include="*.java" --include="*.py" --include="*.ts" . 2>/dev/null | head -20
signals:
  critical:
  - id: LOG-CRIT-001
    signal: Sensitive data logged in plaintext
    evidence_pattern: log.*password|log.*secret|log.*token|log.*apiKey
    explanation: |
      Logging sensitive data creates security vulnerabilities and
      compliance violations. Credentials in logs can be extracted
      by attackers or accidentally exposed in debugging sessions.
    remediation: Remove sensitive data from log statements or mask/redact before logging
  - id: LOG-CRIT-002
    signal: PII logged without redaction
    evidence_pattern: log.*email|log.*ssn|log.*social.*security
    explanation: |
      Logging personally identifiable information violates privacy
      regulations (GDPR, CCPA) and creates data breach risks.
    remediation: Implement PII redaction in logging framework
  high:
  - id: LOG-HIGH-001
    signal: Errors logged without stack traces
    evidence_pattern: log\.error\([^,]+\)(?!.*exception)
    explanation: |
      Logging errors without stack traces makes debugging nearly
      impossible as the error origin cannot be determined.
    remediation: Always include exception/error object in error logs
  - id: LOG-HIGH-002
    signal: No structured logging format
    evidence_pattern: log.*\+.*\+|log.*%s|log.*\{\}
    explanation: |
      Unstructured string concatenation in logs makes parsing and
      analysis in log aggregation systems difficult or impossible.
    remediation: Use structured logging with key-value pairs or JSON format
  medium:
  - id: LOG-MED-001
    signal: Inconsistent log levels used for errors
    remediation: Establish and enforce log level guidelines
  - id: LOG-MED-002
    signal: Missing correlation IDs in logs
    remediation: Include request/trace IDs in all log statements
  - id: LOG-MED-003
    signal: Console.log used in production code
    evidence_pattern: console\.log|System\.out\.print
    remediation: Replace console output with proper logging framework
  low:
  - id: LOG-LOW-001
    signal: Verbose logging in non-debug paths
  positive:
  - id: LOG-POS-001
    signal: Consistent structured logging with correlation IDs
  - id: LOG-POS-002
    signal: Centralized logging configuration with appropriate levels
procedure:
  context:
    cognitive_mode: critical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Inventory logging infrastructure
    description: |
      Identify logging frameworks in use, configuration files,
      and log output destinations.
    duration_estimate: 30 min
    commands:
    - purpose: Find logging configuration files
      command: find . -name '*log*' -type f \( -name '*.xml' -o -name '*.yaml' -o -name '*.properties'
        -o -name '*.json' \) 2>/dev/null
    expected_findings:
    - Logging frameworks in use
    - Configuration locations
  - id: '2'
    name: Analyze error logging patterns
    description: |
      Review how errors are logged, checking for stack trace inclusion,
      contextual information, and appropriate log levels.
    duration_estimate: 45 min
    commands:
    - purpose: Sample error logging statements
      command: grep -rn 'log.*error\|logger.*error\|LOG.*ERROR' --include='*.java' --include='*.py' --include='*.ts'
        --include='*.go' . 2>/dev/null | head -50
    expected_findings:
    - Error logging patterns
    - Stack trace inclusion practices
  - id: '3'
    name: Check for sensitive data in logs
    description: |
      Search for logging of sensitive data including credentials,
      PII, and security tokens.
    duration_estimate: 45 min
    commands:
    - purpose: Find potential sensitive data logging
      command: grep -rn -i 'log.*password\|log.*secret\|log.*token\|log.*key\|log.*email\|log.*ssn' --include='*.java'
        --include='*.py' --include='*.ts' . 2>/dev/null
    expected_findings:
    - Sensitive data exposure risks
    - PII logging instances
  - id: '4'
    name: Verify structured logging
    description: |
      Check that logs are structured appropriately for aggregation
      and analysis tools.
    duration_estimate: 30 min
    expected_findings:
    - Logging format patterns
    - Aggregation readiness
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Sensitive Data Findings
    - Logging Quality Analysis
    - Recommendations
  confidence_guidance:
    high: Direct evidence of logging issues or sensitive data
    medium: Pattern suggests potential issues
    low: Indirect indicators requiring log output verification
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: owasp-logging
      priority: required
profiles:
  membership:
    quick:
      included: true
      priority: 3
    full:
      included: true
      priority: 1
    security:
      included: true
      priority: 1
    production:
      included: true
      priority: 1
closeout_checklist:
- id: error-logging-001
  item: No passwords or secrets in log statements
  level: CRITICAL
  verification: grep -rni 'log.*password\|log.*secret' --include='*.java' --include='*.py' --include='*.ts'
    --include='*.go' . 2>/dev/null | wc -l | xargs -I{} sh -c 'if [ {} -eq 0 ]; then echo PASS; else echo
    FAIL; fi'
  expected: PASS
- id: error-logging-002
  item: No console.log statements in production code
  level: BLOCKING
  verification: grep -rn 'console\.log' --include='*.ts' --include='*.js' src/ 2>/dev/null | grep -v 'test\|spec\|\.test\.'
    | wc -l | xargs -I{} sh -c 'if [ {} -eq 0 ]; then echo PASS; else echo FAIL; fi'
  expected: PASS
- id: error-logging-003
  item: Error logs include stack traces
  level: BLOCKING
  verification: manual
  verification_notes: Review error logging to ensure exception objects are passed to log methods
  expected: Confirmed by reviewer
- id: error-logging-004
  item: Structured logging format configured
  level: WARNING
  verification: manual
  verification_notes: Verify logging configuration uses JSON or structured format
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: OWASP
    controls:
    - A09:2021-Security Logging and Monitoring Failures
  - framework: SOC2
    controls:
    - CC7.2
  - framework: GDPR
    controls:
    - Article 5
relationships:
  commonly_combined:
  - reliability-resilience.error-handling.exception-handling
  - reliability-resilience.error-handling.error-rate-monitoring
