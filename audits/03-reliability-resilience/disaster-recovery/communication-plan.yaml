# ============================================================
# AUDIT: Communication Plan Audit
# ============================================================
# Evaluates disaster recovery communication procedures including
# notification chains, stakeholder communication, and status updates.
# ============================================================

# ============================================================
# SECTION 1: IDENTITY & METADATA
# ============================================================

audit:
  id: "reliability-resilience.disaster-recovery.communication-plan"

  name: "Communication Plan Audit"

  version: "1.0.0"
  last_updated: "2026-01-18"
  status: "active"

  category: "reliability-resilience"
  category_number: 3
  subcategory: "disaster-recovery"

  tier: "expert"
  estimated_duration: "2 hours"

  completeness: "complete"
  requires_runtime: false
  destructive: false

# ============================================================
# SECTION 2: EXECUTION CLASSIFICATION
# ============================================================

execution:
  automatable: "manual"

  severity: "high"

  scope: "organizational"

  default_profiles:
    - "full"
    - "production"

  blocks_phase: false
  parallelizable: true

# ============================================================
# SECTION 3: DESCRIPTION & RATIONALE
# ============================================================

description:
  what: |
    Evaluates disaster recovery communication plans including
    notification procedures, escalation chains, stakeholder
    communication templates, and status update processes.
    Assesses whether communication procedures support effective
    disaster response coordination.

  why_it_matters: |
    Effective communication is critical during disasters. Poor
    communication leads to duplicated efforts, missed actions,
    stakeholder confusion, and extended recovery times. Clear
    communication plans ensure all parties are informed and
    coordinated throughout the recovery process.

  when_to_run:
    - "Annual DR planning review"
    - "After communication failures during incidents"
    - "When organizational structure changes"
    - "Before major DR exercises"

# ============================================================
# SECTION 4: PREREQUISITES
# ============================================================

prerequisites:
  required_artifacts:
    - type: "documentation"
      description: "DR communication plan documentation"
    - type: "contact_list"
      description: "Emergency contact information"
    - type: "templates"
      description: "Communication templates for various scenarios"

  access_requirements:
    - "Access to DR documentation"
    - "Emergency contact lists"
    - "Stakeholder interview availability"

# ============================================================
# SECTION 5: DISCOVERY SPECIFICATION
# ============================================================

discovery:
  file_patterns:
    - glob: "**/disaster-recovery/**/*communication*"
      purpose: "Communication plan documentation"
    - glob: "**/runbooks/**/*escalation*"
      purpose: "Escalation procedures"

  interviews:
    - role: "DR Coordinators"
      questions:
        - "What is the notification process when disaster is declared?"
        - "Who needs to be notified and in what order?"
        - "How are status updates communicated during recovery?"
        - "What communication channels are used?"
      purpose: "Understand DR communication procedures"
    - role: "Executive Stakeholders"
      questions:
        - "How do you expect to be informed during a disaster?"
        - "What information do you need during recovery?"
        - "Are communication expectations currently met?"
      purpose: "Assess stakeholder communication needs"

  documents_to_review:
    - type: "Communication plan"
      purpose: "Primary audit target"
    - type: "Escalation matrix"
      purpose: "Review notification chains"

# ============================================================
# SECTION 6: EXTERNAL KNOWLEDGE SOURCES
# ============================================================

knowledge_sources:
  specifications:
    - id: "nist-cp"
      name: "NIST SP 800-34 - Contingency Planning Guide"
      url: "https://csrc.nist.gov/publications/detail/sp/800-34/rev-1/final"
      offline_cache: true
      priority: "required"
    - id: "iso-22301"
      name: "ISO 22301 - Business Continuity Management"
      url: "https://www.iso.org/standard/75106.html"
      offline_cache: true
      priority: "recommended"

  guides:
    - id: "crisis-communication"
      name: "Crisis Communication Best Practices"
      url: "https://www.ready.gov/business/implementation/crisis"
      offline_cache: true
    - id: "sre-book"
      name: "Site Reliability Engineering"
      url: "https://sre.google/sre-book/table-of-contents/"
      offline_cache: true

# ============================================================
# SECTION 7: TOOLING & AUTOMATION
# ============================================================

tooling:
  assessment_tools:
    - tool: "Communication plan template"
      purpose: "Evaluate plan completeness"
    - tool: "Contact verification"
      purpose: "Verify contact information accuracy"

# ============================================================
# SECTION 8: SIGNALS & FINDINGS TAXONOMY
# ============================================================

signals:
  critical:
    - id: "COMM-CRIT-001"
      signal: "No documented DR communication plan"
      evidence_indicators:
        - "Communication plan document missing"
        - "Ad-hoc communication only"
      explanation: |
        Without a communication plan, disaster response becomes
        chaotic with unclear responsibilities and missed notifications.
      remediation: "Create comprehensive DR communication plan"

    - id: "COMM-CRIT-002"
      signal: "Emergency contact information outdated or missing"
      evidence_indicators:
        - "Contact list not updated in 6+ months"
        - "Key personnel contacts missing"
      explanation: |
        Outdated contacts cause delays in notification and may
        prevent reaching critical personnel during emergencies.
      remediation: "Update and verify all emergency contact information"

  high:
    - id: "COMM-HIGH-001"
      signal: "No backup communication channels defined"
      explanation: "Primary channels may be unavailable during disasters"
      remediation: "Define redundant communication channels"

    - id: "COMM-HIGH-002"
      signal: "Escalation procedures unclear or untested"
      explanation: "Unclear escalation delays critical decision-making"
      remediation: "Document and test escalation procedures"

  medium:
    - id: "COMM-MED-001"
      signal: "No communication templates for common scenarios"
      remediation: "Create pre-approved templates for status updates and notifications"

    - id: "COMM-MED-002"
      signal: "External stakeholder communication not addressed"
      remediation: "Include customer and vendor communication in plan"

  low:
    - id: "COMM-LOW-001"
      signal: "Communication plan not tested in exercises"

  positive:
    - id: "COMM-POS-001"
      signal: "Comprehensive communication plan with tested procedures"
    - id: "COMM-POS-002"
      signal: "Automated notification system with verified contacts"

# ============================================================
# SECTION 9: EXECUTION PROCEDURE
# ============================================================

procedure:
  context:
    cognitive_mode: "evaluative"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Review Communication Plan"
      description: |
        Examine the documented DR communication plan for
        completeness and clarity.
      duration_estimate: "30 min"
      questions:
        - "Is there a documented communication plan?"
        - "Does it cover all disaster scenarios?"
        - "Are roles and responsibilities clear?"
      expected_findings:
        - "Plan existence and scope"
        - "Coverage of scenarios"

    - id: "2"
      name: "Verify Contact Information"
      description: |
        Check that emergency contact information is current
        and verified.
      duration_estimate: "30 min"
      questions:
        - "When was contact information last verified?"
        - "Are all key personnel included?"
        - "Are backup contacts identified?"
      expected_findings:
        - "Contact list currency"
        - "Coverage completeness"

    - id: "3"
      name: "Assess Communication Channels"
      description: |
        Evaluate primary and backup communication channels
        for reliability during disasters.
      duration_estimate: "20 min"
      questions:
        - "What communication channels are used?"
        - "Are backup channels identified?"
        - "Can channels function during infrastructure outages?"
      expected_findings:
        - "Channel inventory"
        - "Redundancy assessment"

    - id: "4"
      name: "Review Escalation Procedures"
      description: |
        Examine escalation matrices and procedures for
        clarity and appropriateness.
      duration_estimate: "20 min"
      questions:
        - "Are escalation triggers defined?"
        - "Is the escalation chain clear?"
        - "Are timeframes specified?"
      expected_findings:
        - "Escalation procedure assessment"
        - "Trigger definitions"

# ============================================================
# SECTION 10: OUTPUT SPECIFICATION
# ============================================================

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "communication_matrix"
      format: "table"
      columns:
        - "Stakeholder Group"
        - "Primary Contact"
        - "Backup Contact"
        - "Channel"
        - "Timing"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Plan Assessment"
        - "Contact Verification"
        - "Recommendations"

  confidence_guidance:
    high: "Plan reviewed and contacts verified"
    medium: "Plan reviewed but contacts not independently verified"
    low: "Based on interviews without documentation review"

# ============================================================
# SECTION 11: OFFLINE SUPPORT
# ============================================================

offline:
  capability: "full"

  cache_manifest:
    knowledge:
      - source_id: "nist-cp"
        priority: "required"

# ============================================================
# SECTION 12: PROFILES
# ============================================================

profiles:
  membership:
    quick:
      included: false
      reason: "Communication plan review requires stakeholder engagement"
    full:
      included: true
      priority: 2
    production:
      included: true
      priority: 2

# ============================================================
# SECTION 13: DETERMINISTIC VERIFICATION
# ============================================================

closeout_checklist:
  - id: "comm-001"
    item: "DR communication plan documented and accessible"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Locate and review communication plan documentation"
    expected: "Confirmed by reviewer"

  - id: "comm-002"
    item: "Emergency contact list current (updated within 90 days)"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Check last update date and sample verify contacts"
    expected: "Confirmed by reviewer"

  - id: "comm-003"
    item: "Backup communication channels identified"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Review plan for redundant communication methods"
    expected: "Confirmed by reviewer"

  - id: "comm-004"
    item: "Communication templates available for common scenarios"
    level: "WARNING"
    verification: "manual"
    verification_notes: "Review available templates"
    expected: "Confirmed by reviewer"

# ============================================================
# SECTION 14: GOVERNANCE
# ============================================================

governance:
  applicable_to:
    archetypes: ["all"]

  compliance_frameworks:
    - framework: "SOC 2"
      controls: ["CC7.4"]
    - framework: "ISO 22301"
      controls: ["8.4.3"]
    - framework: "NIST CSF"
      controls: ["RC.CO-1", "RC.CO-2", "RC.CO-3"]

# ============================================================
# SECTION 15: RELATIONSHIPS
# ============================================================

relationships:
  commonly_combined:
    - "reliability-resilience.disaster-recovery.dr-runbook-completeness"
    - "reliability-resilience.disaster-recovery.dr-test-coverage"
