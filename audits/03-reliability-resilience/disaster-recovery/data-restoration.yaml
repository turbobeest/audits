audit:
  id: reliability-resilience.disaster-recovery.data-restoration
  name: Data Restoration Audit
  version: 1.0.0
  last_updated: '2026-01-18'
  status: active
  category: reliability-resilience
  category_number: 3
  subcategory: disaster-recovery
  tier: phd
  estimated_duration: 4 hours
  completeness: complete
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: critical
  scope: infrastructure
  default_profiles:
  - full
  - production
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates data restoration procedures including restore workflows,
    point-in-time recovery capabilities, data validation after restore,
    and restoration time benchmarks. Assesses whether data can be
    reliably restored to a known good state.
  why_it_matters: |
    Backup without proven restoration is incomplete. Organizations must
    know they can restore data accurately, completely, and within
    acceptable timeframes. Restoration procedures must be tested and
    validated to ensure business continuity during disasters.
  when_to_run:
  - After backup infrastructure changes
  - Quarterly restoration testing
  - Following any restoration failure
  - When adding new data stores
prerequisites:
  required_artifacts:
  - type: documentation
    description: Data restoration procedures and runbooks
  - type: test_results
    description: Historical restoration test results
  - type: backup_inventory
    description: Backup catalog with restore points
  access_requirements:
  - Access to backup systems
  - Test environment for restoration validation
  - Historical restoration logs
discovery:
  file_patterns:
  - glob: '**/runbooks/**/*restore*'
    purpose: Restoration runbooks
  - glob: '**/backup/**/*restore*'
    purpose: Restoration configurations
  interviews:
  - role: Database Administrators
    questions:
    - What is the restore process for each database type?
    - How long does a typical restore take?
    - How is restored data validated?
    - Can you perform point-in-time recovery?
    purpose: Understand database restoration capabilities
  - role: Platform/SRE Engineers
    questions:
    - What tools are used for data restoration?
    - Are restoration procedures automated?
    - What are the dependencies for restoration?
    purpose: Assess restoration tooling and automation
  documents_to_review:
  - type: Restoration runbooks
    purpose: Review documented procedures
  - type: Restoration test reports
    purpose: Assess historical restoration success
knowledge_sources:
  specifications:
  - id: nist-cp
    name: NIST SP 800-34 - Contingency Planning Guide
    url: https://csrc.nist.gov/publications/detail/sp/800-34/rev-1/final
    offline_cache: true
    priority: required
  guides:
  - id: aws-restore
    name: AWS Backup Restore Guide
    url: https://docs.aws.amazon.com/aws-backup/latest/devguide/restoring-a-backup.html
    offline_cache: true
  - id: sre-book
    name: Site Reliability Engineering
    url: https://sre.google/sre-book/table-of-contents/
    offline_cache: true
tooling:
  infrastructure_tools:
  - tool: AWS Backup
    purpose: Restore from AWS Backup vaults
    command: aws backup start-restore-job --recovery-point-arn ARN --iam-role-arn ROLE --resource-type
      RDS
  - tool: Velero
    purpose: Kubernetes resource restoration
    command: velero restore create --from-backup BACKUP_NAME
  - tool: pg_restore
    purpose: PostgreSQL database restoration
    command: pg_restore -d DATABASE BACKUP_FILE
  scripts:
  - id: validate-restore
    language: bash
    purpose: Validate restored data integrity
    source: inline
    code: |
      #!/bin/bash
      # Validate restored data against known checksums
      echo "Validating restored data..."
      # Implementation specific to data type
signals:
  critical:
  - id: REST-CRIT-001
    signal: No documented restoration procedures for critical data
    evidence_indicators:
    - Restoration runbook missing
    - Ad-hoc restoration only
    explanation: |
      Without documented procedures, restoration depends on specific
      individuals and institutional knowledge, creating risk during
      actual disasters.
    remediation: Document step-by-step restoration procedures for all critical data
  - id: REST-CRIT-002
    signal: Restoration never tested or consistently fails
    evidence_indicators:
    - No restoration test history
    - Test restores failing repeatedly
    explanation: |
      Untested restoration procedures have unknown effectiveness.
      Consistent failures indicate backup or procedure problems.
    remediation: Conduct regular restoration tests and fix identified issues
  high:
  - id: REST-HIGH-001
    signal: No point-in-time recovery capability for transactional databases
    explanation: Without PITR, can only restore to backup time, potentially losing significant data
    remediation: Enable WAL archiving or equivalent for point-in-time recovery
  - id: REST-HIGH-002
    signal: Restored data not validated for integrity
    explanation: Restoration may complete but data may be corrupted or incomplete
    remediation: Implement post-restore validation checks
  medium:
  - id: REST-MED-001
    signal: Restoration time exceeds RTO targets
    remediation: Optimize restoration process or adjust RTO expectations
  - id: REST-MED-002
    signal: Restoration requires manual intervention at multiple steps
    remediation: Automate restoration workflow where possible
  low:
  - id: REST-LOW-001
    signal: Restoration documentation not kept current
  positive:
  - id: REST-POS-001
    signal: Automated restoration with validation
  - id: REST-POS-002
    signal: Regular restoration testing with documented success
procedure:
  context:
    cognitive_mode: critical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Review Restoration Documentation
    description: |
      Gather and review all data restoration procedures
      and runbooks.
    duration_estimate: 45 min
    questions:
    - Are restoration procedures documented?
    - Do procedures cover all critical data stores?
    - Are procedures clear and actionable?
    expected_findings:
    - Restoration documentation inventory
    - Coverage gaps
  - id: '2'
    name: Assess Restoration Capabilities
    description: |
      Evaluate technical restoration capabilities including
      point-in-time recovery and restore targets.
    duration_estimate: 45 min
    commands:
    - purpose: Check RDS PITR capability
      command: aws rds describe-db-instances --query 'DBInstances[*].[DBInstanceIdentifier,LatestRestorableTime]'
    questions:
    - Is point-in-time recovery available?
    - What restore points are available?
    - Can data be restored to alternate targets?
    expected_findings:
    - PITR capabilities by data store
    - Restore point availability
  - id: '3'
    name: Analyze Restoration Test History
    description: |
      Review historical restoration tests for success rates
      and timing.
    duration_estimate: 45 min
    questions:
    - When were restoration tests last performed?
    - What was the success rate?
    - How long did restorations take?
    expected_findings:
    - Test frequency and success rate
    - Restoration time benchmarks
  - id: '4'
    name: Evaluate Data Validation
    description: |
      Assess post-restoration validation procedures to ensure
      data integrity.
    duration_estimate: 30 min
    questions:
    - How is restored data validated?
    - Are checksums or row counts verified?
    - Is application-level validation performed?
    expected_findings:
    - Validation procedures
    - Integrity verification methods
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: restoration_matrix
    format: table
    columns:
    - Data Store
    - Restoration Method
    - PITR Capable
    - Last Test
    - Avg Restore Time
    - Status
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Capability Assessment
    - Test Results Analysis
    - Recommendations
  confidence_guidance:
    high: Restoration tests observed or results directly verified
    medium: Documentation reviewed with sample validation
    low: Based on interviews without test verification
offline:
  capability: partial
  cache_manifest:
    knowledge:
    - source_id: nist-cp
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Restoration assessment requires runtime access
    full:
      included: true
      priority: 1
    production:
      included: true
      priority: 1
closeout_checklist:
- id: rest-001
  item: Restoration procedures documented for all critical data stores
  level: CRITICAL
  verification: manual
  verification_notes: Review restoration runbooks and documentation
  expected: Confirmed by reviewer
- id: rest-002
  item: Restoration tested successfully within last 30 days
  level: CRITICAL
  verification: manual
  verification_notes: Review restoration test logs and reports
  expected: Confirmed by reviewer
- id: rest-003
  item: Point-in-time recovery enabled for transactional databases
  level: BLOCKING
  verification: aws rds describe-db-instances --query 'DBInstances[?LatestRestorableTime!=null].DBInstanceIdentifier'
    | grep -q . && echo PASS || echo FAIL
  expected: PASS
- id: rest-004
  item: Post-restoration data validation procedures defined
  level: WARNING
  verification: manual
  verification_notes: Review validation steps in restoration runbooks
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: SOC 2
    controls:
    - A1.2
  - framework: ISO 27001
    controls:
    - A.12.3.1
  - framework: HIPAA
    controls:
    - 164.308(a)(7)(ii)(A)
relationships:
  commonly_combined:
  - reliability-resilience.disaster-recovery.backup-verification
  - reliability-resilience.disaster-recovery.recovery-time-objective
  - reliability-resilience.disaster-recovery.recovery-point-objective
