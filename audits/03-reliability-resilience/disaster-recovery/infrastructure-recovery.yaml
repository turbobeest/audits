audit:
  id: reliability-resilience.disaster-recovery.infrastructure-recovery
  name: Infrastructure Recovery Audit
  version: 1.0.0
  last_updated: '2026-01-18'
  status: active
  category: reliability-resilience
  category_number: 3
  subcategory: disaster-recovery
  tier: phd
  estimated_duration: 4 hours
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: critical
  scope: infrastructure
  default_profiles:
  - full
  - production
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates infrastructure recovery capabilities including compute
    resources, networking configurations, Kubernetes clusters, and
    dependent services. Assesses whether infrastructure can be
    recreated or failed over in disaster scenarios.
  why_it_matters: |
    Data recovery requires functioning infrastructure. Without the
    ability to restore compute, networking, and service configurations,
    recovered data cannot be made accessible to users. Infrastructure
    recovery must be coordinated with data recovery for complete DR.
  when_to_run:
  - After infrastructure architecture changes
  - Annual DR planning review
  - Following infrastructure-related incidents
  - Before major deployments
prerequisites:
  required_artifacts:
  - type: infrastructure_code
    description: Terraform, CloudFormation, or other IaC definitions
  - type: architecture_diagram
    description: Infrastructure architecture documentation
  - type: runbooks
    description: Infrastructure recovery procedures
  access_requirements:
  - Read access to infrastructure-as-code repositories
  - Access to infrastructure documentation
  - Cloud provider console access
discovery:
  file_patterns:
  - glob: '**/terraform/**/*.tf'
    purpose: Terraform infrastructure definitions
  - glob: '**/cloudformation/**/*.yaml'
    purpose: CloudFormation templates
  - glob: '**/k8s/**/*.yaml'
    purpose: Kubernetes manifests
  interviews:
  - role: Platform/Infrastructure Engineers
    questions:
    - Can infrastructure be fully recreated from code?
    - What manual configuration exists outside IaC?
    - How are secrets and configurations managed?
    - What is the infrastructure recovery sequence?
    purpose: Understand infrastructure recovery capabilities
  - role: Network Engineers
    questions:
    - How are network configurations recovered?
    - Are DNS failover procedures documented?
    - What are the network dependencies?
    purpose: Assess network recovery capabilities
  documents_to_review:
  - type: IaC documentation
    purpose: Understand infrastructure definition completeness
  - type: Recovery runbooks
    purpose: Review infrastructure recovery procedures
knowledge_sources:
  specifications:
  - id: aws-dr
    name: AWS Disaster Recovery Whitepaper
    url: https://docs.aws.amazon.com/whitepapers/latest/disaster-recovery-workloads-on-aws/
    offline_cache: true
    priority: required
  guides:
  - id: terraform-dr
    name: Terraform for Disaster Recovery
    url: https://www.hashicorp.com/blog/disaster-recovery-for-terraform
    offline_cache: true
  - id: sre-book
    name: Site Reliability Engineering
    url: https://sre.google/sre-book/table-of-contents/
    offline_cache: true
tooling:
  infrastructure_tools:
  - tool: Terraform
    purpose: Infrastructure provisioning and recovery
    command: terraform plan
  - tool: kubectl
    purpose: Kubernetes cluster management
    command: kubectl get all -A
  - tool: AWS CLI
    purpose: AWS resource management
    command: aws ec2 describe-instances
  scripts:
  - id: iac-drift-check
    language: bash
    purpose: Check for infrastructure drift from IaC
    source: inline
    code: |
      #!/bin/bash
      # Check for drift between IaC and actual infrastructure
      terraform plan -detailed-exitcode
      if [ $? -eq 2 ]; then
        echo "DRIFT DETECTED"
      else
        echo "NO DRIFT"
      fi
signals:
  critical:
  - id: INF-CRIT-001
    signal: Infrastructure cannot be recreated from code
    evidence_indicators:
    - No IaC definitions exist
    - Significant manual configurations
    - IaC out of sync with actual infrastructure
    explanation: |
      Without infrastructure-as-code, recovery requires manual
      recreation which is slow, error-prone, and dependent on
      specific individuals' knowledge.
    remediation: Implement comprehensive IaC for all infrastructure components
  - id: INF-CRIT-002
    signal: Critical dependencies not documented or recoverable
    evidence_indicators:
    - Third-party service dependencies unknown
    - Network configuration not in IaC
    explanation: |
      Hidden dependencies can block recovery even when primary
      infrastructure is restored.
    remediation: Document all dependencies and include in recovery planning
  high:
  - id: INF-HIGH-001
    signal: Secrets and configurations not backed up or recoverable
    explanation: Applications may fail to start without proper secrets and configs
    remediation: Implement secret backup or recreation procedures
  - id: INF-HIGH-002
    signal: Infrastructure recovery sequence not documented
    explanation: Incorrect recovery order can cause cascading failures
    remediation: Document infrastructure dependency graph and recovery sequence
  medium:
  - id: INF-MED-001
    signal: DNS failover not automated
    remediation: Implement automated DNS failover with health checks
  - id: INF-MED-002
    signal: Load balancer configurations not in IaC
    remediation: Include load balancer configs in infrastructure code
  low:
  - id: INF-LOW-001
    signal: Infrastructure recovery documentation incomplete
  positive:
  - id: INF-POS-001
    signal: 100% infrastructure defined in version-controlled IaC
  - id: INF-POS-002
    signal: Automated infrastructure recovery with tested failover
procedure:
  context:
    cognitive_mode: critical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Assess IaC Coverage
    description: |
      Evaluate what percentage of infrastructure is defined
      in infrastructure-as-code.
    duration_estimate: 60 min
    commands:
    - purpose: Check Terraform state
      command: terraform state list | wc -l
    - purpose: List all AWS resources
      command: aws resourcegroupstaggingapi get-resources --query 'ResourceTagMappingList[*].ResourceARN'
    questions:
    - What infrastructure components are in IaC?
    - What components are managed manually?
    expected_findings:
    - IaC coverage percentage
    - List of manually managed components
  - id: '2'
    name: Verify IaC Accuracy
    description: |
      Check for drift between IaC definitions and actual
      deployed infrastructure.
    duration_estimate: 45 min
    commands:
    - purpose: Check Terraform drift
      command: terraform plan -detailed-exitcode
    expected_findings:
    - Drift assessment
    - Components out of sync
  - id: '3'
    name: Map Dependencies
    description: |
      Document infrastructure dependencies including external
      services, networking, and inter-service dependencies.
    duration_estimate: 45 min
    questions:
    - What are the critical infrastructure dependencies?
    - What is the correct recovery sequence?
    - Are there external dependencies?
    expected_findings:
    - Dependency map
    - Recovery sequence documentation
  - id: '4'
    name: Evaluate Recovery Procedures
    description: |
      Review infrastructure recovery runbooks and procedures
      for completeness and accuracy.
    duration_estimate: 30 min
    questions:
    - Are recovery procedures documented?
    - Can infrastructure be recovered from secondary region?
    - What is the expected recovery time?
    expected_findings:
    - Recovery procedure assessment
    - Estimated recovery time
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: iac_coverage_report
    format: table
    columns:
    - Component Type
    - Total Count
    - In IaC
    - Coverage %
    - Status
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - IaC Coverage Analysis
    - Dependency Mapping
    - Recommendations
  confidence_guidance:
    high: IaC verified against deployed infrastructure
    medium: IaC reviewed but not validated against deployment
    low: Based on documentation without code review
offline:
  capability: partial
  cache_manifest:
    knowledge:
    - source_id: aws-dr
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Infrastructure assessment requires comprehensive review
    full:
      included: true
      priority: 1
    production:
      included: true
      priority: 1
closeout_checklist:
- id: inf-001
  item: All production infrastructure defined in version-controlled IaC
  level: CRITICAL
  verification: manual
  verification_notes: Review IaC coverage against deployed resources
  expected: Confirmed by reviewer
- id: inf-002
  item: No significant drift between IaC and deployed infrastructure
  level: CRITICAL
  verification: terraform plan -detailed-exitcode; [ $? -ne 2 ] && echo PASS || echo FAIL
  expected: PASS
- id: inf-003
  item: Infrastructure recovery sequence documented
  level: BLOCKING
  verification: manual
  verification_notes: Review infrastructure recovery runbook for sequence
  expected: Confirmed by reviewer
- id: inf-004
  item: Secret and configuration recovery procedures documented
  level: WARNING
  verification: manual
  verification_notes: Review secret management and recovery documentation
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: SOC 2
    controls:
    - A1.2
    - A1.3
  - framework: ISO 27001
    controls:
    - A.17.1.1
    - A.17.1.2
relationships:
  commonly_combined:
  - reliability-resilience.disaster-recovery.dr-runbook-completeness
  - reliability-resilience.disaster-recovery.recovery-time-objective
  - reliability-resilience.high-availability.multi-region-deployment
