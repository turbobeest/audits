# ============================================================
# AUDIT: Resolution/Fidelity
# Category: 43 - Metaverse & Immersive
# Subcategory: rendering-performance
# ============================================================

audit:
  id: "metaverse-immersive.rendering-performance.resolution-fidelity"
  name: "Resolution/Fidelity Audit"
  version: "1.0.0"
  last_updated: "2025-01-22"
  status: "active"

  category: "metaverse-immersive"
  category_number: 43
  subcategory: "rendering-performance"

  tier: "expert"
  estimated_duration: "2-4 hours"  # median: 3h

  completeness: "requires_discovery"
  requires_runtime: true
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "xr-systems"

  default_profiles:
    - "full"
    - "quick"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Evaluates the visual resolution and fidelity of XR rendering including
    render target resolution, supersampling, fixed foveated rendering,
    and overall visual quality. Balances clarity against performance
    constraints.

  why_it_matters: |
    Visual fidelity directly impacts immersion and user comfort. Low resolution
    causes blurriness and reduces readability. However, excessive resolution
    wastes GPU resources and can impact frame rate. Finding the right balance
    is essential for quality XR experiences.

  when_to_run:
    - "During visual quality tuning"
    - "When text is hard to read"
    - "When optimizing performance"
    - "When targeting new hardware"

prerequisites:
  required_artifacts:
    - type: "render_settings"
      description: "Rendering configuration"
    - type: "xr_hardware"
      description: "Target hardware specs"

  access_requirements:
    - "Access to render settings"
    - "XR device for testing"

discovery:
  file_patterns:
    - glob: "**/graphics/**/*.cs"
      purpose: "Find graphics settings"
    - glob: "**/quality/**/*.asset"
      purpose: "Find quality presets"

  code_patterns:
    - pattern: "renderTargetSize|eyeTextureResolution"
      type: "keyword"
      scope: "source"
      purpose: "Find resolution settings"
    - pattern: "foveatedRendering|FFR"
      type: "keyword"
      scope: "source"
      purpose: "Find foveated rendering"

knowledge_sources:
  guides:
    - id: "meta-resolution"
      name: "Meta Quest Resolution Guide"
      url: "https://developer.oculus.com/documentation/unity/unity-resolution/"
      offline_cache: true

    - id: "foveated-rendering"
      name: "Fixed Foveated Rendering"
      url: "https://developer.oculus.com/documentation/native/android/mobile-ffr/"
      offline_cache: true

tooling:
  analysis_tools:
    - tool: "resolution-analyzer"
      purpose: "Analyze render resolution"

    - tool: "gpu-profiler"
      purpose: "Fill rate analysis"

signals:
  critical:
    - id: "RF-CRIT-001"
      signal: "Resolution too low for readability"
      evidence_indicators:
        - "Text illegible at normal viewing distance"
        - "UI elements blurry"
        - "Resolution below device minimum"
      explanation: |
        If text and UI cannot be read comfortably, the application
        is not usable for its intended purpose.
      remediation: "Increase resolution or use larger text/UI"

    - id: "RF-CRIT-002"
      signal: "Resolution causes performance failure"
      evidence_indicators:
        - "Resolution too high for hardware"
        - "Frame rate drops below target"
      explanation: |
        Excessive resolution sacrifices frame rate, which is worse
        than lower fidelity graphics in VR.
      remediation: "Reduce resolution to maintain frame rate"

  high:
    - id: "RF-HIGH-001"
      signal: "Foveated rendering artifacts visible"
      evidence_indicators:
        - "Peripheral blur noticeable"
        - "FFR level too aggressive"
      remediation: "Reduce foveated rendering aggressiveness"

    - id: "RF-HIGH-002"
      signal: "No resolution scaling"
      evidence_indicators:
        - "Fixed resolution regardless of scene"
        - "No adaptive quality"
      remediation: "Implement dynamic resolution scaling"

  medium:
    - id: "RF-MED-001"
      signal: "Aliasing visible"
      remediation: "Enable appropriate antialiasing"

    - id: "RF-MED-002"
      signal: "Resolution not optimized per device"
      remediation: "Set device-appropriate resolution"

  low:
    - id: "RF-LOW-001"
      signal: "Resolution settings undocumented"
      remediation: "Document resolution choices"

  positive:
    - id: "RF-POS-001"
      signal: "Clear, readable visuals"
    - id: "RF-POS-002"
      signal: "Resolution balanced with performance"
    - id: "RF-POS-003"
      signal: "Effective foveated rendering"

procedure:
  context:
    cognitive_mode: "evaluative"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Document Current Resolution"
      description: "Record render resolution settings"
      duration_estimate: "30 min"

    - id: "2"
      name: "Test Readability"
      description: "Verify text and UI clarity"
      duration_estimate: "45 min"

    - id: "3"
      name: "Profile Fill Rate"
      description: "Measure GPU fill rate usage"
      duration_estimate: "45 min"

    - id: "4"
      name: "Test Foveated Rendering"
      description: "Check FFR quality and artifacts"
      duration_estimate: "45 min"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "resolution_report"
      format: "json"
      description: "Resolution and fidelity analysis"

closeout_checklist:
  - id: "rf-001"
    item: "Resolution adequate for readability"
    level: "CRITICAL"
    verification: "manual"

  - id: "rf-002"
    item: "Performance maintained"
    level: "CRITICAL"
    verification: "automated"

  - id: "rf-003"
    item: "Foveated rendering configured"
    level: "WARNING"
    verification: "manual"

governance:
  applicable_to:
    archetypes: ["vr-applications", "xr-applications"]

relationships:
  commonly_combined:
    - "metaverse-immersive.rendering-performance.frame-rate-stability"
    - "metaverse-immersive.rendering-performance.shader-performance"
