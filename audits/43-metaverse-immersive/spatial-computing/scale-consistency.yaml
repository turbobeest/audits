# ============================================================
# AUDIT: Scale Consistency
# Category: 43 - Metaverse & Immersive
# Subcategory: spatial-computing
# ============================================================

audit:
  id: "metaverse-immersive.spatial-computing.scale-consistency"
  name: "Scale Consistency Audit"
  version: "1.0.0"
  last_updated: "2025-01-22"
  status: "active"

  category: "metaverse-immersive"
  category_number: 43
  subcategory: "spatial-computing"

  tier: "expert"
  estimated_duration: "2-4 hours"  # median: 3h

  completeness: "requires_discovery"
  requires_runtime: true
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "xr-systems"

  default_profiles:
    - "full"
    - "quick"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Evaluates the consistency of scale throughout XR experiences. Verifies
    that objects appear at appropriate real-world scale, interactions feel
    natural, and scale remains consistent across different content and
    environments.

  why_it_matters: |
    Incorrect scale breaks immersion and can cause discomfort. Objects that
    are too large or too small feel wrong and make interactions awkward.
    Inconsistent scale between objects destroys believability. Proper scale
    is fundamental to presence.

  when_to_run:
    - "During content integration"
    - "When objects feel wrong-sized"
    - "During level design review"
    - "After importing new assets"

prerequisites:
  required_artifacts:
    - type: "xr_content"
      description: "3D content and scenes"
    - type: "scale_references"
      description: "Real-world scale references"

  access_requirements:
    - "Access to content"
    - "XR runtime access"
    - "Measurement tools"

discovery:
  file_patterns:
    - glob: "**/assets/**/*.fbx"
      purpose: "Find 3D assets"
    - glob: "**/scenes/**/*.unity"
      purpose: "Find scene files"

  code_patterns:
    - pattern: "scale|localScale|transform.scale"
      type: "keyword"
      scope: "source"
      purpose: "Find scale operations"

knowledge_sources:
  guides:
    - id: "vr-scale"
      name: "VR Scale Best Practices"
      url: "https://developer.oculus.com/documentation/unity/unity-scale/"
      offline_cache: true

tooling:
  analysis_tools:
    - tool: "scale-checker"
      purpose: "Verify object scales"

    - tool: "reference-tools"
      purpose: "Real-world scale comparison"

signals:
  critical:
    - id: "SC-CRIT-001"
      signal: "Human-scale objects grossly wrong"
      evidence_indicators:
        - "Doors, chairs, tables wrong size"
        - "Human avatars not 1:1 scale"
        - "Scale factor far from 1.0"
      explanation: |
        Incorrectly scaled human-reference objects immediately feel
        wrong and destroy immersion. Users have strong intuition
        about human-scale object sizes.
      remediation: "Correct scale of human-reference objects to real-world size"

    - id: "SC-CRIT-002"
      signal: "Scale changes during experience"
      evidence_indicators:
        - "Objects change size unexpectedly"
        - "World scale shifts"
        - "User feels like they're growing/shrinking"
      explanation: |
        Unexpected scale changes are disorienting and can cause
        motion sickness. Scale should remain stable.
      remediation: "Fix unintended scale modifications"

  high:
    - id: "SC-HIGH-001"
      signal: "Inconsistent scale between assets"
      evidence_indicators:
        - "Similar objects at different scales"
        - "Mixed scale sources not normalized"
      remediation: "Normalize all assets to consistent scale"

    - id: "SC-HIGH-002"
      signal: "Interaction zones don't match scale"
      evidence_indicators:
        - "Grab ranges feel wrong"
        - "UI elements at wrong distance"
      remediation: "Adjust interaction parameters for scale"

  medium:
    - id: "SC-MED-001"
      signal: "Scale not documented"
      remediation: "Document scale conventions"

    - id: "SC-MED-002"
      signal: "Import pipeline doesn't normalize scale"
      remediation: "Add scale normalization to import"

  low:
    - id: "SC-LOW-001"
      signal: "Scale verification tools missing"
      remediation: "Add scale reference objects"

  positive:
    - id: "SC-POS-001"
      signal: "Consistent real-world scale"
    - id: "SC-POS-002"
      signal: "Scale normalization in pipeline"
    - id: "SC-POS-003"
      signal: "Scale verified against references"

procedure:
  context:
    cognitive_mode: "evaluative"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Check Human-Scale References"
      description: "Verify human-reference objects"
      duration_estimate: "45 min"

    - id: "2"
      name: "Compare Asset Scales"
      description: "Check consistency across assets"
      duration_estimate: "1 hour"

    - id: "3"
      name: "Test in VR"
      description: "Subjective scale evaluation"
      duration_estimate: "45 min"

    - id: "4"
      name: "Review Import Pipeline"
      description: "Check scale handling on import"
      duration_estimate: "30 min"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "scale_analysis"
      format: "json"
      description: "Scale consistency report"

closeout_checklist:
  - id: "sc-001"
    item: "Human-scale objects correct"
    level: "CRITICAL"
    verification: "manual"

  - id: "sc-002"
    item: "Scale consistent across assets"
    level: "BLOCKING"
    verification: "automated"

  - id: "sc-003"
    item: "Scale documented"
    level: "WARNING"
    verification: "manual"

governance:
  applicable_to:
    archetypes: ["xr-applications"]

relationships:
  commonly_combined:
    - "metaverse-immersive.spatial-computing.coordinate-system"
    - "metaverse-immersive.3d-asset-quality.model-polygon-count"
