# ============================================================
# AUDIT: Model Polygon Count
# Category: 43 - Metaverse & Immersive
# Subcategory: 3d-asset-quality
# ============================================================

audit:
  id: "metaverse-immersive.3d-asset-quality.model-polygon-count"
  name: "Model Polygon Count Audit"
  version: "1.0.0"
  last_updated: "2025-01-22"
  status: "active"

  category: "metaverse-immersive"
  category_number: 43
  subcategory: "3d-asset-quality"

  tier: "expert"
  estimated_duration: "2-4 hours"  # median: 3h

  completeness: "requires_discovery"
  requires_runtime: false
  destructive: false

execution:
  automatable: "yes"
  severity: "high"
  scope: "xr-systems"

  default_profiles:
    - "full"
    - "quick"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Evaluates polygon counts of 3D models against performance budgets.
    Assesses individual model complexity, total scene complexity, and
    optimization opportunities for XR rendering constraints.

  why_it_matters: |
    Polygon count directly impacts rendering performance. XR applications
    have strict performance requirements that limit total polygons per
    frame. Over-budget assets cause frame rate drops that lead to discomfort.

  when_to_run:
    - "When importing assets"
    - "During performance optimization"
    - "When frame rate drops"
    - "During asset review"

prerequisites:
  required_artifacts:
    - type: "3d_assets"
      description: "3D model files"
    - type: "polygon_budget"
      description: "Target polygon limits"

  access_requirements:
    - "Access to 3D assets"
    - "Model analysis tools"

discovery:
  file_patterns:
    - glob: "**/*.fbx"
      purpose: "Find FBX models"
    - glob: "**/*.obj"
      purpose: "Find OBJ models"
    - glob: "**/*.gltf"
      purpose: "Find glTF models"

knowledge_sources:
  guides:
    - id: "vr-poly-budgets"
      name: "VR Polygon Budgets"
      url: "https://developer.oculus.com/documentation/unity/unity-polygon-budgets/"
      offline_cache: true

tooling:
  analysis_tools:
    - tool: "poly-counter"
      purpose: "Count polygons per model"

    - tool: "mesh-analyzer"
      purpose: "Mesh optimization analysis"

signals:
  critical:
    - id: "MPC-CRIT-001"
      signal: "Total scene polygons exceed budget"
      evidence_threshold: "scene_polygons > platform_budget"
      explanation: |
        Exceeding the polygon budget guarantees frame rate drops.
        The scene cannot render at target frame rate.
      remediation: "Reduce polygon counts until within budget"

    - id: "MPC-CRIT-002"
      signal: "Single model exceeds reasonable limit"
      evidence_threshold: "model_polygons > 100000 for mobile VR"
      explanation: |
        Individual models that are extremely high-poly are often
        the result of unoptimized source assets.
      remediation: "Optimize or replace high-poly models"

  high:
    - id: "MPC-HIGH-001"
      signal: "Background objects too detailed"
      evidence_indicators:
        - "Distant objects at high detail"
        - "No LOD on background"
      remediation: "Add LOD for distant objects"

    - id: "MPC-HIGH-002"
      signal: "Duplicated geometry"
      evidence_indicators:
        - "Same mesh not instanced"
        - "Redundant geometry"
      remediation: "Use instancing for repeated objects"

  medium:
    - id: "MPC-MED-001"
      signal: "Invisible geometry"
      remediation: "Remove geometry that cannot be seen"

    - id: "MPC-MED-002"
      signal: "Polygon density uneven"
      remediation: "Balance detail distribution"

  low:
    - id: "MPC-LOW-001"
      signal: "Polygon counts undocumented"
      remediation: "Document polygon budgets"

  positive:
    - id: "MPC-POS-001"
      signal: "Within polygon budget"
    - id: "MPC-POS-002"
      signal: "Efficient polygon distribution"
    - id: "MPC-POS-003"
      signal: "LOD implemented"

procedure:
  context:
    cognitive_mode: "evaluative"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Count Total Polygons"
      description: "Measure scene polygon count"
      duration_estimate: "30 min"

    - id: "2"
      name: "Analyze Per-Model"
      description: "Check individual model counts"
      duration_estimate: "1 hour"

    - id: "3"
      name: "Identify High-Poly"
      description: "Find optimization targets"
      duration_estimate: "45 min"

    - id: "4"
      name: "Compare to Budget"
      description: "Check against platform limits"
      duration_estimate: "30 min"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "polygon_report"
      format: "json"
      description: "Polygon count analysis"

closeout_checklist:
  - id: "mpc-001"
    item: "Scene within budget"
    level: "CRITICAL"
    verification: "automated"

  - id: "mpc-002"
    item: "No extreme outliers"
    level: "BLOCKING"
    verification: "automated"

governance:
  applicable_to:
    archetypes: ["xr-applications", "3d-applications"]

relationships:
  commonly_combined:
    - "metaverse-immersive.rendering-performance.lod-implementation"
    - "metaverse-immersive.rendering-performance.frame-rate-stability"
