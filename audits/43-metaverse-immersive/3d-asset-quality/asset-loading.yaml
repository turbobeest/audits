# ============================================================
# AUDIT: Asset Loading
# Category: 43 - Metaverse & Immersive
# Subcategory: 3d-asset-quality
# ============================================================

audit:
  id: "metaverse-immersive.3d-asset-quality.asset-loading"
  name: "Asset Loading Audit"
  version: "1.0.0"
  last_updated: "2025-01-22"
  status: "active"

  category: "metaverse-immersive"
  category_number: 43
  subcategory: "3d-asset-quality"

  tier: "expert"
  estimated_duration: "2-4 hours"  # median: 3h

  completeness: "requires_discovery"
  requires_runtime: true
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "xr-systems"

  default_profiles:
    - "full"
    - "quick"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Evaluates asset loading strategies for XR including load times,
    streaming, level of detail loading, and impact on user experience
    during loading transitions.

  why_it_matters: |
    Loading in VR is challenging because users are immersed and cannot
    look away. Long loads break immersion while hitches during streaming
    cause discomfort. Smooth asset loading is essential for quality XR.

  when_to_run:
    - "When load times are long"
    - "When streaming causes hitches"
    - "During optimization"
    - "When adding new content"

prerequisites:
  required_artifacts:
    - type: "loading_system"
      description: "Asset loading implementation"
    - type: "streaming_config"
      description: "Streaming settings"

  access_requirements:
    - "Access to loading code"
    - "Full application testing"

discovery:
  file_patterns:
    - glob: "**/loading/**/*.cs"
      purpose: "Find loading code"
    - glob: "**/streaming/**/*.cs"
      purpose: "Find streaming code"

  code_patterns:
    - pattern: "LoadAsync|Addressables|AssetBundle"
      type: "keyword"
      scope: "source"
      purpose: "Find loading systems"

knowledge_sources:
  guides:
    - id: "vr-loading"
      name: "VR Loading Best Practices"
      url: "https://developer.oculus.com/documentation/unity/unity-loading/"
      offline_cache: true

tooling:
  analysis_tools:
    - tool: "loading-profiler"
      purpose: "Load time measurement"

signals:
  critical:
    - id: "AL-CRIT-001"
      signal: "Loading causes black screen"
      evidence_indicators:
        - "Screen goes black during load"
        - "No loading environment"
      explanation: |
        Black screens in VR are disorienting and break immersion.
        Users should always have visual reference.
      remediation: "Add loading environment or transition"

    - id: "AL-CRIT-002"
      signal: "Streaming causes frame drops"
      evidence_indicators:
        - "Hitches during streaming"
        - "Main thread blocked by loading"
      explanation: |
        Frame drops during streaming cause discomfort.
        Loading must be truly asynchronous.
      remediation: "Make loading fully async"

  high:
    - id: "AL-HIGH-001"
      signal: "Initial load time excessive"
      evidence_threshold: "initial_load > 30 seconds"
      remediation: "Optimize initial load or add splash content"

    - id: "AL-HIGH-002"
      signal: "No loading progress indication"
      evidence_indicators:
        - "Users don't know load status"
        - "No progress feedback"
      remediation: "Add loading progress indication"

  medium:
    - id: "AL-MED-001"
      signal: "Level transitions jarring"
      remediation: "Add smooth transition effects"

    - id: "AL-MED-002"
      signal: "Assets pop in visibly"
      remediation: "Implement smooth LOD transitions"

  low:
    - id: "AL-LOW-001"
      signal: "Loading times not measured"
      remediation: "Add loading time telemetry"

  positive:
    - id: "AL-POS-001"
      signal: "Smooth loading experience"
    - id: "AL-POS-002"
      signal: "No streaming hitches"
    - id: "AL-POS-003"
      signal: "Clear loading feedback"

procedure:
  context:
    cognitive_mode: "evaluative"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Measure Load Times"
      description: "Time all loading scenarios"
      duration_estimate: "45 min"

    - id: "2"
      name: "Test Streaming"
      description: "Check for streaming hitches"
      duration_estimate: "1 hour"

    - id: "3"
      name: "Review Loading Experience"
      description: "Assess user experience during loads"
      duration_estimate: "45 min"

    - id: "4"
      name: "Check Transitions"
      description: "Verify smooth transitions"
      duration_estimate: "30 min"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "loading_report"
      format: "json"
      description: "Asset loading analysis"

closeout_checklist:
  - id: "al-001"
    item: "No black screens during loading"
    level: "CRITICAL"
    verification: "manual"

  - id: "al-002"
    item: "No streaming hitches"
    level: "CRITICAL"
    verification: "automated"

governance:
  applicable_to:
    archetypes: ["xr-applications"]

relationships:
  commonly_combined:
    - "metaverse-immersive.rendering-performance.frame-rate-stability"
    - "metaverse-immersive.3d-asset-quality.texture-resolution"
