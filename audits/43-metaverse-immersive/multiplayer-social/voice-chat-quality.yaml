# ============================================================
# AUDIT: Voice Chat Quality
# Category: 43 - Metaverse & Immersive
# Subcategory: multiplayer-social
# ============================================================

audit:
  id: "metaverse-immersive.multiplayer-social.voice-chat-quality"
  name: "Voice Chat Quality Audit"
  version: "1.0.0"
  last_updated: "2025-01-22"
  status: "active"

  category: "metaverse-immersive"
  category_number: 43
  subcategory: "multiplayer-social"

  tier: "expert"
  estimated_duration: "2-4 hours"  # median: 3h

  completeness: "requires_discovery"
  requires_runtime: true
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "xr-systems"

  default_profiles:
    - "full"
    - "quick"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Evaluates voice chat implementation for social VR including audio
    quality, latency, spatial audio integration, and privacy controls.

  why_it_matters: |
    Voice is the primary communication method in social VR. Poor voice
    quality makes communication frustrating while lack of controls
    enables harassment. Quality voice chat is essential for social presence.

  when_to_run:
    - "During multiplayer development"
    - "When voice quality issues reported"
    - "During safety review"
    - "After voice system changes"

prerequisites:
  required_artifacts:
    - type: "voice_system"
      description: "Voice chat implementation"
    - type: "privacy_controls"
      description: "Voice privacy settings"

  access_requirements:
    - "Multiplayer environment"
    - "Multiple testers"

discovery:
  file_patterns:
    - glob: "**/voice/**/*.cs"
      purpose: "Find voice code"
    - glob: "**/chat/**/*.cs"
      purpose: "Find chat code"

  code_patterns:
    - pattern: "VoiceChat|Vivox|Photon Voice"
      type: "keyword"
      scope: "source"
      purpose: "Find voice systems"

knowledge_sources:
  guides:
    - id: "voice-design"
      name: "Social VR Voice Design"
      url: "https://developer.oculus.com/documentation/unity/ps-platform-voice/"
      offline_cache: true

tooling:
  analysis_tools:
    - tool: "voice-analyzer"
      purpose: "Voice quality analysis"

signals:
  critical:
    - id: "VCQ-CRIT-001"
      signal: "No mute or block capability"
      evidence_indicators:
        - "Cannot mute other users"
        - "Cannot block harassing users"
      explanation: |
        Without mute/block, users have no defense against harassment
        or unwanted audio.
      remediation: "Implement mute and block features"

    - id: "VCQ-CRIT-002"
      signal: "Voice latency breaks conversation"
      evidence_threshold: "voice_latency > 300ms"
      explanation: |
        High latency makes natural conversation impossible,
        defeating the purpose of social VR.
      remediation: "Reduce voice latency"

  high:
    - id: "VCQ-HIGH-001"
      signal: "Voice quality poor"
      evidence_indicators:
        - "Voice hard to understand"
        - "Excessive compression artifacts"
      remediation: "Improve voice codec and bitrate"

    - id: "VCQ-HIGH-002"
      signal: "Voice not spatially positioned"
      evidence_indicators:
        - "Voice not from avatar position"
        - "No distance attenuation"
      remediation: "Integrate voice with spatial audio"

  medium:
    - id: "VCQ-MED-001"
      signal: "No push-to-talk option"
      remediation: "Add push-to-talk mode"

    - id: "VCQ-MED-002"
      signal: "Voice levels unbalanced"
      remediation: "Add per-user volume control"

  low:
    - id: "VCQ-LOW-001"
      signal: "Voice settings limited"
      remediation: "Add voice configuration options"

  positive:
    - id: "VCQ-POS-001"
      signal: "Clear voice quality"
    - id: "VCQ-POS-002"
      signal: "Spatial voice positioning"
    - id: "VCQ-POS-003"
      signal: "Comprehensive controls"

procedure:
  context:
    cognitive_mode: "evaluative"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Test Voice Quality"
      description: "Assess clarity and latency"
      duration_estimate: "1 hour"

    - id: "2"
      name: "Test Spatial Audio"
      description: "Check voice positioning"
      duration_estimate: "45 min"

    - id: "3"
      name: "Test Controls"
      description: "Verify mute/block/volume"
      duration_estimate: "30 min"

    - id: "4"
      name: "Test Scale"
      description: "Check with many users"
      duration_estimate: "45 min"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "voice_report"
      format: "json"
      description: "Voice chat analysis"

closeout_checklist:
  - id: "vcq-001"
    item: "Mute/block available"
    level: "CRITICAL"
    verification: "manual"

  - id: "vcq-002"
    item: "Latency acceptable"
    level: "BLOCKING"
    verification: "automated"

governance:
  applicable_to:
    archetypes: ["social-vr", "metaverse"]

relationships:
  commonly_combined:
    - "metaverse-immersive.multiplayer-social.avatar-system"
    - "metaverse-immersive.multiplayer-social.social-boundaries"
