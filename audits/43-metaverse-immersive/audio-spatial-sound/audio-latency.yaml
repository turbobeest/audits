audit:
  id: metaverse-immersive.audio-spatial-sound.audio-latency
  name: Audio Latency Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: metaverse-immersive
  category_number: 43
  subcategory: audio-spatial-sound
  tier: expert
  estimated_duration: 2-3 hours  # median: 2h
  completeness: requires_discovery
  requires_runtime: true
  destructive: false
execution:
  automatable: 'yes'
  severity: high
  scope: xr-systems
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Measures and evaluates audio latency in XR applications including
    input-to-sound latency, spatial audio processing latency, and
    audio-visual synchronization.
  why_it_matters: |
    Audio latency breaks the illusion of cause and effect. Delayed
    sounds feel disconnected from actions and reduce presence.
    Audio-visual sync issues are particularly noticeable in VR.
  when_to_run:
  - When audio feels delayed
  - During performance testing
  - After audio system changes
  - When audio desync visible
prerequisites:
  required_artifacts:
  - type: audio_system
    description: Audio implementation
  - type: latency_tools
    description: Latency measurement tools
  access_requirements:
  - Audio system access
  - Measurement tools
discovery:
  metrics_queries:
  - system: audio_profiler
    query: audio_latency_ms
    purpose: Measure audio latency
    threshold: < 20ms
  file_patterns:
  - glob: '**/*.unity'
    purpose: Unity scene files
  - glob: '**/*.uasset'
    purpose: Unreal asset files
  - glob: '**/*.shader'
    purpose: Shader files
  - glob: '**/*.hlsl'
    purpose: HLSL shader code
  - glob: '**/*.glsl'
    purpose: GLSL shader code
  - glob: '**/ProjectSettings/**'
    purpose: Unity project settings
  code_patterns:
  - pattern: XR|VR|AR|MixedReality|OpenXR
    type: regex
    scope: source
    purpose: XR/VR/AR references
  - pattern: AudioSource|SpatialAudio|FMOD|Wwise
    type: regex
    scope: source
    purpose: Audio system references
knowledge_sources:
  guides:
  - id: audio-latency
    name: Audio Latency in XR
    url: https://developer.oculus.com/documentation/unity/audio-native-latency/
    offline_cache: true
tooling:
  analysis_tools:
  - tool: latency-meter
    purpose: Latency measurement
  - tool: av-sync-tester
    purpose: Audio-visual sync testing
signals:
  critical:
  - id: AL-CRIT-001
    signal: Audio latency > 50ms
    evidence_threshold: audio_latency > 50ms
    explanation: |
      High latency causes obvious delay between action and sound,
      breaking immersion and feeling unnatural.
    remediation: Reduce audio buffer sizes and optimize processing
  - id: AL-CRIT-002
    signal: Audio-visual desync visible
    evidence_indicators:
    - Lip sync noticeably off
    - Impact sounds delayed
    explanation: |
      Visible audio-visual desync is very distracting in VR
      due to increased attention to detail.
    remediation: Synchronize audio and visual events
  high:
  - id: AL-HIGH-001
    signal: Spatial audio adds significant latency
    evidence_threshold: spatialization_latency > 10ms
    remediation: Optimize spatial audio processing
  - id: AL-HIGH-002
    signal: Latency varies unpredictably
    evidence_indicators:
    - Latency spikes
    - Inconsistent audio timing
    remediation: Stabilize audio processing
  medium:
  - id: AL-MED-001
    signal: DSP buffer size not optimized
    remediation: Tune buffer size for latency
  - id: AL-MED-002
    signal: Audio threading issues
    remediation: Optimize audio thread
  low:
  - id: AL-LOW-001
    signal: Latency not measured
    remediation: Implement latency measurement
  positive:
  - id: AL-POS-001
    signal: Low audio latency
  - id: AL-POS-002
    signal: Perfect AV sync
  - id: AL-POS-003
    signal: Consistent timing
procedure:
  context:
    cognitive_mode: critical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Measure Base Latency
    description: Measure audio output latency
    duration_estimate: 30 min
  - id: '2'
    name: Test Input-to-Sound
    description: Measure action to sound delay
    duration_estimate: 45 min
  - id: '3'
    name: Check AV Sync
    description: Verify audio-visual synchronization
    duration_estimate: 45 min
  - id: '4'
    name: Test Under Load
    description: Check latency during heavy scenes
    duration_estimate: 30 min
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: latency_report
    format: json
    description: Audio latency metrics
closeout_checklist:
- id: al-001
  item: Latency < 20ms
  level: CRITICAL
  verification: automated
- id: al-002
  item: AV sync acceptable
  level: BLOCKING
  verification: manual
governance:
  applicable_to:
    archetypes:
    - xr-applications
relationships:
  commonly_combined:
  - metaverse-immersive.audio-spatial-sound.3d-audio-implementation
  - metaverse-immersive.rendering-performance.latency-motion-to-photon
