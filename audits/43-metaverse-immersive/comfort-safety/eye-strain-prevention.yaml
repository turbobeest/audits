# ============================================================
# AUDIT: Eye Strain Prevention
# Category: 43 - Metaverse & Immersive
# Subcategory: comfort-safety
# ============================================================

audit:
  id: "metaverse-immersive.comfort-safety.eye-strain-prevention"
  name: "Eye Strain Prevention Audit"
  version: "1.0.0"
  last_updated: "2025-01-22"
  status: "active"

  category: "metaverse-immersive"
  category_number: 43
  subcategory: "comfort-safety"

  tier: "expert"
  estimated_duration: "2-4 hours"  # median: 3h

  completeness: "requires_discovery"
  requires_runtime: true
  destructive: false

execution:
  automatable: "partial"
  requires_human_evaluation: true
  severity: "high"
  scope: "xr-systems"

  default_profiles:
    - "full"
    - "quick"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Evaluates factors that contribute to eye strain in XR including
    vergence-accommodation conflict, focal depth, brightness levels,
    text readability, and visual fatigue indicators.

  why_it_matters: |
    XR places unique strain on eyes due to vergence-accommodation conflict
    and fixed focal distance. Extended use without mitigation causes
    headaches, eye fatigue, and may have long-term health implications.
    Minimizing eye strain is essential for user health.

  when_to_run:
    - "During comfort review"
    - "When users report eye fatigue"
    - "After UI/text changes"
    - "During extended use testing"

prerequisites:
  required_artifacts:
    - type: "visual_design"
      description: "Visual elements and distances"
    - type: "brightness_settings"
      description: "Brightness and contrast controls"

  access_requirements:
    - "Access to VR application"
    - "Extended testing sessions"

discovery:
  file_patterns:
    - glob: "**/ui/**/*.cs"
      purpose: "Find UI code"
    - glob: "**/graphics/**/*.cs"
      purpose: "Find graphics settings"

  code_patterns:
    - pattern: "focusDistance|focalDepth"
      type: "keyword"
      scope: "source"
      purpose: "Find focal settings"

knowledge_sources:
  guides:
    - id: "eye-comfort"
      name: "VR Eye Comfort Guidelines"
      url: "https://developer.oculus.com/documentation/unity/unity-eyes/"
      offline_cache: true

    - id: "visual-fatigue"
      name: "VR Visual Fatigue Research"
      url: "https://pubmed.ncbi.nlm.nih.gov/28704650/"
      offline_cache: false

tooling:
  assessment_tools:
    - tool: "visual-fatigue-questionnaire"
      purpose: "Assess eye strain symptoms"

signals:
  critical:
    - id: "ESP-CRIT-001"
      signal: "Content too close to eyes"
      evidence_indicators:
        - "UI elements within 0.5m"
        - "Objects that must be viewed < 1m"
        - "Forced close focus"
      explanation: |
        Close objects cause severe vergence-accommodation conflict,
        leading to rapid eye strain and headaches.
      remediation: "Keep content at comfortable distance (1-2m)"

    - id: "ESP-CRIT-002"
      signal: "Extreme brightness without adjustment"
      evidence_indicators:
        - "Very bright scenes with no control"
        - "Flash effects without warning"
        - "High contrast causing fatigue"
      explanation: |
        Extreme brightness causes eye fatigue and can trigger
        photosensitive conditions.
      remediation: "Provide brightness controls and avoid extremes"

  high:
    - id: "ESP-HIGH-001"
      signal: "Small text requiring close focus"
      evidence_indicators:
        - "Text unreadable without leaning in"
        - "Small fonts in VR"
      remediation: "Use larger text at comfortable distance"

    - id: "ESP-HIGH-002"
      signal: "Rapid depth changes"
      evidence_indicators:
        - "Constant shifting between near and far"
        - "Focus changes required frequently"
      remediation: "Minimize rapid depth transitions"

  medium:
    - id: "ESP-MED-001"
      signal: "No brightness adjustment"
      remediation: "Add brightness controls"

    - id: "ESP-MED-002"
      signal: "High contrast environments"
      remediation: "Balance contrast levels"

  low:
    - id: "ESP-LOW-001"
      signal: "Eye comfort guidance missing"
      remediation: "Add usage guidance for eye health"

  positive:
    - id: "ESP-POS-001"
      signal: "Content at comfortable distances"
    - id: "ESP-POS-002"
      signal: "Brightness controls available"
    - id: "ESP-POS-003"
      signal: "Readable text without strain"

procedure:
  context:
    cognitive_mode: "evaluative"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Assess Content Distances"
      description: "Check depth of key visual elements"
      duration_estimate: "45 min"

    - id: "2"
      name: "Evaluate Brightness"
      description: "Check brightness levels and controls"
      duration_estimate: "30 min"

    - id: "3"
      name: "Test Readability"
      description: "Verify text comfortable to read"
      duration_estimate: "30 min"

    - id: "4"
      name: "Extended Use Test"
      description: "Test for eye fatigue over time"
      duration_estimate: "1.5 hours"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "eye_comfort_report"
      format: "prose"
      description: "Eye strain assessment"

closeout_checklist:
  - id: "esp-001"
    item: "Content at comfortable distances"
    level: "CRITICAL"
    verification: "manual"

  - id: "esp-002"
    item: "Brightness appropriate"
    level: "BLOCKING"
    verification: "manual"

  - id: "esp-003"
    item: "Text readable"
    level: "WARNING"
    verification: "manual"

governance:
  applicable_to:
    archetypes: ["vr-applications", "xr-applications"]

relationships:
  commonly_combined:
    - "metaverse-immersive.comfort-safety.session-length-guidance"
    - "metaverse-immersive.rendering-performance.resolution-fidelity"
