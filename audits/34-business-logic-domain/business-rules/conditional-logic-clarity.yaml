audit:
  id: business-logic-domain.business-rules.conditional-logic-clarity
  name: Conditional Logic Clarity Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: business-logic-domain
  category_number: 34
  subcategory: business-rules
  tier: expert
  estimated_duration: 3-5 hours  # median: 4h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: business-logic
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates the clarity and maintainability of conditional logic in business
    rules. This audit examines nested conditionals, complex boolean expressions,
    decision tables, and branching logic to ensure business rules are expressed
    clearly and correctly. It identifies overly complex conditions that are
    difficult to understand and maintain.
  why_it_matters: |
    Complex conditional logic is a major source of bugs and maintenance burden.
    When conditions are difficult to understand, developers make mistakes during
    modifications and reviewers miss errors. Clear conditional logic enables
    confident changes and accurate implementation of business requirements.
  when_to_run:
  - During code reviews for business rules
  - When simplifying legacy business logic
  - After bug fixes in conditional code
  - Before major rule modifications
prerequisites:
  required_artifacts:
  - type: source_code
    description: Business rule implementations
  - type: business_requirements
    description: Business rule specifications
  access_requirements:
  - Read access to business logic code
  - Access to code analysis tools
discovery:
  file_patterns:
  - glob: '**/domain/**/*.{ts,java,cs,py}'
    purpose: Find domain logic
  - glob: '**/rules/**/*.{ts,java,cs,py}'
    purpose: Find business rule implementations
  - glob: '**/services/**/*.{ts,java,cs,py}'
    purpose: Find service layer logic
  interview_questions:
  - role: Lead Developer
    questions:
    - Which business rules have the most complex conditionals?
    - Are there known issues with hard-to-understand logic?
    - How do you document complex business decisions?
  - role: Business Analyst
    questions:
    - Can you explain the business logic from reading the code?
    - Are decision tables or matrices used in requirements?
knowledge_sources:
  guides:
  - id: refactoring-conditionals
    name: Refactoring Conditional Logic
    url: https://refactoring.guru/refactoring/techniques/simplifying-conditional-expressions
  standards:
  - id: clean-code
    name: Clean Code
    relevance: Conditional simplification principles
tooling:
  analysis_tools:
  - tool: SonarQube
    purpose: Measure cyclomatic complexity
  - tool: CodeClimate
    purpose: Identify cognitive complexity
  - tool: ESLint complexity rules
    purpose: JavaScript complexity analysis
  - tool: PMD
    purpose: Java complexity metrics
signals:
  critical:
  - id: CLC-CRIT-001
    signal: Business rule has unreachable code paths
    evidence_indicators:
    - Dead code in conditional branches
    - Conditions that can never be true
    - Overlapping conditions with unreachable else
    explanation: |
      Unreachable code indicates logic errors. Business rules with dead code
      suggest either incorrect implementation or requirements that changed
      without code updates.
    remediation: Remove dead code; verify business requirements match implementation
  high:
  - id: CLC-HIGH-001
    signal: Deeply nested conditionals exceeding 4 levels
    evidence_indicators:
    - if-else chains nested more than 4 levels
    - Arrow code pattern
    - Difficult to trace execution path
    remediation: Refactor using guard clauses, extract methods, or strategy pattern
  - id: CLC-HIGH-002
    signal: Complex boolean expressions without explanation
    evidence_indicators:
    - Boolean expressions with more than 3 operators
    - No comments explaining business meaning
    - Conditions not decomposed into named methods
    remediation: Extract conditions into named methods; add business context comments
  medium:
  - id: CLC-MED-001
    signal: Similar conditionals duplicated across methods
    evidence_indicators:
    - Same condition checked in multiple places
    - Copy-pasted conditional logic
    - Inconsistent implementation of same rule
    remediation: Extract common conditionals into shared methods
  - id: CLC-MED-002
    signal: Magic numbers in conditions
    evidence_indicators:
    - Hardcoded values in comparisons
    - No constants for business thresholds
    - Meaning of values unclear
    remediation: Replace magic numbers with named constants explaining business meaning
  low:
  - id: CLC-LOW-001
    signal: Conditional structure does not match business documentation
    evidence_indicators:
    - Decision table in requirements not reflected in code structure
    - Business rules expressed differently than documented
    remediation: Restructure code to match business documentation structure
  positive:
  - id: CLC-POS-001
    signal: Business rules expressed as clear decision tables in code
  - id: CLC-POS-002
    signal: Complex conditions decomposed into well-named methods
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Measure Complexity
    description: Analyze cyclomatic and cognitive complexity metrics
    duration_estimate: 1 hour
    tools:
    - name: SonarQube
      action: Run complexity analysis
  - id: '2'
    name: Identify Complex Conditionals
    description: Find deeply nested and complex boolean expressions
    duration_estimate: 1 hour
  - id: '3'
    name: Review Business Alignment
    description: Check that conditionals match business requirements
    duration_estimate: 1 hour
  - id: '4'
    name: Analyze Duplication
    description: Find duplicated conditional patterns
    duration_estimate: 30 minutes
  - id: '5'
    name: Document Findings
    description: Compile clarity findings and refactoring recommendations
    duration_estimate: 30 minutes
output:
  deliverables:
  - type: finding_list
    format: structured
    description: List of conditional clarity issues
  - type: complexity_report
    format: structured
    description: Complexity metrics for business rules
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Complexity Analysis
    - Clarity Issues
    - Refactoring Recommendations
closeout_checklist:
- id: clc-001
  item: Complexity metrics collected
  level: REQUIRED
  verification: automated
- id: clc-002
  item: High-complexity rules identified
  level: REQUIRED
  verification: manual
- id: clc-003
  item: Refactoring recommendations provided
  level: WARNING
  verification: manual
governance:
  applicable_to:
    archetypes:
    - enterprise-applications
    - fintech
    - e-commerce
  compliance_mappings:
  - framework: Clean Code
    control: Maintainability
    description: Conditional logic clarity standards
relationships:
  commonly_combined:
  - business-logic-domain.business-rules.rule-completeness
  - code-quality.code-complexity
  depends_on:
  - requirements-specification.business-requirements
  feeds_into:
  - code-quality.maintainability
