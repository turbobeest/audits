# ============================================================
# AUDIT: Rule Completeness
# Category: 34 - Business Logic & Domain
# Subcategory: business-rules
# ============================================================

audit:
  id: "business-logic-domain.business-rules.rule-completeness"
  name: "Rule Completeness Audit"
  version: "1.0.0"
  last_updated: "2025-01-22"
  status: "active"

  category: "business-logic-domain"
  category_number: 34
  subcategory: "business-rules"

  tier: "expert"
  estimated_duration: "4-8 hours"  # median: 6h

  completeness: "requires_discovery"
  requires_runtime: false
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "business-logic"

  default_profiles:
    - "full"
    - "quick"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Evaluates whether all documented business rules have been implemented in the
    codebase. This audit traces business requirements to their code implementations,
    identifies unimplemented rules, and ensures that the system enforces all
    required business constraints. It creates a traceability matrix between
    requirements and code.

  why_it_matters: |
    Missing business rule implementations lead to incorrect system behavior,
    compliance violations, and business losses. When rules are documented but
    not implemented, the gap between expected and actual behavior causes confusion
    and erodes trust in the system. Complete rule coverage is essential for
    business integrity.

  when_to_run:
    - "After requirements finalization"
    - "Before release to production"
    - "During compliance audits"
    - "After major requirement changes"

prerequisites:
  required_artifacts:
    - type: "business_requirements"
      description: "Documented business rules and requirements"
    - type: "source_code"
      description: "Business logic implementation"
    - type: "test_cases"
      description: "Test coverage for business rules"

  access_requirements:
    - "Read access to business requirements documentation"
    - "Read access to source code"
    - "Access to test suites"

discovery:
  file_patterns:
    - glob: "**/domain/**/*.{ts,java,cs,py}"
      purpose: "Find domain logic implementations"
    - glob: "**/rules/**/*.{ts,java,cs,py}"
      purpose: "Find business rule implementations"
    - glob: "**/validators/**/*.{ts,java,cs,py}"
      purpose: "Find validation rule implementations"
    - glob: "**/test/**/*Rule*.*"
      purpose: "Find business rule tests"
    - glob: "**/spec/**/*Rule*.*"
      purpose: "Find business rule specifications"

  interview_questions:
    - role: "Business Analyst"
      questions:
        - "Where are all business rules documented?"
        - "How do you track which rules have been implemented?"
        - "Are there any rules that are known to be missing?"
    - role: "Lead Developer"
      questions:
        - "How do you ensure all requirements are implemented?"
        - "Is there traceability between requirements and code?"
        - "How are business rules verified during development?"

knowledge_sources:
  guides:
    - id: "requirements-traceability"
      name: "Requirements Traceability Best Practices"
      url: "https://www.modernanalyst.com/Resources/Articles/tabid/115/ID/1334/"

  standards:
    - id: "ieee-830"
      name: "IEEE 830 Software Requirements Specification"
      relevance: "Requirements documentation and traceability"

tooling:
  analysis_tools:
    - tool: "Jira"
      purpose: "Track requirements to implementation links"
    - tool: "Azure DevOps"
      purpose: "Requirements traceability matrices"
    - tool: "Polarion"
      purpose: "Requirements management and traceability"
    - tool: "Custom Scripts"
      purpose: "Generate traceability reports"

signals:
  critical:
    - id: "RCM-CRIT-001"
      signal: "Critical business rules not implemented"
      evidence_indicators:
        - "Documented rules with no corresponding code"
        - "Business-critical constraints not enforced"
        - "Compliance-required rules missing"
      explanation: |
        Missing critical business rules can lead to financial losses, compliance
        violations, and legal liability. When documented rules are not
        implemented, the system operates incorrectly.
      remediation: "Immediately implement missing critical business rules with full test coverage"

    - id: "RCM-CRIT-002"
      signal: "Rules implemented incorrectly compared to documentation"
      evidence_indicators:
        - "Code behavior differs from documented rules"
        - "Edge cases not handled as specified"
        - "Incorrect threshold or boundary values"
      explanation: |
        Incorrectly implemented rules are worse than missing rules because they
        give false confidence that requirements are met while producing
        incorrect results.
      remediation: "Correct rule implementations to match documented specifications exactly"

  high:
    - id: "RCM-HIGH-001"
      signal: "No traceability between requirements and implementation"
      evidence_indicators:
        - "Cannot map business rules to code locations"
        - "No requirement IDs in code comments or tests"
        - "Documentation and code managed separately"
      remediation: "Establish traceability links between requirements and code"

    - id: "RCM-HIGH-002"
      signal: "Business rules implemented without tests"
      evidence_indicators:
        - "No test coverage for business rule code"
        - "Rules cannot be verified automatically"
        - "Manual testing required for rule verification"
      remediation: "Add comprehensive test coverage for all business rules"

  medium:
    - id: "RCM-MED-001"
      signal: "Business rules partially implemented"
      evidence_indicators:
        - "Some conditions of a rule not handled"
        - "Happy path implemented but edge cases missing"
        - "Rule logic incomplete"
      remediation: "Complete implementation of all rule conditions and edge cases"

    - id: "RCM-MED-002"
      signal: "Undocumented rules implemented in code"
      evidence_indicators:
        - "Code contains business logic not in requirements"
        - "Rules added without business documentation"
        - "Implicit rules with no specification"
      remediation: "Document all implemented rules or remove if not required"

  low:
    - id: "RCM-LOW-001"
      signal: "Rule implementation difficult to trace"
      evidence_indicators:
        - "Business logic scattered across multiple files"
        - "No clear naming linking rules to requirements"
      remediation: "Organize code to make rule implementations easily traceable"

  positive:
    - id: "RCM-POS-001"
      signal: "Complete traceability matrix between requirements and code"
    - id: "RCM-POS-002"
      signal: "All business rules have corresponding test coverage"

procedure:
  context:
    cognitive_mode: "analytical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Inventory Business Rules"
      description: "Collect all documented business rules from requirements"
      duration_estimate: "1-2 hours"

    - id: "2"
      name: "Map Rules to Code"
      description: "Identify code locations implementing each rule"
      duration_estimate: "2-3 hours"

    - id: "3"
      name: "Verify Implementation Correctness"
      description: "Check that implementations match rule specifications"
      duration_estimate: "1-2 hours"

    - id: "4"
      name: "Check Test Coverage"
      description: "Verify test coverage exists for all rules"
      duration_estimate: "1 hour"

    - id: "5"
      name: "Document Findings"
      description: "Create traceability matrix and finding list"
      duration_estimate: "1 hour"

output:
  deliverables:
    - type: "traceability_matrix"
      format: "structured"
      description: "Matrix linking business rules to code implementations"

    - type: "finding_list"
      format: "structured"
      description: "List of missing or incorrect rule implementations"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Rule Coverage Statistics"
        - "Missing Rules"
        - "Incorrect Implementations"
        - "Recommendations"

closeout_checklist:
  - id: "rcm-001"
    item: "All documented rules inventoried"
    level: "REQUIRED"
    verification: "manual"
  - id: "rcm-002"
    item: "Traceability matrix created"
    level: "REQUIRED"
    verification: "manual"
  - id: "rcm-003"
    item: "Missing rules documented"
    level: "REQUIRED"
    verification: "manual"

governance:
  applicable_to:
    archetypes: ["enterprise-applications", "fintech", "healthcare", "regulated-industry"]

  compliance_mappings:
    - framework: "SOX"
      control: "ITGCs"
      description: "Business rule implementation controls"
    - framework: "ISO 9001"
      control: "Requirements Management"
      description: "Requirements traceability"

relationships:
  commonly_combined:
    - "business-logic-domain.business-rules.rule-consistency"
    - "testing-quality-assurance.requirements-coverage"
  depends_on:
    - "requirements-specification.business-requirements"
  feeds_into:
    - "compliance-legal.regulatory-compliance"
