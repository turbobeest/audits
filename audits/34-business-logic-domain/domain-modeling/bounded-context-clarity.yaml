# ============================================================
# AUDIT: Bounded Context Clarity
# Category: 34 - Business Logic & Domain
# Subcategory: domain-modeling
# ============================================================

audit:
  id: "business-logic-domain.domain-modeling.bounded-context-clarity"
  name: "Bounded Context Clarity Audit"
  version: "1.0.0"
  last_updated: "2025-01-22"
  status: "active"

  category: "business-logic-domain"
  category_number: 34
  subcategory: "domain-modeling"

  tier: "expert"
  estimated_duration: "4-8 hours"  # median: 6h

  completeness: "requires_discovery"
  requires_runtime: false
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "business-logic"

  default_profiles:
    - "full"
    - "quick"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Evaluates the clarity and correctness of bounded context definitions within
    a domain-driven design implementation. This audit examines whether bounded
    contexts are properly identified, their boundaries are well-defined, and
    the ubiquitous language is consistent within each context. It also reviews
    context mapping relationships and integration patterns between contexts.

  why_it_matters: |
    Unclear bounded context boundaries lead to model contamination, conflicting
    definitions, and tight coupling between teams. When contexts bleed into each
    other, changes in one area have unexpected impacts elsewhere. Clear bounded
    contexts enable team autonomy, independent deployability, and maintainable
    systems.

  when_to_run:
    - "During strategic domain modeling sessions"
    - "When experiencing model conflicts between teams"
    - "Before splitting a monolith into services"
    - "When onboarding new teams to the domain"

prerequisites:
  required_artifacts:
    - type: "context_map"
      description: "Bounded context map showing context relationships"
    - type: "source_code"
      description: "Domain model implementations across contexts"
    - type: "team_structure"
      description: "Team ownership information"

  access_requirements:
    - "Read access to all domain layer source code"
    - "Access to architecture documentation"
    - "Access to team structure information"

discovery:
  file_patterns:
    - glob: "**/contexts/**/*.{ts,java,cs,py}"
      purpose: "Find context-organized code"
    - glob: "**/modules/**/*.{ts,java,cs,py}"
      purpose: "Find module-organized domain code"
    - glob: "**/domain/**/*.{ts,java,cs,py}"
      purpose: "Find domain layer implementations"
    - glob: "**/anti-corruption-layer/**/*.{ts,java,cs,py}"
      purpose: "Find anti-corruption layer implementations"
    - glob: "**/*Translator*.{ts,java,cs,py}"
      purpose: "Find context translation code"

  interview_questions:
    - role: "Domain Expert"
      questions:
        - "What are the main subdomains in your business?"
        - "Where does the meaning of terms change across different areas?"
        - "Which teams own which parts of the domain?"
    - role: "Architect"
      questions:
        - "How are bounded contexts currently organized?"
        - "What integration patterns are used between contexts?"
        - "Are there any known context boundary violations?"

knowledge_sources:
  guides:
    - id: "ddd-reference"
      name: "Domain-Driven Design Reference"
      url: "https://www.domainlanguage.com/ddd/reference/"
    - id: "context-mapping"
      name: "Context Mapping Patterns"
      url: "https://github.com/ddd-crew/context-mapping"

  standards:
    - id: "ddd-strategic-patterns"
      name: "DDD Strategic Patterns"
      relevance: "Bounded context and context mapping patterns"

tooling:
  analysis_tools:
    - tool: "Context Mapper"
      purpose: "Bounded context visualization and validation"
    - tool: "Event Storming"
      purpose: "Collaborative context discovery"
    - tool: "NDepend"
      purpose: "Cross-context dependency analysis"
    - tool: "ArchUnit"
      purpose: "Enforce context boundary rules"

signals:
  critical:
    - id: "BCC-CRIT-001"
      signal: "Same term has conflicting definitions across contexts without translation"
      evidence_indicators:
        - "Entity with same name means different things in different modules"
        - "No anti-corruption layer between contexts"
        - "Direct imports from one context to another"
      explanation: |
        When the same term is used with different meanings without proper translation,
        it leads to confusion, bugs, and incorrect business logic. Each context
        should have its own model with explicit translation at boundaries.
      remediation: "Implement anti-corruption layers with explicit model translation between contexts"

    - id: "BCC-CRIT-002"
      signal: "Contexts have bidirectional dependencies creating tight coupling"
      evidence_indicators:
        - "Context A depends on B and B depends on A"
        - "Circular import chains across contexts"
        - "Changes in either context break the other"
      explanation: |
        Bidirectional dependencies between bounded contexts prevent independent
        evolution and deployment. This tight coupling defeats the purpose of
        context separation.
      remediation: "Introduce shared kernel or published language pattern to break circular dependencies"

  high:
    - id: "BCC-HIGH-001"
      signal: "Context boundaries do not align with team boundaries"
      evidence_indicators:
        - "Multiple teams modifying same context"
        - "Single team responsible for multiple conflicting contexts"
        - "Frequent merge conflicts across team boundaries"
      remediation: "Realign context boundaries with team ownership following Conway's Law"

    - id: "BCC-HIGH-002"
      signal: "Missing context map documentation"
      evidence_indicators:
        - "No documentation of context relationships"
        - "Team members unaware of context boundaries"
        - "Ad-hoc integration patterns between contexts"
      remediation: "Create and maintain a context map showing all contexts and their relationships"

  medium:
    - id: "BCC-MED-001"
      signal: "Inconsistent ubiquitous language within a context"
      evidence_indicators:
        - "Same concept has multiple names within one context"
        - "Code uses different terminology than domain experts"
        - "Glossary not maintained or followed"
      remediation: "Establish and enforce ubiquitous language glossary for each context"

    - id: "BCC-MED-002"
      signal: "Context integration pattern not explicitly defined"
      evidence_indicators:
        - "Unknown relationship type between contexts"
        - "Mixed integration patterns without clear rationale"
        - "No documented conformist/customer-supplier relationships"
      remediation: "Explicitly define and document integration patterns between all context pairs"

  low:
    - id: "BCC-LOW-001"
      signal: "Context names are technical rather than business-oriented"
      evidence_indicators:
        - "Contexts named after technologies or layers"
        - "Names do not reflect business subdomains"
      remediation: "Rename contexts to reflect business capabilities and subdomains"

  positive:
    - id: "BCC-POS-001"
      signal: "Clear context map with well-defined integration patterns"
    - id: "BCC-POS-002"
      signal: "Ubiquitous language consistently used within each context"

procedure:
  context:
    cognitive_mode: "analytical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Identify Bounded Contexts"
      description: "Map all bounded contexts and their responsibilities"
      duration_estimate: "1-2 hours"
      tools:
        - name: "Context Mapper"
          action: "Generate context map from code"

    - id: "2"
      name: "Analyze Context Relationships"
      description: "Document integration patterns between contexts"
      duration_estimate: "1-2 hours"

    - id: "3"
      name: "Validate Ubiquitous Language"
      description: "Check language consistency within each context"
      duration_estimate: "1 hour"

    - id: "4"
      name: "Review Team Alignment"
      description: "Assess alignment between contexts and team ownership"
      duration_estimate: "1 hour"

    - id: "5"
      name: "Document Findings"
      description: "Compile context clarity findings and recommendations"
      duration_estimate: "1 hour"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"
      description: "List of bounded context clarity issues"

    - type: "context_map"
      format: "diagram"
      description: "Visual context map with relationships"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Context Inventory"
        - "Integration Pattern Analysis"
        - "Language Consistency Review"
        - "Recommendations"

closeout_checklist:
  - id: "bcc-001"
    item: "All bounded contexts identified and documented"
    level: "REQUIRED"
    verification: "manual"
  - id: "bcc-002"
    item: "Context relationships mapped with integration patterns"
    level: "REQUIRED"
    verification: "manual"
  - id: "bcc-003"
    item: "Ubiquitous language reviewed for each context"
    level: "WARNING"
    verification: "manual"

governance:
  applicable_to:
    archetypes: ["enterprise-applications", "microservices", "platform"]

  compliance_mappings:
    - framework: "TOGAF"
      control: "Business Architecture"
      description: "Domain partitioning and capability mapping"

relationships:
  commonly_combined:
    - "business-logic-domain.domain-modeling.aggregate-boundary-analysis"
    - "architecture-design.microservices-boundaries"
  depends_on:
    - "requirements-specification.business-requirements"
  feeds_into:
    - "architecture-design.service-decomposition"
