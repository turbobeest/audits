audit:
  id: business-logic-domain.workflow-processes.workflow-versioning
  name: Workflow Versioning Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: business-logic-domain
  category_number: 34
  subcategory: workflow-processes
  tier: expert
  estimated_duration: 3-5 hours  # median: 4h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: business-logic
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates how workflow definitions are versioned and how version changes are
    handled for in-flight processes. This audit examines version control of
    workflow definitions, migration strategies for running processes, backward
    compatibility, and version tracking. It ensures workflow changes can be
    deployed safely without disrupting ongoing business processes.
  why_it_matters: |
    Business workflows evolve with changing requirements. Without proper versioning,
    workflow updates can break in-flight processes, causing business disruption
    and data integrity issues. Good versioning enables continuous improvement
    while maintaining operational stability.
  when_to_run:
  - Before deploying workflow changes
  - When planning workflow evolution strategy
  - After workflow-related deployment incidents
  - During process architecture reviews
prerequisites:
  required_artifacts:
  - type: workflow_definitions
    description: Workflow definition files
  - type: source_code
    description: Workflow implementation code
  - type: deployment_docs
    description: Workflow deployment procedures
  access_requirements:
  - Read access to workflow definitions
  - Access to version control history
  - Access to workflow engine configuration
discovery:
  file_patterns:
  - glob: '**/*.bpmn'
    purpose: Find BPMN workflow definitions
  - glob: '**/workflows/**/*.{yaml,json}'
    purpose: Find workflow configuration files
  - glob: '**/*Workflow*.{ts,java,cs,py}'
    purpose: Find workflow implementations
  - glob: '**/migrations/**/workflow*'
    purpose: Find workflow migrations
  interview_questions:
  - role: Lead Developer
    questions:
    - How do you version workflow definitions?
    - What happens to running processes when workflows are updated?
    - Can you run multiple versions of a workflow simultaneously?
  - role: Operations
    questions:
    - Have workflow deployments caused issues with in-flight processes?
    - How do you handle workflow rollbacks?
knowledge_sources:
  guides:
  - id: temporal-versioning
    name: Temporal Workflow Versioning
    url: https://docs.temporal.io/workflows#workflow-versioning
  - id: camunda-versioning
    name: Camunda Process Versioning
    url: https://docs.camunda.org/manual/latest/user-guide/process-engine/process-versioning/
  standards:
  - id: bpmn-versioning
    name: BPMN Versioning Best Practices
    relevance: Workflow versioning standards
tooling:
  analysis_tools:
  - tool: Camunda Cockpit
    purpose: Workflow version management
  - tool: Temporal Web UI
    purpose: Workflow version visualization
  - tool: Git
    purpose: Version control for workflow definitions
signals:
  critical:
  - id: WVS-CRIT-001
    signal: Workflow updates break in-flight processes
    evidence_indicators:
    - Running processes fail after deployment
    - Cannot deserialize process state
    - Missing handlers for legacy process steps
    explanation: |
      Breaking in-flight processes causes business disruption, lost work,
      and potential data corruption. Workflow updates must be backward
      compatible or include migration strategies.
    remediation: Implement versioning with migration support; maintain backward compatibility
  - id: WVS-CRIT-002
    signal: No version tracking for process instances
    evidence_indicators:
    - Cannot determine which version a process uses
    - No version stored with process state
    - Cannot audit workflow version at time of execution
    explanation: |
      Without version tracking, debugging issues and auditing process
      execution becomes impossible. Cannot reproduce historical behavior.
    remediation: Store workflow version with process state; add version to audit logs
  high:
  - id: WVS-HIGH-001
    signal: No migration strategy for workflow changes
    evidence_indicators:
    - All processes must complete before update
    - Manual migration required for changes
    - Long deployment windows needed
    remediation: Implement migration tooling; support running multiple versions
  - id: WVS-HIGH-002
    signal: Workflow definitions not in version control
    evidence_indicators:
    - Definitions only in workflow engine database
    - No history of definition changes
    - Cannot diff versions
    remediation: Store workflow definitions in version control; sync to engine
  medium:
  - id: WVS-MED-001
    signal: Breaking changes deployed without version increment
    evidence_indicators:
    - Same version number for incompatible changes
    - No semantic versioning for workflows
    - Cannot identify when breaking changes occurred
    remediation: Adopt semantic versioning for workflows; increment on breaking changes
  - id: WVS-MED-002
    signal: No testing strategy for workflow version upgrades
    evidence_indicators:
    - Version migrations not tested
    - No test processes for upgrade scenarios
    - Issues discovered in production
    remediation: Implement version upgrade testing; test with sample processes
  low:
  - id: WVS-LOW-001
    signal: Old workflow versions not cleaned up
    evidence_indicators:
    - Many unused versions in engine
    - No deprecation process
    remediation: Implement version lifecycle management; deprecate old versions
  positive:
  - id: WVS-POS-001
    signal: Smooth workflow version migrations with zero downtime
  - id: WVS-POS-002
    signal: Multiple workflow versions running simultaneously
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Assess Version Strategy
    description: Understand current workflow versioning approach
    duration_estimate: 1 hour
  - id: '2'
    name: Review Version Compatibility
    description: Analyze backward compatibility of versions
    duration_estimate: 1 hour
  - id: '3'
    name: Check Migration Tooling
    description: Review available migration capabilities
    duration_estimate: 1 hour
  - id: '4'
    name: Verify Version Tracking
    description: Ensure version is tracked with process state
    duration_estimate: 30 minutes
  - id: '5'
    name: Document Findings
    description: Compile workflow versioning findings
    duration_estimate: 30 minutes
output:
  deliverables:
  - type: finding_list
    format: structured
    description: List of workflow versioning issues
  - type: version_inventory
    format: structured
    description: Inventory of workflow versions
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Versioning Strategy
    - Compatibility Analysis
    - Migration Assessment
    - Recommendations
closeout_checklist:
- id: wvs-001
  item: Versioning strategy documented
  level: REQUIRED
  verification: manual
- id: wvs-002
  item: Version tracking verified
  level: REQUIRED
  verification: manual
- id: wvs-003
  item: Migration capabilities assessed
  level: WARNING
  verification: manual
governance:
  applicable_to:
    archetypes:
    - enterprise-applications
    - workflow-heavy-systems
  compliance_mappings:
  - framework: SOX
    control: Change Management
    description: Workflow change control
relationships:
  commonly_combined:
  - business-logic-domain.workflow-processes.state-machine-integrity
  - deployment.version-management
  depends_on:
  - deployment.change-management
  feeds_into:
  - operations-monitoring.workflow-monitoring
