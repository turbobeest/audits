audit:
  id: business-logic-domain.validation-rules.validation-error-handling
  name: Validation Error Handling Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: business-logic-domain
  category_number: 34
  subcategory: validation-rules
  tier: expert
  estimated_duration: 3-5 hours  # median: 4h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: business-logic
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates how validation errors are collected, formatted, and presented to
    users. This audit examines error message quality, field-level error mapping,
    error aggregation, internationalization of messages, and accessibility of
    error presentation.
  why_it_matters: |
    Good validation error handling is essential for user experience and data
    quality. When users cannot understand what is wrong or how to fix it, they
    abandon forms or enter incorrect data. Clear, actionable error messages
    help users succeed.
  when_to_run:
  - During UX reviews
  - After user complaints about errors
  - When implementing new forms
  - During accessibility audits
prerequisites:
  required_artifacts:
  - type: source_code
    description: Validation error handling code
  - type: ui_components
    description: Error display components
  - type: api_specs
    description: Error response formats
  access_requirements:
  - Read access to error handling code
  - Access to UI components
  - Access to localization resources
discovery:
  file_patterns:
  - glob: '**/errors/**/*.{ts,java,cs,py}'
    purpose: Find error handling code
  - glob: '**/components/**/*Error*.*'
    purpose: Find error display components
  - glob: '**/locales/**/*.{json,yaml}'
    purpose: Find error message translations
  - glob: '**/messages/**/*.{properties,json}'
    purpose: Find error messages
  interview_questions:
  - role: UX Designer
    questions:
    - How should validation errors be displayed?
    - What are common user complaints about errors?
    - How are errors prioritized?
  - role: Lead Developer
    questions:
    - How are validation errors collected?
    - Is there a standard error response format?
    - How are errors localized?
knowledge_sources:
  guides:
  - id: error-message-guidelines
    name: Error Message UX Guidelines
    url: https://www.nngroup.com/articles/error-message-guidelines/
  - id: wcag-errors
    name: WCAG Error Identification
    url: https://www.w3.org/WAI/WCAG21/Understanding/error-identification.html
  standards:
  - id: wcag-21
    name: WCAG 2.1
    relevance: Accessible error handling requirements
tooling:
  analysis_tools:
  - tool: aXe accessibility
    purpose: Check error accessibility
  - tool: i18n validators
    purpose: Check error message localization
  - tool: UX testing tools
    purpose: Test error clarity
signals:
  critical:
  - id: VEH-CRIT-001
    signal: Validation errors expose sensitive information
    evidence_indicators:
    - Stack traces in error messages
    - Database field names exposed
    - Internal paths revealed
    explanation: |
      Error messages that expose internal details create security
      vulnerabilities and confuse users.
    remediation: Return user-friendly errors; log technical details internally
  high:
  - id: VEH-HIGH-001
    signal: Only one error shown at a time
    evidence_indicators:
    - Users must fix errors sequentially
    - Only first validation failure returned
    - Multiple form submissions to fix all errors
    remediation: Collect and return all validation errors together
  - id: VEH-HIGH-002
    signal: Errors not associated with specific fields
    evidence_indicators:
    - Generic error at top of form
    - No inline field errors
    - Users cannot identify which field failed
    remediation: Map errors to specific fields; show inline errors
  medium:
  - id: VEH-MED-001
    signal: Error messages not actionable
    evidence_indicators:
    - Messages say what is wrong but not how to fix
    - No guidance on expected format
    - Generic 'invalid' messages
    remediation: Make error messages actionable with fix guidance
  - id: VEH-MED-002
    signal: Error messages not localized
    evidence_indicators:
    - Hardcoded English messages
    - No translation support
    - Technical messages to non-English users
    remediation: Implement error message localization
  low:
  - id: VEH-LOW-001
    signal: Error display not accessible
    evidence_indicators:
    - Errors not announced to screen readers
    - Color-only error indication
    - No ARIA attributes on errors
    remediation: Add ARIA live regions; ensure accessible error display
  positive:
  - id: VEH-POS-001
    signal: All errors collected and shown with field mapping
  - id: VEH-POS-002
    signal: Accessible, localized, actionable error messages
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Review Error Collection
    description: Analyze how validation errors are collected
    duration_estimate: 1 hour
  - id: '2'
    name: Assess Error Formatting
    description: Review error response formats
    duration_estimate: 1 hour
  - id: '3'
    name: Evaluate User Presentation
    description: Test error display in UI
    duration_estimate: 1 hour
    tools:
    - name: aXe
      action: Run accessibility audit on error states
  - id: '4'
    name: Check Localization
    description: Verify error messages are translatable
    duration_estimate: 30 minutes
  - id: '5'
    name: Document Findings
    description: Compile validation error handling findings
    duration_estimate: 30 minutes
output:
  deliverables:
  - type: finding_list
    format: structured
    description: List of error handling issues
  - type: error_inventory
    format: structured
    description: Inventory of error types and messages
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Error Collection Analysis
    - Presentation Review
    - Accessibility Assessment
    - Recommendations
closeout_checklist:
- id: veh-001
  item: Error collection reviewed
  level: REQUIRED
  verification: manual
- id: veh-002
  item: User presentation assessed
  level: REQUIRED
  verification: manual
- id: veh-003
  item: Accessibility verified
  level: WARNING
  verification: automated
governance:
  applicable_to:
    archetypes:
    - all-applications
  compliance_mappings:
  - framework: WCAG
    control: 3.3 Input Assistance
    description: Accessible error handling
relationships:
  commonly_combined:
  - business-logic-domain.validation-rules.input-validation-completeness
  - accessibility.wcag-compliance
  depends_on:
  - ux-design.error-design
  feeds_into:
  - user-experience.form-completion
