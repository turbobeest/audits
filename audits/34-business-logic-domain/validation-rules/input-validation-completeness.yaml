audit:
  id: business-logic-domain.validation-rules.input-validation-completeness
  name: Input Validation Completeness Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: business-logic-domain
  category_number: 34
  subcategory: validation-rules
  tier: expert
  estimated_duration: 4-6 hours  # median: 5h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: business-logic
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates the completeness of input validation across all entry points.
    This audit examines validation rules for user inputs, API parameters,
    file uploads, and external data. It ensures all inputs are validated
    for type, format, range, and business constraints before processing.
  why_it_matters: |
    Incomplete input validation leads to data corruption, security vulnerabilities,
    and system failures. Invalid data that enters the system causes downstream
    errors that are difficult to trace. Comprehensive validation is the first
    line of defense for data integrity.
  when_to_run:
  - During security reviews
  - When adding new input points
  - After data integrity issues
  - Before major releases
prerequisites:
  required_artifacts:
  - type: source_code
    description: Input handling implementations
  - type: api_specs
    description: API specifications
  - type: data_models
    description: Data model definitions
  access_requirements:
  - Read access to input handling code
  - Access to API specifications
  - Access to validation configurations
discovery:
  file_patterns:
  - glob: '**/controllers/**/*.{ts,java,cs,py}'
    purpose: Find controller/handler code
  - glob: '**/validators/**/*.{ts,java,cs,py}'
    purpose: Find validation code
  - glob: '**/*Dto*.{ts,java,cs,py}'
    purpose: Find DTOs with validation
  - glob: '**/*Request*.{ts,java,cs,py}'
    purpose: Find request objects
  - glob: '**/api/**/*.{yaml,json}'
    purpose: Find API specifications
  interview_questions:
  - role: Lead Developer
    questions:
    - How is input validation handled?
    - Are there validation standards or frameworks?
    - Where is validation performed (client, server, both)?
  - role: Security Engineer
    questions:
    - What validation gaps have been found?
    - How are file uploads validated?
    - Are there bypass paths for validation?
knowledge_sources:
  guides:
  - id: owasp-input-validation
    name: OWASP Input Validation
    url: https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html
  - id: bean-validation
    name: Bean Validation (JSR 380)
    url: https://beanvalidation.org/
  standards:
  - id: owasp-asvs
    name: OWASP ASVS
    relevance: Input validation requirements
tooling:
  analysis_tools:
  - tool: OWASP ZAP
    purpose: Automated validation testing
  - tool: SonarQube
    purpose: Detect missing validation
  - tool: Spectral
    purpose: OpenAPI validation rules
  - tool: Bean Validation
    purpose: Java validation framework
signals:
  critical:
  - id: IVC-CRIT-001
    signal: Input directly used without validation
    evidence_indicators:
    - User input passed to database without validation
    - File paths constructed from unvalidated input
    - Command execution with unvalidated parameters
    explanation: |
      Unvalidated input is a major security vulnerability leading to
      injection attacks, path traversal, and command injection.
    remediation: Validate all input at trust boundaries before use
  - id: IVC-CRIT-002
    signal: Validation bypassed through alternative paths
    evidence_indicators:
    - Validation on client but not server
    - Direct API calls bypass UI validation
    - Internal APIs without validation
    explanation: |
      Validation that can be bypassed provides no protection. All
      validation must be enforced server-side.
    remediation: Implement validation at server-side; validate on all entry points
  high:
  - id: IVC-HIGH-001
    signal: Type validation missing
    evidence_indicators:
    - String used where number expected
    - No type coercion validation
    - Type mismatch errors in production
    remediation: Add type validation for all inputs; use strong typing
  - id: IVC-HIGH-002
    signal: Range validation missing
    evidence_indicators:
    - Negative quantities accepted
    - Dates in the past for future events
    - No min/max bounds on numeric inputs
    remediation: Add range validation matching business constraints
  medium:
  - id: IVC-MED-001
    signal: Format validation too permissive
    evidence_indicators:
    - Email validation accepts invalid formats
    - Phone numbers not normalized
    - Date formats inconsistent
    remediation: Tighten format validation; use standard patterns
  - id: IVC-MED-002
    signal: Validation messages not user-friendly
    evidence_indicators:
    - Technical error messages
    - No field-level error identification
    - All-or-nothing validation feedback
    remediation: Provide clear, specific validation messages
  low:
  - id: IVC-LOW-001
    signal: Validation rules not documented
    evidence_indicators:
    - Validation only visible in code
    - API docs don't specify constraints
    remediation: Document validation rules in API specifications
  positive:
  - id: IVC-POS-001
    signal: Comprehensive validation at all entry points
  - id: IVC-POS-002
    signal: Validation rules documented and testable
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Map Entry Points
    description: Identify all input entry points
    duration_estimate: 1 hour
  - id: '2'
    name: Review Validation Rules
    description: Analyze validation for each entry point
    duration_estimate: 2 hours
  - id: '3'
    name: Test Validation Bypass
    description: Attempt to bypass validation
    duration_estimate: 1 hour
    tools:
    - name: OWASP ZAP
      action: Run validation bypass tests
  - id: '4'
    name: Check Business Constraints
    description: Verify business rule validation
    duration_estimate: 1 hour
  - id: '5'
    name: Document Findings
    description: Compile validation completeness findings
    duration_estimate: 30 minutes
output:
  deliverables:
  - type: finding_list
    format: structured
    description: List of validation gaps
  - type: validation_matrix
    format: structured
    description: Matrix of entry points and validation rules
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Entry Point Inventory
    - Validation Coverage
    - Gap Analysis
    - Recommendations
closeout_checklist:
- id: ivc-001
  item: All entry points identified
  level: REQUIRED
  verification: manual
- id: ivc-002
  item: Validation coverage assessed
  level: REQUIRED
  verification: automated
- id: ivc-003
  item: Bypass testing completed
  level: WARNING
  verification: manual
governance:
  applicable_to:
    archetypes:
    - all-applications
  compliance_mappings:
  - framework: OWASP ASVS
    control: V5 Validation
    description: Input validation requirements
  - framework: PCI-DSS
    control: 6.5.1
    description: Injection prevention
relationships:
  commonly_combined:
  - security.injection-prevention
  - business-logic-domain.validation-rules.business-constraint-enforcement
  depends_on:
  - requirements-specification.data-requirements
  feeds_into:
  - security.application-security
