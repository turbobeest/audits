audit:
  id: signal-processing-data-acquisition.spectral-analysis.spectral-leakage
  name: Spectral Leakage Audit
  version: 1.0.0
  last_updated: '2026-01-22'
  status: active
  category: signal-processing-data-acquisition
  category_number: 40
  subcategory: spectral-analysis
  tier: expert
  estimated_duration: 1 hour
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: software
  default_profiles:
  - full
  - signal-processing
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit evaluates spectral leakage control in FFT-based
    spectral analysis. It examines:
    - Sources of spectral leakage
    - Window function effectiveness
    - Impact on dynamic range
    - Leakage effects on weak signal detection
    - Quantification of leakage levels
  why_it_matters: |
    Spectral leakage corrupts frequency measurements:
    - Non-integer-period signals spread energy across bins
    - Side lobes from strong signals mask weak ones
    - Rectangular window has -13dB side lobes
    - Proper windowing reduces leakage to -60dB or better
    - High dynamic range requires excellent leakage control

    Without leakage control, spectral analysis produces misleading
    results with energy appearing at wrong frequencies.
  when_to_run:
  - Spectral analysis system design
  - Dynamic range verification
  - Weak signal detection applications
  - Amplitude accuracy assessment
prerequisites:
  required_artifacts:
  - type: source_code
    description: Spectral analysis implementation
  - type: requirements
    description: Dynamic range requirements
  - type: test_data
    description: Test signals for leakage assessment
  access_requirements:
  - Access to analysis code
  - Dynamic range specifications
  - Test capability
discovery:
  code_patterns:
  - pattern: (leakage|side_lobe|dynamic_range)
    type: regex
    scope: source
    purpose: Detect leakage considerations
  - pattern: (window|hann|hamming|blackman)
    type: regex
    scope: source
    purpose: Detect windowing
  file_patterns:
  - glob: '**/fft*.{c,h,cpp,py}'
    purpose: FFT files
  - glob: '**/spectrum*.{c,h,cpp,py}'
    purpose: Spectral analysis files
knowledge_sources:
  specifications:
  - id: harris-windows
    name: Harris - Windows for Harmonic Analysis
    url: https://ieeexplore.ieee.org/document/1455106
    offline_cache: true
    priority: required
signals:
  critical:
  - id: LEAK-CRIT-001
    signal: Severe spectral leakage masking signals
    evidence_indicators:
    - Weak signals hidden by strong signal side lobes
    - No windowing applied
    - Side lobes > -30dB
    explanation: |
      Severe leakage from unwindowed FFT (-13dB side lobes)
      makes weak signals undetectable near strong ones.
      A signal 20dB above noise masks everything within
      several bins of its frequency.
    remediation: |
      - Apply appropriate window function
      - Use Blackman-Harris for high dynamic range
      - Verify side lobe levels meet requirements
      - Test with signals at expected dynamic range
    cwe: CWE-682
  high:
  - id: LEAK-HIGH-001
    signal: Leakage exceeds dynamic range requirements
    evidence_indicators:
    - Side lobe level > -dynamic_range
    - Measurement floor limited by leakage
    - Window insufficient for application
    explanation: |
      Side lobe level limits achievable dynamic range. For 60dB
      dynamic range, side lobes must be <-60dB. Window selection
      must match dynamic range requirements.
    remediation: |
      - Select window with adequate side lobe suppression
      - Hann: -32dB, Hamming: -43dB, Blackman: -58dB
      - Use Blackman-Harris for >60dB range
      - Verify actual dynamic range in measurements
  medium:
  - id: LEAK-MED-001
    signal: Leakage effects not characterized
    evidence_indicators:
    - Side lobe levels unknown
    - Dynamic range assumed but not verified
    - No leakage test performed
    explanation: |
      Without characterization, leakage effects are unknown.
      System may have hidden dynamic range limitations that
      affect measurement accuracy.
    remediation: |
      - Characterize side lobe levels
      - Test with known signals and measure leakage
      - Document achieved dynamic range
      - Verify against requirements
  low:
  - id: LEAK-LOW-001
    signal: Leakage not documented
    evidence_indicators:
    - No specification of expected leakage
    - Window selection not justified for leakage
    - Dynamic range not in specifications
    explanation: |
      Undocumented leakage characteristics make it difficult
      to assess measurement capability and troubleshoot issues.
    remediation: |
      - Document expected side lobe levels
      - Specify dynamic range capability
      - Include in system specifications
      - Note limitations
  positive:
  - id: LEAK-POS-001
    signal: Leakage well-controlled and characterized
    evidence_indicators:
    - Window matched to dynamic range
    - Side lobe levels verified
    - Documentation complete
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: dsp-engineer
  steps:
  - id: '1'
    name: Leakage Control Review
    description: |
      Review windowing and leakage control.
    duration_estimate: 30 min
    commands:
    - purpose: Find windowing implementation
      command: |
        grep -rniE "(window|leakage)" \
          --include="*.c" --include="*.h" --include="*.py" . 2>/dev/null | head -20
    expected_findings:
    - Window type
    - Expected side lobe level
    - Dynamic range considerations
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Leakage Analysis
    - Dynamic Range Assessment
    - Recommendations
profiles:
  membership:
    quick:
      included: false
    full:
      included: true
      priority: 3
    signal-processing:
      included: true
      priority: 2
closeout_checklist:
- id: leak-001
  item: Spectral leakage controlled
  level: CRITICAL
  verification: manual
  verification_notes: Verify windowing applied and adequate
  expected: Confirmed by reviewer
- id: leak-002
  item: Dynamic range meets requirements
  level: BLOCKING
  verification: manual
  verification_notes: Verify side lobe level supports required dynamic range
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - signal-processing
    - scientific-instruments
    - audio-systems
relationships:
  commonly_combined:
  - signal-processing.spectral-analysis.windowing-function
  - signal-processing.spectral-analysis.fft-implementation
  - signal-processing.spectral-analysis.power-spectral-density

# Glossary of domain-specific terms:
glossary:
  "mu (step size)": "Learning rate parameter in adaptive filters, controls convergence speed vs stability"
  "LMS": "Least Mean Squares - adaptive filter algorithm that minimizes mean squared error"
  "FFT": "Fast Fourier Transform - efficient algorithm to compute discrete Fourier transform"
