audit:
  id: dependency-supply-chain.license-compliance.attribution-requirements
  name: Attribution Requirements Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: dependency-supply-chain
  category_number: 32
  subcategory: license-compliance
  tier: expert
  estimated_duration: 2-3 hours  # median: 2h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: dependencies
  default_profiles:
  - full
  - legal
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit identifies and documents all attribution requirements
    from dependency licenses. Many open source licenses (Apache, BSD,
    MIT) require attribution when software is distributed. This audit
    ensures all required attributions are properly included.
  why_it_matters: |
    Failure to provide required attributions is a license violation,
    even for permissive licenses. Organizations have faced legal action
    for missing attributions. Proper attribution also respects the
    contributions of open source maintainers.
  when_to_run:
  - Before software release
  - When updating dependencies
  - During compliance audits
  - Before open-sourcing projects
prerequisites:
  required_artifacts:
  - type: license_inventory
    description: List of dependency licenses
  - type: notice_files
    description: NOTICE files from dependencies
  access_requirements:
  - Read access to dependency packages
  - Read access to distribution materials
discovery:
  file_patterns:
  - glob: '**/NOTICE*'
    purpose: Find NOTICE files
  - glob: '**/ATTRIBUTION*'
    purpose: Find attribution files
  - glob: '**/CREDITS*'
    purpose: Find credits files
  - glob: '**/THIRD-PARTY*'
    purpose: Find third-party notices
  - glob: '**/node_modules/*/LICENSE*'
    purpose: Find dependency licenses
knowledge_sources:
  guides:
  - id: apache-notice
    name: Apache License NOTICE Requirements
    url: https://www.apache.org/licenses/LICENSE-2.0#redistribution
  - id: attribution-best-practices
    name: Open Source Attribution Best Practices
    url: https://wiki.openstack.org/wiki/LegalIssuesFAQ#What_is_the_NOTICE_file_for.3F
  standards:
  - id: spdx-notice
    name: SPDX Notice Requirements
    relevance: Standard attribution practices
tooling:
  analysis_tools:
  - tool: license-checker
    purpose: Generate license notices
  - tool: generate-license-file
    purpose: Create combined license file
  - tool: oss-attribution-generator
    purpose: Generate attribution documents
signals:
  critical:
  - id: DEP-ATTR-CRIT-001
    signal: Required attributions missing from distribution
    evidence_indicators:
    - Apache licensed deps without NOTICE in dist
    - BSD deps without copyright notice
    explanation: |
      Missing required attributions constitute license violation.
      This can result in legal action and requirement to recall
      distributed software.
    remediation: Add all required attributions to distribution
  high:
  - id: DEP-ATTR-HIGH-001
    signal: NOTICE file incomplete
    evidence_indicators:
    - Some Apache dependencies not in NOTICE
    - NOTICE not updated when deps change
    remediation: Update NOTICE to include all required attributions
  - id: DEP-ATTR-HIGH-002
    signal: Attribution in wrong location
    evidence_indicators:
    - Attribution only in source, not in binary distribution
    - NOTICE file not included in package
    remediation: Ensure attribution included in all distribution formats
  medium:
  - id: DEP-ATTR-MED-001
    signal: Attribution not updated with dependency changes
    evidence_indicators:
    - Stale attributions for removed deps
    - New deps without attribution
    remediation: Automate attribution generation on build
  - id: DEP-ATTR-MED-002
    signal: Attribution format inconsistent
    evidence_indicators:
    - Mix of formats
    - Some attributions incomplete
    remediation: Standardize attribution format
  low:
  - id: DEP-ATTR-LOW-001
    signal: Attribution not easily accessible to users
    evidence_indicators:
    - Deep in file hierarchy
    - Not linked from README
    remediation: Make attributions easily discoverable
  positive:
  - id: DEP-ATTR-POS-001
    signal: Complete and accurate attribution maintained
  - id: DEP-ATTR-POS-002
    signal: Attribution automatically generated on build
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Generate License Summary
    description: Create list of all dependency licenses
    commands:
    - purpose: Generate licenses with package info
      command: npx license-checker --csv 2>/dev/null | head -50 || echo 'license-checker not available'
  - id: '2'
    name: Identify Attribution Requirements
    description: Find licenses requiring attribution
    commands:
    - purpose: Find Apache licensed packages
      command: npx license-checker 2>/dev/null | grep -E 'Apache|BSD|MIT' | head -30 || echo 'Attribution
        check not available'
  - id: '3'
    name: Check for NOTICE Files
    description: Find existing attribution files
    commands:
    - purpose: Find NOTICE files
      command: find . -iname 'NOTICE*' -o -iname 'ATTRIBUTION*' -o -iname 'THIRD-PARTY*' | grep -v node_modules
        | head -10
  - id: '4'
    name: Generate Attribution File
    description: Create combined attribution document
    commands:
    - purpose: Generate license file with license-checker
      command: npx license-checker --generateDisclaimers --output THIRD_PARTY_LICENSES.txt 2>/dev/null
        && echo 'Generated THIRD_PARTY_LICENSES.txt' || echo 'Attribution generation not available'
  - id: '5'
    name: Check Build Includes Attribution
    description: Verify attribution in distribution
    commands:
    - purpose: Check dist directory for notices
      command: find dist build -iname '*NOTICE*' -o -iname '*LICENSE*' -o -iname '*THIRD*' 2>/dev/null
        | head -10 || echo 'Check distribution manually'
  - id: '6'
    name: Verify Specific Requirements
    description: Check for special attribution needs
    commands:
    - purpose: Check for Apache NOTICE requirements
      command: find node_modules -name 'NOTICE*' 2>/dev/null | head -20 || echo 'Check Apache package
        NOTICE files manually'
output:
  deliverables:
  - type: attribution_requirements
    format: structured
    description: List of required attributions
  - type: notice_file
    format: text
    description: Generated NOTICE/attribution file
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Attribution Requirements
    - Current State
    - Gap Analysis
    - Recommendations
closeout_checklist:
- id: dep-attr-001
  item: All attribution requirements identified
  level: REQUIRED
  verification: Requirements documented
- id: dep-attr-002
  item: NOTICE/attribution file generated
  level: REQUIRED
  verification: File exists and is complete
- id: dep-attr-003
  item: Attribution included in distribution
  level: CRITICAL
  verification: Distribution includes notices
- id: dep-attr-004
  item: Attribution generation automated
  level: RECOMMENDED
  verification: Build generates attribution
governance:
  applicable_to:
    archetypes:
    - all-software-projects
  compliance_mappings:
  - framework: SOC 2
    control: CC6.1
    description: License compliance
  - framework: ISO 27001
    control: A.18.1.2
    description: Intellectual property rights
relationships:
  commonly_combined:
  - dependency-supply-chain.license-compliance.license-detection
  depends_on:
  - dependency-supply-chain.license-compliance.license-detection
  feeds_into:
  - compliance-legal.distribution-compliance
