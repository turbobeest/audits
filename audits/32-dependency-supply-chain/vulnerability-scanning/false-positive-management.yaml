audit:
  id: dependency-supply-chain.vulnerability-scanning.false-positive-management
  name: False Positive Management Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: dependency-supply-chain
  category_number: 32
  subcategory: vulnerability-scanning
  tier: expert
  estimated_duration: 1-2 hours  # median: 1h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: dependencies
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit evaluates how false positives from vulnerability scanners
    are identified, documented, and managed. It assesses the processes
    for reviewing scanner findings, marking legitimate false positives,
    and preventing alert fatigue that leads to real issues being ignored.
  why_it_matters: |
    High false positive rates cause security alert fatigue, leading teams
    to ignore scanner results entirely. Proper false positive management
    maintains scanner credibility while ensuring legitimate issues get
    attention. Undocumented suppressions can hide real vulnerabilities.
  when_to_run:
  - When scanner noise becomes problematic
  - During security tool effectiveness reviews
  - When onboarding new scanners
  - Quarterly maintenance
prerequisites:
  required_artifacts:
  - type: scanner_config
    description: Scanner configuration including suppressions
  - type: ignore_files
    description: .snyk, .trivyignore, etc.
  access_requirements:
  - Access to scanner configuration
  - Access to suppression documentation
discovery:
  file_patterns:
  - glob: '**/.snyk'
    purpose: Find Snyk ignore configuration
  - glob: '**/.trivyignore'
    purpose: Find Trivy ignore configuration
  - glob: '**/.grype.yaml'
    purpose: Find Grype configuration
  - glob: '**/audit-resolve.json'
    purpose: Find npm audit resolutions
  - glob: '**/.nsprc'
    purpose: Find nsp ignore configuration
knowledge_sources:
  guides:
  - id: snyk-ignoring
    name: Snyk Ignoring Issues
    url: https://docs.snyk.io/snyk-cli/commands/ignore
  - id: trivy-filtering
    name: Trivy Filtering Vulnerabilities
    url: https://aquasecurity.github.io/trivy/latest/docs/configuration/filtering/
tooling:
  analysis_tools:
  - tool: snyk
    purpose: Manage Snyk ignores
  - tool: trivy
    purpose: Configure Trivy exclusions
  - tool: grype
    purpose: Configure Grype ignores
signals:
  critical:
  - id: DEP-FP-CRIT-001
    signal: Suppressions hiding actual vulnerabilities
    evidence_indicators:
    - Broad wildcard suppressions
    - Suppressions without expiration dates
    - Old suppressions never reviewed
    explanation: |
      Overly broad or stale suppressions may be hiding real vulnerabilities
      that should be addressed. Regular review of suppressions is essential
      to prevent this security debt accumulation.
    remediation: Review and narrow all suppressions; add expiration dates
  high:
  - id: DEP-FP-HIGH-001
    signal: Suppressions lack justification
    evidence_indicators:
    - No documentation for why suppressed
    - No ticket or issue reference
    remediation: Document justification for all suppressions
  - id: DEP-FP-HIGH-002
    signal: No review process for suppressions
    evidence_indicators:
    - Suppressions added without approval
    - No periodic review scheduled
    remediation: Implement suppression review process
  medium:
  - id: DEP-FP-MED-001
    signal: High percentage of findings suppressed
    evidence_indicators:
    - More than 20% of findings suppressed
    - Large ignore lists
    remediation: Evaluate if scanner is appropriate; review suppressions
  - id: DEP-FP-MED-002
    signal: Suppressions not version-specific
    evidence_indicators:
    - Ignoring CVE regardless of version
    - Suppression continues after package update
    remediation: Make suppressions specific to affected versions
  low:
  - id: DEP-FP-LOW-001
    signal: Suppression configuration scattered
    evidence_indicators:
    - Multiple ignore files
    - Suppressions in different formats
    remediation: Consolidate suppression configuration
  positive:
  - id: DEP-FP-POS-001
    signal: Well-documented suppression process
  - id: DEP-FP-POS-002
    signal: Regular suppression review performed
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Find Suppression Configurations
    description: Locate all vulnerability suppression files
    commands:
    - purpose: Find ignore files
      command: find . -name '.snyk' -o -name '.trivyignore' -o -name '.grype.yaml' -o -name 'audit-resolve.json'
        2>/dev/null | grep -v node_modules
  - id: '2'
    name: Review Snyk Ignores
    description: Analyze Snyk suppression configuration
    commands:
    - purpose: View Snyk ignores
      command: cat .snyk 2>/dev/null | head -50 || echo 'No .snyk file found'
  - id: '3'
    name: Review npm Audit Resolutions
    description: Check npm audit-resolve configuration
    commands:
    - purpose: View npm audit resolutions
      command: cat audit-resolve.json 2>/dev/null || echo 'No audit-resolve.json found'
    - purpose: Check package.json overrides
      command: cat package.json 2>/dev/null | jq '.overrides // .resolutions // empty' || echo 'No overrides
        found'
  - id: '4'
    name: Assess Suppression Justifications
    description: Check if suppressions are documented
    commands:
    - purpose: Look for suppression documentation
      command: |-
        echo 'Manual review required:
        - Check if each suppression has a reason
        - Verify expiration dates are set
        - Look for ticket/issue references'
  - id: '5'
    name: Count Suppression Rate
    description: Calculate what percentage of findings are suppressed
    commands:
    - purpose: Compare total vs suppressed
      command: |-
        echo 'Compare:
        - Total vulnerabilities detected (run full scan)
        - Vulnerabilities after suppressions applied
        - Calculate suppression rate'
  - id: '6'
    name: Check Suppression Age
    description: Identify stale suppressions
    commands:
    - purpose: Check file modification dates
      command: ls -la .snyk .trivyignore audit-resolve.json 2>/dev/null || echo 'Check git history for
        suppression file ages'
output:
  deliverables:
  - type: suppression_inventory
    format: structured
    description: List of all active suppressions
  - type: suppression_assessment
    format: structured
    description: Assessment of suppression quality
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Suppression Inventory
    - Justification Review
    - Stale Suppression Analysis
    - Recommendations
closeout_checklist:
- id: dep-fp-001
  item: All suppressions inventoried
  level: REQUIRED
  verification: Complete list of suppressions documented
- id: dep-fp-002
  item: Suppressions have justifications
  level: CRITICAL
  verification: Each suppression has documented reason
- id: dep-fp-003
  item: No overly broad suppressions
  level: CRITICAL
  verification: No wildcard or all-version suppressions
- id: dep-fp-004
  item: Suppression review process defined
  level: REQUIRED
  verification: Review schedule documented
governance:
  applicable_to:
    archetypes:
    - all-software-projects
  compliance_mappings:
  - framework: SOC 2
    control: CC6.1
    description: Risk acceptance documentation
  - framework: ISO 27001
    control: A.12.6.1
    description: Vulnerability management process
relationships:
  commonly_combined:
  - dependency-supply-chain.vulnerability-scanning.cve-detection
  depends_on:
  - dependency-supply-chain.vulnerability-scanning.cve-detection
  feeds_into:
  - security-trust.risk-acceptance-process
