audit:
  id: dependency-supply-chain.vulnerability-scanning.cve-detection
  name: CVE Detection Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: dependency-supply-chain
  category_number: 32
  subcategory: vulnerability-scanning
  tier: expert
  estimated_duration: 1-2 hours  # median: 1h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: full
  severity: critical
  scope: dependencies
  default_profiles:
  - full
  - quick
  blocks_phase: true
  parallelizable: true
description:
  what: |
    This audit scans all project dependencies against known vulnerability
    databases (CVE, NVD, OSV, GitHub Advisory Database) to identify
    dependencies with published security vulnerabilities. It covers both
    direct and transitive dependencies across all ecosystems.
  why_it_matters: |
    Known vulnerabilities in dependencies are a leading cause of security
    breaches. The Equifax breach (CVE-2017-5638) and Log4Shell (CVE-2021-44228)
    demonstrated catastrophic impacts from unpatched dependencies. Regular
    scanning is essential for identifying and remediating known risks.
  when_to_run:
  - On every build in CI/CD
  - Before deployments
  - Daily in production environments
  - After any dependency changes
prerequisites:
  required_artifacts:
  - type: dependency_manifest
    description: package.json, requirements.txt, go.mod, etc.
  - type: lock_file
    description: Lock files for accurate version identification
  access_requirements:
  - Read access to dependency files
  - Network access to vulnerability databases
discovery:
  file_patterns:
  - glob: '**/package.json'
    purpose: Find npm dependencies
  - glob: '**/package-lock.json'
    purpose: Get exact npm versions
  - glob: '**/requirements.txt'
    purpose: Find Python dependencies
  - glob: '**/Pipfile.lock'
    purpose: Get exact Python versions
  - glob: '**/go.mod'
    purpose: Find Go dependencies
  - glob: '**/go.sum'
    purpose: Get exact Go versions
  - glob: '**/Cargo.lock'
    purpose: Get exact Rust versions
  - glob: '**/pom.xml'
    purpose: Find Maven dependencies
  - glob: '**/Gemfile.lock'
    purpose: Get exact Ruby versions
knowledge_sources:
  guides:
  - id: owasp-vulnerable-components
    name: OWASP A06:2021 Vulnerable Components
    url: https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/
  - id: nvd
    name: National Vulnerability Database
    url: https://nvd.nist.gov/
  standards:
  - id: cve-program
    name: CVE Program
    relevance: Standard vulnerability identification
tooling:
  analysis_tools:
  - tool: npm audit
    purpose: Scan npm dependencies for vulnerabilities
  - tool: pip-audit
    purpose: Scan Python dependencies for vulnerabilities
  - tool: govulncheck
    purpose: Scan Go dependencies for vulnerabilities
  - tool: cargo audit
    purpose: Scan Rust dependencies for vulnerabilities
  - tool: trivy
    purpose: Multi-ecosystem vulnerability scanner
  - tool: grype
    purpose: Anchore vulnerability scanner
  - tool: snyk
    purpose: Commercial vulnerability scanning
  - tool: osv-scanner
    purpose: Google OSV database scanner
signals:
  critical:
  - id: DEP-CVE-CRIT-001
    signal: Critical severity vulnerability (CVSS >= 9.0) detected
    evidence_indicators:
    - CVE with CVSS score 9.0 or higher
    - Remote code execution vulnerability
    - Authentication bypass vulnerability
    explanation: |
      Critical vulnerabilities allow attackers to compromise systems with
      minimal effort. Remote code execution flaws are particularly dangerous
      as they may allow complete system takeover.
    remediation: Immediately update to patched version or apply workaround
  - id: DEP-CVE-CRIT-002
    signal: Actively exploited vulnerability in dependency
    evidence_indicators:
    - CISA KEV (Known Exploited Vulnerabilities) listed
    - Exploit publicly available
    remediation: Treat as emergency; update within 24-48 hours
  high:
  - id: DEP-CVE-HIGH-001
    signal: High severity vulnerability (CVSS 7.0-8.9) detected
    evidence_indicators:
    - CVE with CVSS score 7.0-8.9
    - Privilege escalation vulnerability
    - Significant data exposure risk
    remediation: Plan update within 7 days; apply workarounds immediately
  - id: DEP-CVE-HIGH-002
    signal: Multiple vulnerabilities in single dependency
    evidence_indicators:
    - 3+ vulnerabilities in one package
    - Pattern of security issues
    remediation: Evaluate dependency; consider replacement if pattern continues
  medium:
  - id: DEP-CVE-MED-001
    signal: Medium severity vulnerability (CVSS 4.0-6.9) detected
    evidence_indicators:
    - CVE with CVSS score 4.0-6.9
    - Limited impact or complex attack vector
    remediation: Schedule update within 30 days
  low:
  - id: DEP-CVE-LOW-001
    signal: Low severity vulnerability (CVSS < 4.0) detected
    evidence_indicators:
    - CVE with CVSS score below 4.0
    - Minimal practical impact
    remediation: Include in next regular update cycle
  positive:
  - id: DEP-CVE-POS-001
    signal: No known vulnerabilities detected
  - id: DEP-CVE-POS-002
    signal: All previously identified vulnerabilities remediated
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Run npm Audit
    description: Scan npm dependencies for vulnerabilities
    commands:
    - purpose: Run npm vulnerability scan
      command: npm audit --json 2>/dev/null | head -500 || echo 'npm audit not applicable'
  - id: '2'
    name: Run Python Audit
    description: Scan Python dependencies for vulnerabilities
    commands:
    - purpose: Run pip-audit
      command: pip-audit --format json 2>/dev/null | head -500 || echo 'pip-audit not applicable'
    - purpose: Alternative with safety
      command: safety check --json 2>/dev/null | head -500 || echo 'safety not applicable'
  - id: '3'
    name: Run Go Vulnerability Check
    description: Scan Go dependencies for vulnerabilities
    commands:
    - purpose: Run govulncheck
      command: govulncheck ./... 2>/dev/null | head -200 || echo 'govulncheck not applicable'
  - id: '4'
    name: Run Trivy Scan
    description: Multi-ecosystem vulnerability scan
    commands:
    - purpose: Run trivy filesystem scan
      command: trivy fs --scanners vuln . 2>/dev/null | head -500 || echo 'trivy not applicable'
  - id: '5'
    name: Run OSV Scanner
    description: Scan against Google OSV database
    commands:
    - purpose: Run osv-scanner
      command: osv-scanner -r . 2>/dev/null | head -500 || echo 'osv-scanner not applicable'
  - id: '6'
    name: Run Grype Scan
    description: Scan with Anchore Grype
    commands:
    - purpose: Run grype on directory
      command: grype dir:. 2>/dev/null | head -500 || echo 'grype not applicable'
  - id: '7'
    name: Compile Vulnerability Report
    description: Aggregate results from all scanners
    commands:
    - purpose: Summarize findings
      command: echo 'Compile results from all scanners above into unified vulnerability report'
output:
  deliverables:
  - type: vulnerability_report
    format: structured
    description: Complete list of CVEs found in dependencies
  - type: severity_breakdown
    format: table
    description: Vulnerabilities grouped by severity
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Critical Findings
    - High Priority Items
    - Remediation Plan
    - Scan Coverage
closeout_checklist:
- id: dep-cve-001
  item: No critical vulnerabilities present
  level: CRITICAL
  verification: npm audit --audit-level=critical returns clean
- id: dep-cve-002
  item: No high vulnerabilities without remediation plan
  level: CRITICAL
  verification: All high findings have documented plan
- id: dep-cve-003
  item: All ecosystems scanned
  level: REQUIRED
  verification: Appropriate scanner run for each language
- id: dep-cve-004
  item: Findings documented with CVE IDs
  level: REQUIRED
  verification: Report includes CVE references
governance:
  applicable_to:
    archetypes:
    - all-software-projects
  compliance_mappings:
  - framework: SOC 2
    control: CC6.1
    description: Vulnerability management
  - framework: PCI DSS
    control: '6.2'
    description: Address known vulnerabilities
  - framework: HIPAA
    control: 164.308(a)(5)
    description: Security awareness and training
  - framework: ISO 27001
    control: A.12.6.1
    description: Management of technical vulnerabilities
relationships:
  commonly_combined:
  - dependency-supply-chain.vulnerability-scanning.vulnerability-prioritization
  depends_on:
  - dependency-supply-chain.dependency-inventory.dependency-enumeration
  feeds_into:
  - security-trust.vulnerability-management
