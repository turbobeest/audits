audit:
  id: dependency-supply-chain.vulnerability-scanning.scanner-coverage
  name: Scanner Coverage Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: dependency-supply-chain
  category_number: 32
  subcategory: vulnerability-scanning
  tier: expert
  estimated_duration: 1-2 hours  # median: 1h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: dependencies
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit evaluates the coverage and effectiveness of vulnerability
    scanning tools deployed in the project. It assesses which ecosystems
    are covered, which vulnerability databases are queried, and identifies
    potential gaps in scanning coverage.
  why_it_matters: |
    No single scanner covers all ecosystems and vulnerability databases
    perfectly. Understanding scanner limitations helps identify blind spots.
    Using multiple complementary scanners provides defense in depth for
    vulnerability detection.
  when_to_run:
  - When setting up scanning infrastructure
  - When adding new technology stacks
  - During security tool evaluations
  - Annually for tool effectiveness review
prerequisites:
  required_artifacts:
  - type: scanner_config
    description: Configuration for vulnerability scanners
  - type: dependency_manifest
    description: To understand ecosystems in use
  access_requirements:
  - Access to scanning tool configurations
  - Understanding of project technology stack
discovery:
  file_patterns:
  - glob: '**/package.json'
    purpose: Identify npm ecosystem
  - glob: '**/requirements.txt'
    purpose: Identify Python ecosystem
  - glob: '**/go.mod'
    purpose: Identify Go ecosystem
  - glob: '**/Cargo.toml'
    purpose: Identify Rust ecosystem
  - glob: '**/pom.xml'
    purpose: Identify Java/Maven ecosystem
  - glob: '**/Gemfile'
    purpose: Identify Ruby ecosystem
  - glob: '**/composer.json'
    purpose: Identify PHP ecosystem
knowledge_sources:
  guides:
  - id: nvd-data-feeds
    name: NVD Data Feeds
    url: https://nvd.nist.gov/vuln/data-feeds
  - id: osv-schema
    name: OSV Schema
    url: https://ossf.github.io/osv-schema/
  standards:
  - id: vulnerability-databases
    name: Vulnerability Database Standards
    relevance: Understanding data sources
tooling:
  analysis_tools:
  - tool: npm audit
    purpose: npm/Node.js coverage
  - tool: pip-audit
    purpose: Python/PyPI coverage
  - tool: govulncheck
    purpose: Go coverage with call graph analysis
  - tool: cargo audit
    purpose: Rust coverage
  - tool: trivy
    purpose: Multi-ecosystem scanner
  - tool: grype
    purpose: Multi-ecosystem scanner
  - tool: snyk
    purpose: Commercial multi-ecosystem
  - tool: osv-scanner
    purpose: OSV database scanner
signals:
  critical:
  - id: DEP-COV-CRIT-001
    signal: Major ecosystem has no vulnerability scanning
    evidence_indicators:
    - Production language with no scanner configured
    - Key dependency ecosystem uncovered
    explanation: |
      Unscanned ecosystems represent complete blind spots. Vulnerabilities
      in these dependencies will never be detected by automated processes,
      leaving the application exposed.
    remediation: Add appropriate scanner for all production ecosystems
  high:
  - id: DEP-COV-HIGH-001
    signal: Scanner using outdated vulnerability database
    evidence_indicators:
    - Database not updated in 7+ days
    - Missing recently disclosed CVEs
    remediation: Update scanner databases; configure automatic updates
  - id: DEP-COV-HIGH-002
    signal: Scanner only checking direct dependencies
    evidence_indicators:
    - Transitive dependencies not scanned
    - Shallow scanning configured
    remediation: Configure deep scanning of full dependency tree
  medium:
  - id: DEP-COV-MED-001
    signal: Only one vulnerability database queried
    evidence_indicators:
    - Single data source
    - Missing coverage from other databases
    remediation: Use scanner that aggregates multiple databases
  - id: DEP-COV-MED-002
    signal: Operating system dependencies not scanned
    evidence_indicators:
    - Container base image not scanned
    - System libraries not covered
    remediation: Add container/OS scanning capability
  low:
  - id: DEP-COV-LOW-001
    signal: Scanner results not aggregated
    evidence_indicators:
    - Multiple scanner outputs not correlated
    - Duplicate findings across scanners
    remediation: Implement result aggregation and deduplication
  positive:
  - id: DEP-COV-POS-001
    signal: All ecosystems have appropriate scanner coverage
  - id: DEP-COV-POS-002
    signal: Multiple complementary scanners in use
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Identify All Ecosystems
    description: Determine which package ecosystems are in use
    commands:
    - purpose: Find ecosystem indicators
      command: ls package.json requirements.txt Pipfile go.mod Cargo.toml pom.xml build.gradle Gemfile
        composer.json 2>/dev/null || echo 'Check manually for ecosystem files'
  - id: '2'
    name: Check npm Scanning
    description: Verify npm vulnerability scanning coverage
    commands:
    - purpose: Check npm audit availability
      command: npm audit --help 2>/dev/null && echo 'npm audit available' || echo 'npm audit not available'
  - id: '3'
    name: Check Python Scanning
    description: Verify Python vulnerability scanning coverage
    commands:
    - purpose: Check pip-audit availability
      command: pip-audit --help 2>/dev/null && echo 'pip-audit available' || echo 'pip-audit not available'
    - purpose: Check safety availability
      command: safety --help 2>/dev/null && echo 'safety available' || echo 'safety not available'
  - id: '4'
    name: Check Multi-Ecosystem Scanners
    description: Verify broad-coverage scanner availability
    commands:
    - purpose: Check trivy availability
      command: trivy --version 2>/dev/null && echo 'trivy available' || echo 'trivy not available'
    - purpose: Check grype availability
      command: grype version 2>/dev/null && echo 'grype available' || echo 'grype not available'
    - purpose: Check osv-scanner availability
      command: osv-scanner --version 2>/dev/null && echo 'osv-scanner available' || echo 'osv-scanner
        not available'
  - id: '5'
    name: Assess Database Coverage
    description: Identify which vulnerability databases are queried
    commands:
    - purpose: Document database sources
      command: |-
        echo 'Common vulnerability databases:
        - NVD (National Vulnerability Database)
        - OSV (Open Source Vulnerabilities)
        - GitHub Advisory Database
        - Snyk Vulnerability Database
        - npm Advisory Database
        - PyPI Advisory Database

        Check scanner documentation for specific sources.'
  - id: '6'
    name: Create Coverage Matrix
    description: Build coverage matrix of ecosystems vs scanners
    commands:
    - purpose: Generate coverage template
      command: |-
        echo 'Scanner Coverage Matrix:

        Ecosystem    | npm-audit | pip-audit | trivy | grype | snyk
        -------------|-----------|-----------|-------|-------|------
        npm/Node.js  |     X     |           |   X   |   X   |   X
        Python/PyPI  |           |     X     |   X   |   X   |   X
        Go           |           |           |   X   |   X   |   X
        Rust         |           |           |   X   |   X   |   X
        Java/Maven   |           |           |   X   |   X   |   X
        Ruby/Gems    |           |           |   X   |   X   |   X
        Containers   |           |           |   X   |   X   |   X'
output:
  deliverables:
  - type: coverage_matrix
    format: table
    description: Ecosystems vs scanner coverage
  - type: gap_analysis
    format: list
    description: Ecosystems lacking scanner coverage
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Scanner Inventory
    - Coverage Analysis
    - Gap Identification
    - Recommendations
closeout_checklist:
- id: dep-cov-001
  item: All production ecosystems have scanner coverage
  level: CRITICAL
  verification: Coverage matrix shows all ecosystems covered
- id: dep-cov-002
  item: Scanner databases are current
  level: REQUIRED
  verification: Check database update timestamps
- id: dep-cov-003
  item: Transitive dependencies included
  level: REQUIRED
  verification: Verify deep scanning configuration
- id: dep-cov-004
  item: Coverage gaps documented and planned
  level: REQUIRED
  verification: Gap remediation plan exists
governance:
  applicable_to:
    archetypes:
    - all-software-projects
  compliance_mappings:
  - framework: SOC 2
    control: CC6.1
    description: Vulnerability detection controls
  - framework: PCI DSS
    control: '6.5'
    description: Address common vulnerabilities
relationships:
  commonly_combined:
  - dependency-supply-chain.vulnerability-scanning.cve-detection
  depends_on:
  - dependency-supply-chain.dependency-inventory.dependency-enumeration
  feeds_into:
  - security-trust.security-tooling-assessment
