audit:
  id: dependency-supply-chain.vulnerability-scanning.continuous-monitoring
  name: Continuous Vulnerability Monitoring Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: dependency-supply-chain
  category_number: 32
  subcategory: vulnerability-scanning
  tier: phd
  estimated_duration: 2-4 hours  # median: 3h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: dependencies
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit evaluates the systems and processes in place for continuous
    vulnerability monitoring of dependencies. It assesses automated scanning
    integration, alerting mechanisms, and the ability to quickly detect
    newly disclosed vulnerabilities affecting the project.
  why_it_matters: |
    New vulnerabilities are disclosed constantly. Without continuous monitoring,
    organizations may run vulnerable dependencies for months before discovery.
    Automated monitoring catches new CVEs as they're published, enabling
    rapid response to emerging threats like Log4Shell.
  when_to_run:
  - When setting up new projects
  - During security program assessments
  - After security incidents
  - Quarterly review of monitoring effectiveness
prerequisites:
  required_artifacts:
  - type: ci_cd_config
    description: CI/CD pipeline configuration
  - type: monitoring_config
    description: Security monitoring configuration
  access_requirements:
  - Access to CI/CD system
  - Access to security monitoring tools
discovery:
  file_patterns:
  - glob: '**/.github/workflows/*.yml'
    purpose: Find GitHub Actions workflows
  - glob: '**/Jenkinsfile'
    purpose: Find Jenkins pipelines
  - glob: '**/.gitlab-ci.yml'
    purpose: Find GitLab CI configuration
  - glob: '**/dependabot.yml'
    purpose: Find Dependabot configuration
  - glob: '**/.snyk'
    purpose: Find Snyk configuration
  - glob: '**/renovate.json'
    purpose: Find Renovate configuration
knowledge_sources:
  guides:
  - id: github-dependabot
    name: GitHub Dependabot
    url: https://docs.github.com/en/code-security/dependabot
  - id: snyk-monitoring
    name: Snyk Continuous Monitoring
    url: https://snyk.io/product/open-source-security-management/
  standards:
  - id: nist-vulnerability-management
    name: NIST Vulnerability Management
    relevance: Continuous monitoring requirements
tooling:
  analysis_tools:
  - tool: dependabot
    purpose: Automated GitHub vulnerability alerts
  - tool: snyk
    purpose: Continuous monitoring with Snyk
  - tool: renovate
    purpose: Automated dependency updates
  - tool: github-advanced-security
    purpose: GitHub dependency scanning
  - tool: socket.dev
    purpose: Supply chain monitoring
signals:
  critical:
  - id: DEP-MON-CRIT-001
    signal: No automated vulnerability monitoring in place
    evidence_indicators:
    - No Dependabot, Snyk, or similar enabled
    - Only manual scanning performed
    explanation: |
      Without automated monitoring, new vulnerabilities won't be detected
      until the next manual scan, which could be weeks or months. This
      leaves a dangerous window of exposure.
    remediation: Implement automated vulnerability monitoring immediately
  high:
  - id: DEP-MON-HIGH-001
    signal: Vulnerability alerts not reaching responsible parties
    evidence_indicators:
    - Alerts going to unused email address
    - No integration with ticketing system
    remediation: Configure alerts to reach security and dev teams
  - id: DEP-MON-HIGH-002
    signal: Monitoring coverage incomplete
    evidence_indicators:
    - Only some ecosystems monitored
    - Some repositories not covered
    remediation: Extend monitoring to cover all dependencies
  medium:
  - id: DEP-MON-MED-001
    signal: No SLA for vulnerability response
    evidence_indicators:
    - No defined response time targets
    - Alerts not triaged timely
    remediation: Define and enforce vulnerability response SLAs
  - id: DEP-MON-MED-002
    signal: CI pipeline doesn't fail on vulnerabilities
    evidence_indicators:
    - Scans run but don't block deployment
    - Results advisory only
    remediation: Configure pipeline to fail on high/critical vulnerabilities
  low:
  - id: DEP-MON-LOW-001
    signal: Vulnerability metrics not tracked
    evidence_indicators:
    - No dashboard for vulnerability status
    - No trend analysis
    remediation: Implement vulnerability metrics and reporting
  positive:
  - id: DEP-MON-POS-001
    signal: Comprehensive automated monitoring enabled
  - id: DEP-MON-POS-002
    signal: Clear alerting and response procedures
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Check Dependabot Configuration
    description: Verify Dependabot is enabled and configured
    commands:
    - purpose: Find Dependabot config
      command: cat .github/dependabot.yml 2>/dev/null || echo 'No Dependabot configuration found'
  - id: '2'
    name: Check CI Pipeline for Scanning
    description: Verify vulnerability scanning in CI
    commands:
    - purpose: Check GitHub Actions for security scans
      command: grep -rE '(npm audit|snyk|trivy|grype|safety)' .github/workflows/ 2>/dev/null || echo 'No
        vulnerability scanning found in GitHub Actions'
    - purpose: Check for security-related workflow files
      command: ls -la .github/workflows/*security* .github/workflows/*vuln* 2>/dev/null || echo 'No obvious
        security workflow files'
  - id: '3'
    name: Check Snyk Integration
    description: Verify Snyk monitoring if used
    commands:
    - purpose: Check for Snyk config
      command: cat .snyk 2>/dev/null || echo 'No Snyk configuration found'
    - purpose: Check Snyk CLI
      command: snyk monitor --dry-run 2>/dev/null || echo 'Snyk not configured or not installed'
  - id: '4'
    name: Check Renovate Configuration
    description: Verify Renovate for automated updates
    commands:
    - purpose: Find Renovate config
      command: cat renovate.json 2>/dev/null || cat .renovaterc 2>/dev/null || echo 'No Renovate configuration
        found'
  - id: '5'
    name: Verify Alert Configuration
    description: Check that alerts reach appropriate people
    commands:
    - purpose: Check GitHub notification settings
      command: |-
        echo 'Manual verification required:
        - Check GitHub repository security settings
        - Verify notification routing
        - Confirm team members receive alerts'
  - id: '6'
    name: Review Response Procedures
    description: Check for documented response procedures
    commands:
    - purpose: Find security runbooks
      command: find . -iname '*security*' -iname '*runbook*' -o -iname '*incident*' 2>/dev/null | grep
        -v node_modules | head -10 || echo 'No security runbooks found'
output:
  deliverables:
  - type: monitoring_assessment
    format: structured
    description: Evaluation of monitoring capabilities
  - type: gap_analysis
    format: list
    description: Missing monitoring capabilities
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Current Monitoring State
    - Coverage Gaps
    - Alert Configuration
    - Recommendations
closeout_checklist:
- id: dep-mon-001
  item: Automated vulnerability monitoring enabled
  level: CRITICAL
  verification: Dependabot/Snyk/equivalent active
- id: dep-mon-002
  item: All ecosystems covered
  level: REQUIRED
  verification: Monitoring config covers all languages
- id: dep-mon-003
  item: Alerts properly routed
  level: REQUIRED
  verification: Test alert delivery
- id: dep-mon-004
  item: CI integration blocking on vulnerabilities
  level: REQUIRED
  verification: Test PR with known vulnerability
governance:
  applicable_to:
    archetypes:
    - all-software-projects
  compliance_mappings:
  - framework: SOC 2
    control: CC7.1
    description: Monitoring controls
  - framework: PCI DSS
    control: '11.2'
    description: Vulnerability scans
  - framework: ISO 27001
    control: A.12.6.1
    description: Technical vulnerability management
relationships:
  commonly_combined:
  - dependency-supply-chain.vulnerability-scanning.cve-detection
  depends_on:
  - dependency-supply-chain.dependency-inventory.dependency-enumeration
  feeds_into:
  - security-trust.security-monitoring
