audit:
  id: dependency-supply-chain.update-management.update-frequency
  name: Update Frequency Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: dependency-supply-chain
  category_number: 32
  subcategory: update-management
  tier: expert
  estimated_duration: 1-2 hours  # median: 1h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: dependencies
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit evaluates how frequently dependencies are updated in the
    project. It analyzes the age of current dependencies, the update
    history, and assesses whether update frequency aligns with security
    best practices and project needs.
  why_it_matters: |
    Infrequent updates lead to accumulated technical debt, making each
    update more painful. Outdated dependencies accumulate vulnerabilities
    and miss security fixes. Regular, incremental updates are easier and
    safer than large, infrequent version jumps.
  when_to_run:
  - During quarterly reviews
  - When assessing technical debt
  - Before major releases
  - When establishing update policies
prerequisites:
  required_artifacts:
  - type: dependency_manifest
    description: package.json, requirements.txt, etc.
  - type: lock_file
    description: Lock files showing current versions
  - type: git_history
    description: Commit history for update analysis
  access_requirements:
  - Read access to dependency files
  - Access to git history
discovery:
  file_patterns:
  - glob: '**/package.json'
    purpose: Find npm manifests
  - glob: '**/package-lock.json'
    purpose: Find npm lock files
  - glob: '**/requirements.txt'
    purpose: Find Python requirements
  - glob: '**/go.mod'
    purpose: Find Go modules
knowledge_sources:
  guides:
  - id: dependabot-best-practices
    name: Dependabot Best Practices
    url: https://docs.github.com/en/code-security/dependabot/working-with-dependabot
  - id: renovate-scheduling
    name: Renovate Scheduling
    url: https://docs.renovatebot.com/configuration-options/#schedule
  standards:
  - id: continuous-update
    name: Continuous Dependency Updates
    relevance: Modern update practices
tooling:
  analysis_tools:
  - tool: npm outdated
    purpose: Check for outdated npm packages
  - tool: pip list --outdated
    purpose: Check for outdated Python packages
  - tool: go list -m -u all
    purpose: Check for Go module updates
  - tool: npm-check-updates
    purpose: Interactive npm update tool
  - tool: libyear
    purpose: Measure dependency age
signals:
  critical:
  - id: DEP-UPD-CRIT-001
    signal: Dependencies not updated in over 1 year
    evidence_indicators:
    - Lock file unchanged for 12+ months
    - Dependencies multiple major versions behind
    explanation: |
      Year-old dependencies likely contain multiple unpatched vulnerabilities
      and miss important security fixes. Updating becomes increasingly
      difficult as the gap widens.
    remediation: Implement immediate update plan; consider dependency-by-dependency approach
  high:
  - id: DEP-UPD-HIGH-001
    signal: Dependencies 6+ months outdated
    evidence_indicators:
    - Significant version drift
    - Many patches and minor versions skipped
    remediation: Plan comprehensive update cycle within 30 days
  - id: DEP-UPD-HIGH-002
    signal: No automated update mechanism
    evidence_indicators:
    - No Dependabot/Renovate configured
    - Manual-only update process
    remediation: Implement automated dependency update tooling
  medium:
  - id: DEP-UPD-MED-001
    signal: Dependencies 3-6 months outdated
    evidence_indicators:
    - Moderate version drift
    - Several minor versions behind
    remediation: Schedule update sprint within next quarter
  - id: DEP-UPD-MED-002
    signal: Inconsistent update frequency
    evidence_indicators:
    - Some dependencies current, others very old
    - No regular update schedule
    remediation: Establish regular update cadence
  low:
  - id: DEP-UPD-LOW-001
    signal: Minor patch updates available
    evidence_indicators:
    - Patch versions available
    - Dependencies generally current
    remediation: Include in next scheduled update
  positive:
  - id: DEP-UPD-POS-001
    signal: Regular update schedule maintained
  - id: DEP-UPD-POS-002
    signal: Dependencies within 1 month of latest
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Check npm Outdated
    description: Identify outdated npm packages
    commands:
    - purpose: List outdated npm packages
      command: npm outdated 2>/dev/null || echo 'npm outdated not applicable'
  - id: '2'
    name: Check Python Outdated
    description: Identify outdated Python packages
    commands:
    - purpose: List outdated pip packages
      command: pip list --outdated 2>/dev/null | head -50 || echo 'pip list not applicable'
  - id: '3'
    name: Check Go Outdated
    description: Identify outdated Go modules
    commands:
    - purpose: List Go module updates
      command: go list -m -u all 2>/dev/null | grep '\[' | head -50 || echo 'go list not applicable'
  - id: '4'
    name: Measure Dependency Age
    description: Calculate aggregate dependency age
    commands:
    - purpose: Check with libyear
      command: npx libyear 2>/dev/null | tail -20 || echo 'libyear calculation not available'
  - id: '5'
    name: Analyze Lock File History
    description: Check how recently lock files were updated
    commands:
    - purpose: Get lock file last modification
      command: git log -1 --format='%ci' -- package-lock.json yarn.lock poetry.lock Cargo.lock go.sum
        2>/dev/null | head -5 || echo 'Lock file history not available'
  - id: '6'
    name: Count Update Frequency
    description: Analyze update commit frequency
    commands:
    - purpose: Count dependency-related commits
      command: git log --oneline --since='1 year ago' -- package*.json requirements*.txt go.* Cargo.*
        2>/dev/null | wc -l || echo 'Git history not available'
output:
  deliverables:
  - type: outdated_report
    format: structured
    description: List of outdated dependencies
  - type: age_analysis
    format: structured
    description: Dependency age metrics
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Update Frequency Analysis
    - Outdated Dependencies
    - Update History
    - Recommendations
closeout_checklist:
- id: dep-upd-001
  item: Current dependency age documented
  level: REQUIRED
  verification: Outdated report generated
- id: dep-upd-002
  item: Update frequency assessed
  level: REQUIRED
  verification: Historical analysis complete
- id: dep-upd-003
  item: Update schedule established
  level: REQUIRED
  verification: Schedule documented and agreed
- id: dep-upd-004
  item: Automated updates configured
  level: RECOMMENDED
  verification: Dependabot/Renovate active
governance:
  applicable_to:
    archetypes:
    - all-software-projects
  compliance_mappings:
  - framework: SOC 2
    control: CC6.1
    description: Timely vulnerability remediation
  - framework: PCI DSS
    control: '6.2'
    description: Installing security patches
relationships:
  commonly_combined:
  - dependency-supply-chain.update-management.automated-updates
  depends_on:
  - dependency-supply-chain.dependency-inventory.dependency-enumeration
  feeds_into:
  - code-quality.technical-debt
