audit:
  id: dependency-supply-chain.update-management.automated-updates
  name: Automated Updates Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: dependency-supply-chain
  category_number: 32
  subcategory: update-management
  tier: expert
  estimated_duration: 1-2 hours  # median: 1h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: dependencies
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit evaluates the configuration and effectiveness of automated
    dependency update tools like Dependabot, Renovate, or similar systems.
    It assesses configuration completeness, grouping strategies, and
    integration with review workflows.
  why_it_matters: |
    Manual dependency updates don't scale and are easily forgotten. Automated
    tools ensure updates are proposed promptly, enabling teams to maintain
    current dependencies without constant manual effort. Proper configuration
    prevents update fatigue from too many PRs.
  when_to_run:
  - When setting up new projects
  - When update PRs become overwhelming
  - During quarterly security reviews
  - When changing CI/CD configuration
prerequisites:
  required_artifacts:
  - type: update_config
    description: dependabot.yml, renovate.json, etc.
  - type: ci_config
    description: CI/CD configuration files
  access_requirements:
  - Access to repository configuration
  - Access to update tool settings
discovery:
  file_patterns:
  - glob: '**/.github/dependabot.yml'
    purpose: Find Dependabot configuration
  - glob: '**/dependabot.yml'
    purpose: Find Dependabot in root
  - glob: '**/renovate.json'
    purpose: Find Renovate configuration
  - glob: '**/.renovaterc*'
    purpose: Find Renovate config variations
  - glob: '**/renovate.json5'
    purpose: Find Renovate JSON5 config
knowledge_sources:
  guides:
  - id: dependabot-config
    name: Dependabot Configuration Options
    url: https://docs.github.com/en/code-security/dependabot/dependabot-version-updates/configuration-options-for-the-dependabot.yml-file
  - id: renovate-config
    name: Renovate Configuration
    url: https://docs.renovatebot.com/configuration-options/
  standards:
  - id: continuous-dependency-updates
    name: Continuous Dependency Update Practices
    relevance: Modern update workflows
tooling:
  analysis_tools:
  - tool: dependabot
    purpose: GitHub native dependency updates
  - tool: renovate
    purpose: Flexible dependency update bot
  - tool: greenkeeper
    purpose: Legacy npm update tool
  - tool: snyk
    purpose: Security-focused updates
signals:
  critical:
  - id: DEP-AUTO-CRIT-001
    signal: No automated dependency update tool configured
    evidence_indicators:
    - No dependabot.yml or renovate.json
    - Updates only done manually
    explanation: |
      Without automation, dependency updates require constant manual
      attention that rarely happens. Security updates may be missed
      for extended periods.
    remediation: Configure Dependabot or Renovate immediately
  high:
  - id: DEP-AUTO-HIGH-001
    signal: Automated updates disabled or broken
    evidence_indicators:
    - Update bot paused
    - Configuration syntax errors
    - No PRs created in months
    remediation: Fix configuration and re-enable updates
  - id: DEP-AUTO-HIGH-002
    signal: Security updates not prioritized
    evidence_indicators:
    - Security PRs same priority as regular updates
    - No auto-merge for security patches
    remediation: Configure separate security update handling
  medium:
  - id: DEP-AUTO-MED-001
    signal: Update PRs not being reviewed timely
    evidence_indicators:
    - Many open update PRs
    - PRs open for weeks
    remediation: Improve review process; consider auto-merge for low-risk updates
  - id: DEP-AUTO-MED-002
    signal: Some ecosystems not covered
    evidence_indicators:
    - npm configured but not Python
    - Docker not included
    remediation: Extend configuration to cover all ecosystems
  - id: DEP-AUTO-MED-003
    signal: Too many individual PRs causing fatigue
    evidence_indicators:
    - 10+ update PRs per week
    - Each dependency in separate PR
    remediation: Configure grouping and scheduling to batch updates
  low:
  - id: DEP-AUTO-LOW-001
    signal: Update schedule could be optimized
    evidence_indicators:
    - Updates at inconvenient times
    - No schedule configured
    remediation: Configure schedule aligned with team workflow
  positive:
  - id: DEP-AUTO-POS-001
    signal: Comprehensive automated update configuration
  - id: DEP-AUTO-POS-002
    signal: Update PRs reviewed and merged promptly
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Check Dependabot Configuration
    description: Review Dependabot settings
    commands:
    - purpose: View Dependabot config
      command: cat .github/dependabot.yml 2>/dev/null || echo 'No Dependabot configuration found'
  - id: '2'
    name: Check Renovate Configuration
    description: Review Renovate settings
    commands:
    - purpose: View Renovate config
      command: cat renovate.json .renovaterc .renovaterc.json renovate.json5 2>/dev/null || echo 'No Renovate
        configuration found'
  - id: '3'
    name: Verify Ecosystem Coverage
    description: Check which ecosystems are configured for updates
    commands:
    - purpose: List configured package ecosystems
      command: grep -E 'package-ecosystem|packageRules' .github/dependabot.yml renovate.json 2>/dev/null
        || echo 'Could not determine configured ecosystems'
  - id: '4'
    name: Check Open Update PRs
    description: Review pending update pull requests
    commands:
    - purpose: Count open Dependabot PRs
      command: gh pr list --label dependencies 2>/dev/null | wc -l || echo 'Could not check PRs; verify
        manually'
    - purpose: List open update PRs
      command: gh pr list --label dependencies --limit 10 2>/dev/null || echo 'Could not list PRs'
  - id: '5'
    name: Check Update PR Merge History
    description: Analyze how quickly update PRs are merged
    commands:
    - purpose: List recently merged update PRs
      command: gh pr list --state merged --label dependencies --limit 10 2>/dev/null || echo 'Could not
        check merged PRs'
  - id: '6'
    name: Verify Grouping Configuration
    description: Check if updates are properly grouped
    commands:
    - purpose: Check for grouping config
      command: grep -E '(groups|group:|groupName)' .github/dependabot.yml renovate.json 2>/dev/null ||
        echo 'No grouping configuration found'
output:
  deliverables:
  - type: configuration_assessment
    format: structured
    description: Evaluation of update tool configuration
  - type: coverage_report
    format: list
    description: Ecosystems with/without update coverage
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Tool Configuration
    - Ecosystem Coverage
    - PR Management
    - Recommendations
closeout_checklist:
- id: dep-auto-001
  item: Automated update tool configured
  level: CRITICAL
  verification: dependabot.yml or renovate.json exists
- id: dep-auto-002
  item: All ecosystems covered
  level: REQUIRED
  verification: Configuration covers all languages
- id: dep-auto-003
  item: Security updates prioritized
  level: REQUIRED
  verification: Separate security update handling
- id: dep-auto-004
  item: Reasonable grouping and scheduling
  level: RECOMMENDED
  verification: No PR fatigue issues
governance:
  applicable_to:
    archetypes:
    - all-software-projects
  compliance_mappings:
  - framework: SOC 2
    control: CC6.1
    description: Automated vulnerability management
  - framework: NIST CSF
    control: PR.IP-12
    description: Vulnerability management plan
relationships:
  commonly_combined:
  - dependency-supply-chain.update-management.update-frequency
  depends_on:
  - dependency-supply-chain.dependency-inventory.dependency-enumeration
  feeds_into:
  - development-workflow.pull-request-management
