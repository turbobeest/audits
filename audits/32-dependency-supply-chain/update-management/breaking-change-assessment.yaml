audit:
  id: dependency-supply-chain.update-management.breaking-change-assessment
  name: Breaking Change Assessment Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: dependency-supply-chain
  category_number: 32
  subcategory: update-management
  tier: expert
  estimated_duration: 2-4 hours  # median: 3h
  completeness: complete
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: dependencies
  default_profiles:
  - full
  - comprehensive
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit evaluates how major version updates and breaking changes
    are assessed before adoption. It examines the process for reviewing
    changelogs, migration guides, and compatibility impacts when dependencies
    introduce breaking changes.
  why_it_matters: |
    Major version updates often contain breaking changes that can cause
    subtle bugs or complete failures. Without proper assessment, teams
    either avoid necessary updates (accumulating security debt) or rush
    updates (causing production incidents).
  when_to_run:
  - Before major version updates
  - When planning dependency upgrade sprints
  - When multiple major updates are pending
  - After experiencing upgrade-related issues
prerequisites:
  required_artifacts:
  - type: dependency_manifest
    description: Current dependency versions
  - type: changelog_access
    description: Access to dependency changelogs
  - type: test_suite
    description: Comprehensive test coverage
  access_requirements:
  - Read access to dependency documentation
  - Ability to run test suites
discovery:
  file_patterns:
  - glob: '**/package.json'
    purpose: Find npm dependencies
  - glob: '**/CHANGELOG*'
    purpose: Find project changelogs
  - glob: '**/MIGRATION*'
    purpose: Find migration guides
knowledge_sources:
  guides:
  - id: semver
    name: Semantic Versioning
    url: https://semver.org/
  - id: keepachangelog
    name: Keep a Changelog
    url: https://keepachangelog.com/
  standards:
  - id: semver-spec
    name: SemVer Specification
    relevance: Understanding version number meaning
tooling:
  analysis_tools:
  - tool: npm-check-updates
    purpose: Identify available major updates
  - tool: npm view
    purpose: View package information including changelog
  - tool: npm diff
    purpose: Compare package versions
signals:
  critical:
  - id: DEP-BREAK-CRIT-001
    signal: Major updates applied without testing
    evidence_indicators:
    - Major version bumps without changelog review
    - No testing before merge
    explanation: |
      Major version updates by definition contain breaking changes.
      Applying them without review and testing virtually guarantees
      production issues.
    remediation: Implement mandatory review process for major updates
  high:
  - id: DEP-BREAK-HIGH-001
    signal: Multiple major versions behind
    evidence_indicators:
    - Need to jump 2+ major versions
    - Migration path unclear
    remediation: Create step-by-step migration plan; consider intermediate versions
  - id: DEP-BREAK-HIGH-002
    signal: Breaking changes in critical dependencies
    evidence_indicators:
    - Major update in framework or core library
    - Significant API changes
    remediation: Allocate dedicated time for thorough migration
  medium:
  - id: DEP-BREAK-MED-001
    signal: No process for reviewing changelogs
    evidence_indicators:
    - Changelogs not checked before updates
    - Breaking changes discovered post-merge
    remediation: Add changelog review to update process
  - id: DEP-BREAK-MED-002
    signal: Test coverage insufficient for upgrade validation
    evidence_indicators:
    - Low test coverage on dependency-heavy code
    - Updates pass tests but cause production issues
    remediation: Improve test coverage for dependency integration
  low:
  - id: DEP-BREAK-LOW-001
    signal: Migration guides not followed
    evidence_indicators:
    - Custom migration approach
    - Migration guide exists but not used
    remediation: Follow official migration guides when available
  positive:
  - id: DEP-BREAK-POS-001
    signal: Structured process for major updates
  - id: DEP-BREAK-POS-002
    signal: All breaking changes reviewed before adoption
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Identify Pending Major Updates
    description: Find dependencies with major version updates available
    commands:
    - purpose: List major npm updates
      command: npx npm-check-updates --target major 2>/dev/null || npm outdated 2>/dev/null | head -50
  - id: '2'
    name: Review Changelogs
    description: Access changelogs for major updates
    commands:
    - purpose: View package info and changelog location
      command: 'npm view react changelog repository.url 2>/dev/null || echo ''Example: npm view [package]
        for changelog info'''
  - id: '3'
    name: Check for Migration Guides
    description: Find official migration documentation
    commands:
    - purpose: Note migration guide sources
      command: |-
        echo 'Check for migration guides:
        - GitHub releases page
        - Official documentation
        - MIGRATION.md in repo
        - Blog posts from maintainers'
  - id: '4'
    name: Assess Impact Scope
    description: Determine how much code uses the dependency
    commands:
    - purpose: Find import statements for a package
      command: grep -rE "(import|require).*'react'" src/ --include='*.js' --include='*.ts' --include='*.jsx'
        --include='*.tsx' 2>/dev/null | wc -l || echo 'Adjust package name and paths as needed'
  - id: '5'
    name: Run Test Suite
    description: Verify tests pass with current versions
    commands:
    - purpose: Run tests to establish baseline
      command: npm test 2>/dev/null || echo 'npm test not applicable'
  - id: '6'
    name: Document Assessment
    description: Create assessment documentation
    commands:
    - purpose: Generate assessment template
      command: |-
        echo 'Breaking Change Assessment Template:

        Package: [name]
        Current: [version]
        Target: [version]

        Breaking Changes:
        - [ ] Change 1
        - [ ] Change 2

        Migration Steps:
        1. Step 1
        2. Step 2

        Risk Level: [Low/Medium/High]
        Estimated Effort: [hours/days]'
output:
  deliverables:
  - type: major_update_inventory
    format: structured
    description: List of pending major updates
  - type: impact_assessment
    format: structured
    description: Breaking change impact analysis
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Pending Major Updates
    - Breaking Change Analysis
    - Migration Effort Estimates
    - Recommendations
closeout_checklist:
- id: dep-break-001
  item: All pending major updates identified
  level: REQUIRED
  verification: npm-check-updates --target major
- id: dep-break-002
  item: Changelogs reviewed for each major update
  level: REQUIRED
  verification: Breaking changes documented
- id: dep-break-003
  item: Migration effort estimated
  level: REQUIRED
  verification: Effort estimates documented
- id: dep-break-004
  item: Test coverage adequate for validation
  level: RECOMMENDED
  verification: Coverage report reviewed
governance:
  applicable_to:
    archetypes:
    - all-software-projects
  compliance_mappings:
  - framework: SOC 2
    control: CC8.1
    description: Change management controls
  - framework: ISO 27001
    control: A.14.2.2
    description: System change control procedures
relationships:
  commonly_combined:
  - dependency-supply-chain.update-management.update-frequency
  depends_on:
  - dependency-supply-chain.dependency-inventory.dependency-enumeration
  feeds_into:
  - project-management.sprint-planning
