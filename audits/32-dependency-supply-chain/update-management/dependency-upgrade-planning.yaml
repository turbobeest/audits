audit:
  id: dependency-supply-chain.update-management.dependency-upgrade-planning
  name: Dependency Upgrade Planning Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: dependency-supply-chain
  category_number: 32
  subcategory: update-management
  tier: phd
  estimated_duration: 2-4 hours  # median: 3h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: dependencies
  default_profiles:
  - full
  - comprehensive
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit evaluates the planning and execution of dependency upgrade
    initiatives. It assesses how major upgrades are planned, resourced,
    and executed, including handling of deprecated dependencies and
    end-of-life migrations.
  why_it_matters: |
    Ad-hoc upgrades lead to perpetual technical debt. Planned upgrade
    initiatives ensure dependencies stay current, align with long-term
    support timelines, and prevent emergency migrations when dependencies
    reach end-of-life.
  when_to_run:
  - During quarterly planning
  - When dependencies approach EOL
  - Before major releases
  - When technical debt is reviewed
prerequisites:
  required_artifacts:
  - type: dependency_manifest
    description: Current dependency versions
  - type: project_roadmap
    description: Project planning documents
  access_requirements:
  - Read access to dependency files
  - Access to planning systems
discovery:
  file_patterns:
  - glob: '**/package.json'
    purpose: Find npm dependencies
  - glob: '**/requirements.txt'
    purpose: Find Python dependencies
  - glob: '**/ROADMAP*'
    purpose: Find planning documents
knowledge_sources:
  guides:
  - id: nodejs-release-schedule
    name: Node.js Release Schedule
    url: https://nodejs.org/en/about/releases/
  - id: python-release-cycle
    name: Python Release Cycle
    url: https://devguide.python.org/versions/
  standards:
  - id: software-lifecycle
    name: Software Lifecycle Management
    relevance: Planning for EOL transitions
tooling:
  analysis_tools:
  - tool: endoflife.date
    purpose: Track EOL dates for software
  - tool: npm outdated
    purpose: Identify available updates
  - tool: libyear
    purpose: Measure dependency age
signals:
  critical:
  - id: DEP-PLAN-CRIT-001
    signal: Dependencies using EOL runtime or framework
    evidence_indicators:
    - Node.js version past EOL
    - Python 2.x still in use
    - Framework no longer maintained
    explanation: |
      End-of-life dependencies no longer receive security updates.
      Running EOL software in production creates unacceptable risk
      that grows daily as new vulnerabilities are discovered.
    remediation: Plan immediate migration from EOL dependencies
  high:
  - id: DEP-PLAN-HIGH-001
    signal: Dependencies approaching EOL with no migration plan
    evidence_indicators:
    - Major dependencies EOL within 6 months
    - No documented upgrade path
    remediation: Create and resource migration plan immediately
  - id: DEP-PLAN-HIGH-002
    signal: No regular upgrade planning process
    evidence_indicators:
    - Upgrades only happen reactively
    - No scheduled upgrade reviews
    remediation: Implement quarterly upgrade planning
  medium:
  - id: DEP-PLAN-MED-001
    signal: Multiple major version upgrades deferred
    evidence_indicators:
    - Backlog of major updates
    - No timeline for addressing
    remediation: Prioritize and schedule major upgrades
  - id: DEP-PLAN-MED-002
    signal: Upgrade effort consistently underestimated
    evidence_indicators:
    - Upgrades take longer than planned
    - Scope creep in upgrade work
    remediation: Improve estimation; add buffer time
  low:
  - id: DEP-PLAN-LOW-001
    signal: No tracking of dependency EOL dates
    evidence_indicators:
    - EOL dates not monitored
    - Surprised by deprecations
    remediation: Track EOL dates for critical dependencies
  positive:
  - id: DEP-PLAN-POS-001
    signal: Regular upgrade planning and execution
  - id: DEP-PLAN-POS-002
    signal: Dependencies well ahead of EOL dates
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Check Runtime Versions
    description: Verify runtime versions are current
    commands:
    - purpose: Check Node.js version
      command: node --version 2>/dev/null || echo 'Node.js not installed'
    - purpose: Check Python version
      command: python3 --version 2>/dev/null || python --version 2>/dev/null || echo 'Python not found'
    - purpose: Check engines in package.json
      command: cat package.json 2>/dev/null | jq '.engines' || echo 'No engines specified'
  - id: '2'
    name: Identify EOL Dependencies
    description: Find dependencies approaching or past EOL
    commands:
    - purpose: Note EOL checking process
      command: |-
        echo 'Check endoflife.date for:
        - Node.js: https://endoflife.date/nodejs
        - Python: https://endoflife.date/python
        - Key frameworks: React, Vue, Django, etc.

        Compare against current versions in use.'
  - id: '3'
    name: Review Upgrade Backlog
    description: Identify deferred major upgrades
    commands:
    - purpose: List major updates available
      command: npx npm-check-updates --target major 2>/dev/null | head -30 || npm outdated 2>/dev/null
        | head -30
  - id: '4'
    name: Check Dependency Age
    description: Measure overall dependency age
    commands:
    - purpose: Calculate libyear
      command: npx libyear 2>/dev/null | tail -5 || echo 'libyear not available'
  - id: '5'
    name: Review Planning Documents
    description: Check for upgrade planning
    commands:
    - purpose: Find planning docs
      command: find . -iname '*roadmap*' -o -iname '*upgrade*' -o -iname '*migration*' 2>/dev/null | grep
        -vE 'node_modules|vendor' | head -10
  - id: '6'
    name: Create Upgrade Plan Template
    description: Document upgrade planning approach
    commands:
    - purpose: Generate planning template
      command: |-
        echo 'Dependency Upgrade Plan Template:

        Quarter: Q[X] 202[X]

        High Priority (EOL/Security):
        - [ ] Package 1 (EOL date: YYYY-MM-DD)
        - [ ] Package 2 (Security concern)

        Medium Priority (Major versions):
        - [ ] Package 3 (current -> target)

        Low Priority (Minor/Patch):
        - [ ] Batch minor updates

        Estimated Effort: [X] developer-days
        Assigned To: [Team/Person]
        Target Completion: [Date]'
output:
  deliverables:
  - type: eol_assessment
    format: structured
    description: Dependencies at or approaching EOL
  - type: upgrade_plan
    format: structured
    description: Prioritized upgrade plan
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - EOL Analysis
    - Upgrade Backlog
    - Resource Requirements
    - Recommendations
closeout_checklist:
- id: dep-plan-001
  item: No EOL dependencies in production
  level: CRITICAL
  verification: EOL check complete
- id: dep-plan-002
  item: Approaching EOL dependencies have migration plans
  level: CRITICAL
  verification: Migration plans documented
- id: dep-plan-003
  item: Quarterly upgrade planning scheduled
  level: REQUIRED
  verification: Planning cadence established
- id: dep-plan-004
  item: Upgrade backlog prioritized
  level: REQUIRED
  verification: Backlog reviewed and prioritized
governance:
  applicable_to:
    archetypes:
    - all-software-projects
  compliance_mappings:
  - framework: SOC 2
    control: CC6.1
    description: Supported software management
  - framework: PCI DSS
    control: '6.2'
    description: Vendor security patches
relationships:
  commonly_combined:
  - dependency-supply-chain.update-management.breaking-change-assessment
  depends_on:
  - dependency-supply-chain.dependency-inventory.dependency-enumeration
  feeds_into:
  - project-management.technical-debt-planning
