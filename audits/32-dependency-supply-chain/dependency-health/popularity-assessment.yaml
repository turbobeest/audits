audit:
  id: dependency-supply-chain.dependency-health.popularity-assessment
  name: Popularity Assessment Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: dependency-supply-chain
  category_number: 32
  subcategory: dependency-health
  tier: expert
  estimated_duration: 1-2 hours  # median: 1h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: full
  severity: low
  scope: dependencies
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit evaluates the popularity and adoption of dependencies
    through metrics like download counts, GitHub stars, dependent
    projects, and community size. While popularity doesn't guarantee
    quality, it indicates community validation and support availability.
  why_it_matters: |
    Popular packages typically have more eyes reviewing code, more
    resources for maintenance, and more community support. Unpopular
    packages may lack scrutiny and support. However, popularity should
    be balanced against other health factors.
  when_to_run:
  - When selecting between alternatives
  - When evaluating new dependencies
  - During dependency rationalization
  - For understanding support availability
prerequisites:
  required_artifacts:
  - type: dependency_manifest
    description: List of dependencies
  access_requirements:
  - Access to package registries
  - Access to GitHub
discovery:
  file_patterns:
  - glob: '**/package.json'
    purpose: Find npm dependencies
knowledge_sources:
  guides:
  - id: npm-stats
    name: npm Download Statistics
    url: https://www.npmjs.com/
  standards:
  - id: package-selection
    name: Package Selection Criteria
    relevance: Balancing popularity with other factors
tooling:
  analysis_tools:
  - tool: npm info
    purpose: Get package download counts
  - tool: npmtrends
    purpose: Compare package popularity
signals:
  critical:
  - id: DEP-POP-CRIT-001
    signal: Critical dependency has very low adoption
    evidence_indicators:
    - Less than 100 weekly downloads
    - No dependents
    - Unknown package for critical function
    explanation: |
      Very low adoption of a critical dependency suggests either
      it's a specialized niche or possibly abandoned/low-quality.
      Low scrutiny increases risk of undetected issues.
    remediation: Thoroughly vet; prefer more popular alternatives if available
  high:
  - id: DEP-POP-HIGH-001
    signal: Dependency declining in popularity rapidly
    evidence_indicators:
    - Downloads dropping significantly
    - Dependents migrating away
    remediation: Research why; may indicate problems
  medium:
  - id: DEP-POP-MED-001
    signal: Dependency has moderate but stable adoption
    evidence_indicators:
    - Consistent but not growing downloads
    - Small but active community
    remediation: Acceptable; ensure other health factors positive
  - id: DEP-POP-MED-002
    signal: Alternative packages significantly more popular
    evidence_indicators:
    - Competitor has 10x+ downloads
    - Industry standard exists
    remediation: Evaluate if switching provides benefits
  low:
  - id: DEP-POP-LOW-001
    signal: Niche package with appropriate adoption
    evidence_indicators:
    - Specialized package for specific use case
    - Expected lower popularity
    remediation: Acceptable for niche purposes
  positive:
  - id: DEP-POP-POS-001
    signal: Dependencies widely adopted and growing
  - id: DEP-POP-POS-002
    signal: Using industry-standard packages
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Check npm Download Stats
    description: Get download counts from npm
    commands:
    - purpose: Get weekly downloads
      command: curl -s 'https://api.npmjs.org/downloads/point/last-week/lodash' 2>/dev/null | jq '.downloads'
        || echo 'npm API not available'
  - id: '2'
    name: Check GitHub Stars
    description: Get star count from GitHub
    commands:
    - purpose: Get star count
      command: gh api repos/lodash/lodash --jq '.stargazers_count' 2>/dev/null || echo 'GitHub API not
        available'
  - id: '3'
    name: Check Dependent Count
    description: See how many projects depend on this
    commands:
    - purpose: Get dependents
      command: npm info lodash dependents 2>/dev/null | head -20 || echo 'Check npm page for dependents'
  - id: '4'
    name: Compare Alternatives
    description: Check popularity vs alternatives
    commands:
    - purpose: Note comparison tools
      command: |-
        echo 'Compare package popularity:
        - npmtrends.com (npm packages)
        - deps.dev (multiple ecosystems)
        - Star history (GitHub stars over time)'
  - id: '5'
    name: Check Download Trends
    description: Analyze popularity trajectory
    commands:
    - purpose: Get download history
      command: curl -s 'https://api.npmjs.org/downloads/range/last-year/lodash' 2>/dev/null | jq '.downloads[-1]'
        || echo 'Download trend API not available'
  - id: '6'
    name: Document Popularity Metrics
    description: Record popularity for key dependencies
    commands:
    - purpose: Generate metrics template
      command: |-
        echo 'Popularity Metrics Template:

        Package: [name]
        Weekly Downloads: [count]
        GitHub Stars: [count]
        Dependents: [count]
        Trend: [rising/stable/declining]'
output:
  deliverables:
  - type: popularity_assessment
    format: structured
    description: Popularity metrics for dependencies
  - type: comparison_analysis
    format: structured
    description: Comparison with alternatives
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Popularity Metrics
    - Trend Analysis
    - Alternative Comparison
    - Recommendations
closeout_checklist:
- id: dep-pop-001
  item: Popularity metrics collected
  level: REQUIRED
  verification: Metrics documented
- id: dep-pop-002
  item: Low-adoption deps flagged
  level: REQUIRED
  verification: Low-adoption list complete
- id: dep-pop-003
  item: Declining deps identified
  level: REQUIRED
  verification: Trend analysis complete
- id: dep-pop-004
  item: Alternatives compared
  level: RECOMMENDED
  verification: Comparison documented
governance:
  applicable_to:
    archetypes:
    - all-software-projects
  compliance_mappings:
  - framework: SOC 2
    control: CC9.2
    description: Vendor evaluation
relationships:
  commonly_combined:
  - dependency-supply-chain.dependency-health.maintenance-status
  depends_on:
  - dependency-supply-chain.dependency-inventory.dependency-enumeration
  feeds_into:
  - dependency-supply-chain.dependency-health.abandonment-risk
