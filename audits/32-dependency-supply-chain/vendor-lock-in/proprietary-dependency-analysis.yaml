audit:
  id: dependency-supply-chain.vendor-lock-in.proprietary-dependency-analysis
  name: Proprietary Dependency Analysis Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: dependency-supply-chain
  category_number: 32
  subcategory: vendor-lock-in
  tier: expert
  estimated_duration: 2-3 hours  # median: 2h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: dependencies
  default_profiles:
  - full
  - strategic
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit identifies dependencies on proprietary or vendor-specific
    APIs, libraries, and services. It assesses the depth of integration
    with commercial/proprietary solutions that may create lock-in
    situations.
  why_it_matters: |
    Deep integration with proprietary dependencies can lead to vendor
    lock-in, making it difficult or expensive to switch providers.
    Understanding proprietary dependencies helps with strategic planning,
    cost negotiations, and risk management.
  when_to_run:
  - During architecture reviews
  - When evaluating vendor relationships
  - Before major integrations
  - During cost optimization initiatives
prerequisites:
  required_artifacts:
  - type: dependency_manifest
    description: List of dependencies
  - type: architecture_documentation
    description: System architecture understanding
  access_requirements:
  - Read access to codebase
  - Understanding of vendor relationships
discovery:
  file_patterns:
  - glob: '**/package.json'
    purpose: Find npm dependencies
  - glob: '**/*.config.*'
    purpose: Find vendor configurations
  - glob: '**/docker-compose*.yml'
    purpose: Find service dependencies
knowledge_sources:
  guides:
  - id: vendor-lock-in
    name: Avoiding Vendor Lock-in
    url: https://martinfowler.com/bliki/PlatformLockIn.html
  standards:
  - id: portability
    name: Application Portability
    relevance: Reducing vendor dependency
tooling:
  analysis_tools:
  - tool: code-search
    purpose: Find vendor-specific imports
signals:
  critical:
  - id: DEP-PROP-CRIT-001
    signal: Critical path depends entirely on proprietary service
    evidence_indicators:
    - Core functionality tied to vendor API
    - No abstraction layer
    - Vendor has no competitors
    explanation: |
      Complete dependence on a single proprietary solution for
      critical functions creates existential risk. Vendor changes,
      price increases, or discontinuation could severely impact
      operations.
    remediation: Implement abstraction layer; evaluate alternatives
  high:
  - id: DEP-PROP-HIGH-001
    signal: Extensive use of vendor-specific features
    evidence_indicators:
    - Using vendor-unique APIs
    - Features not available elsewhere
    remediation: Document lock-in; plan abstraction
  - id: DEP-PROP-HIGH-002
    signal: Proprietary data formats creating lock-in
    evidence_indicators:
    - Data stored in vendor-specific format
    - No export capability
    remediation: Implement data export; use standard formats
  medium:
  - id: DEP-PROP-MED-001
    signal: Moderate use of vendor SDKs
    evidence_indicators:
    - Vendor SDK in use
    - Alternatives exist but unused
    remediation: Consider abstraction for flexibility
  - id: DEP-PROP-MED-002
    signal: Vendor-specific tooling in build process
    evidence_indicators:
    - Build depends on vendor tools
    - Developer experience tied to vendor
    remediation: Evaluate open alternatives
  low:
  - id: DEP-PROP-LOW-001
    signal: Minor vendor-specific integrations
    evidence_indicators:
    - Optional vendor features used
    - Easy to remove
    remediation: Document; low priority
  positive:
  - id: DEP-PROP-POS-001
    signal: Abstraction layers in place
  - id: DEP-PROP-POS-002
    signal: Standard protocols and formats used
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Identify Vendor Dependencies
    description: Find proprietary/vendor-specific packages
    commands:
    - purpose: Search for cloud provider SDKs
      command: cat package.json 2>/dev/null | jq -r '.dependencies + .devDependencies | keys[]' | grep
        -iE '(aws|azure|gcp|google-cloud|@aws-sdk|@azure)' || echo 'No obvious cloud SDKs found'
  - id: '2'
    name: Search for Vendor Imports
    description: Find vendor-specific code usage
    commands:
    - purpose: Find AWS imports
      command: grep -rE 'aws-sdk|@aws-sdk' src/ --include='*.ts' --include='*.js' 2>/dev/null | wc -l
        || echo 'Count AWS usages manually'
    - purpose: Find Azure imports
      command: grep -rE '@azure/' src/ --include='*.ts' --include='*.js' 2>/dev/null | wc -l || echo 'Count
        Azure usages manually'
  - id: '3'
    name: Identify Proprietary Databases
    description: Find proprietary database dependencies
    commands:
    - purpose: Search for proprietary DBs
      command: grep -rE '(dynamodb|cosmosdb|firestore|fauna|planetscale)' . --include='*.ts' --include='*.js'
        --include='*.env*' 2>/dev/null | head -20 || echo 'No proprietary DB usage found'
  - id: '4'
    name: Check for Abstraction Layers
    description: Verify abstraction patterns exist
    commands:
    - purpose: Find adapter/repository patterns
      command: find src -name '*adapter*' -o -name '*repository*' -o -name '*provider*' 2>/dev/null |
        head -20 || echo 'Look for abstraction patterns in code'
  - id: '5'
    name: Assess Data Portability
    description: Check data export capabilities
    commands:
    - purpose: Note data portability check
      command: |-
        echo 'Data Portability Checklist:

        [ ] Data can be exported in standard format
        [ ] No proprietary binary formats
        [ ] Migration scripts exist
        [ ] Backup in portable format
        [ ] Data schema documented'
  - id: '6'
    name: Document Vendor Dependencies
    description: Create vendor dependency inventory
    commands:
    - purpose: Generate inventory template
      command: |-
        echo 'Vendor Dependency Inventory:

        Vendor: [name]
        Components Used:
        - [component 1]
        - [component 2]
        Abstraction: [Yes/No/Partial]
        Alternatives: [list]
        Migration Difficulty: [Low/Medium/High]
        Lock-in Risk: [Low/Medium/High]'
output:
  deliverables:
  - type: vendor_dependency_inventory
    format: structured
    description: List of proprietary dependencies
  - type: lock_in_assessment
    format: structured
    description: Risk assessment for vendor lock-in
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Proprietary Dependencies
    - Lock-in Risk Assessment
    - Abstraction Analysis
    - Recommendations
closeout_checklist:
- id: dep-prop-001
  item: Proprietary dependencies identified
  level: REQUIRED
  verification: Inventory complete
- id: dep-prop-002
  item: Lock-in risk assessed
  level: REQUIRED
  verification: Risk levels documented
- id: dep-prop-003
  item: Abstraction opportunities identified
  level: RECOMMENDED
  verification: Abstraction recommendations
- id: dep-prop-004
  item: Data portability evaluated
  level: REQUIRED
  verification: Portability assessment complete
governance:
  applicable_to:
    archetypes:
    - all-software-projects
  compliance_mappings:
  - framework: SOC 2
    control: CC9.2
    description: Vendor risk management
  - framework: ISO 27001
    control: A.15.2
    description: Supplier service delivery
relationships:
  commonly_combined:
  - dependency-supply-chain.vendor-lock-in.migration-difficulty
  depends_on:
  - dependency-supply-chain.dependency-inventory.dependency-enumeration
  feeds_into:
  - architecture.vendor-strategy
