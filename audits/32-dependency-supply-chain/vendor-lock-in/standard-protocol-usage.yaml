audit:
  id: dependency-supply-chain.vendor-lock-in.standard-protocol-usage
  name: Standard Protocol Usage Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: dependency-supply-chain
  category_number: 32
  subcategory: vendor-lock-in
  tier: expert
  estimated_duration: 2-3 hours  # median: 2h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: dependencies
  default_profiles:
  - full
  - architecture
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit evaluates the use of standard, open protocols versus
    proprietary vendor-specific protocols. Standard protocols enable
    interoperability and easier migration between vendors.
  why_it_matters: |
    Using standard protocols (like OpenID Connect, S3-compatible APIs,
    SQL, etc.) means you can swap implementations without changing
    integration code. Proprietary protocols lock you into specific
    vendors and make migration costly.
  when_to_run:
  - When designing new integrations
  - During architecture reviews
  - When evaluating vendor offerings
  - As part of portability assessments
prerequisites:
  required_artifacts:
  - type: source_code
    description: Integration code
  - type: api_documentation
    description: API specifications being used
  access_requirements:
  - Read access to codebase
  - Understanding of protocol standards
discovery:
  file_patterns:
  - glob: '**/*config*'
    purpose: Find configuration files
  - glob: '**/*api*'
    purpose: Find API integrations
  - glob: '**/openapi*'
    purpose: Find OpenAPI specs
knowledge_sources:
  guides:
  - id: open-standards
    name: Open Standards Definition
    url: https://opensource.com/resources/what-are-open-standards
  standards:
  - id: various-open-standards
    name: Common Open Standards
    relevance: Standard protocol references
tooling:
  analysis_tools:
  - tool: code-analysis
    purpose: Identify protocol usage
signals:
  critical:
  - id: DEP-PROTO-CRIT-001
    signal: Core integration uses proprietary protocol
    evidence_indicators:
    - Vendor-specific wire protocol
    - No standard equivalent
    - Binary/undocumented protocol
    explanation: |
      Proprietary protocols create hard lock-in. Only that vendor
      can implement the protocol, leaving no migration path except
      complete replacement.
    remediation: Evaluate if standard protocol alternative exists
  high:
  - id: DEP-PROTO-HIGH-001
    signal: Standard protocol available but not used
    evidence_indicators:
    - Using vendor SDK when REST available
    - Proprietary auth when OIDC supported
    remediation: Switch to standard protocol
  - id: DEP-PROTO-HIGH-002
    signal: Using vendor extensions to standards
    evidence_indicators:
    - Vendor-specific extensions to SQL
    - Non-standard API additions
    remediation: Minimize extension usage; abstract if needed
  medium:
  - id: DEP-PROTO-MED-001
    signal: Mix of standard and proprietary
    evidence_indicators:
    - Some standard protocols
    - Some vendor-specific
    remediation: Standardize where possible
  - id: DEP-PROTO-MED-002
    signal: Data formats are vendor-specific
    evidence_indicators:
    - Proprietary file format
    - Vendor-specific serialization
    remediation: Use JSON, XML, Parquet, or other standards
  low:
  - id: DEP-PROTO-LOW-001
    signal: Minor vendor-specific features used
    evidence_indicators:
    - Mostly standard with few extras
    - Easy to remove vendor features
    remediation: Document; low priority
  positive:
  - id: DEP-PROTO-POS-001
    signal: Standard protocols used throughout
  - id: DEP-PROTO-POS-002
    signal: S3-compatible, SQL, OIDC, etc.
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Identify Integration Points
    description: Find all external integrations
    commands:
    - purpose: Find API calls
      command: grep -rE '(fetch|axios|http|request)' src/ --include='*.ts' --include='*.js' 2>/dev/null
        | head -30 || echo 'Search for API integration patterns'
  - id: '2'
    name: Check Authentication Protocols
    description: Verify standard auth protocols
    commands:
    - purpose: Check for standard auth
      command: grep -rE '(oauth|oidc|openid|saml|jwt)' src/ --include='*.ts' --include='*.js' 2>/dev/null
        | head -20 || echo 'Check authentication protocol usage'
  - id: '3'
    name: Check Database Protocols
    description: Verify standard database access
    commands:
    - purpose: Check SQL usage
      command: grep -rE '(postgres|mysql|sqlite|mongodb|redis)' src/ --include='*.ts' --include='*.js'
        2>/dev/null | head -20 || echo 'Check database client usage'
  - id: '4'
    name: Check Storage Protocols
    description: Verify S3-compatible or standard storage
    commands:
    - purpose: Check for S3 compatibility
      command: grep -rE '(s3|minio|storage)' src/ --include='*.ts' --include='*.js' 2>/dev/null | head
        -20 || echo 'Check storage protocol usage'
  - id: '5'
    name: Document Protocol Usage
    description: Create protocol inventory
    commands:
    - purpose: Generate protocol inventory
      command: |-
        echo 'Protocol Usage Inventory:

        Authentication:
        - Protocol: [OIDC/OAuth2/proprietary]
        - Standard: [Yes/No]

        Database:
        - Protocol: [SQL/proprietary]
        - Standard: [Yes/No]

        Storage:
        - Protocol: [S3/proprietary]
        - Standard: [Yes/No]

        Messaging:
        - Protocol: [AMQP/proprietary]
        - Standard: [Yes/No]

        API:
        - Protocol: [REST/GraphQL/gRPC/proprietary]
        - Standard: [Yes/No]'
  - id: '6'
    name: Identify Standardization Opportunities
    description: Find where standards could replace proprietary
    commands:
    - purpose: Generate opportunities list
      command: |-
        echo 'Standardization Opportunities:

        Current: [proprietary protocol]
        Standard Alternative: [standard]
        Effort to Switch: [Low/Medium/High]
        Benefit: [description]
        Recommendation: [yes/no/investigate]'
output:
  deliverables:
  - type: protocol_inventory
    format: structured
    description: Inventory of protocols in use
  - type: standardization_opportunities
    format: list
    description: Opportunities to use standards
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Protocol Inventory
    - Standard vs Proprietary Analysis
    - Standardization Opportunities
    - Recommendations
closeout_checklist:
- id: dep-proto-001
  item: All protocols inventoried
  level: REQUIRED
  verification: Protocol list complete
- id: dep-proto-002
  item: Proprietary protocols identified
  level: REQUIRED
  verification: Proprietary list documented
- id: dep-proto-003
  item: Standardization opportunities noted
  level: REQUIRED
  verification: Opportunities documented
- id: dep-proto-004
  item: Authentication uses OIDC/OAuth2
  level: RECOMMENDED
  verification: Auth protocol verified
governance:
  applicable_to:
    archetypes:
    - all-software-projects
  compliance_mappings:
  - framework: SOC 2
    control: CC6.7
    description: Interoperability
  - framework: ISO 27001
    control: A.14.1.3
    description: System acquisition
relationships:
  commonly_combined:
  - dependency-supply-chain.vendor-lock-in.abstraction-layer-assessment
  depends_on:
  - architecture.integration-patterns
  feeds_into:
  - dependency-supply-chain.vendor-lock-in.migration-difficulty
