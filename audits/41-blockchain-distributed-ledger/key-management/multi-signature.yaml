audit:
  id: blockchain-distributed-ledger.key-management.multi-signature
  name: Multi-Signature Audit
  version: 1.0.0
  last_updated: '2026-01-22'
  status: active
  category: blockchain-distributed-ledger
  category_number: 41
  subcategory: key-management
  tier: expert
  estimated_duration: 2-3 hours  # median: 2h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: software
  default_profiles:
  - full
  - blockchain
  - security
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit evaluates multi-signature wallet implementations
    for security and operational correctness. It examines:
    - Threshold configuration (M-of-N)
    - Signer management
    - Transaction signing flow
    - Signature verification
    - Recovery procedures
    - Operational security
  why_it_matters: |
    Multi-sig provides critical security controls:
    - Single key compromise doesn't enable theft
    - Collusion required for malicious transactions
    - Separation of duties enforced
    - Recovery possible with sufficient signers
    - Reduces insider threat risk

    Proper multi-sig implementation is essential for custody.
  when_to_run:
  - Multi-sig deployment
  - Treasury setup
  - Custody review
  - Signer changes
prerequisites:
  required_artifacts:
  - type: source_code
    description: Multi-sig contract or configuration
  - type: documentation
    description: Operational procedures
  access_requirements:
  - Multi-sig contract code
  - Signer configuration
discovery:
  code_patterns:
  - pattern: (multisig|multiSig|gnosis|safe)
    type: regex
    scope: source
    purpose: Detect multi-sig usage
  - pattern: (threshold|required|confirmations)
    type: regex
    scope: source
    purpose: Detect threshold configuration
  - pattern: (owner|signer|approve)
    type: regex
    scope: source
    purpose: Detect signer management
  file_patterns:
  - glob: '**/*.sol'
    purpose: Solidity contracts
  - glob: '**/*.{js,ts}'
    purpose: Configuration files
signals:
  critical:
  - id: MSIG-CRIT-001
    signal: Threshold too low
    evidence_indicators:
    - 1-of-N multi-sig
    - Threshold < 2 for high value
    - Single signer approval sufficient
    explanation: |
      Low thresholds defeat multi-sig purpose. Single signer
      approval enables unilateral action, negating security
      benefits.
    remediation: |
      - Increase threshold appropriately
      - Use at least 2-of-3 for moderate value
      - Use 3-of-5 or higher for high value
      - Balance security with operational needs
  - id: MSIG-CRIT-002
    signal: Signer overlap creates single point of failure
    evidence_indicators:
    - Same person controls multiple keys
    - Keys stored in same location
    - Signers not independent
    explanation: |
      If one party controls multiple keys meeting threshold,
      multi-sig protection is defeated.
    remediation: |
      - Ensure signer independence
      - Distribute keys geographically
      - Use separate custody for each key
      - Verify signer diversity
  high:
  - id: MSIG-HIGH-001
    signal: No timelock on high-value transactions
    evidence_indicators:
    - Immediate execution after threshold
    - No delay for large transfers
    - No cancellation period
    explanation: |
      Timelocks provide opportunity to detect and cancel
      malicious transactions before execution.
    remediation: |
      - Add timelock for high-value transactions
      - Implement value-based delays
      - Allow cancellation during delay
      - Monitor pending transactions
  - id: MSIG-HIGH-002
    signal: Signer removal requires fewer signers
    evidence_indicators:
    - Self-removal possible
    - Lower threshold for signer changes
    - Hostile takeover possible
    explanation: |
      If signer changes require fewer signatures than
      transactions, attackers can remove legitimate signers.
    remediation: |
      - Require same or higher threshold for signer changes
      - Add timelock to signer modifications
      - Require unanimous consent for removal
      - Monitor signer change events
  medium:
  - id: MSIG-MED-001
    signal: No transaction review process
    evidence_indicators:
    - Signers sign without verification
    - Transaction details not confirmed
    - Blind signing common
    explanation: |
      Signers should verify transaction details before
      signing to prevent signing malicious transactions.
    remediation: |
      - Implement transaction review UI
      - Require human-readable descriptions
      - Verify transaction simulation
      - Document review procedures
  - id: MSIG-MED-002
    signal: Recovery procedures undefined
    evidence_indicators:
    - No lost signer recovery
    - Stuck transactions possible
    - Threshold unachievable if signers lost
    explanation: |
      Lost signers may make threshold unachievable, locking
      funds permanently.
    remediation: |
      - Define recovery procedures
      - Plan for signer unavailability
      - Consider backup signers
      - Test recovery scenarios
  low:
  - id: MSIG-LOW-001
    signal: Signing activity not monitored
    evidence_indicators:
    - No alert on pending transactions
    - Signing events not logged
    - Activity not reviewed
    explanation: |
      Unmonitored multi-sig activity may miss suspicious
      transactions or unauthorized attempts.
    remediation: |
      - Alert on pending transactions
      - Log all signing events
      - Monitor for unusual activity
      - Review activity regularly
  positive:
  - id: MSIG-POS-001
    signal: Robust multi-sig implementation
    evidence_indicators:
    - Appropriate threshold
    - Independent signers
    - Timelock implemented
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: security-auditor
  steps:
  - id: '1'
    name: Multi-sig Analysis
    description: |
      Analyze multi-signature configuration and implementation.
    duration_estimate: 60 min
    commands:
    - purpose: Find multi-sig patterns
      command: |
        grep -rniE "(multisig|multiSig|gnosis|safe)" \
          --include="*.sol" --include="*.js" --include="*.ts" . 2>/dev/null | head -30
    - purpose: Find threshold configuration
      command: |
        grep -rniE "(threshold|required|owners)" \
          --include="*.sol" --include="*.json" . 2>/dev/null | head -20
    expected_findings:
    - Multi-sig implementation
    - Threshold configuration
    - Signer management
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Multi-sig Analysis
    - Configuration Assessment
    - Recommendations
profiles:
  membership:
    quick:
      included: false
    full:
      included: true
      priority: 2
    blockchain:
      included: true
      priority: 2
closeout_checklist:
- id: msig-001
  item: Threshold appropriate for value
  level: CRITICAL
  verification: manual
  verification_notes: Verify threshold matches security requirements
  expected: Confirmed by reviewer
- id: msig-002
  item: Signers are independent
  level: BLOCKING
  verification: manual
  verification_notes: Verify no single party controls threshold keys
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - blockchain
    - treasury
    - dao
    - custody
relationships:
  commonly_combined:
  - blockchain.key-management.private-key-security
  - blockchain.governance.admin-key-risk
  - blockchain.smart-contract-security.access-control

# Glossary of domain-specific terms:
glossary:
  "timelock": "Governance mechanism requiring delay between proposal and execution"
  "reentrancy": "Vulnerability where external call allows re-entering function before completion"
  "oracle": "External data feed providing off-chain information to smart contracts"
