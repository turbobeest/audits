audit:
  id: blockchain-distributed-ledger.smart-contract-security.access-control
  name: Access Control Audit
  version: 1.0.0
  last_updated: '2026-01-22'
  status: active
  category: blockchain-distributed-ledger
  category_number: 41
  subcategory: smart-contract-security
  tier: expert
  estimated_duration: 2-3 hours  # median: 2h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: critical
  scope: software
  default_profiles:
  - full
  - blockchain
  - security
  blocks_phase: true
  parallelizable: true
description:
  what: |
    This audit evaluates smart contract access control mechanisms
    to ensure proper authorization of sensitive operations. It examines:
    - Owner/admin privilege patterns
    - Role-based access control implementation
    - Function visibility modifiers
    - Modifier correctness and placement
    - Privilege escalation vectors
    - Access control bypass possibilities
  why_it_matters: |
    Access control failures enable unauthorized operations:
    - Missing access control allows anyone to call admin functions
    - Incorrect modifier usage leaves functions unprotected
    - Centralization risks from single owner patterns
    - Privilege escalation can compromise entire contracts
    - Public functions may expose sensitive operations

    Proper access control is essential for contract security.
  when_to_run:
  - Smart contract development
  - Pre-deployment audit
  - Privilege function review
  - After access control changes
prerequisites:
  required_artifacts:
  - type: source_code
    description: Smart contract source code
  - type: documentation
    description: Access control requirements
  access_requirements:
  - Access to contract source
  - Understanding of intended permissions
discovery:
  code_patterns:
  - pattern: (onlyOwner|onlyAdmin|onlyRole)
    type: regex
    scope: source
    purpose: Detect access control modifiers
  - pattern: (require.*msg\.sender|_checkRole)
    type: regex
    scope: source
    purpose: Detect authorization checks
  - pattern: (external|public).*function
    type: regex
    scope: source
    purpose: Detect externally callable functions
  file_patterns:
  - glob: '**/*.sol'
    purpose: Solidity contracts
  - glob: '**/access/**/*.sol'
    purpose: Access control contracts
knowledge_sources:
  specifications:
  - id: swc-105
    name: 'SWC-105: Unprotected Ether Withdrawal'
    url: https://swcregistry.io/docs/SWC-105
    offline_cache: true
    priority: required
  - id: swc-106
    name: 'SWC-106: Unprotected SELFDESTRUCT'
    url: https://swcregistry.io/docs/SWC-106
    offline_cache: true
signals:
  critical:
  - id: ACC-CRIT-001
    signal: Sensitive function without access control
    evidence_indicators:
    - Public function modifies critical state
    - No onlyOwner or role check
    - Anyone can call privileged operation
    explanation: |
      Sensitive functions without access control allow anyone to
      execute privileged operations. This can result in fund theft,
      contract destruction, or state manipulation.
    remediation: |
      - Add appropriate access control modifier
      - Use OpenZeppelin AccessControl or Ownable
      - Audit all external/public functions
      - Document intended access levels
    cwe: CWE-284
  - id: ACC-CRIT-002
    signal: tx.origin used for authentication
    evidence_indicators:
    - require(tx.origin == owner)
    - tx.origin instead of msg.sender
    - Authorization based on transaction origin
    explanation: |
      Using tx.origin for authentication enables phishing attacks.
      If owner interacts with malicious contract, it can call
      protected functions as tx.origin is still the owner.
    remediation: |
      - Replace tx.origin with msg.sender
      - Never use tx.origin for authorization
      - Use msg.sender for all access checks
      - Consider signature-based authorization
    cwe: CWE-477
  high:
  - id: ACC-HIGH-001
    signal: Single point of failure in ownership
    evidence_indicators:
    - Single owner controls critical functions
    - No multisig for admin operations
    - Owner key compromise = total compromise
    explanation: |
      Single owner patterns create centralization risks. If the
      owner key is compromised, the entire contract is compromised.
      No checks and balances exist.
    remediation: |
      - Implement multi-signature requirements
      - Use timelock for critical operations
      - Consider role-based access control
      - Implement ownership transfer safely
  - id: ACC-HIGH-002
    signal: Modifier bypass possible
    evidence_indicators:
    - Modifier can be skipped via internal call
    - Inconsistent modifier application
    - Protected function callable indirectly
    explanation: |
      Access control modifiers may be bypassed if protected functions
      are callable through unprotected internal paths or if modifiers
      are inconsistently applied.
    remediation: |
      - Apply modifiers consistently
      - Check all call paths to sensitive code
      - Use internal functions carefully
      - Audit modifier effectiveness
  medium:
  - id: ACC-MED-001
    signal: Role management not secure
    evidence_indicators:
    - Roles can be granted without approval
    - No role revocation capability
    - Role hierarchy unclear
    explanation: |
      Insecure role management can lead to privilege escalation or
      inability to revoke compromised accounts.
    remediation: |
      - Implement secure role granting
      - Ensure roles can be revoked
      - Document role hierarchy
      - Add events for role changes
  - id: ACC-MED-002
    signal: Missing function visibility
    evidence_indicators:
    - Functions without explicit visibility
    - Default visibility used
    - Unclear access intention
    explanation: |
      Missing explicit visibility makes access control unclear and
      may expose functions unintentionally.
    remediation: |
      - Add explicit visibility to all functions
      - Use private/internal where possible
      - Review all public/external functions
      - Document access intentions
  low:
  - id: ACC-LOW-001
    signal: Access control events not emitted
    evidence_indicators:
    - No events for admin actions
    - Role changes not logged
    - Silent privilege operations
    explanation: |
      Without events, access control changes cannot be monitored
      or audited off-chain.
    remediation: |
      - Emit events for all admin actions
      - Log role grants and revocations
      - Enable off-chain monitoring
      - Include actor in events
  positive:
  - id: ACC-POS-001
    signal: Robust access control implementation
    evidence_indicators:
    - OpenZeppelin AccessControl used
    - Consistent modifier application
    - Role hierarchy documented
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: security-auditor
  steps:
  - id: '1'
    name: Access Control Analysis
    description: |
      Analyze access control patterns and authorization.
    duration_estimate: 60 min
    commands:
    - purpose: Find access control patterns
      command: |
        grep -rniE "(onlyOwner|onlyAdmin|onlyRole|_checkRole)" \
          --include="*.sol" . 2>/dev/null | head -30
    - purpose: Find public/external functions
      command: |
        grep -rniE "(external|public)\s+function" \
          --include="*.sol" . 2>/dev/null | head -30
    - purpose: Check for tx.origin
      command: |
        grep -rniE "tx\.origin" \
          --include="*.sol" . 2>/dev/null | head -10
    expected_findings:
    - Access control implementation
    - Function visibility
    - Authorization patterns
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Access Control Analysis
    - Privilege Assessment
    - Recommendations
profiles:
  membership:
    quick:
      included: false
    full:
      included: true
      priority: 1
    blockchain:
      included: true
      priority: 1
closeout_checklist:
- id: acc-001
  item: All sensitive functions protected
  level: CRITICAL
  verification: manual
  verification_notes: Verify all admin functions have access control
  expected: Confirmed by reviewer
- id: acc-002
  item: No tx.origin for authorization
  level: BLOCKING
  verification: |
    grep -rniE "tx\.origin.*==" \
      --include="*.sol" . 2>/dev/null | \
      wc -l | xargs -I{} test {} -eq 0 && echo "PASS" || echo "FAIL"
  expected: PASS
governance:
  applicable_to:
    archetypes:
    - blockchain
    - defi
    - dao
    - financial
relationships:
  commonly_combined:
  - blockchain.smart-contract-security.reentrancy-vulnerability
  - blockchain.governance.admin-key-risk
  - blockchain.key-management.multi-signature

# Glossary of domain-specific terms:
glossary:
  "timelock": "Governance mechanism requiring delay between proposal and execution"
  "reentrancy": "Vulnerability where external call allows re-entering function before completion"
  "oracle": "External data feed providing off-chain information to smart contracts"
