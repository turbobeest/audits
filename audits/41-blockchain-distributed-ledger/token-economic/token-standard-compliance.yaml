audit:
  id: blockchain-distributed-ledger.token-economic.token-standard-compliance
  name: Token Standard Compliance Audit
  version: 1.0.0
  last_updated: '2026-01-22'
  status: active
  category: blockchain-distributed-ledger
  category_number: 41
  subcategory: token-economic
  tier: expert
  estimated_duration: 1-2 hours  # median: 1h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: software
  default_profiles:
  - full
  - blockchain
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit evaluates token implementation compliance with
    ERC standards (ERC20, ERC721, ERC1155, etc.). It examines:
    - Interface implementation completeness
    - Function signature correctness
    - Event emission compliance
    - Return value handling
    - Optional function implementation
    - Metadata standard compliance
  why_it_matters: |
    Standard compliance enables ecosystem integration:
    - Wallets depend on standard interfaces
    - Exchanges require compliant tokens
    - DeFi protocols assume standard behavior
    - Non-compliance breaks integrations
    - Standards ensure interoperability

    Compliance with token standards is essential for adoption.
  when_to_run:
  - Token development
  - Pre-deployment review
  - Exchange listing preparation
  - Integration testing
prerequisites:
  required_artifacts:
  - type: source_code
    description: Token contract source
  - type: documentation
    description: Token specification
  access_requirements:
  - Token contract source
  - Relevant ERC specification
discovery:
  code_patterns:
  - pattern: (ERC20|ERC721|ERC1155|IERC)
    type: regex
    scope: source
    purpose: Detect token standards
  - pattern: (transfer|transferFrom|approve|balanceOf)
    type: regex
    scope: source
    purpose: Detect ERC20 functions
  - pattern: (ownerOf|safeTransferFrom|tokenURI)
    type: regex
    scope: source
    purpose: Detect ERC721 functions
  file_patterns:
  - glob: '**/*.sol'
    purpose: Solidity contracts
knowledge_sources:
  specifications:
  - id: erc20
    name: 'ERC-20: Token Standard'
    url: https://eips.ethereum.org/EIPS/eip-20
    offline_cache: true
    priority: required
  - id: erc721
    name: 'ERC-721: Non-Fungible Token Standard'
    url: https://eips.ethereum.org/EIPS/eip-721
    offline_cache: true
signals:
  critical:
  - id: TOKSTD-CRIT-001
    signal: Required interface function missing
    evidence_indicators:
    - transfer() not implemented
    - balanceOf() missing
    - Required function absent
    explanation: |
      Missing required functions break standard compliance,
      preventing integration with wallets, exchanges, and protocols.
    remediation: |
      - Implement all required functions
      - Verify against ERC specification
      - Use OpenZeppelin implementations
      - Test with standard tools
    cwe: CWE-684
  - id: TOKSTD-CRIT-002
    signal: Transfer returns wrong type
    evidence_indicators:
    - transfer() returns nothing
    - Boolean return missing
    - Return value incorrect
    explanation: |
      ERC20 specifies transfer returns bool. Non-compliant returns
      break many integrations that check the return value.
    remediation: |
      - Return bool from transfer/approve
      - Follow ERC20 specification exactly
      - Test return values
      - Use SafeERC20 for interactions
  high:
  - id: TOKSTD-HIGH-001
    signal: Events not emitted correctly
    evidence_indicators:
    - Transfer event missing
    - Approval event not emitted
    - Event signature wrong
    explanation: |
      Standard events are required for indexers and UIs to
      track token movements.
    remediation: |
      - Emit all required events
      - Use correct event signatures
      - Emit in correct order
      - Test event emission
  - id: TOKSTD-HIGH-002
    signal: decimals() returns wrong value
    evidence_indicators:
    - Non-standard decimal count
    - Inconsistent decimal handling
    - decimals() missing
    explanation: |
      Incorrect decimals cause display errors and integration
      issues. Standard is 18 decimals for ERC20.
    remediation: |
      - Use standard 18 decimals if possible
      - Document non-standard decimals clearly
      - Implement decimals() function
      - Verify display correctness
  medium:
  - id: TOKSTD-MED-001
    signal: Optional functions inconsistent
    evidence_indicators:
    - name() but no symbol()
    - Partial metadata implementation
    - Inconsistent optional support
    explanation: |
      Partial optional function implementation creates
      confusing behavior and integration issues.
    remediation: |
      - Implement all optional functions together
      - Use consistent metadata pattern
      - Document optional function support
      - Test optional function handling
  - id: TOKSTD-MED-002
    signal: supportsInterface incorrect
    evidence_indicators:
    - Wrong interface ID
    - Missing interface support
    - ERC165 not implemented correctly
    explanation: |
      supportsInterface enables interface detection. Incorrect
      implementation breaks standard detection.
    remediation: |
      - Implement ERC165 correctly
      - Return true for supported interfaces
      - Calculate interface IDs correctly
      - Test interface detection
  low:
  - id: TOKSTD-LOW-001
    signal: Metadata incomplete
    evidence_indicators:
    - tokenURI returns empty
    - Metadata missing fields
    - Non-standard metadata format
    explanation: |
      Incomplete metadata affects display in wallets, marketplaces,
      and other applications.
    remediation: |
      - Implement complete metadata
      - Follow OpenSea metadata standard
      - Include all required fields
      - Validate metadata format
  positive:
  - id: TOKSTD-POS-001
    signal: Full standard compliance
    evidence_indicators:
    - All required functions
    - Correct return values
    - Proper events
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: standards-reviewer
  steps:
  - id: '1'
    name: Standard Compliance Review
    description: |
      Review token standard compliance.
    duration_estimate: 30 min
    commands:
    - purpose: Find token standard
      command: |
        grep -rniE "(ERC20|ERC721|ERC1155)" \
          --include="*.sol" . 2>/dev/null | head -20
    - purpose: Find transfer function
      command: |
        grep -rniE "function\s+(transfer|transferFrom)" \
          --include="*.sol" . 2>/dev/null | head -20
    expected_findings:
    - Token standard used
    - Function implementations
    - Event emissions
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Compliance Analysis
    - Standard Deviations
    - Recommendations
profiles:
  membership:
    quick:
      included: true
      priority: 1
    full:
      included: true
      priority: 1
    blockchain:
      included: true
      priority: 1
closeout_checklist:
- id: tokstd-001
  item: Required functions implemented
  level: CRITICAL
  verification: manual
  verification_notes: Verify all ERC functions present
  expected: Confirmed by reviewer
- id: tokstd-002
  item: Events emitted correctly
  level: BLOCKING
  verification: manual
  verification_notes: Verify standard events emitted
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - blockchain
    - token
    - nft-platform
    - defi
relationships:
  commonly_combined:
  - blockchain.smart-contract-quality.event-emission
  - blockchain.integration.indexer-reliability
  - blockchain.smart-contract-security.integer-overflow-underflow
