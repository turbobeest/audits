audit:
  id: blockchain-distributed-ledger.token-economic.token-distribution
  name: Token Distribution Audit
  version: 1.0.0
  last_updated: '2026-01-22'
  status: active
  category: blockchain-distributed-ledger
  category_number: 41
  subcategory: token-economic
  tier: expert
  estimated_duration: 1-2 hours  # median: 1h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: software
  default_profiles:
  - full
  - blockchain
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit evaluates token distribution mechanisms for fairness
    and security. It examines:
    - Initial distribution allocation
    - Vesting schedule implementation
    - Minting and supply controls
    - Airdrop security
    - Distribution centralization
    - Cliff and release mechanics
  why_it_matters: |
    Token distribution affects decentralization and value:
    - Concentrated distribution enables manipulation
    - Unfair distribution harms community
    - Vesting protects against dumps
    - Supply controls affect tokenomics
    - Distribution attacks extract value

    Fair distribution builds community trust.
  when_to_run:
  - Token launch planning
  - Vesting implementation
  - Distribution audit
  - Community sale review
prerequisites:
  required_artifacts:
  - type: source_code
    description: Distribution contract code
  - type: documentation
    description: Tokenomics documentation
  access_requirements:
  - Distribution contract source
  - Allocation documentation
discovery:
  code_patterns:
  - pattern: (vest|vesting|cliff|release)
    type: regex
    scope: source
    purpose: Detect vesting mechanisms
  - pattern: (mint|distribute|airdrop)
    type: regex
    scope: source
    purpose: Detect distribution functions
  - pattern: (allocation|reserve|treasury)
    type: regex
    scope: source
    purpose: Detect allocation handling
  file_patterns:
  - glob: '**/*.sol'
    purpose: Solidity contracts
signals:
  critical:
  - id: TOKDIS-CRIT-001
    signal: Unlimited minting possible
    evidence_indicators:
    - No max supply cap
    - Admin can mint unlimited
    - Supply not bounded
    explanation: |
      Unlimited minting enables infinite inflation, destroying
      token value for holders.
    remediation: |
      - Implement max supply cap
      - Add minting controls
      - Require governance for minting
      - Document supply policy
    cwe: CWE-284
  - id: TOKDIS-CRIT-002
    signal: Vesting can be bypassed
    evidence_indicators:
    - Tokens transferable before vest
    - Vesting contract circumventable
    - Early release possible
    explanation: |
      Bypassable vesting allows large holders to dump tokens
      before intended release, harming other holders.
    remediation: |
      - Lock tokens in vesting contract
      - Prevent early withdrawal
      - Verify vesting enforcement
      - Test vesting schedule
  high:
  - id: TOKDIS-HIGH-001
    signal: Excessive team/insider allocation
    evidence_indicators:
    - Team allocation > 30%
    - Short vesting for insiders
    - Immediate unlock for founders
    explanation: |
      Excessive insider allocation concentrates power and
      creates dump risk.
    remediation: |
      - Review allocation fairness
      - Extend vesting periods
      - Add cliff periods
      - Document allocations publicly
  - id: TOKDIS-HIGH-002
    signal: Airdrop vulnerable to sybil attack
    evidence_indicators:
    - No sybil protection
    - Easy to claim multiple times
    - Address eligibility gameable
    explanation: |
      Sybil-vulnerable airdrops allow attackers to claim
      disproportionate allocation using multiple addresses.
    remediation: |
      - Implement sybil resistance
      - Use merkle tree verification
      - Add eligibility criteria
      - Consider proof of personhood
  medium:
  - id: TOKDIS-MED-001
    signal: Vesting cliff too short
    evidence_indicators:
    - Cliff under 6 months
    - Large initial unlock
    - Weak commitment incentive
    explanation: |
      Short cliffs allow early selling before alignment
      with long-term project success.
    remediation: |
      - Extend cliff period
      - Reduce initial unlock
      - Align with project milestones
      - Document vesting rationale
  - id: TOKDIS-MED-002
    signal: Distribution timeline not enforced
    evidence_indicators:
    - Manual distribution
    - Schedule not on-chain
    - Discretionary release
    explanation: |
      Off-chain distribution schedules are not enforceable and
      can be changed without transparency.
    remediation: |
      - Put schedule on-chain
      - Implement automatic release
      - Make schedule immutable
      - Provide transparency tools
  low:
  - id: TOKDIS-LOW-001
    signal: Distribution not documented
    evidence_indicators:
    - Allocation unclear
    - Vesting schedule hidden
    - No public tokenomics
    explanation: |
      Undocumented distribution creates uncertainty and
      reduces trust.
    remediation: |
      - Document all allocations
      - Publish vesting schedules
      - Provide real-time tracking
      - Update documentation regularly
  positive:
  - id: TOKDIS-POS-001
    signal: Fair and transparent distribution
    evidence_indicators:
    - Supply capped
    - Vesting enforced
    - Distribution documented
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: tokenomics-analyst
  steps:
  - id: '1'
    name: Distribution Analysis
    description: |
      Analyze token distribution mechanisms.
    duration_estimate: 30 min
    commands:
    - purpose: Find vesting implementation
      command: |
        grep -rniE "(vest|cliff|release)" \
          --include="*.sol" . 2>/dev/null | head -30
    - purpose: Find minting controls
      command: |
        grep -rniE "(mint|_mint|maxSupply)" \
          --include="*.sol" . 2>/dev/null | head -20
    expected_findings:
    - Distribution mechanisms
    - Vesting implementation
    - Supply controls
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Distribution Analysis
    - Fairness Assessment
    - Recommendations
profiles:
  membership:
    quick:
      included: false
    full:
      included: true
      priority: 2
    blockchain:
      included: true
      priority: 2
closeout_checklist:
- id: tokdis-001
  item: Supply cap enforced
  level: CRITICAL
  verification: manual
  verification_notes: Verify max supply cannot be exceeded
  expected: Confirmed by reviewer
- id: tokdis-002
  item: Vesting enforced on-chain
  level: BLOCKING
  verification: manual
  verification_notes: Verify vesting cannot be bypassed
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - blockchain
    - token
    - ico
    - dao
relationships:
  commonly_combined:
  - blockchain.token-economic.economic-model
  - blockchain.governance.voting-power
  - blockchain.smart-contract-security.access-control
