audit:
  id: blockchain-distributed-ledger.smart-contract-quality.emergency-stop
  name: Emergency Stop Audit
  version: 1.0.0
  last_updated: '2026-01-22'
  status: active
  category: blockchain-distributed-ledger
  category_number: 41
  subcategory: smart-contract-quality
  tier: expert
  estimated_duration: 1-2 hours  # median: 1h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: software
  default_profiles:
  - full
  - blockchain
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit evaluates smart contract emergency stop mechanisms
    that allow pausing operations during incidents. It examines:
    - Pause mechanism implementation
    - Function coverage by pause
    - Pause authorization
    - Unpause procedures
    - User fund protection during pause
    - Circuit breaker patterns
  why_it_matters: |
    Emergency stops are critical incident response tools:
    - Exploits can be stopped before draining funds
    - Bugs can be isolated while fixing
    - Market manipulation can be halted
    - Regulatory compliance may require pause ability
    - Recovery becomes possible with pause

    Proper emergency mechanisms balance security and censorship.
  when_to_run:
  - Smart contract development
  - Security review
  - Incident response planning
  - Regulatory compliance
prerequisites:
  required_artifacts:
  - type: source_code
    description: Smart contract source code
  - type: documentation
    description: Emergency procedures
  access_requirements:
  - Access to contract source
  - Pause authority documentation
discovery:
  code_patterns:
  - pattern: (pause|Pausable|whenNotPaused)
    type: regex
    scope: source
    purpose: Detect pause mechanism
  - pattern: (circuit.*breaker|emergency|halt)
    type: regex
    scope: source
    purpose: Detect circuit breakers
  - pattern: (unpause|resume)
    type: regex
    scope: source
    purpose: Detect unpause functions
  file_patterns:
  - glob: '**/*.sol'
    purpose: Solidity contracts
signals:
  critical:
  - id: EMERG-CRIT-001
    signal: No emergency stop mechanism
    evidence_indicators:
    - No pause functionality
    - No circuit breaker
    - Cannot halt operations
    explanation: |
      Without emergency stop, exploits cannot be halted and
      contracts cannot respond to incidents. This is especially
      critical for value-handling contracts.
    remediation: |
      - Implement OpenZeppelin Pausable
      - Add pause to sensitive functions
      - Document pause procedures
      - Test pause mechanism
    cwe: CWE-754
  - id: EMERG-CRIT-002
    signal: Pause authority too centralized
    evidence_indicators:
    - Single EOA can pause/unpause
    - No guardian mechanism
    - Pause authority = upgrade authority
    explanation: |
      Centralized pause authority can be abused for censorship
      or exploited if compromised.
    remediation: |
      - Separate pause and admin roles
      - Use guardian for emergency pause
      - Require multisig for unpause
      - Add timelock for unpause
  high:
  - id: EMERG-HIGH-001
    signal: Critical functions not pausable
    evidence_indicators:
    - Withdraw without pause check
    - Sensitive operations ignore pause
    - Partial pause coverage
    explanation: |
      If critical functions are not covered by pause, exploits
      targeting those functions cannot be stopped.
    remediation: |
      - Apply pause to all sensitive functions
      - Review function pause coverage
      - Test pause effectiveness
      - Document paused functions
  - id: EMERG-HIGH-002
    signal: Funds locked during pause
    evidence_indicators:
    - Withdrawal blocked when paused
    - No emergency withdraw
    - User funds inaccessible
    explanation: |
      If users cannot withdraw during pause, their funds are
      effectively locked. Emergency withdrawal should remain
      possible.
    remediation: |
      - Allow emergency withdrawals
      - Implement time-limited pauses
      - Provide fund recovery mechanism
      - Balance security and access
  medium:
  - id: EMERG-MED-001
    signal: No automatic circuit breakers
    evidence_indicators:
    - Manual pause only
    - No threshold-based triggers
    - No anomaly detection
    explanation: |
      Manual pause requires human response time. Automatic
      circuit breakers can respond instantly to anomalies.
    remediation: |
      - Add threshold-based triggers
      - Implement rate limiting
      - Monitor for anomalies
      - Auto-pause on suspicious activity
  - id: EMERG-MED-002
    signal: Pause status not visible
    evidence_indicators:
    - No pause status view
    - No pause events
    - Users unaware of pause
    explanation: |
      Hidden pause status confuses users and makes monitoring
      difficult.
    remediation: |
      - Expose paused() view function
      - Emit Paused/Unpaused events
      - Update UI for pause status
      - Document pause indicators
  low:
  - id: EMERG-LOW-001
    signal: Emergency procedures not documented
    evidence_indicators:
    - No incident playbook
    - Pause procedures unclear
    - Unpause criteria undefined
    explanation: |
      Undocumented emergency procedures slow incident response
      and increase error likelihood.
    remediation: |
      - Document emergency procedures
      - Define pause criteria
      - Specify unpause requirements
      - Practice incident response
  positive:
  - id: EMERG-POS-001
    signal: Comprehensive emergency mechanisms
    evidence_indicators:
    - Pausable implemented
    - Appropriate coverage
    - Procedures documented
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: security-auditor
  steps:
  - id: '1'
    name: Emergency Stop Analysis
    description: |
      Analyze emergency stop mechanisms.
    duration_estimate: 30 min
    commands:
    - purpose: Find pause mechanism
      command: |
        grep -rniE "(pause|Pausable|whenNotPaused)" \
          --include="*.sol" . 2>/dev/null | head -30
    - purpose: Find emergency functions
      command: |
        grep -rniE "(emergency|circuit|halt)" \
          --include="*.sol" . 2>/dev/null | head -20
    expected_findings:
    - Pause implementation
    - Function coverage
    - Authorization pattern
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Emergency Stop Analysis
    - Coverage Assessment
    - Recommendations
profiles:
  membership:
    quick:
      included: false
    full:
      included: true
      priority: 2
    blockchain:
      included: true
      priority: 2
closeout_checklist:
- id: emerg-001
  item: Emergency stop mechanism exists
  level: CRITICAL
  verification: |
    grep -rniE "(pause|Pausable)" \
      --include="*.sol" . 2>/dev/null | \
      wc -l | xargs -I{} test {} -gt 0 && echo "PASS" || echo "FAIL"
  expected: PASS
- id: emerg-002
  item: Pause covers sensitive functions
  level: BLOCKING
  verification: manual
  verification_notes: Verify all sensitive functions are pausable
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - blockchain
    - defi
    - financial
    - regulated
relationships:
  commonly_combined:
  - blockchain.smart-contract-security.access-control
  - blockchain.governance.admin-key-risk
  - blockchain.smart-contract-quality.error-handling

# Glossary of domain-specific terms:
glossary:
  "timelock": "Governance mechanism requiring delay between proposal and execution"
  "reentrancy": "Vulnerability where external call allows re-entering function before completion"
  "oracle": "External data feed providing off-chain information to smart contracts"
