audit:
  id: blockchain-distributed-ledger.integration.bridge-security
  name: Bridge Security Audit
  version: 1.0.0
  last_updated: '2026-01-22'
  status: active
  category: blockchain-distributed-ledger
  category_number: 41
  subcategory: integration
  tier: expert
  estimated_duration: 3-4 hours  # median: 3h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: critical
  scope: software
  default_profiles:
  - full
  - blockchain
  - security
  blocks_phase: true
  parallelizable: true
description:
  what: |
    This audit evaluates cross-chain bridge security for safe
    asset transfers between blockchains. It examines:
    - Bridge architecture and trust model
    - Message verification security
    - Validator/relayer security
    - Double-spend prevention
    - Withdrawal security
    - Emergency procedures
  why_it_matters: |
    Bridges are high-value attack targets:
    - Bridge hacks have lost billions of dollars
    - Cross-chain verification is complex
    - Validator compromise enables theft
    - Double-spend attacks drain bridges
    - Recovery is often impossible

    Bridge security is critical for cross-chain ecosystem.
  when_to_run:
  - Bridge development
  - Pre-deployment audit
  - Security assessment
  - After bridge incidents
prerequisites:
  required_artifacts:
  - type: source_code
    description: Bridge contracts on both chains
  - type: documentation
    description: Bridge architecture documentation
  access_requirements:
  - All bridge contract code
  - Validator configuration
discovery:
  code_patterns:
  - pattern: (bridge|cross.*chain|relay)
    type: regex
    scope: source
    purpose: Detect bridge components
  - pattern: (verify.*message|validate.*proof)
    type: regex
    scope: source
    purpose: Detect verification
  - pattern: (withdraw|claim|release)
    type: regex
    scope: source
    purpose: Detect withdrawal functions
  file_patterns:
  - glob: '**/*.sol'
    purpose: Solidity contracts
signals:
  critical:
  - id: BRIDGE-CRIT-001
    signal: Message verification bypassable
    evidence_indicators:
    - Signature verification flawed
    - Proof verification incomplete
    - Fake messages accepted
    explanation: |
      If message verification can be bypassed, attackers can
      forge cross-chain messages to mint unbacked tokens.
    remediation: |
      - Implement robust verification
      - Require multiple validators
      - Verify all message components
      - Test with malicious messages
    cwe: CWE-347
  - id: BRIDGE-CRIT-002
    signal: Double-spend possible
    evidence_indicators:
    - Same message processable twice
    - Nonce not enforced
    - Replay protection missing
    explanation: |
      Double-spend allows same deposit to be claimed multiple
      times, draining bridge reserves.
    remediation: |
      - Track processed messages
      - Implement nonce system
      - Prevent message replay
      - Verify message uniqueness
  high:
  - id: BRIDGE-HIGH-001
    signal: Validator set too small
    evidence_indicators:
    - Few validators control bridge
    - Single validator sufficient
    - Collusion risk high
    explanation: |
      Small validator sets can be compromised or collude to
      steal bridge funds.
    remediation: |
      - Increase validator count
      - Require higher threshold
      - Diversify validator selection
      - Monitor validator behavior
  - id: BRIDGE-HIGH-002
    signal: No rate limiting on withdrawals
    evidence_indicators:
    - Unlimited withdrawals
    - Full drain possible
    - No cooldown period
    explanation: |
      Without rate limiting, a single exploit can drain all
      bridge funds before response.
    remediation: |
      - Implement withdrawal limits
      - Add cooldown periods
      - Monitor large withdrawals
      - Design circuit breakers
  medium:
  - id: BRIDGE-MED-001
    signal: Finality not waited for
    evidence_indicators:
    - Immediate credit on source
    - Reorg can reverse deposit
    - Insufficient confirmations
    explanation: |
      Processing deposits before finality allows attackers to
      revert source chain deposit after claiming on destination.
    remediation: |
      - Wait for finality
      - Use appropriate confirmations
      - Design for reorg handling
      - Document finality requirements
  - id: BRIDGE-MED-002
    signal: No emergency pause
    evidence_indicators:
    - Cannot halt bridge
    - No circuit breaker
    - Exploit continues
    explanation: |
      Without emergency pause, attacks continue until funds
      are exhausted.
    remediation: |
      - Implement emergency pause
      - Add circuit breakers
      - Define pause authority
      - Test pause mechanism
  low:
  - id: BRIDGE-LOW-001
    signal: Bridge monitoring insufficient
    evidence_indicators:
    - No real-time monitoring
    - Anomalies not detected
    - Alerts not configured
    explanation: |
      Without monitoring, attacks may proceed undetected
      until significant damage occurs.
    remediation: |
      - Implement real-time monitoring
      - Alert on anomalies
      - Track all bridge activity
      - Enable rapid response
  positive:
  - id: BRIDGE-POS-001
    signal: Secure bridge implementation
    evidence_indicators:
    - Robust verification
    - Double-spend prevented
    - Emergency controls
procedure:
  context:
    cognitive_mode: adversarial
    ensemble_role: security-auditor
  steps:
  - id: '1'
    name: Bridge Security Analysis
    description: |
      Analyze bridge security architecture.
    duration_estimate: 90 min
    commands:
    - purpose: Find bridge contracts
      command: |
        grep -rniE "(bridge|crosschain|relay)" \
          --include="*.sol" . 2>/dev/null | head -30
    - purpose: Find verification logic
      command: |
        grep -rniE "(verify|validate|proof)" \
          --include="*.sol" . 2>/dev/null | head -30
    expected_findings:
    - Bridge architecture
    - Verification logic
    - Security controls
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Bridge Analysis
    - Security Assessment
    - Recommendations
profiles:
  membership:
    quick:
      included: false
    full:
      included: true
      priority: 1
    blockchain:
      included: true
      priority: 1
closeout_checklist:
- id: bridge-001
  item: Message verification secure
  level: CRITICAL
  verification: manual
  verification_notes: Verify message verification cannot be bypassed
  expected: Confirmed by reviewer
- id: bridge-002
  item: Double-spend prevented
  level: BLOCKING
  verification: manual
  verification_notes: Verify messages cannot be replayed
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - blockchain
    - cross-chain
    - defi
    - bridge
relationships:
  commonly_combined:
  - blockchain.smart-contract-security.signature-verification
  - blockchain.smart-contract-security.reentrancy-vulnerability
  - blockchain.integration.cross-chain

# Glossary of domain-specific terms:
glossary:
  "timelock": "Governance mechanism requiring delay between proposal and execution"
  "reentrancy": "Vulnerability where external call allows re-entering function before completion"
  "oracle": "External data feed providing off-chain information to smart contracts"
