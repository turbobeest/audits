audit:
  id: blockchain-distributed-ledger.integration.cross-chain
  name: Cross-Chain Audit
  version: 1.0.0
  last_updated: '2026-01-22'
  status: active
  category: blockchain-distributed-ledger
  category_number: 41
  subcategory: integration
  tier: expert
  estimated_duration: 2-3 hours  # median: 2h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: software
  default_profiles:
  - full
  - blockchain
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit evaluates cross-chain communication patterns
    for security and reliability. It examines:
    - Cross-chain messaging protocols
    - State synchronization
    - Error handling across chains
    - Timeout and retry logic
    - Consistency guarantees
    - Protocol selection
  why_it_matters: |
    Cross-chain operations are complex:
    - Different finality on each chain
    - Message delivery not guaranteed
    - State can become inconsistent
    - Failures hard to recover from
    - Security depends on weakest link

    Robust cross-chain design prevents stuck funds and exploits.
  when_to_run:
  - Cross-chain protocol development
  - Multi-chain deployment
  - Integration review
  - Protocol selection
prerequisites:
  required_artifacts:
  - type: source_code
    description: Cross-chain integration code
  - type: documentation
    description: Protocol documentation
  access_requirements:
  - All chain contracts
  - Protocol configuration
discovery:
  code_patterns:
  - pattern: (layerzero|wormhole|axelar|ccip)
    type: regex
    scope: source
    purpose: Detect cross-chain protocols
  - pattern: (send.*message|receive.*message)
    type: regex
    scope: source
    purpose: Detect message handling
  - pattern: (chainSelector|destChain|srcChain)
    type: regex
    scope: source
    purpose: Detect chain selection
  file_patterns:
  - glob: '**/*.sol'
    purpose: Solidity contracts
signals:
  critical:
  - id: XCHAIN-CRIT-001
    signal: Message sender not validated
    evidence_indicators:
    - Any contract can send messages
    - Source address not verified
    - Spoofed messages accepted
    explanation: |
      Without sender validation, attackers can send malicious
      messages that appear to come from trusted sources.
    remediation: |
      - Validate message sender
      - Whitelist trusted sources
      - Verify source chain
      - Authenticate messages
    cwe: CWE-346
  - id: XCHAIN-CRIT-002
    signal: No stuck fund recovery
    evidence_indicators:
    - Failed messages not recoverable
    - Funds locked on failure
    - No timeout mechanism
    explanation: |
      Messages can fail for many reasons. Without recovery,
      funds are permanently locked.
    remediation: |
      - Implement timeout refunds
      - Add recovery mechanisms
      - Handle failed messages
      - Test failure scenarios
  high:
  - id: XCHAIN-HIGH-001
    signal: Atomicity not ensured
    evidence_indicators:
    - Operations can partially complete
    - State inconsistent across chains
    - No rollback on failure
    explanation: |
      Non-atomic operations leave state inconsistent between
      chains when failures occur.
    remediation: |
      - Design for eventual consistency
      - Implement compensation logic
      - Handle partial failures
      - Document consistency model
  - id: XCHAIN-HIGH-002
    signal: Chain finality not respected
    evidence_indicators:
    - Act before source finality
    - Reorg causes inconsistency
    - Finality assumptions wrong
    explanation: |
      Acting before finality can lead to inconsistency if
      source chain reorganizes.
    remediation: |
      - Wait for appropriate finality
      - Handle reorg scenarios
      - Document finality requirements
      - Test with chain reorgs
  medium:
  - id: XCHAIN-MED-001
    signal: Gas estimation incorrect
    evidence_indicators:
    - Messages fail due to gas
    - No gas adjustment
    - Destination gas unpredictable
    explanation: |
      Incorrect gas estimation causes message failures on
      destination chain.
    remediation: |
      - Estimate gas conservatively
      - Allow gas adjustment
      - Handle gas failures
      - Monitor gas usage
  - id: XCHAIN-MED-002
    signal: Protocol dependency not evaluated
    evidence_indicators:
    - Single protocol reliance
    - Protocol risks not assessed
    - No fallback protocol
    explanation: |
      Dependence on single cross-chain protocol introduces
      centralization and failure risks.
    remediation: |
      - Evaluate protocol risks
      - Consider backup protocols
      - Monitor protocol health
      - Plan for protocol issues
  low:
  - id: XCHAIN-LOW-001
    signal: Cross-chain monitoring missing
    evidence_indicators:
    - Message status not tracked
    - No delivery confirmation
    - Failures not detected
    explanation: |
      Without monitoring, failed or stuck messages may go
      undetected.
    remediation: |
      - Track message status
      - Monitor delivery
      - Alert on failures
      - Provide status UI
  positive:
  - id: XCHAIN-POS-001
    signal: Robust cross-chain design
    evidence_indicators:
    - Sender validation
    - Recovery mechanisms
    - Proper finality handling
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: integration-engineer
  steps:
  - id: '1'
    name: Cross-Chain Analysis
    description: |
      Analyze cross-chain communication patterns.
    duration_estimate: 60 min
    commands:
    - purpose: Find cross-chain protocols
      command: |
        grep -rniE "(layerzero|wormhole|axelar|ccip)" \
          --include="*.sol" --include="*.js" --include="*.ts" . 2>/dev/null | head -30
    - purpose: Find message handling
      command: |
        grep -rniE "(receive|send).*Message" \
          --include="*.sol" . 2>/dev/null | head -20
    expected_findings:
    - Protocol usage
    - Message handling
    - Error handling
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Cross-Chain Analysis
    - Reliability Assessment
    - Recommendations
profiles:
  membership:
    quick:
      included: false
    full:
      included: true
      priority: 2
    blockchain:
      included: true
      priority: 2
closeout_checklist:
- id: xchain-001
  item: Message sender validated
  level: CRITICAL
  verification: manual
  verification_notes: Verify message sources are authenticated
  expected: Confirmed by reviewer
- id: xchain-002
  item: Recovery mechanism exists
  level: BLOCKING
  verification: manual
  verification_notes: Verify failed messages can be recovered
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - blockchain
    - multi-chain
    - defi
    - bridge
relationships:
  commonly_combined:
  - blockchain.integration.bridge-security
  - blockchain.consensus-network.finality-guarantee
  - blockchain.smart-contract-quality.error-handling
