audit:
  id: blockchain-distributed-ledger.governance.proposal-process
  name: Proposal Process Audit
  version: 1.0.0
  last_updated: '2026-01-22'
  status: active
  category: blockchain-distributed-ledger
  category_number: 41
  subcategory: governance
  tier: expert
  estimated_duration: 1-2 hours  # median: 1h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: software
  default_profiles:
  - full
  - blockchain
  - dao
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit evaluates the governance proposal process for
    security and usability. It examines:
    - Proposal creation requirements
    - Proposal state transitions
    - Cancellation and amendment
    - Description and metadata
    - Execution payload validation
    - Proposal spam prevention
  why_it_matters: |
    Proposal process affects governance quality:
    - Poor process enables attacks
    - Complex process reduces participation
    - Unclear states confuse voters
    - No validation enables malicious payloads
    - Spam degrades governance

    Well-designed proposal process enables effective governance.
  when_to_run:
  - Governance design
  - UX review
  - Process audit
  - After governance issues
prerequisites:
  required_artifacts:
  - type: source_code
    description: Proposal handling code
  - type: documentation
    description: Governance documentation
  access_requirements:
  - Governance contract code
  - Process documentation
discovery:
  code_patterns:
  - pattern: (propose|proposal|createProposal)
    type: regex
    scope: source
    purpose: Detect proposal creation
  - pattern: (state|status|Pending|Active|Succeeded)
    type: regex
    scope: source
    purpose: Detect proposal states
  - pattern: (cancel|veto|amend)
    type: regex
    scope: source
    purpose: Detect proposal modification
  file_patterns:
  - glob: '**/*.sol'
    purpose: Solidity contracts
signals:
  high:
  - id: PROP-HIGH-001
    signal: Proposal payload not validated
    evidence_indicators:
    - Arbitrary calldata accepted
    - No target validation
    - Malicious calls possible
    explanation: |
      Unvalidated payloads allow proposals to execute
      malicious or unintended operations.
    remediation: |
      - Validate proposal targets
      - Whitelist allowed functions
      - Check payload format
      - Review payloads before vote
  - id: PROP-HIGH-002
    signal: Proposal can be frontrun
    evidence_indicators:
    - No proposer protection
    - Ideas can be stolen
    - Execution order manipulable
    explanation: |
      Frontrunnable proposals allow others to steal ideas
      or execute competing proposals first.
    remediation: |
      - Add proposal commitment
      - Protect proposer credit
      - Implement fair ordering
      - Use commit-reveal
  medium:
  - id: PROP-MED-001
    signal: Proposal state machine unclear
    evidence_indicators:
    - Transitions not documented
    - States overlap
    - Invalid transitions possible
    explanation: |
      Unclear state machines confuse voters and may allow
      invalid state transitions.
    remediation: |
      - Define clear state machine
      - Document all transitions
      - Validate transitions
      - Display current state
  - id: PROP-MED-002
    signal: Proposal cancellation restricted
    evidence_indicators:
    - Cannot cancel malicious proposals
    - No emergency cancellation
    - Proposer cannot withdraw
    explanation: |
      Inability to cancel proposals means malicious or
      mistaken proposals must complete full lifecycle.
    remediation: |
      - Allow proposer cancellation
      - Add guardian cancellation
      - Enable emergency cancellation
      - Document cancellation rules
  low:
  - id: PROP-LOW-001
    signal: Proposal description not enforced
    evidence_indicators:
    - Empty descriptions allowed
    - No context required
    - Rationale missing
    explanation: |
      Proposals without descriptions make informed voting
      difficult.
    remediation: |
      - Require minimum description
      - Enforce description format
      - Link to discussion
      - Display prominently
  - id: PROP-LOW-002
    signal: Proposal history not accessible
    evidence_indicators:
    - Past proposals hard to find
    - No proposal index
    - History not preserved
    explanation: |
      Inaccessible history prevents learning from past
      proposals and reduces transparency.
    remediation: |
      - Index all proposals
      - Preserve proposal history
      - Enable search/filter
      - Show historical context
  positive:
  - id: PROP-POS-001
    signal: Well-designed proposal process
    evidence_indicators:
    - Clear state machine
    - Payload validation
    - Good documentation
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: governance-analyst
  steps:
  - id: '1'
    name: Proposal Process Analysis
    description: |
      Analyze proposal lifecycle and security.
    duration_estimate: 30 min
    commands:
    - purpose: Find proposal functions
      command: |
        grep -rniE "(propose|createProposal)" \
          --include="*.sol" . 2>/dev/null | head -30
    - purpose: Find proposal states
      command: |
        grep -rniE "(ProposalState|Pending|Active|Canceled|Executed)" \
          --include="*.sol" . 2>/dev/null | head -20
    expected_findings:
    - Proposal creation
    - State management
    - Validation patterns
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Process Analysis
    - Security Assessment
    - Recommendations
profiles:
  membership:
    quick:
      included: false
    full:
      included: true
      priority: 3
    blockchain:
      included: true
      priority: 3
closeout_checklist:
- id: prop-001
  item: Proposal payload validated
  level: BLOCKING
  verification: manual
  verification_notes: Verify payloads are validated
  expected: Confirmed by reviewer
- id: prop-002
  item: State machine clear
  level: WARNING
  verification: manual
  verification_notes: Verify proposal states documented
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - dao
    - governance
    - protocol
relationships:
  commonly_combined:
  - blockchain.governance.governance-mechanism
  - blockchain.governance.timelock
  - blockchain.smart-contract-security.access-control

# Glossary of domain-specific terms:
glossary:
  "timelock": "Governance mechanism requiring delay between proposal and execution"
  "reentrancy": "Vulnerability where external call allows re-entering function before completion"
  "oracle": "External data feed providing off-chain information to smart contracts"
