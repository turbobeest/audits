audit:
  id: blockchain-distributed-ledger.governance.timelock
  name: Timelock Audit
  version: 1.0.0
  last_updated: '2026-01-22'
  status: active
  category: blockchain-distributed-ledger
  category_number: 41
  subcategory: governance
  tier: expert
  estimated_duration: 1-2 hours  # median: 1h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: software
  default_profiles:
  - full
  - blockchain
  - dao
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit evaluates governance timelock implementation for
    security and effectiveness. It examines:
    - Timelock delay duration
    - Queue and execution flow
    - Cancellation mechanisms
    - Bypass vulnerabilities
    - Emergency operations
    - Admin controls
  why_it_matters: |
    Timelocks protect against malicious governance:
    - Delay allows community review
    - Users can exit before execution
    - Malicious proposals can be canceled
    - Emergency response possible
    - Reduces surprise attacks

    Proper timelocks are critical governance security.
  when_to_run:
  - Governance deployment
  - Security review
  - Upgrade assessment
  - After timelock issues
prerequisites:
  required_artifacts:
  - type: source_code
    description: Timelock contracts
  - type: configuration
    description: Timelock parameters
  access_requirements:
  - Timelock contract code
  - Parameter configuration
discovery:
  code_patterns:
  - pattern: (Timelock|timelock|delay)
    type: regex
    scope: source
    purpose: Detect timelock
  - pattern: (queue|execute|cancel)
    type: regex
    scope: source
    purpose: Detect timelock operations
  - pattern: (minDelay|eta|executionTime)
    type: regex
    scope: source
    purpose: Detect delay parameters
  file_patterns:
  - glob: '**/*.sol'
    purpose: Solidity contracts
signals:
  critical:
  - id: TLOCK-CRIT-001
    signal: Timelock bypassable
    evidence_indicators:
    - Direct execution path exists
    - Admin can skip timelock
    - Emergency bypass too broad
    explanation: |
      Bypassable timelocks negate their protection, allowing
      immediate execution of harmful proposals.
    remediation: |
      - Remove bypass paths
      - Require timelock for all changes
      - Limit emergency powers
      - Audit all execution paths
    cwe: CWE-284
  - id: TLOCK-CRIT-002
    signal: Timelock delay too short
    evidence_indicators:
    - Delay under 24 hours
    - Insufficient review time
    - Fast exit not possible
    explanation: |
      Short delays don't provide adequate time for review
      or user response to malicious proposals.
    remediation: |
      - Increase minimum delay
      - Use 48+ hours for critical changes
      - Consider variable delays by impact
      - Document delay rationale
  high:
  - id: TLOCK-HIGH-001
    signal: No cancellation mechanism
    evidence_indicators:
    - Queued proposals cannot be canceled
    - No guardian cancel
    - Malicious proposals must execute
    explanation: |
      Without cancellation, discovered malicious proposals
      execute after delay despite detection.
    remediation: |
      - Implement cancellation
      - Add guardian cancel power
      - Enable proposer cancel
      - Test cancellation flow
  - id: TLOCK-HIGH-002
    signal: Timelock admin too powerful
    evidence_indicators:
    - Admin can change delay
    - Admin can bypass queue
    - Single admin controls
    explanation: |
      Powerful timelock admin can undermine protections,
      negating security benefits.
    remediation: |
      - Limit admin powers
      - Require timelock for admin changes
      - Use multisig for admin
      - Document admin capabilities
  medium:
  - id: TLOCK-MED-001
    signal: No timelock monitoring
    evidence_indicators:
    - Queue not visible
    - No pending notifications
    - Users unaware of queue
    explanation: |
      Without monitoring, users may miss queued proposals
      and cannot respond before execution.
    remediation: |
      - Display pending proposals
      - Send notifications
      - Show execution countdown
      - Enable queue subscription
  - id: TLOCK-MED-002
    signal: Emergency functions not timelocked
    evidence_indicators:
    - Pause without delay
    - Emergency powers immediate
    - Critical functions bypass
    explanation: |
      While emergency functions need speed, completely
      bypassing timelock creates risk.
    remediation: |
      - Use short delay for emergency
      - Limit emergency scope
      - Require justification
      - Enable retrospective review
  low:
  - id: TLOCK-LOW-001
    signal: Timelock parameters not documented
    evidence_indicators:
    - Delay not published
    - Queue rules unclear
    - Documentation missing
    explanation: |
      Undocumented timelock parameters make governance
      unpredictable for participants.
    remediation: |
      - Document all parameters
      - Explain delay rationale
      - Publish queue contents
      - Keep documentation current
  positive:
  - id: TLOCK-POS-001
    signal: Robust timelock implementation
    evidence_indicators:
    - Adequate delay
    - Cancellation possible
    - No bypass
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: security-auditor
  steps:
  - id: '1'
    name: Timelock Analysis
    description: |
      Analyze timelock implementation and configuration.
    duration_estimate: 30 min
    commands:
    - purpose: Find timelock implementation
      command: |
        grep -rniE "(Timelock|timelock|TimelockController)" \
          --include="*.sol" . 2>/dev/null | head -30
    - purpose: Find delay configuration
      command: |
        grep -rniE "(minDelay|delay|eta)" \
          --include="*.sol" . 2>/dev/null | head -20
    expected_findings:
    - Timelock implementation
    - Delay configuration
    - Cancellation mechanism
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Timelock Analysis
    - Security Assessment
    - Recommendations
profiles:
  membership:
    quick:
      included: false
    full:
      included: true
      priority: 2
    blockchain:
      included: true
      priority: 2
closeout_checklist:
- id: tlock-001
  item: Timelock not bypassable
  level: CRITICAL
  verification: manual
  verification_notes: Verify no bypass paths exist
  expected: Confirmed by reviewer
- id: tlock-002
  item: Delay adequate
  level: BLOCKING
  verification: manual
  verification_notes: Verify delay >= 24 hours
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - dao
    - governance
    - protocol
    - upgradeable
relationships:
  commonly_combined:
  - blockchain.governance.governance-mechanism
  - blockchain.governance.admin-key-risk
  - blockchain.smart-contract-quality.upgradeability-pattern

# Glossary of domain-specific terms:
glossary:
  "timelock": "Governance mechanism requiring delay between proposal and execution"
  "reentrancy": "Vulnerability where external call allows re-entering function before completion"
  "oracle": "External data feed providing off-chain information to smart contracts"
