audit:
  id: blockchain-distributed-ledger.governance.governance-mechanism
  name: Governance Mechanism Audit
  version: 1.0.0
  last_updated: '2026-01-22'
  status: active
  category: blockchain-distributed-ledger
  category_number: 41
  subcategory: governance
  tier: expert
  estimated_duration: 2-3 hours  # median: 2h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: software
  default_profiles:
  - full
  - blockchain
  - dao
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit evaluates DAO governance mechanism design for
    security and effectiveness. It examines:
    - Proposal creation and lifecycle
    - Voting mechanism design
    - Quorum requirements
    - Execution security
    - Governance attack resistance
    - Parameter change controls
  why_it_matters: |
    Governance controls protocol destiny:
    - Flawed governance enables attacks
    - Low quorums allow minority control
    - Flash loan voting manipulates outcomes
    - Poor execution security enables exploits
    - Governance can override all other controls

    Sound governance protects protocol integrity.
  when_to_run:
  - DAO deployment
  - Governance review
  - Pre-launch audit
  - After governance incidents
prerequisites:
  required_artifacts:
  - type: source_code
    description: Governance contracts
  - type: documentation
    description: Governance documentation
  access_requirements:
  - Governance contract code
  - Parameter configuration
discovery:
  code_patterns:
  - pattern: (Governor|governance|propose|vote)
    type: regex
    scope: source
    purpose: Detect governance
  - pattern: (quorum|threshold|majority)
    type: regex
    scope: source
    purpose: Detect voting parameters
  - pattern: (execute|queue|timelock)
    type: regex
    scope: source
    purpose: Detect execution
  file_patterns:
  - glob: '**/*.sol'
    purpose: Solidity contracts
knowledge_sources:
  specifications:
  - id: oz-governor
    name: OpenZeppelin Governor
    url: https://docs.openzeppelin.com/contracts/4.x/governance
    offline_cache: true
    priority: recommended
signals:
  critical:
  - id: GOV-CRIT-001
    signal: Flash loan governance attack possible
    evidence_indicators:
    - Current balance for voting power
    - No snapshot mechanism
    - Votes counted at execution time
    explanation: |
      Without snapshots, attackers can flash loan governance
      tokens to pass malicious proposals.
    remediation: |
      - Use voting power snapshots
      - Implement ERC20Votes
      - Snapshot at proposal creation
      - Add voting delay
    cwe: CWE-362
  - id: GOV-CRIT-002
    signal: Proposal execution not secured
    evidence_indicators:
    - Execute without timelock
    - Arbitrary code execution
    - No guardian protection
    explanation: |
      Unsecured execution allows malicious proposals to
      immediately harm the protocol.
    remediation: |
      - Add timelock delay
      - Implement guardian veto
      - Validate execution targets
      - Use battle-tested governor
  high:
  - id: GOV-HIGH-001
    signal: Quorum too low
    evidence_indicators:
    - Quorum < 4% of supply
    - Few voters can pass proposals
    - Minority can control protocol
    explanation: |
      Low quorum allows small groups to pass proposals without
      broad consensus.
    remediation: |
      - Increase quorum requirement
      - Balance participation vs. security
      - Consider dynamic quorum
      - Monitor participation rates
  - id: GOV-HIGH-002
    signal: Proposal creation unrestricted
    evidence_indicators:
    - Anyone can propose
    - No proposal threshold
    - Spam attacks possible
    explanation: |
      Unrestricted proposal creation enables spam attacks that
      overwhelm governance and voters.
    remediation: |
      - Add proposal threshold
      - Require minimum stake
      - Implement proposal cost
      - Rate limit proposals
  medium:
  - id: GOV-MED-001
    signal: Voting period too short
    evidence_indicators:
    - Voting under 3 days
    - Insufficient review time
    - Surprise proposals possible
    explanation: |
      Short voting periods prevent adequate review and may
      catch voters off guard.
    remediation: |
      - Extend voting period
      - Add announcement period
      - Allow vote changes
      - Notify token holders
  - id: GOV-MED-002
    signal: No on-chain proposal discussion
    evidence_indicators:
    - Discussion off-chain only
    - Rationale not recorded
    - Context lost
    explanation: |
      Off-chain discussion leaves proposal context unavailable
      for permanent record.
    remediation: |
      - Link discussion on-chain
      - Require proposal description
      - Archive discussions
      - Enable on-chain comments
  low:
  - id: GOV-LOW-001
    signal: Governance parameters not documented
    evidence_indicators:
    - Quorum unclear
    - Voting period undocumented
    - Execution delay unknown
    explanation: |
      Undocumented parameters make governance unpredictable
      for participants.
    remediation: |
      - Document all parameters
      - Explain rationale
      - Publish in governance docs
      - Update on changes
  positive:
  - id: GOV-POS-001
    signal: Robust governance mechanism
    evidence_indicators:
    - Snapshot voting
    - Timelock execution
    - Adequate quorum
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: governance-specialist
  steps:
  - id: '1'
    name: Governance Analysis
    description: |
      Analyze governance mechanism design.
    duration_estimate: 60 min
    commands:
    - purpose: Find governance contracts
      command: |
        grep -rniE "(Governor|governance|propose)" \
          --include="*.sol" . 2>/dev/null | head -30
    - purpose: Find voting parameters
      command: |
        grep -rniE "(quorum|votingPeriod|threshold)" \
          --include="*.sol" . 2>/dev/null | head -20
    expected_findings:
    - Governance implementation
    - Voting parameters
    - Execution controls
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Governance Analysis
    - Security Assessment
    - Recommendations
profiles:
  membership:
    quick:
      included: false
    full:
      included: true
      priority: 2
    blockchain:
      included: true
      priority: 2
closeout_checklist:
- id: gov-001
  item: Snapshot voting implemented
  level: CRITICAL
  verification: manual
  verification_notes: Verify voting power uses snapshots
  expected: Confirmed by reviewer
- id: gov-002
  item: Timelock on execution
  level: BLOCKING
  verification: |
    grep -rniE "(timelock|Timelock)" \
      --include="*.sol" . 2>/dev/null | \
      wc -l | xargs -I{} test {} -gt 0 && echo "PASS" || echo "CHECK"
  expected: PASS
governance:
  applicable_to:
    archetypes:
    - dao
    - defi
    - protocol
    - governance
relationships:
  commonly_combined:
  - blockchain.governance.voting-power
  - blockchain.governance.timelock
  - blockchain.smart-contract-security.flash-loan-attack

# Glossary of domain-specific terms:
glossary:
  "timelock": "Governance mechanism requiring delay between proposal and execution"
  "reentrancy": "Vulnerability where external call allows re-entering function before completion"
  "oracle": "External data feed providing off-chain information to smart contracts"
