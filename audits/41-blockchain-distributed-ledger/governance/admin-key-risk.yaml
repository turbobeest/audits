audit:
  id: blockchain-distributed-ledger.governance.admin-key-risk
  name: Admin Key Risk Audit
  version: 1.0.0
  last_updated: '2026-01-22'
  status: active
  category: blockchain-distributed-ledger
  category_number: 41
  subcategory: governance
  tier: expert
  estimated_duration: 2-3 hours  # median: 2h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: critical
  scope: software
  default_profiles:
  - full
  - blockchain
  - security
  blocks_phase: true
  parallelizable: true
description:
  what: |
    This audit evaluates risks from administrative keys and
    privileged access patterns. It examines:
    - Admin function inventory
    - Key custody and security
    - Single point of failure risks
    - Multisig requirements
    - Renunciation possibilities
    - Emergency powers scope
  why_it_matters: |
    Admin keys are high-value targets:
    - Compromised admin enables total control
    - Single admin is single point of failure
    - Admin powers can drain funds
    - Users trust admin not to rug
    - Decentralization requires limiting admin

    Admin key security is critical for user trust.
  when_to_run:
  - Protocol launch
  - Security audit
  - Decentralization assessment
  - After admin incidents
prerequisites:
  required_artifacts:
  - type: source_code
    description: Smart contracts
  - type: documentation
    description: Admin function documentation
  access_requirements:
  - Contract source code
  - Admin key information
discovery:
  code_patterns:
  - pattern: (owner|admin|operator|guardian)
    type: regex
    scope: source
    purpose: Detect admin roles
  - pattern: (onlyOwner|onlyAdmin|restricted)
    type: regex
    scope: source
    purpose: Detect admin functions
  - pattern: (renounce|transfer.*Ownership)
    type: regex
    scope: source
    purpose: Detect renunciation
  file_patterns:
  - glob: '**/*.sol'
    purpose: Solidity contracts
signals:
  critical:
  - id: ADMIN-CRIT-001
    signal: Admin can drain user funds
    evidence_indicators:
    - Admin withdraw function
    - No withdrawal limits
    - Emergency functions unbounded
    explanation: |
      Admin ability to drain funds is a rug pull vector.
      Users have no protection if admin is compromised
      or malicious.
    remediation: |
      - Remove admin fund access
      - Implement timelock on withdrawals
      - Add withdrawal limits
      - Use multisig for any fund access
    cwe: CWE-284
  - id: ADMIN-CRIT-002
    signal: Single EOA admin
    evidence_indicators:
    - Owner is single address
    - No multisig
    - Single key controls protocol
    explanation: |
      Single admin key creates single point of failure.
      Key compromise or loss is total protocol compromise.
    remediation: |
      - Migrate to multisig
      - Implement timelock
      - Consider governance
      - Document key custody
  high:
  - id: ADMIN-HIGH-001
    signal: Admin powers not documented
    evidence_indicators:
    - Admin functions unknown
    - No capability list
    - Users unaware of risk
    explanation: |
      Undocumented admin powers hide risks from users and
      prevent proper security assessment.
    remediation: |
      - Document all admin functions
      - Publish capability list
      - Explain admin necessity
      - Disclose key custody
  - id: ADMIN-HIGH-002
    signal: Admin cannot be removed
    evidence_indicators:
    - No renounceOwnership
    - No transfer to governance
    - Admin permanent
    explanation: |
      Permanent admin prevents decentralization and creates
      ongoing centralization risk.
    remediation: |
      - Implement renunciation
      - Plan transition to governance
      - Allow ownership transfer
      - Document decentralization path
  medium:
  - id: ADMIN-MED-001
    signal: Admin key custody unclear
    evidence_indicators:
    - Key storage unknown
    - No custody documentation
    - Single person access possible
    explanation: |
      Unclear custody creates security uncertainty and
      potential for single-person control.
    remediation: |
      - Document key custody
      - Use hardware wallets
      - Implement access controls
      - Regular custody audits
  - id: ADMIN-MED-002
    signal: No admin action monitoring
    evidence_indicators:
    - Admin actions not logged
    - No alerts on admin calls
    - Activity not visible
    explanation: |
      Unmonitored admin activity may include unauthorized
      actions that go undetected.
    remediation: |
      - Monitor admin transactions
      - Alert on admin actions
      - Log all admin calls
      - Review activity regularly
  low:
  - id: ADMIN-LOW-001
    signal: Admin functions not minimized
    evidence_indicators:
    - Excessive admin powers
    - Admin for convenience
    - Not security necessary
    explanation: |
      Excessive admin powers increase attack surface and
      risk beyond necessity.
    remediation: |
      - Minimize admin functions
      - Remove unnecessary powers
      - Design for minimal admin
      - Document necessity
  positive:
  - id: ADMIN-POS-001
    signal: Admin risk well managed
    evidence_indicators:
    - Multisig admin
    - Documented powers
    - Decentralization path
procedure:
  context:
    cognitive_mode: adversarial
    ensemble_role: security-auditor
  steps:
  - id: '1'
    name: Admin Key Analysis
    description: |
      Analyze admin key risks and controls.
    duration_estimate: 60 min
    commands:
    - purpose: Find admin patterns
      command: |
        grep -rniE "(owner|admin|onlyOwner|onlyAdmin)" \
          --include="*.sol" . 2>/dev/null | head -30
    - purpose: Find privileged functions
      command: |
        grep -rniE "function.*(owner|admin|restricted)" \
          --include="*.sol" . 2>/dev/null | head -20
    expected_findings:
    - Admin roles
    - Privileged functions
    - Custody patterns
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Admin Key Analysis
    - Risk Assessment
    - Recommendations
profiles:
  membership:
    quick:
      included: false
    full:
      included: true
      priority: 1
    blockchain:
      included: true
      priority: 1
closeout_checklist:
- id: admin-001
  item: Admin cannot drain funds
  level: CRITICAL
  verification: manual
  verification_notes: Verify no unilateral fund access
  expected: Confirmed by reviewer
- id: admin-002
  item: Multisig or governance admin
  level: BLOCKING
  verification: manual
  verification_notes: Verify admin is not single EOA
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - blockchain
    - defi
    - protocol
    - custody
relationships:
  commonly_combined:
  - blockchain.key-management.multi-signature
  - blockchain.governance.timelock
  - blockchain.smart-contract-security.access-control

# Glossary of domain-specific terms:
glossary:
  "timelock": "Governance mechanism requiring delay between proposal and execution"
  "reentrancy": "Vulnerability where external call allows re-entering function before completion"
  "oracle": "External data feed providing off-chain information to smart contracts"
