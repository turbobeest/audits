# ============================================================
# AUDIT: Qubit Requirement
# Category: 42 - Quantum Computing
# Subcategory: resource-estimation
# ============================================================

audit:
  id: "quantum-computing.resource-estimation.qubit-requirement"
  name: "Quantum Qubit Requirement Audit"
  version: "1.0.0"
  last_updated: "2025-01-22"
  status: "active"

  category: "quantum-computing"
  category_number: 42
  subcategory: "resource-estimation"

  tier: "expert"
  estimated_duration: "2-4 hours"  # median: 3h

  completeness: "requires_discovery"
  requires_runtime: false
  destructive: false

execution:
  automatable: "yes"
  severity: "high"
  scope: "quantum-systems"

  default_profiles:
    - "full"
    - "quick"

  blocks_phase: true
  parallelizable: true

description:
  what: |
    Estimates and validates qubit requirements for quantum algorithms including
    data qubits, ancilla qubits, and qubits needed for error correction.
    Assesses scaling with problem size and compatibility with available hardware.

  why_it_matters: |
    Qubit count determines whether an algorithm can run on available hardware.
    Underestimating requirements leads to failed execution. Overestimating
    wastes resources. Accurate qubit estimation is essential for planning
    and hardware selection.

  when_to_run:
    - "During algorithm design"
    - "Before hardware allocation"
    - "When scaling to larger problems"
    - "During resource planning"

prerequisites:
  required_artifacts:
    - type: "algorithm_specification"
      description: "Algorithm requirements"
    - type: "problem_parameters"
      description: "Problem size and parameters"
    - type: "hardware_inventory"
      description: "Available quantum hardware"

  access_requirements:
    - "Algorithm specification"
    - "Hardware specifications"

discovery:
  file_patterns:
    - glob: "**/circuits/**/*.py"
      purpose: "Find circuit definitions"
    - glob: "**/resources/**/*.py"
      purpose: "Find resource estimation code"

  metrics_queries:
    - system: "qiskit"
      query: "circuit.num_qubits"
      purpose: "Count qubits needed"

knowledge_sources:
  guides:
    - id: "resource-estimation"
      name: "Quantum Resource Estimation"
      url: "https://azure.microsoft.com/en-us/products/quantum/resource-estimation"
      offline_cache: true

tooling:
  analysis_tools:
    - tool: "azure-quantum-re"
      purpose: "Resource estimation"

    - tool: "qiskit"
      purpose: "Circuit qubit counting"

signals:
  critical:
    - id: "QR-CRIT-001"
      signal: "Qubit requirement exceeds all available hardware"
      evidence_threshold: "required_qubits > max_available_qubits"
      explanation: |
        Algorithm cannot run on any available hardware. Must reduce
        qubit requirements or wait for larger quantum processors.
      remediation: |
        Apply qubit reduction techniques.
        Consider circuit cutting.
        Wait for larger hardware.

    - id: "QR-CRIT-002"
      signal: "Qubit requirement not estimated"
      evidence_indicators:
        - "No qubit count documented"
        - "Scaling unknown"
      remediation: "Perform systematic qubit requirement analysis"

  high:
    - id: "QR-HIGH-001"
      signal: "Qubit requirement approaches hardware limit"
      evidence_threshold: "required_qubits > 0.8 * available_qubits"
      remediation: "Consider qubit optimization or alternative hardware"

    - id: "QR-HIGH-002"
      signal: "Error correction overhead not included"
      evidence_indicators:
        - "Physical qubit count only"
        - "No QEC overhead considered"
      remediation: "Calculate full physical qubit requirement with QEC"

  medium:
    - id: "QR-MED-001"
      signal: "Scaling not characterized"
      remediation: "Analyze qubit scaling with problem size"

    - id: "QR-MED-002"
      signal: "No hardware comparison performed"
      remediation: "Compare requirements across available hardware"

  low:
    - id: "QR-LOW-001"
      signal: "Qubit requirements not documented"
      remediation: "Document qubit requirements"

  positive:
    - id: "QR-POS-001"
      signal: "Qubit requirements well within hardware limits"
    - id: "QR-POS-002"
      signal: "Scaling clearly characterized"
    - id: "QR-POS-003"
      signal: "QEC overhead included"

procedure:
  context:
    cognitive_mode: "evaluative"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Count Data Qubits"
      description: "Determine qubits needed for problem encoding"
      duration_estimate: "30 min"

    - id: "2"
      name: "Count Ancilla Qubits"
      description: "Determine auxiliary qubits needed"
      duration_estimate: "30 min"

    - id: "3"
      name: "Estimate QEC Overhead"
      description: "Calculate physical qubits for error correction"
      duration_estimate: "45 min"

    - id: "4"
      name: "Analyze Scaling"
      description: "Determine how requirements scale"
      duration_estimate: "45 min"

    - id: "5"
      name: "Compare to Hardware"
      description: "Match requirements to available hardware"
      duration_estimate: "30 min"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "qubit_estimate"
      format: "json"
      description: "Detailed qubit requirements"

closeout_checklist:
  - id: "qr-001"
    item: "Qubit requirement within hardware"
    level: "CRITICAL"
    verification: "automated"

  - id: "qr-002"
    item: "Scaling characterized"
    level: "BLOCKING"
    verification: "manual"

  - id: "qr-003"
    item: "QEC overhead included"
    level: "WARNING"
    verification: "manual"

governance:
  applicable_to:
    archetypes: ["quantum-systems"]

relationships:
  commonly_combined:
    - "quantum-computing.resource-estimation.gate-count"
    - "quantum-computing.resource-estimation.hardware-compatibility"
  feeds_into:
    - "quantum-computing.resource-estimation.execution-time-estimate"
