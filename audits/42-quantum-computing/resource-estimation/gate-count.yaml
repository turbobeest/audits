# ============================================================
# AUDIT: Gate Count
# Category: 42 - Quantum Computing
# Subcategory: resource-estimation
# ============================================================

audit:
  id: "quantum-computing.resource-estimation.gate-count"
  name: "Quantum Gate Count Audit"
  version: "1.0.0"
  last_updated: "2025-01-22"
  status: "active"

  category: "quantum-computing"
  category_number: 42
  subcategory: "resource-estimation"

  tier: "expert"
  estimated_duration: "2-3 hours"  # median: 2h

  completeness: "requires_discovery"
  requires_runtime: false
  destructive: false

execution:
  automatable: "yes"
  severity: "high"
  scope: "quantum-systems"

  default_profiles:
    - "full"
    - "quick"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Analyzes the gate count of quantum circuits including single-qubit gates,
    two-qubit gates, and gate breakdown by type. Assesses how gate count
    contributes to error accumulation and execution time.

  why_it_matters: |
    Each gate contributes to error accumulation. High gate counts reduce
    fidelity and may exceed coherence limits. Gate count directly impacts
    execution time and cost on quantum hardware. Optimizing gate count is
    essential for practical quantum algorithms.

  when_to_run:
    - "During circuit optimization"
    - "When estimating error rates"
    - "Before hardware execution"
    - "When comparing implementations"

prerequisites:
  required_artifacts:
    - type: "quantum_circuits"
      description: "Circuits to analyze"
    - type: "gate_error_rates"
      description: "Error rates per gate type"

  access_requirements:
    - "Access to circuit code"
    - "Hardware gate specifications"

discovery:
  file_patterns:
    - glob: "**/circuits/**/*.py"
      purpose: "Find circuit definitions"
    - glob: "**/*.qasm"
      purpose: "Find QASM files"

  metrics_queries:
    - system: "qiskit"
      query: "circuit.count_ops()"
      purpose: "Count gates by type"

knowledge_sources:
  guides:
    - id: "gate-optimization"
      name: "Quantum Gate Optimization"
      url: "https://qiskit.org/documentation/apidoc/transpiler.html"
      offline_cache: true

tooling:
  analysis_tools:
    - tool: "qiskit"
      purpose: "Gate counting"

    - tool: "pytket"
      purpose: "Gate optimization"

signals:
  critical:
    - id: "GC-CRIT-001"
      signal: "Gate count causes error rate > 50%"
      evidence_threshold: "1 - (1-gate_error)^gate_count > 0.5"
      explanation: |
        When cumulative gate errors exceed 50%, results are dominated
        by noise. The computation cannot produce useful output.
      remediation: |
        Reduce gate count through optimization.
        Use error mitigation.
        Target lower-error hardware.

    - id: "GC-CRIT-002"
      signal: "Two-qubit gate count excessive"
      evidence_indicators:
        - "Two-qubit gates > 10x single-qubit gates"
        - "Two-qubit count growing exponentially"
      explanation: |
        Two-qubit gates have much higher error rates than single-qubit.
        Excessive two-qubit gates dominate the error budget.
      remediation: "Optimize circuit to reduce two-qubit gate count"

  high:
    - id: "GC-HIGH-001"
      signal: "Gate count not optimized"
      evidence_indicators:
        - "No optimization passes applied"
        - "Redundant gates present"
      remediation: "Apply circuit optimization"

    - id: "GC-HIGH-002"
      signal: "Non-native gates not decomposed"
      remediation: "Decompose to native gate set"

  medium:
    - id: "GC-MED-001"
      signal: "Gate count scaling not characterized"
      remediation: "Analyze gate count scaling"

    - id: "GC-MED-002"
      signal: "Gate breakdown not documented"
      remediation: "Document gate counts by type"

  low:
    - id: "GC-LOW-001"
      signal: "Minor optimization opportunities"
      remediation: "Apply advanced optimization"

  positive:
    - id: "GC-POS-001"
      signal: "Gate count minimized"
    - id: "GC-POS-002"
      signal: "Two-qubit gates optimized"
    - id: "GC-POS-003"
      signal: "Gate count well characterized"

procedure:
  context:
    cognitive_mode: "evaluative"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Count Total Gates"
      description: "Measure total gate count"
      duration_estimate: "20 min"
      commands:
        - purpose: "Count gates"
          command: "python -c 'from qiskit import QuantumCircuit; qc = QuantumCircuit.from_qasm_file(\"circuit.qasm\"); print(qc.count_ops())'"

    - id: "2"
      name: "Break Down by Type"
      description: "Analyze gates by category"
      duration_estimate: "30 min"

    - id: "3"
      name: "Estimate Error Contribution"
      description: "Calculate cumulative error from gates"
      duration_estimate: "45 min"

    - id: "4"
      name: "Identify Optimization Opportunities"
      description: "Find gates that can be eliminated"
      duration_estimate: "45 min"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "gate_analysis"
      format: "json"
      description: "Detailed gate count breakdown"

closeout_checklist:
  - id: "gc-001"
    item: "Cumulative error acceptable"
    level: "CRITICAL"
    verification: "automated"

  - id: "gc-002"
    item: "Optimization applied"
    level: "BLOCKING"
    verification: "automated"

  - id: "gc-003"
    item: "Gate breakdown documented"
    level: "WARNING"
    verification: "manual"

governance:
  applicable_to:
    archetypes: ["quantum-systems"]

relationships:
  commonly_combined:
    - "quantum-computing.resource-estimation.circuit-width-depth"
    - "quantum-computing.error-handling.error-budget"
  feeds_into:
    - "quantum-computing.resource-estimation.execution-time-estimate"
