# ============================================================
# AUDIT: Circuit Width/Depth
# Category: 42 - Quantum Computing
# Subcategory: resource-estimation
# ============================================================

audit:
  id: "quantum-computing.resource-estimation.circuit-width-depth"
  name: "Quantum Circuit Width/Depth Audit"
  version: "1.0.0"
  last_updated: "2025-01-22"
  status: "active"

  category: "quantum-computing"
  category_number: 42
  subcategory: "resource-estimation"

  tier: "expert"
  estimated_duration: "2-3 hours"  # median: 2h

  completeness: "requires_discovery"
  requires_runtime: false
  destructive: false

execution:
  automatable: "yes"
  severity: "high"
  scope: "quantum-systems"

  default_profiles:
    - "full"
    - "quick"

  blocks_phase: true
  parallelizable: true

description:
  what: |
    Analyzes the width (qubit count) and depth (critical path length) of
    quantum circuits. Evaluates the space-time tradeoffs and assesses
    whether circuits fit within hardware constraints for both dimensions.

  why_it_matters: |
    Width determines hardware requirements while depth determines coherence
    requirements. Both dimensions must fit within hardware constraints.
    Understanding width-depth tradeoffs enables algorithm optimization
    for specific hardware platforms.

  when_to_run:
    - "During circuit design"
    - "When targeting specific hardware"
    - "During optimization"
    - "Before hardware execution"

prerequisites:
  required_artifacts:
    - type: "quantum_circuits"
      description: "Circuits to analyze"
    - type: "hardware_specs"
      description: "Target hardware constraints"

  access_requirements:
    - "Access to circuit code"
    - "Hardware specifications"

discovery:
  file_patterns:
    - glob: "**/circuits/**/*.py"
      purpose: "Find circuit definitions"

  metrics_queries:
    - system: "qiskit"
      query: "circuit.num_qubits, circuit.depth()"
      purpose: "Measure width and depth"

knowledge_sources:
  guides:
    - id: "circuit-optimization"
      name: "Circuit Optimization Techniques"
      url: "https://qiskit.org/documentation/tutorials/circuits/3_circuit_optimization.html"
      offline_cache: true

tooling:
  analysis_tools:
    - tool: "qiskit"
      purpose: "Width/depth analysis"

signals:
  critical:
    - id: "CWD-CRIT-001"
      signal: "Width exceeds hardware capacity"
      evidence_threshold: "circuit.num_qubits > hardware.num_qubits"
      explanation: |
        Circuit cannot execute on target hardware. Must reduce width
        through qubit optimization or circuit cutting.
      remediation: "Reduce circuit width or target larger hardware"

    - id: "CWD-CRIT-002"
      signal: "Depth exceeds coherence limits"
      evidence_threshold: "circuit.depth * gate_time > 0.1 * T1"
      explanation: |
        Circuit depth exceeds hardware coherence time. Results will
        be dominated by decoherence errors.
      remediation: "Reduce depth through optimization or use faster gates"

  high:
    - id: "CWD-HIGH-001"
      signal: "Suboptimal width-depth tradeoff"
      evidence_indicators:
        - "Could trade width for depth"
        - "Ancilla qubits wasting coherence"
      remediation: "Evaluate width-depth tradeoffs for target hardware"

    - id: "CWD-HIGH-002"
      signal: "No parallelization of independent operations"
      remediation: "Apply circuit scheduling optimization"

  medium:
    - id: "CWD-MED-001"
      signal: "Width-depth not characterized for scaling"
      remediation: "Analyze scaling behavior"

    - id: "CWD-MED-002"
      signal: "Circuit not optimized for target hardware"
      remediation: "Apply hardware-aware optimization"

  low:
    - id: "CWD-LOW-001"
      signal: "Width-depth metrics not documented"
      remediation: "Document circuit dimensions"

  positive:
    - id: "CWD-POS-001"
      signal: "Width and depth within hardware limits"
    - id: "CWD-POS-002"
      signal: "Optimal parallelization achieved"
    - id: "CWD-POS-003"
      signal: "Width-depth tradeoff documented"

procedure:
  context:
    cognitive_mode: "evaluative"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Measure Circuit Dimensions"
      description: "Calculate width and depth"
      duration_estimate: "30 min"

    - id: "2"
      name: "Compare to Hardware Limits"
      description: "Check against target hardware"
      duration_estimate: "30 min"

    - id: "3"
      name: "Analyze Tradeoffs"
      description: "Evaluate width-depth tradeoff options"
      duration_estimate: "45 min"

    - id: "4"
      name: "Check Optimization"
      description: "Verify optimization has been applied"
      duration_estimate: "30 min"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "dimension_analysis"
      format: "json"
      description: "Width/depth metrics"

closeout_checklist:
  - id: "cwd-001"
    item: "Width within hardware capacity"
    level: "CRITICAL"
    verification: "automated"

  - id: "cwd-002"
    item: "Depth within coherence limits"
    level: "CRITICAL"
    verification: "automated"

  - id: "cwd-003"
    item: "Optimization applied"
    level: "WARNING"
    verification: "manual"

governance:
  applicable_to:
    archetypes: ["quantum-systems"]

relationships:
  commonly_combined:
    - "quantum-computing.resource-estimation.qubit-requirement"
    - "quantum-computing.quantum-algorithm.circuit-depth"
  feeds_into:
    - "quantum-computing.resource-estimation.execution-time-estimate"
