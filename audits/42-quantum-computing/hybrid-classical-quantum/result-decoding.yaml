# ============================================================
# AUDIT: Result Decoding
# Category: 42 - Quantum Computing
# Subcategory: hybrid-classical-quantum
# ============================================================

audit:
  id: "quantum-computing.hybrid-classical-quantum.result-decoding"
  name: "Quantum Result Decoding Audit"
  version: "1.0.0"
  last_updated: "2025-01-22"
  status: "active"

  category: "quantum-computing"
  category_number: 42
  subcategory: "hybrid-classical-quantum"

  tier: "expert"
  estimated_duration: "2-4 hours"  # median: 3h

  completeness: "requires_discovery"
  requires_runtime: true
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "quantum-systems"

  default_profiles:
    - "full"
    - "quick"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Evaluates how quantum measurement results are decoded and interpreted
    for classical post-processing. Assesses statistical aggregation, error
    handling for unexpected results, confidence estimation, and conversion
    to application-meaningful outputs.

  why_it_matters: |
    Quantum computation produces probabilistic outputs that must be correctly
    interpreted. Incorrect decoding transforms correct quantum results into
    wrong classical answers. Proper statistical treatment and error handling
    are essential for reliable results.

  when_to_run:
    - "When developing hybrid algorithms"
    - "When results seem incorrect"
    - "When changing measurement strategy"
    - "During integration testing"

prerequisites:
  required_artifacts:
    - type: "decoding_code"
      description: "Result decoding implementation"
    - type: "expected_format"
      description: "Expected result format"

  access_requirements:
    - "Access to decoding code"
    - "Sample quantum results"

discovery:
  file_patterns:
    - glob: "**/results/**/*.py"
      purpose: "Find result processing code"
    - glob: "**/decoding/**/*.py"
      purpose: "Find decoding implementations"

  code_patterns:
    - pattern: "get_counts|counts|result"
      type: "keyword"
      scope: "source"
      purpose: "Find result handling"
    - pattern: "expectation|probabilities"
      type: "keyword"
      scope: "source"
      purpose: "Find statistical processing"

knowledge_sources:
  guides:
    - id: "qiskit-results"
      name: "Qiskit Result Handling"
      url: "https://qiskit.org/documentation/tutorials/circuits/01_circuit_basics.html"
      offline_cache: true

tooling:
  analysis_tools:
    - tool: "statistical-tools"
      purpose: "Result statistical analysis"

signals:
  critical:
    - id: "RD-CRIT-001"
      signal: "Incorrect probability estimation"
      evidence_indicators:
        - "Probabilities don't sum to 1"
        - "Statistical estimator biased"
        - "Confidence intervals wrong"
      explanation: |
        Incorrect probability estimation invalidates all downstream
        analysis. Statistical rigor is essential for meaningful results.
      remediation: |
        Use proper statistical estimators.
        Verify normalization.
        Calculate correct confidence intervals.

    - id: "RD-CRIT-002"
      signal: "Unexpected results not handled"
      evidence_indicators:
        - "Unrecognized bit strings cause crash"
        - "Noise-induced results discarded silently"
        - "No validation of result format"
      explanation: |
        Noisy quantum hardware produces unexpected results. Without
        proper handling, these cause failures or silent data loss.
      remediation: "Implement robust result validation and handling"

  high:
    - id: "RD-HIGH-001"
      signal: "No confidence estimation"
      evidence_indicators:
        - "Point estimates without uncertainty"
        - "No shot noise consideration"
      remediation: "Add confidence intervals to results"

    - id: "RD-HIGH-002"
      signal: "Biased sampling interpretation"
      evidence_indicators:
        - "Measurement error not corrected"
        - "Readout bias not considered"
      remediation: "Apply measurement error mitigation"

  medium:
    - id: "RD-MED-001"
      signal: "Inefficient result aggregation"
      remediation: "Optimize statistical aggregation"

    - id: "RD-MED-002"
      signal: "No result caching"
      remediation: "Cache expensive computations"

  low:
    - id: "RD-LOW-001"
      signal: "Decoding not documented"
      remediation: "Document result interpretation"

  positive:
    - id: "RD-POS-001"
      signal: "Robust statistical handling"
    - id: "RD-POS-002"
      signal: "Proper confidence estimation"
    - id: "RD-POS-003"
      signal: "Measurement error mitigation applied"

procedure:
  context:
    cognitive_mode: "critical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Review Decoding Logic"
      description: "Examine how results are interpreted"
      duration_estimate: "45 min"

    - id: "2"
      name: "Verify Statistical Correctness"
      description: "Check statistical estimators"
      duration_estimate: "1 hour"

    - id: "3"
      name: "Test Error Handling"
      description: "Verify handling of unexpected results"
      duration_estimate: "45 min"

    - id: "4"
      name: "Check Confidence Estimation"
      description: "Verify uncertainty quantification"
      duration_estimate: "30 min"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "decoding_analysis"
      format: "json"
      description: "Result decoding assessment"

closeout_checklist:
  - id: "rd-001"
    item: "Statistical correctness verified"
    level: "CRITICAL"
    verification: "manual"

  - id: "rd-002"
    item: "Error handling tested"
    level: "BLOCKING"
    verification: "automated"

  - id: "rd-003"
    item: "Confidence estimation present"
    level: "WARNING"
    verification: "manual"

governance:
  applicable_to:
    archetypes: ["quantum-systems", "hybrid-systems"]

relationships:
  commonly_combined:
    - "quantum-computing.hybrid-classical-quantum.data-encoding"
    - "quantum-computing.quantum-algorithm.measurement-strategy"
  feeds_into:
    - "quantum-computing.hybrid-classical-quantum.optimization-convergence"
