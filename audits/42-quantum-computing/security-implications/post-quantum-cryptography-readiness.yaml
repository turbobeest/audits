# ============================================================
# AUDIT: Post-Quantum Cryptography Readiness
# Category: 42 - Quantum Computing
# Subcategory: security-implications
# ============================================================

audit:
  id: "quantum-computing.security-implications.post-quantum-cryptography-readiness"
  name: "Post-Quantum Cryptography Readiness Audit"
  version: "1.0.0"
  last_updated: "2025-01-22"
  status: "active"

  category: "quantum-computing"
  category_number: 42
  subcategory: "security-implications"

  tier: "expert"
  estimated_duration: "4-6 hours"  # median: 5h

  completeness: "requires_discovery"
  requires_runtime: false
  destructive: false

execution:
  automatable: "partial"
  severity: "critical"
  scope: "security"

  default_profiles:
    - "full"
    - "security"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Evaluates organizational readiness for the post-quantum cryptographic
    transition. Assesses cryptographic inventory, vulnerability assessment,
    migration planning, and implementation of quantum-resistant algorithms
    per NIST standards.

  why_it_matters: |
    Quantum computers will break RSA, ECC, and other widely-used cryptography.
    Organizations must transition to quantum-resistant algorithms before
    cryptographically relevant quantum computers exist. Data encrypted today
    can be harvested and decrypted later ("harvest now, decrypt later").

  when_to_run:
    - "During security planning"
    - "When updating cryptographic standards"
    - "During compliance reviews"
    - "Annually for security assessment"

prerequisites:
  required_artifacts:
    - type: "cryptographic_inventory"
      description: "List of cryptographic implementations"
    - type: "security_policies"
      description: "Current cryptographic policies"
    - type: "data_classification"
      description: "Data sensitivity classifications"

  access_requirements:
    - "Access to cryptographic implementations"
    - "Security policy documentation"
    - "Architecture documentation"

discovery:
  file_patterns:
    - glob: "**/crypto/**/*.py"
      purpose: "Find cryptographic code"
    - glob: "**/security/**/*.py"
      purpose: "Find security implementations"
    - glob: "**/config/**/*tls*"
      purpose: "Find TLS configurations"

  code_patterns:
    - pattern: "RSA|ECC|ECDSA|DH|ECDH"
      type: "keyword"
      scope: "source"
      purpose: "Find vulnerable algorithms"
    - pattern: "Kyber|Dilithium|SPHINCS"
      type: "keyword"
      scope: "source"
      purpose: "Find PQC implementations"

knowledge_sources:
  specifications:
    - id: "nist-pqc"
      name: "NIST Post-Quantum Cryptography Standards"
      url: "https://csrc.nist.gov/projects/post-quantum-cryptography"
      offline_cache: true
      priority: "required"

    - id: "fips-203"
      name: "FIPS 203 (ML-KEM)"
      url: "https://csrc.nist.gov/pubs/fips/203/final"
      offline_cache: true
      priority: "required"

  guides:
    - id: "cisa-pqc"
      name: "CISA Post-Quantum Cryptography Guidance"
      url: "https://www.cisa.gov/quantum"
      offline_cache: true

tooling:
  analysis_tools:
    - tool: "cryptographic-inventory"
      purpose: "Catalog cryptographic usage"

    - tool: "pqc-scanner"
      purpose: "Identify vulnerable algorithms"

signals:
  critical:
    - id: "PQC-CRIT-001"
      signal: "No PQC migration plan exists"
      evidence_indicators:
        - "No timeline for PQC transition"
        - "No cryptographic inventory"
        - "No awareness of quantum threat"
      explanation: |
        Without a migration plan, organizations will be unprepared when
        quantum computers break current cryptography. Long-lived secrets
        are already at risk from harvest-now-decrypt-later attacks.
      remediation: |
        Develop comprehensive PQC migration strategy.
        Create cryptographic inventory.
        Prioritize based on data sensitivity and lifetime.

    - id: "PQC-CRIT-002"
      signal: "Sensitive long-lived data protected only by quantum-vulnerable crypto"
      evidence_indicators:
        - "Classified or PII with 10+ year lifetime"
        - "Only RSA/ECC encryption"
        - "No hybrid encryption"
      explanation: |
        Data with long confidentiality requirements is vulnerable to
        harvest-now-decrypt-later attacks. Must transition immediately.
      remediation: "Implement hybrid classical-PQC encryption for sensitive data"

  high:
    - id: "PQC-HIGH-001"
      signal: "No cryptographic inventory"
      remediation: "Create comprehensive cryptographic inventory"

    - id: "PQC-HIGH-002"
      signal: "Using deprecated cryptographic algorithms"
      evidence_indicators:
        - "SHA-1, MD5, DES still in use"
        - "Small key sizes"
      remediation: "Upgrade to modern algorithms as PQC stepping stone"

    - id: "PQC-HIGH-003"
      signal: "Hard-coded cryptographic choices"
      evidence_indicators:
        - "Algorithms hard-coded in applications"
        - "No cryptographic agility"
      remediation: "Implement cryptographic agility"

  medium:
    - id: "PQC-MED-001"
      signal: "PQC libraries not evaluated"
      remediation: "Evaluate NIST-approved PQC implementations"

    - id: "PQC-MED-002"
      signal: "Staff not trained on PQC"
      remediation: "Provide PQC training to security team"

  low:
    - id: "PQC-LOW-001"
      signal: "PQC monitoring not established"
      remediation: "Monitor NIST PQC standardization progress"

  positive:
    - id: "PQC-POS-001"
      signal: "PQC migration plan in place"
    - id: "PQC-POS-002"
      signal: "Hybrid encryption implemented"
    - id: "PQC-POS-003"
      signal: "Cryptographic agility achieved"

procedure:
  context:
    cognitive_mode: "critical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Create Cryptographic Inventory"
      description: "Catalog all cryptographic usage"
      duration_estimate: "1.5 hours"

    - id: "2"
      name: "Assess Vulnerability"
      description: "Identify quantum-vulnerable algorithms"
      duration_estimate: "1 hour"

    - id: "3"
      name: "Prioritize by Risk"
      description: "Rank based on data sensitivity and lifetime"
      duration_estimate: "45 min"

    - id: "4"
      name: "Evaluate Migration Options"
      description: "Assess PQC algorithm options"
      duration_estimate: "1 hour"

    - id: "5"
      name: "Review Migration Plan"
      description: "Check existing plan or recommend creation"
      duration_estimate: "45 min"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "crypto_inventory"
      format: "json"
      description: "Cryptographic usage inventory"

    - type: "migration_recommendations"
      format: "prose"
      description: "PQC migration recommendations"

closeout_checklist:
  - id: "pqc-001"
    item: "Cryptographic inventory complete"
    level: "CRITICAL"
    verification: "manual"

  - id: "pqc-002"
    item: "Migration plan exists"
    level: "CRITICAL"
    verification: "manual"

  - id: "pqc-003"
    item: "High-priority items addressed"
    level: "BLOCKING"
    verification: "manual"

governance:
  applicable_to:
    archetypes: ["all"]

  compliance_frameworks:
    - framework: "NIST SP 800-208"
      controls: ["PQC-1", "PQC-2"]
    - framework: "NSA CNSA 2.0"
      controls: ["Algorithm Requirements"]

relationships:
  commonly_combined:
    - "quantum-computing.security-implications.quantum-safe-algorithm"
    - "quantum-computing.security-implications.cryptographic-agility"
  feeds_into:
    - "security-trust.cryptography.algorithm-selection"
