# ============================================================
# AUDIT: Qubit Count Efficiency
# Category: 42 - Quantum Computing
# Subcategory: quantum-algorithm
# ============================================================

audit:
  id: "quantum-computing.quantum-algorithm.qubit-count-efficiency"
  name: "Qubit Count Efficiency Audit"
  version: "1.0.0"
  last_updated: "2025-01-22"
  status: "active"

  category: "quantum-computing"
  category_number: 42
  subcategory: "quantum-algorithm"

  tier: "expert"
  estimated_duration: "2-4 hours"  # median: 3h

  completeness: "requires_discovery"
  requires_runtime: true
  destructive: false

execution:
  automatable: "yes"
  severity: "high"
  scope: "quantum-systems"

  default_profiles:
    - "full"
    - "quick"

  blocks_phase: true
  parallelizable: true

description:
  what: |
    Evaluates the efficiency of qubit utilization in quantum algorithms.
    Analyzes whether the number of qubits used is optimal for the problem,
    identifies unnecessary ancilla qubits, and assesses qubit recycling
    opportunities. Compares actual usage against theoretical minimum.

  why_it_matters: |
    Qubits are the scarcest resource in quantum computing. Inefficient qubit
    usage limits the problem sizes that can be addressed and may prevent
    algorithm execution on available hardware. Every unnecessary qubit
    compounds error rates and reduces fidelity.

  when_to_run:
    - "During algorithm design"
    - "Before hardware deployment"
    - "When optimizing for specific devices"
    - "When scaling to larger problems"

prerequisites:
  required_artifacts:
    - type: "quantum_circuits"
      description: "Circuit definitions to analyze"
    - type: "problem_specification"
      description: "Problem size and parameters"
    - type: "hardware_constraints"
      description: "Available qubit counts on target hardware"

  access_requirements:
    - "Access to circuit code"
    - "Problem specification"
    - "Hardware qubit limits"

discovery:
  file_patterns:
    - glob: "**/circuits/**/*.py"
      purpose: "Find circuit definitions"
    - glob: "**/*.qasm"
      purpose: "Find QASM files"

  metrics_queries:
    - system: "qiskit"
      query: "circuit.num_qubits"
      purpose: "Count total qubits used"

knowledge_sources:
  specifications:
    - id: "qubit-efficiency-papers"
      name: "Space-Efficient Quantum Algorithms"
      url: "https://arxiv.org/search/?query=space+efficient+quantum&searchtype=all"
      offline_cache: false
      priority: "recommended"

  guides:
    - id: "ancilla-optimization"
      name: "Ancilla Qubit Optimization Techniques"
      url: "https://qiskit.org/documentation/optimization.html"
      offline_cache: true

tooling:
  analysis_tools:
    - tool: "qiskit"
      purpose: "Qubit count analysis"

    - tool: "qubit-mapping-tools"
      purpose: "Analyze qubit mapping efficiency"

signals:
  critical:
    - id: "QCE-CRIT-001"
      signal: "Qubit count exceeds hardware capacity"
      evidence_threshold: "circuit.num_qubits > hardware.num_qubits"
      explanation: |
        Algorithm cannot execute on target hardware. Must reduce qubit count
        or target larger quantum processors.
      remediation: |
        Apply qubit reduction techniques.
        Consider ancilla-free algorithm variants.
        Identify qubit recycling opportunities.

    - id: "QCE-CRIT-002"
      signal: "Exponential qubit scaling"
      evidence_indicators:
        - "Qubit count grows exponentially with problem size"
        - "No theoretical justification for qubit growth"
      explanation: |
        Exponential qubit growth eliminates quantum advantage and
        prevents scaling to useful problem sizes.
      remediation: "Review algorithm design for polynomial qubit alternatives"

  high:
    - id: "QCE-HIGH-001"
      signal: "Excessive ancilla qubits"
      evidence_indicators:
        - "More than 50% of qubits are ancilla"
        - "Ancilla not justified by algorithm requirements"
      remediation: "Review ancilla necessity and apply reduction techniques"

    - id: "QCE-HIGH-002"
      signal: "No qubit recycling implemented"
      evidence_indicators:
        - "Qubits idle after measurement not reused"
        - "Reset operations not utilized"
      remediation: "Implement qubit recycling where possible"

  medium:
    - id: "QCE-MED-001"
      signal: "Suboptimal qubit encoding"
      remediation: "Review encoding strategy for efficiency"

    - id: "QCE-MED-002"
      signal: "Redundant qubit allocation"
      remediation: "Analyze and remove redundant qubits"

  low:
    - id: "QCE-LOW-001"
      signal: "Qubit usage not documented"
      remediation: "Document qubit allocation and purpose"

  positive:
    - id: "QCE-POS-001"
      signal: "Optimal qubit count achieved"
    - id: "QCE-POS-002"
      signal: "Efficient qubit recycling implemented"
    - id: "QCE-POS-003"
      signal: "Polynomial qubit scaling documented"

procedure:
  context:
    cognitive_mode: "critical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Count Qubits"
      description: "Measure total qubit usage"
      duration_estimate: "30 min"
      commands:
        - purpose: "Count qubits in circuit"
          command: "python -c 'from qiskit import QuantumCircuit; qc = QuantumCircuit.from_qasm_file(\"circuit.qasm\"); print(f\"Qubits: {qc.num_qubits}\")'"

    - id: "2"
      name: "Classify Qubit Usage"
      description: "Categorize qubits as data, ancilla, or output"
      duration_estimate: "45 min"

    - id: "3"
      name: "Compare to Theoretical Minimum"
      description: "Assess qubit count against information-theoretic limits"
      duration_estimate: "1 hour"

    - id: "4"
      name: "Identify Optimization Opportunities"
      description: "Find qubit reduction and recycling opportunities"
      duration_estimate: "1 hour"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "qubit_analysis"
      format: "json"
      description: "Detailed qubit utilization breakdown"

closeout_checklist:
  - id: "qce-001"
    item: "Qubit count within hardware limits"
    level: "CRITICAL"
    verification: "automated"

  - id: "qce-002"
    item: "Qubit efficiency analyzed"
    level: "BLOCKING"
    verification: "manual"

  - id: "qce-003"
    item: "Optimization opportunities documented"
    level: "WARNING"
    verification: "manual"

governance:
  applicable_to:
    archetypes: ["quantum-systems"]

relationships:
  commonly_combined:
    - "quantum-computing.resource-estimation.qubit-requirement"
    - "quantum-computing.quantum-algorithm.algorithm-correctness"
  feeds_into:
    - "quantum-computing.resource-estimation.hardware-compatibility"
