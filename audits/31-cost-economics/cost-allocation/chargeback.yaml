audit:
  id: cost-economics.cost-allocation.chargeback
  name: Chargeback Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: cost-economics
  category_number: 31
  subcategory: cost-allocation
  tier: expert
  estimated_duration: 5-7 hours  # median: 6h
  completeness: requires_discovery
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: organizational
  default_profiles:
  - full
  - finops
  blocks_phase: false
  parallelizable: false
description:
  what: |
    This audit examines chargeback processes where IT and cloud
    costs are directly charged to consuming business units,
    affecting their P&L. It evaluates allocation methodology,
    accuracy, fairness, and organizational acceptance.
  why_it_matters: |
    Chargeback creates true financial accountability by making
    cost consumers directly responsible. When done well, it drives
    cost-conscious behavior and efficient resource use. When done
    poorly, it creates friction, disputes, and suboptimal behavior.
  when_to_run:
  - Monthly chargeback reconciliation
  - Before implementing or changing chargeback
  - When disputes arise
  - During financial governance reviews
prerequisites:
  required_artifacts:
  - type: chargeback-methodology
    description: Documented allocation methodology
  - type: cost-data
    description: Detailed cost data for allocation
  - type: consumption-data
    description: Resource consumption by business unit
  access_requirements:
  - Access to cost allocation system
  - Access to consumption metrics
  - Access to chargeback reports
  - Interview access to stakeholders
discovery:
  chargeback_models:
  - model: Direct allocation
    description: Costs charged based on direct consumption
  - model: Tiered/metered
    description: Consumption-based charging with rates
  - model: Fixed allocation
    description: Predetermined percentages or amounts
  - model: Hybrid
    description: Combination of methods
  allocation_basis:
  - basis: Actual consumption
    accuracy: High
    complexity: High
  - basis: Headcount
    accuracy: Low
    complexity: Low
  - basis: Revenue
    accuracy: Low
    complexity: Low
  - basis: Resource tags
    accuracy: Medium-High
    complexity: Medium
  file_patterns:
  - glob: '**/*.tf'
    purpose: Terraform files
  - glob: '**/cloudformation/**/*.yaml'
    purpose: CloudFormation templates
  - glob: '**/*cost*.yaml'
    purpose: Cost configuration files
  - glob: '**/*budget*.yaml'
    purpose: Budget configuration files
  - glob: '**/*tag*.yaml'
    purpose: Tagging policy files
  code_patterns:
  - pattern: tags\s*[=:]|cost_center|billing|budget
    type: regex
    scope: config
    purpose: Cost/billing references
  - pattern: reserved_instance|spot_instance|savings_plan
    type: regex
    scope: config
    purpose: Cost optimization patterns
knowledge_sources:
  specifications:
  - id: finops-chargeback
    name: FinOps - Chargeback and Showback
    url: https://www.finops.org/framework/capabilities/chargeback-showback/
    offline_cache: true
    priority: required
  guides:
  - id: it-chargeback
    name: IT Chargeback Best Practices
    url: https://www.gartner.com/en/information-technology/glossary/chargeback
    offline_cache: true
tooling:
  allocation_tools:
  - tool: Cloud cost management platforms
    purpose: Automated cost allocation
  - tool: Enterprise financial systems
    purpose: Chargeback processing
  - tool: Custom allocation engines
    purpose: Complex allocation logic
signals:
  critical:
  - id: CB-CRIT-001
    signal: Chargeback methodology not documented or understood
    evidence_pattern: No clear allocation rules
    explanation: |
      Without documented methodology, allocation appears
      arbitrary, leading to disputes and loss of credibility.
      Recipients must understand how charges are calculated.
    remediation: Document and communicate chargeback methodology
  - id: CB-CRIT-002
    signal: Significant unexplained variance in chargebacks
    evidence_threshold: month_over_month_variance > 30%
    explanation: |
      Large unexplained variances create budget problems for
      recipients and undermine confidence in the process.
    remediation: Investigate and explain variances proactively
  high:
  - id: CB-HIGH-001
    signal: Chargeback based on poor-quality data
    evidence_pattern: Allocation using incomplete or inaccurate data
    explanation: |
      Chargebacks based on poor data create disputes and
      erode trust. The foundation of chargeback must be
      accurate consumption data.
    remediation: Improve data quality before allocating
  - id: CB-HIGH-002
    signal: Shared costs allocated arbitrarily
    evidence_pattern: No fair methodology for shared resources
    explanation: |
      Arbitrary allocation of shared costs (platforms,
      infrastructure) creates disputes and perverse
      incentives.
    remediation: Implement fair shared cost allocation methodology
  medium:
  - id: CB-MED-001
    signal: No dispute resolution process
    evidence_pattern: Disputes escalated without process
    remediation: Establish formal dispute resolution
  - id: CB-MED-002
    signal: Chargeback timing creates budget issues
    evidence_pattern: Charges received after budget periods
    remediation: Align chargeback timing with budget cycles
  low:
  - id: CB-LOW-001
    signal: No chargeback reconciliation process
    evidence_pattern: Chargebacks not verified
    remediation: Implement reconciliation process
  positive:
  - id: CB-POS-001
    signal: Transparent, documented methodology
  - id: CB-POS-002
    signal: Accurate consumption-based allocation
  - id: CB-POS-003
    signal: Organizational acceptance with minimal disputes
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Review chargeback methodology
    description: |
      Examine the documented methodology for how costs are
      allocated to business units.
    duration_estimate: 60 min
    expected_findings:
    - Methodology assessment
    - Allocation basis review
  - id: '2'
    name: Assess data quality
    description: |
      Evaluate the quality of data used for allocation
      including consumption and cost data.
    duration_estimate: 60 min
    expected_findings:
    - Data quality assessment
    - Gap identification
  - id: '3'
    name: Review shared cost allocation
    description: |
      Examine how shared and common costs are distributed
      across business units.
    duration_estimate: 45 min
    expected_findings:
    - Shared cost methodology
    - Fairness assessment
  - id: '4'
    name: Analyze chargeback accuracy
    description: |
      Verify that chargebacks accurately reflect consumption
      through sampling and reconciliation.
    duration_estimate: 60 min
    expected_findings:
    - Accuracy analysis
    - Error identification
  - id: '5'
    name: Evaluate stakeholder acceptance
    description: |
      Assess how well the chargeback process is accepted
      by recipients through interviews or dispute analysis.
    duration_estimate: 45 min
    expected_findings:
    - Acceptance assessment
    - Dispute analysis
  - id: '6'
    name: Review governance and process
    description: |
      Evaluate the overall governance of chargeback including
      timing, reporting, and dispute resolution.
    duration_estimate: 30 min
    expected_findings:
    - Process assessment
    - Governance review
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Methodology Assessment
    - Data Quality Review
    - Accuracy Analysis
    - Recommendations
  - type: allocation_analysis
    format: table
    columns:
    - Cost Category
    - Allocation Method
    - Data Quality
    - Accuracy
    - Disputes
  confidence_guidance:
    high: Complete data access with stakeholder interviews
    medium: Data access without stakeholder input
    low: Documentation review only
offline:
  capability: partial
  cache_manifest:
    knowledge:
    - source_id: finops-chargeback
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires comprehensive review
    full:
      included: true
      priority: 1
    finops:
      included: true
      priority: 1
closeout_checklist:
- id: cb-001
  item: Methodology documented and understood
  level: CRITICAL
  verification: manual
  expected: Documentation verified
- id: cb-002
  item: Allocation accuracy validated
  level: BLOCKING
  verification: automated
  expected: Accuracy > 95%
- id: cb-003
  item: Stakeholder acceptance assessed
  level: WARNING
  verification: manual
  expected: Assessment complete
governance:
  applicable_to:
    archetypes:
    - enterprise
    - multi-business-unit
    - cost-conscious
  compliance_frameworks:
  - framework: FinOps Foundation
    controls:
    - Chargeback and Showback
  - framework: ITIL
    controls:
    - Financial Management
relationships:
  commonly_combined:
  - cost-economics.cost-allocation.showback
  - cost-economics.cost-visibility.cost-attribution
  - cost-economics.cost-allocation.cost-centers
