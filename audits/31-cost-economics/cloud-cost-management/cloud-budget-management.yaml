audit:
  id: cost-economics.cloud-cost-management.cloud-budget-management
  name: Cloud Budget Management Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: cost-economics
  category_number: 31
  subcategory: cloud-cost-management
  tier: expert
  estimated_duration: 3-4 hours  # median: 3h
  completeness: requires_discovery
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: organizational
  default_profiles:
  - full
  - finops
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines cloud budget management practices including
    budget definition, threshold alerting, automated actions, and
    alignment between budgets and actual organizational structure.
    It evaluates the effectiveness of budget controls.
  why_it_matters: |
    Budgets are the primary mechanism for controlling cloud costs.
    Without effective budget management, organizations frequently
    experience cost overruns, surprise bills, and loss of financial
    predictability. Proper budgeting enables accountability and
    informed decision-making.
  when_to_run:
  - Monthly budget review
  - During annual budget planning
  - After organizational changes
  - When budget overruns occur
prerequisites:
  required_artifacts:
  - type: budget-configs
    description: Cloud budget configurations
  - type: alert-settings
    description: Budget alert thresholds and notifications
  - type: org-structure
    description: Organizational hierarchy for budget alignment
  access_requirements:
  - Access to AWS Budgets or equivalent
  - Access to budget alert configurations
  - Access to organizational budget plans
discovery:
  budget_types:
  - type: Cost budgets
    purpose: Total spend limits
  - type: Usage budgets
    purpose: Resource consumption limits
  - type: RI utilization budgets
    purpose: Commitment efficiency tracking
  - type: Savings Plans coverage budgets
    purpose: Coverage target tracking
  alert_thresholds:
  - threshold: 50%
    action: Notification for awareness
  - threshold: 80%
    action: Warning for investigation
  - threshold: 100%
    action: Critical alert
  - threshold: Forecasted breach
    action: Proactive notification
  file_patterns:
  - glob: '**/*.tf'
    purpose: Terraform files
  - glob: '**/cloudformation/**/*.yaml'
    purpose: CloudFormation templates
  - glob: '**/*cost*.yaml'
    purpose: Cost configuration files
  - glob: '**/*budget*.yaml'
    purpose: Budget configuration files
  - glob: '**/*tag*.yaml'
    purpose: Tagging policy files
  code_patterns:
  - pattern: tags\s*[=:]|cost_center|billing|budget
    type: regex
    scope: config
    purpose: Cost/billing references
  - pattern: reserved_instance|spot_instance|savings_plan
    type: regex
    scope: config
    purpose: Cost optimization patterns
knowledge_sources:
  specifications:
  - id: aws-budgets
    name: AWS Budgets Documentation
    url: https://docs.aws.amazon.com/cost-management/latest/userguide/budgets-managing-costs.html
    offline_cache: true
    priority: required
  guides:
  - id: finops-budgeting
    name: FinOps - Budgeting and Forecasting
    url: https://www.finops.org/framework/capabilities/budget-forecasting/
    offline_cache: true
tooling:
  budget_tools:
  - tool: AWS Budgets
    purpose: Native AWS budget management
    command: aws budgets describe-budgets --account-id ACCOUNT_ID
  - tool: Azure Cost Management Budgets
    purpose: Native Azure budget management
  - tool: GCP Budget Alerts
    purpose: Native GCP budget management
signals:
  critical:
  - id: BUD-CRIT-001
    signal: No cloud budgets defined
    evidence_pattern: Zero budget configurations
    explanation: |
      Without budgets, there are no guardrails on cloud spending.
      Teams have no targets and leadership has no visibility
      into planned vs actual spending.
    remediation: Define budgets aligned with organizational structure
  - id: BUD-CRIT-002
    signal: Budget alerts not routed to actionable parties
    evidence_pattern: Alerts to unused email addresses
    explanation: |
      Budget alerts that do not reach responsible parties provide
      no value. Alerts must reach people who can investigate and
      take action.
    remediation: Configure alert routing to appropriate stakeholders
  high:
  - id: BUD-HIGH-001
    signal: Budgets not aligned with organizational structure
    evidence_pattern: Account-level budgets only
    explanation: |
      Budgets should align with how the organization operates -
      by team, project, or business unit. Account-level budgets
      alone do not enable meaningful accountability.
    remediation: Create budgets aligned with organizational structure
  - id: BUD-HIGH-002
    signal: No forecasted breach alerts configured
    evidence_pattern: Only actual threshold alerts
    explanation: |
      Waiting until budgets are breached is reactive. Forecasted
      breach alerts provide early warning to prevent overruns.
    remediation: Configure forecasted budget alerts
  medium:
  - id: BUD-MED-001
    signal: Single alert threshold only
    evidence_pattern: Only 100% threshold configured
    remediation: Add multiple thresholds (50%, 80%, 100%)
  - id: BUD-MED-002
    signal: Budgets not updated for organizational changes
    evidence_pattern: Outdated budget configurations
    remediation: Review and update budgets regularly
  low:
  - id: BUD-LOW-001
    signal: No budget review process documented
    evidence_pattern: Ad-hoc budget management
    remediation: Document budget review process
  positive:
  - id: BUD-POS-001
    signal: Comprehensive budgets with multiple thresholds
  - id: BUD-POS-002
    signal: Forecasted breach alerts with proactive response
  - id: BUD-POS-003
    signal: Regular budget review and adjustment process
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Inventory current budgets
    description: |
      Catalog all configured budgets including amounts, periods,
      and scope.
    duration_estimate: 30 min
    commands:
    - purpose: List AWS budgets
      command: |
        aws budgets describe-budgets \
          --account-id $(aws sts get-caller-identity --query Account --output text)
    expected_findings:
    - Budget inventory
    - Coverage assessment
  - id: '2'
    name: Review alert configurations
    description: |
      Examine alert thresholds, notification channels, and
      recipient configurations.
    duration_estimate: 30 min
    expected_findings:
    - Alert configuration review
    - Notification routing
  - id: '3'
    name: Assess organizational alignment
    description: |
      Evaluate whether budgets align with organizational
      structure and accountability.
    duration_estimate: 45 min
    expected_findings:
    - Alignment assessment
    - Coverage gaps
  - id: '4'
    name: Review budget vs actual
    description: |
      Analyze budget performance including variances and
      breach history.
    duration_estimate: 30 min
    expected_findings:
    - Budget performance
    - Variance analysis
  - id: '5'
    name: Evaluate budget actions
    description: |
      Review automated actions triggered by budget alerts
      and their effectiveness.
    duration_estimate: 30 min
    expected_findings:
    - Automated actions
    - Response effectiveness
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Budget Inventory
    - Alert Configuration Review
    - Performance Analysis
    - Recommendations
  - type: metrics_dashboard
    metrics:
    - Budget coverage
    - Alert configuration completeness
    - Budget variance
    - Breach frequency
  confidence_guidance:
    high: Complete budget access with historical data
    medium: Current configuration access only
    low: Limited access
offline:
  capability: partial
  cache_manifest:
    knowledge:
    - source_id: finops-budgeting
      priority: required
profiles:
  membership:
    quick:
      included: true
      priority: 2
      reduced_scope: Configuration review only
    full:
      included: true
      priority: 1
    finops:
      included: true
      priority: 1
closeout_checklist:
- id: bud-001
  item: Budgets cover all major cost centers
  level: CRITICAL
  verification: manual
  expected: Coverage confirmed
- id: bud-002
  item: Alert routing verified
  level: BLOCKING
  verification: manual
  expected: Routing confirmed
- id: bud-003
  item: Multiple alert thresholds configured
  level: WARNING
  verification: automated
  expected: At least 3 thresholds
governance:
  applicable_to:
    archetypes:
    - cloud-native
    - hybrid
    - enterprise
  compliance_frameworks:
  - framework: FinOps Foundation
    controls:
    - Budget and Forecasting
  - framework: AWS Well-Architected
    controls:
    - COST-03
relationships:
  commonly_combined:
  - cost-economics.financial-governance.budget-management
  - cost-economics.cost-visibility.cost-anomaly-detection
  - cost-economics.financial-governance.forecasting
