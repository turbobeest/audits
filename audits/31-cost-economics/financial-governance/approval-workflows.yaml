audit:
  id: cost-economics.financial-governance.approval-workflows
  name: Approval Workflows Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: cost-economics
  category_number: 31
  subcategory: financial-governance
  tier: expert
  estimated_duration: 3-4 hours  # median: 3h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: organizational
  default_profiles:
  - full
  - compliance
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines approval workflows for cloud and IT
    spending including spending thresholds, approval authority
    levels, escalation paths, and the balance between control
    and agility.
  why_it_matters: |
    Approval workflows provide financial control while enabling
    business operations. Overly restrictive workflows slow
    innovation; too-permissive workflows create risk. Well-designed
    workflows balance control with agility and provide appropriate
    oversight for spending decisions.
  when_to_run:
  - Annual governance review
  - After spending incidents
  - When implementing new services
  - During compliance audits
prerequisites:
  required_artifacts:
  - type: workflow-documentation
    description: Documented approval workflows
  - type: authority-matrix
    description: Spending authority levels
  - type: approval-history
    description: Historical approval data
  access_requirements:
  - Access to workflow documentation
  - Access to approval system
  - Interview access to approvers
discovery:
  workflow_types:
  - type: Procurement approval
    triggers:
    - New purchases
    - Renewals
  - type: Resource creation
    triggers:
    - Cloud resource provisioning
  - type: Budget exception
    triggers:
    - Over-budget spending
  - type: Commitment approval
    triggers:
    - RIs
    - Savings Plans
    - Contracts
  authority_levels:
  - level: Team lead
    typical_threshold: Up to $5,000
  - level: Manager
    typical_threshold: $5,000 - $25,000
  - level: Director
    typical_threshold: $25,000 - $100,000
  - level: VP/Executive
    typical_threshold: $100,000+
  file_patterns:
  - glob: '**/*.tf'
    purpose: Terraform files
  - glob: '**/cloudformation/**/*.yaml'
    purpose: CloudFormation templates
  - glob: '**/*cost*.yaml'
    purpose: Cost configuration files
  - glob: '**/*budget*.yaml'
    purpose: Budget configuration files
  - glob: '**/*tag*.yaml'
    purpose: Tagging policy files
  code_patterns:
  - pattern: tags\s*[=:]|cost_center|billing|budget
    type: regex
    scope: config
    purpose: Cost/billing references
  - pattern: reserved_instance|spot_instance|savings_plan
    type: regex
    scope: config
    purpose: Cost optimization patterns
knowledge_sources:
  specifications:
  - id: financial-controls
    name: IT Financial Controls
    url: https://www.isaca.org/resources/cobit
    offline_cache: true
    priority: required
  guides:
  - id: cloud-governance
    name: Cloud Financial Governance
    url: https://www.finops.org/framework/
    offline_cache: true
tooling:
  workflow_tools:
  - tool: ServiceNow
    purpose: IT service management and approvals
  - tool: Coupa/Ariba
    purpose: Procurement approvals
  - tool: Custom workflows
    purpose: Cloud-specific approvals
signals:
  critical:
  - id: APPR-CRIT-001
    signal: No approval workflow for significant spending
    evidence_pattern: Large purchases without oversight
    explanation: |
      Spending without approval creates financial risk and
      prevents proper oversight. All significant spending
      should have appropriate approval.
    remediation: Implement approval workflows with thresholds
  - id: APPR-CRIT-002
    signal: Approval workflows routinely bypassed
    evidence_pattern: Spending occurring outside workflow
    explanation: |
      Bypassed workflows indicate either too-restrictive
      processes or cultural issues. Either way, controls
      are not functioning.
    remediation: Investigate and address root causes of bypasses
  high:
  - id: APPR-HIGH-001
    signal: Approval thresholds not aligned with risk
    evidence_pattern: Same approval for $100 and $100,000
    explanation: |
      Flat approval processes waste time on low-risk items
      while providing insufficient scrutiny for high-risk
      spending.
    remediation: Implement tiered approval thresholds
  - id: APPR-HIGH-002
    signal: Cloud spending bypassing standard procurement
    evidence_pattern: Direct credit card purchases unreviewed
    explanation: |
      Cloud's ease of consumption enables bypassing traditional
      controls. This creates visibility gaps and compliance
      risk.
    remediation: Integrate cloud spending into approval workflow
  medium:
  - id: APPR-MED-001
    signal: Approval workflows too slow for business needs
    evidence_threshold: average_approval_time > 5 days
    remediation: Streamline workflows for lower-risk items
  - id: APPR-MED-002
    signal: No emergency approval process
    evidence_pattern: No expedited path for urgent needs
    remediation: Define emergency approval process
  low:
  - id: APPR-LOW-001
    signal: Approval workflows not documented
    evidence_pattern: Informal approval processes
    remediation: Document all approval workflows
  positive:
  - id: APPR-POS-001
    signal: Tiered approvals aligned with risk
  - id: APPR-POS-002
    signal: Automated low-risk approvals
  - id: APPR-POS-003
    signal: Clear escalation paths
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Document current workflows
    description: |
      Map all approval workflows for IT and cloud spending
      including triggers, thresholds, and approvers.
    duration_estimate: 45 min
    expected_findings:
    - Workflow inventory
    - Threshold mapping
  - id: '2'
    name: Assess threshold appropriateness
    description: |
      Evaluate whether approval thresholds are appropriate
      for the risk level of different spending types.
    duration_estimate: 45 min
    expected_findings:
    - Threshold assessment
    - Risk alignment
  - id: '3'
    name: Review workflow performance
    description: |
      Analyze workflow metrics including approval times,
      rejection rates, and bypass frequency.
    duration_estimate: 45 min
    expected_findings:
    - Performance metrics
    - Bottleneck identification
  - id: '4'
    name: Evaluate coverage
    description: |
      Identify spending types that may bypass or fall
      outside current approval workflows.
    duration_estimate: 30 min
    expected_findings:
    - Coverage gaps
    - Risk assessment
  - id: '5'
    name: Assess balance
    description: |
      Evaluate whether workflows appropriately balance
      control with business agility.
    duration_estimate: 30 min
    expected_findings:
    - Balance assessment
    - Stakeholder feedback
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Workflow Inventory
    - Threshold Analysis
    - Performance Review
    - Recommendations
  - type: workflow_matrix
    format: table
    columns:
    - Spending Type
    - Threshold
    - Approver
    - Average Time
    - Effectiveness
  confidence_guidance:
    high: Complete workflow access with metrics
    medium: Documentation review only
    low: Limited workflow visibility
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: cloud-governance
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires comprehensive review
    full:
      included: true
      priority: 2
    compliance:
      included: true
      priority: 1
closeout_checklist:
- id: appr-001
  item: Workflows documented
  level: CRITICAL
  verification: manual
  expected: Documentation complete
- id: appr-002
  item: Coverage gaps identified
  level: BLOCKING
  verification: manual
  expected: Gaps documented
- id: appr-003
  item: Recommendations provided
  level: WARNING
  verification: manual
  expected: Recommendations documented
governance:
  applicable_to:
    archetypes:
    - enterprise
    - regulated
    - hybrid
  compliance_frameworks:
  - framework: SOX
    controls:
    - IT General Controls
  - framework: COBIT
    controls:
    - Financial Management
relationships:
  commonly_combined:
  - cost-economics.financial-governance.budget-management
  - cost-economics.cloud-cost-management.cost-governance-policies
  - cost-economics.financial-governance.spending-controls
