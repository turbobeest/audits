audit:
  id: cost-economics.license-management.cloud-license-mobility
  name: Cloud License Mobility Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: cost-economics
  category_number: 31
  subcategory: license-management
  tier: expert
  estimated_duration: 3-5 hours  # median: 4h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: organizational
  default_profiles:
  - full
  - compliance
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines the ability to use existing on-premises
    software licenses in cloud environments. It evaluates BYOL
    (Bring Your Own License) rights, license mobility through
    Software Assurance, and compliance with cloud-specific
    licensing requirements.
  why_it_matters: |
    Proper use of license mobility can save 40-70% on cloud
    software costs compared to cloud-included licensing. However,
    improper BYOL creates compliance risk. Understanding mobility
    rights enables cost optimization while maintaining compliance.
  when_to_run:
  - During cloud migration planning
  - When evaluating BYOL options
  - During cloud cost optimization
  - Before renewing enterprise agreements
prerequisites:
  required_artifacts:
  - type: license-entitlements
    description: Current license holdings with mobility rights
  - type: cloud-deployments
    description: Cloud software deployments
  - type: vendor-agreements
    description: Enterprise agreements with mobility terms
  access_requirements:
  - Access to license records
  - Access to cloud deployment details
  - Access to vendor agreement terms
discovery:
  mobility_programs:
  - vendor: Microsoft
    program: License Mobility through SA
    coverage: Select server applications
  - vendor: Microsoft
    program: Azure Hybrid Benefit
    coverage: Windows Server, SQL Server
  - vendor: Oracle
    program: Bring Your Own License
    coverage: Oracle Database (with restrictions)
  - vendor: Red Hat
    program: Cloud Access
    coverage: RHEL subscriptions
  cloud_considerations:
  - consideration: Dedicated vs shared tenancy
    vendors:
    - Oracle
  - consideration: Processor core counting
    vendors:
    - Oracle
    - Microsoft
  - consideration: Cloud provider authorization
    vendors:
    - Microsoft
  file_patterns:
  - glob: '**/*.tf'
    purpose: Terraform files
  - glob: '**/cloudformation/**/*.yaml'
    purpose: CloudFormation templates
  - glob: '**/*cost*.yaml'
    purpose: Cost configuration files
  - glob: '**/*budget*.yaml'
    purpose: Budget configuration files
  - glob: '**/*tag*.yaml'
    purpose: Tagging policy files
  code_patterns:
  - pattern: tags\s*[=:]|cost_center|billing|budget
    type: regex
    scope: config
    purpose: Cost/billing references
  - pattern: reserved_instance|spot_instance|savings_plan
    type: regex
    scope: config
    purpose: Cost optimization patterns
knowledge_sources:
  specifications:
  - id: azure-hybrid-benefit
    name: Azure Hybrid Benefit Documentation
    url: https://azure.microsoft.com/pricing/hybrid-benefit/
    offline_cache: true
    priority: required
  guides:
  - id: aws-byol
    name: AWS BYOL Options
    url: https://aws.amazon.com/windows/resources/licensing/
    offline_cache: true
  - id: oracle-cloud-licensing
    name: Oracle Cloud Licensing Policies
    url: https://www.oracle.com/corporate/contracts/cloud-licensing/
    offline_cache: true
tooling:
  tracking_tools:
  - tool: AWS License Manager
    purpose: BYOL tracking in AWS
  - tool: Azure Hybrid Benefit tracking
    purpose: AHB usage monitoring
  - tool: License management platforms
    purpose: Cross-cloud BYOL tracking
signals:
  critical:
  - id: CLMB-CRIT-001
    signal: BYOL used without proper rights
    evidence_pattern: On-prem licenses deployed to cloud without mobility
    explanation: |
      Using licenses in cloud without proper mobility rights
      creates serious compliance exposure. Cloud vendors
      specifically audit for unauthorized BYOL.
    remediation: Verify mobility rights or acquire cloud licenses
  - id: CLMB-CRIT-002
    signal: Oracle licenses on unauthorized cloud infrastructure
    evidence_pattern: Oracle software on non-dedicated cloud hosts
    explanation: |
      Oracle licensing requires dedicated infrastructure in
      most cloud scenarios. Unauthorized deployment creates
      significant compliance risk.
    remediation: Move to authorized infrastructure or acquire rights
  high:
  - id: CLMB-HIGH-001
    signal: BYOL opportunities not utilized
    evidence_pattern: Paying for cloud-included when BYOL available
    explanation: |
      Not using available BYOL rights wastes significant money.
      Azure Hybrid Benefit alone can save 40%+ on Windows and
      SQL Server.
    remediation: Enable BYOL where available
  - id: CLMB-HIGH-002
    signal: BYOL tracking not implemented
    evidence_pattern: No visibility into BYOL usage
    explanation: |
      Without BYOL tracking, organizations cannot ensure
      compliance or optimize usage. This creates both
      compliance and cost risk.
    remediation: Implement BYOL tracking
  medium:
  - id: CLMB-MED-001
    signal: License mobility not considered in cloud planning
    evidence_pattern: Cloud decisions without license analysis
    remediation: Include license mobility in cloud planning
  - id: CLMB-MED-002
    signal: Software Assurance not maintained for mobility
    evidence_pattern: SA lapsed losing mobility rights
    remediation: Evaluate SA value including mobility
  low:
  - id: CLMB-LOW-001
    signal: No documentation of BYOL decisions
    evidence_pattern: BYOL rationale not recorded
    remediation: Document BYOL decisions and rights
  positive:
  - id: CLMB-POS-001
    signal: BYOL actively utilized where available
  - id: CLMB-POS-002
    signal: Compliance with all mobility terms
  - id: CLMB-POS-003
    signal: BYOL usage tracked and optimized
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Inventory cloud software deployments
    description: |
      Catalog all software running in cloud environments
      that may be eligible for BYOL.
    duration_estimate: 45 min
    expected_findings:
    - Cloud software inventory
    - Current licensing model
  - id: '2'
    name: Assess mobility rights
    description: |
      Review license entitlements to determine mobility
      rights and restrictions.
    duration_estimate: 60 min
    expected_findings:
    - Mobility rights assessment
    - Eligible licenses
  - id: '3'
    name: Verify BYOL compliance
    description: |
      Confirm that current BYOL deployments comply with
      license terms.
    duration_estimate: 45 min
    expected_findings:
    - Compliance assessment
    - Violations identified
  - id: '4'
    name: Identify BYOL opportunities
    description: |
      Find cloud deployments where BYOL could be enabled
      for cost savings.
    duration_estimate: 30 min
    expected_findings:
    - BYOL opportunities
    - Potential savings
  - id: '5'
    name: Calculate cost impact
    description: |
      Quantify savings from proper BYOL utilization and
      cost of compliance remediation.
    duration_estimate: 30 min
    expected_findings:
    - Savings potential
    - Remediation costs
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Cloud Deployment Inventory
    - Mobility Rights Assessment
    - BYOL Opportunities
    - Compliance Status
  - type: byol_matrix
    format: table
    columns:
    - Software
    - Cloud
    - Current Model
    - BYOL Eligible
    - Potential Savings
  confidence_guidance:
    high: Complete license and deployment data
    medium: Partial data
    low: Estimated analysis
offline:
  capability: partial
  cache_manifest:
    knowledge:
    - source_id: azure-hybrid-benefit
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires comprehensive review
    full:
      included: true
      priority: 2
    compliance:
      included: true
      priority: 1
closeout_checklist:
- id: clmb-001
  item: BYOL compliance verified
  level: CRITICAL
  verification: manual
  expected: Compliance confirmed
- id: clmb-002
  item: BYOL opportunities identified
  level: BLOCKING
  verification: manual
  expected: Opportunities documented
- id: clmb-003
  item: Savings quantified
  level: WARNING
  verification: automated
  expected: Savings calculated
governance:
  applicable_to:
    archetypes:
    - hybrid
    - cloud-migrating
    - enterprise
  compliance_frameworks:
  - framework: Vendor License Agreements
    controls:
    - Cloud Licensing Terms
relationships:
  commonly_combined:
  - cost-economics.license-management.license-compliance
  - cost-economics.cost-optimization.reserved-instances
  - cost-economics.roi-value-analysis.tco-analysis
