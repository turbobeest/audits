audit:
  id: cost-economics.license-management.license-compliance
  name: License Compliance Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: cost-economics
  category_number: 31
  subcategory: license-management
  tier: expert
  estimated_duration: 6-8 hours  # median: 7h
  completeness: requires_discovery
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: critical
  scope: organizational
  default_profiles:
  - full
  - compliance
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines software license compliance across the
    organization. It compares software deployments against owned
    licenses, identifies compliance gaps, and ensures license terms
    are being met including cloud mobility rights and virtual
    environments.
  why_it_matters: |
    License non-compliance creates significant financial and legal
    risk. Vendor audits can result in substantial penalties, back-
    payments, and legal action. Over-licensing wastes money. Proper
    license management balances compliance risk with cost efficiency.
  when_to_run:
  - Quarterly compliance review
  - Before vendor audits
  - After major deployments
  - During SAM program reviews
prerequisites:
  required_artifacts:
  - type: software-inventory
    description: Complete inventory of deployed software
  - type: license-entitlements
    description: License purchases and entitlements
  - type: contract-terms
    description: License agreement terms and conditions
  access_requirements:
  - Access to software discovery tools
  - Access to license management system
  - Access to procurement records
  - Access to vendor contracts
discovery:
  license_types:
  - type: Per-user/Named User
    compliance_check: Users vs licenses
  - type: Per-device/Per-seat
    compliance_check: Installations vs licenses
  - type: Per-core/Per-processor
    compliance_check: Core count vs entitlements
  - type: Enterprise/Subscription
    compliance_check: Coverage scope
  - type: Cloud/SaaS
    compliance_check: Active users vs subscriptions
  high_risk_software:
  - category: Database
    vendors:
    - Oracle
    - Microsoft SQL Server
    - IBM DB2
  - category: Virtualization
    vendors:
    - VMware
    - Microsoft Hyper-V
  - category: Enterprise Software
    vendors:
    - SAP
    - Adobe
    - Autodesk
  - category: Operating Systems
    vendors:
    - Microsoft Windows Server
    - Red Hat
  file_patterns:
  - glob: '**/*.tf'
    purpose: Terraform files
  - glob: '**/cloudformation/**/*.yaml'
    purpose: CloudFormation templates
  - glob: '**/*cost*.yaml'
    purpose: Cost configuration files
  - glob: '**/*budget*.yaml'
    purpose: Budget configuration files
  - glob: '**/*tag*.yaml'
    purpose: Tagging policy files
  code_patterns:
  - pattern: tags\s*[=:]|cost_center|billing|budget
    type: regex
    scope: config
    purpose: Cost/billing references
  - pattern: reserved_instance|spot_instance|savings_plan
    type: regex
    scope: config
    purpose: Cost optimization patterns
knowledge_sources:
  specifications:
  - id: iso-19770
    name: ISO 19770 Software Asset Management
    url: https://www.iso.org/standard/68531.html
    offline_cache: true
    priority: required
  guides:
  - id: sam-best-practices
    name: ITAM/SAM Best Practices
    url: https://www.itassetmanagement.net/
    offline_cache: true
  - id: cloud-licensing
    name: Cloud Licensing Considerations
    url: https://www.microsoft.com/licensing/
    offline_cache: true
tooling:
  sam_tools:
  - tool: ServiceNow SAM
    purpose: Software asset management
  - tool: Flexera
    purpose: License optimization
  - tool: Snow Software
    purpose: Software asset management
  - tool: AWS License Manager
    purpose: AWS license tracking
signals:
  critical:
  - id: LIC-CRIT-001
    signal: Software deployed without valid license
    evidence_pattern: Deployments exceeding entitlements
    explanation: |
      Using software without proper licensing exposes the
      organization to audit penalties, back-payments, and
      potential legal action from vendors.
    remediation: Acquire additional licenses or remove deployments
  - id: LIC-CRIT-002
    signal: License terms being violated
    evidence_pattern: Usage outside license scope
    explanation: |
      Even with sufficient license counts, terms violations
      (e.g., cloud mobility restrictions, geographic limits)
      create compliance exposure.
    remediation: Align usage with license terms or renegotiate
  high:
  - id: LIC-HIGH-001
    signal: Virtual environment licensing not properly addressed
    evidence_pattern: VM licensing gaps
    explanation: |
      Virtualization creates complex licensing scenarios.
      Improper VM licensing is a common compliance gap and
      a frequent audit finding.
    remediation: Review and correct virtual environment licensing
  - id: LIC-HIGH-002
    signal: Cloud deployment violating on-premises license terms
    evidence_pattern: On-prem licenses used in cloud without rights
    explanation: |
      Many on-premises licenses cannot be used in public cloud
      without specific mobility rights or separate cloud licenses.
    remediation: Verify cloud mobility rights or acquire cloud licenses
  medium:
  - id: LIC-MED-001
    signal: License inventory incomplete or outdated
    evidence_pattern: Unable to reconcile all deployments
    remediation: Update license inventory
  - id: LIC-MED-002
    signal: License agreements expiring without renewal plan
    evidence_pattern: Expiring contracts not addressed
    remediation: Plan renewals or transitions
  low:
  - id: LIC-LOW-001
    signal: No software asset management program
    evidence_pattern: Ad-hoc license management
    remediation: Establish SAM program
  positive:
  - id: LIC-POS-001
    signal: Full compliance with all license terms
  - id: LIC-POS-002
    signal: Active SAM program with regular reconciliation
  - id: LIC-POS-003
    signal: Audit-ready documentation and evidence
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Inventory deployed software
    description: |
      Discover and catalog all software deployed across the
      organization including servers, desktops, and cloud.
    duration_estimate: 90 min
    expected_findings:
    - Software inventory
    - Deployment locations
  - id: '2'
    name: Inventory license entitlements
    description: |
      Catalog all license purchases, agreements, and
      entitlements.
    duration_estimate: 60 min
    expected_findings:
    - License inventory
    - Entitlement details
  - id: '3'
    name: Reconcile deployments vs entitlements
    description: |
      Compare deployed software against owned licenses to
      identify gaps and excess.
    duration_estimate: 90 min
    expected_findings:
    - Compliance position
    - Gaps and excess
  - id: '4'
    name: Review high-risk software
    description: |
      Focus detailed review on high-risk, high-cost software
      commonly audited by vendors.
    duration_estimate: 60 min
    expected_findings:
    - High-risk assessment
    - Specific compliance issues
  - id: '5'
    name: Assess license terms compliance
    description: |
      Review usage against specific license terms including
      virtualization and cloud rights.
    duration_estimate: 60 min
    expected_findings:
    - Terms compliance assessment
    - Violation identification
  - id: '6'
    name: Calculate compliance exposure
    description: |
      Quantify the financial exposure from compliance gaps
      including potential penalties.
    duration_estimate: 30 min
    expected_findings:
    - Financial exposure estimate
    - Remediation cost
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Compliance Position
    - High-Risk Software Analysis
    - Exposure Assessment
    - Remediation Plan
  - type: compliance_matrix
    format: table
    columns:
    - Software
    - Deployed
    - Entitled
    - Position
    - Risk
  confidence_guidance:
    high: Complete discovery with verified license records
    medium: Partial discovery or incomplete records
    low: Sampling or estimated data
offline:
  capability: partial
  cache_manifest:
    knowledge:
    - source_id: iso-19770
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires comprehensive review
    full:
      included: true
      priority: 1
    compliance:
      included: true
      priority: 1
closeout_checklist:
- id: lic-001
  item: Software discovery completed
  level: CRITICAL
  verification: manual
  expected: Discovery complete
- id: lic-002
  item: Compliance position documented
  level: CRITICAL
  verification: manual
  expected: Position documented
- id: lic-003
  item: Remediation plan for gaps
  level: BLOCKING
  verification: manual
  expected: Plan documented
governance:
  applicable_to:
    archetypes:
    - enterprise
    - hybrid
    - on-premises
  compliance_frameworks:
  - framework: ISO 19770
    controls:
    - Software Asset Management
  - framework: SOX
    controls:
    - IT General Controls
relationships:
  commonly_combined:
  - cost-economics.license-management.software-asset-management
  - cost-economics.license-management.license-optimization
  - cost-economics.license-management.vendor-audit-readiness
