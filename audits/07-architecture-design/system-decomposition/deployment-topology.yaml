audit:
  id: architecture-design.system-decomposition.deployment-topology
  name: Deployment Topology Audit
  version: 1.0.0
  last_updated: '2026-01-19'
  status: active
  category: architecture-design
  category_number: 7
  subcategory: system-decomposition
  tier: phd
  estimated_duration: 2-3 hours  # median: 2h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: none
  severity: high
  scope: architecture
  default_profiles:
  - full
  - architecture
  - discovery
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit evaluates whether the deployment topology shown in
    architecture diagrams is clear, complete, and feasible. It checks
    for missing deployment details, unclear environment boundaries,
    network topology gaps, and operational feasibility concerns.
  why_it_matters: |
    Unclear deployment topology causes:
    - Confusion during infrastructure provisioning
    - Security gaps from undocumented network paths
    - Operational issues from missing monitoring/logging
    - Compliance problems from unclear data residency
    - Failed deployments from infrastructure surprises

    Clear deployment topology enables smooth implementation and operations.
  when_to_run:
  - During Discovery phase when evaluating deployment strategy
  - During PRD phase when assessing operational requirements
  - Before infrastructure provisioning decisions
  - When planning multi-region or multi-cloud deployments
prerequisites:
  required_artifacts:
  - type: deployment_diagram
    description: Deployment or infrastructure diagrams
  - type: architecture_diagram
    description: System architecture showing components
  access_requirements:
  - Access to architecture/deployment diagrams
  - Access to infrastructure requirements
signals:
  critical:
  - id: DEPLOY-CRIT-001
    signal: Missing deployment environment for component
    evidence_pattern: Service shown but no indication where it runs
    explanation: |
      Components without deployment targets cannot be provisioned.
      This blocks infrastructure setup and deployment automation.
    remediation: Specify deployment target for every component
  - id: DEPLOY-CRIT-002
    signal: Network path crosses trust boundary without security
    evidence_pattern: Public internet traffic to internal service without gateway
    explanation: |
      Unprotected network paths are security vulnerabilities.
      All traffic crossing trust boundaries needs explicit security.
    remediation: Add API gateway, firewall, or VPN for trust boundary crossings
  high:
  - id: DEPLOY-HIGH-001
    signal: Missing database/storage deployment details
    evidence_pattern: Database shown but no cluster, backup, or HA details
    explanation: |
      Databases need deployment topology for replication, backup,
      and high availability. Missing details lead to operational gaps.
    remediation: Document database deployment topology including HA
  - id: DEPLOY-HIGH-002
    signal: Single availability zone for production
    evidence_pattern: All components in one AZ
    explanation: |
      Single AZ deployments have zone failure risk. Production
      workloads typically require multi-AZ.
    remediation: Design for multi-AZ deployment
  medium:
  - id: DEPLOY-MED-001
    signal: Missing load balancer for scaled service
    evidence_pattern: Multiple instances but no LB shown
    remediation: Add load balancer to diagram
  - id: DEPLOY-MED-002
    signal: Unclear environment separation
    evidence_pattern: Dev/staging/prod not clearly distinguished
    remediation: Clearly separate environments in diagrams
  low:
  - id: DEPLOY-LOW-001
    signal: Missing infrastructure labels (instance types, etc.)
    remediation: Add sizing/configuration annotations
  positive:
  - id: DEPLOY-POS-001
    signal: Clear multi-AZ/multi-region topology
  - id: DEPLOY-POS-002
    signal: Network boundaries and security controls shown
  - id: DEPLOY-POS-003
    signal: Environment separation clear
procedure:
  context:
    cognitive_mode: critical
    ensemble_role: architect
  steps:
  - id: '1'
    name: Map components to deployment targets
    description: |
      Verify every component has a clear deployment target.
    duration_estimate: 20 min
    questions:
    - Where does each component run?
    - Are compute resources specified?
    - Are container/serverless details provided?
    expected_findings:
    - Deployment target mapping
    - Missing targets
  - id: '2'
    name: Analyze network topology
    description: |
      Examine network paths and boundaries.
    duration_estimate: 25 min
    questions:
    - What network boundaries exist?
    - How does traffic flow between zones?
    - Are trust boundaries marked?
    expected_findings:
    - Network topology assessment
    - Trust boundary identification
  - id: '3'
    name: Check high availability design
    description: |
      Verify HA patterns for critical components.
    duration_estimate: 20 min
    questions:
    - Is multi-AZ deployment planned?
    - Are there single points of failure?
    - Is database HA designed?
    expected_findings:
    - HA assessment
    - SPOF identification
  - id: '4'
    name: Validate security topology
    description: |
      Check security controls at network boundaries.
    duration_estimate: 20 min
    questions:
    - Are public endpoints protected?
    - Is internal traffic segmented?
    - Are secrets management paths clear?
    expected_findings:
    - Security topology assessment
    - Control gaps
  - id: '5'
    name: Document findings
    description: |
      Compile topology issues and recommendations.
    duration_estimate: 15 min
    expected_findings:
    - Topology issues
    - Recommendations
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: topology_assessment
    format: tabular
    sections:
    - Component
    - Deployment Target
    - Network Zone
    - HA Status
    - Issues
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Deployment Topology Analysis
    - Security Assessment
    - Recommendations
profiles:
  membership:
    quick:
      included: false
      reason: Requires infrastructure analysis
    full:
      included: true
      priority: 1
    architecture:
      included: true
      priority: 1
    discovery:
      included: true
      priority: 1
closeout_checklist:
- id: deploy-001
  item: All components have deployment targets
  level: CRITICAL
  verification: manual
  expected: No orphaned components
- id: deploy-002
  item: Network topology documented
  level: CRITICAL
  verification: manual
  expected: Clear network boundaries
- id: deploy-003
  item: High availability design appropriate
  level: BLOCKING
  verification: manual
  expected: Multi-AZ for production
- id: deploy-004
  item: Security controls at trust boundaries
  level: BLOCKING
  verification: manual
  expected: Protected public endpoints
governance:
  applicable_to:
    archetypes:
    - all
relationships:
  commonly_combined:
  - architecture-design.system-decomposition.technology-stack-compatibility
  - cloud-infrastructure.network-design.vpc-architecture
  - devops-ci-cd.deployment.deployment-strategy
discovery:
  file_patterns:
  - glob: '**/*.md'
    purpose: Documentation files
  - glob: '**/*.yaml'
    purpose: Configuration files
  - glob: '**/*.json'
    purpose: JSON configuration
