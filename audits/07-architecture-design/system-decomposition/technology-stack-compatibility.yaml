audit:
  id: architecture-design.system-decomposition.technology-stack-compatibility
  name: Technology Stack Compatibility Audit
  version: 1.0.0
  last_updated: '2026-01-19'
  status: active
  category: architecture-design
  category_number: 7
  subcategory: system-decomposition
  tier: phd
  estimated_duration: 2-3 hours  # median: 2h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: architecture
  default_profiles:
  - full
  - architecture
  - discovery
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit evaluates whether the technologies shown in architecture
    diagrams are compatible with each other. It checks for protocol
    mismatches, version conflicts, known integration issues, and
    unrealistic technology combinations that could block implementation.
  why_it_matters: |
    Incompatible technology choices cause:
    - Blocked implementation when technologies won't integrate
    - Custom integration code that becomes technical debt
    - Performance problems from protocol mismatches
    - Security vulnerabilities from forced workarounds
    - Extended timelines discovering compatibility issues

    Early detection prevents costly technology pivots.
  when_to_run:
  - During Discovery phase when evaluating technology choices
  - During PRD phase when validating feasibility
  - Before finalizing technology decisions
  - When proposing new technology additions
prerequisites:
  required_artifacts:
  - type: architecture_diagram
    description: System architecture diagrams with technology labels
  - type: technology_requirements
    description: PRD or ADR with technology decisions
  access_requirements:
  - Access to architecture diagrams
  - Access to technology documentation
signals:
  critical:
  - id: TECH-CRIT-001
    signal: Incompatible protocol between connected components
    evidence_pattern: gRPC service connected to REST-only client
    explanation: |
      Protocol mismatches require custom adapters or one side must change.
      This is a blocking integration issue.
    remediation: Align protocols or add explicit adapter component
  - id: TECH-CRIT-002
    signal: Database technology incompatible with query patterns
    evidence_pattern: Document DB chosen for highly relational data
    explanation: |
      Mismatched database technology leads to either poor performance
      or complex application-level workarounds.
    remediation: Re-evaluate database choice against data patterns
  high:
  - id: TECH-HIGH-001
    signal: Version conflict between dependent technologies
    evidence_pattern: Spring Boot 2.x with Java 17 (requires Spring Boot 3.x)
    explanation: |
      Version conflicts cause runtime errors or require locked versions
      that miss security updates.
    remediation: Update version matrix to compatible versions
  - id: TECH-HIGH-002
    signal: Missing infrastructure for chosen technology
    evidence_pattern: Kafka chosen but no cluster management shown
    explanation: |
      Technologies that require infrastructure (Kafka, Kubernetes, etc.)
      need that infrastructure documented or it's an unrealistic choice.
    remediation: Add infrastructure requirements or simplify technology
  medium:
  - id: TECH-MED-001
    signal: Technology with limited ecosystem in target environment
    evidence_pattern: Exotic framework with no cloud-native support
    remediation: Evaluate operational implications; consider alternatives
  - id: TECH-MED-002
    signal: Multiple technologies serving same purpose
    evidence_pattern: Both RabbitMQ and Kafka for messaging
    remediation: Consolidate or document clear differentiation
  low:
  - id: TECH-LOW-001
    signal: Technology version not specified
    remediation: Add version requirements to documentation
  positive:
  - id: TECH-POS-001
    signal: Well-established technology combinations
  - id: TECH-POS-002
    signal: Clear version matrix documented
  - id: TECH-POS-003
    signal: Infrastructure requirements explicit
procedure:
  context:
    cognitive_mode: critical
    ensemble_role: architect
  steps:
  - id: '1'
    name: Inventory technology stack
    description: |
      Extract all technologies from architecture diagrams.
    duration_estimate: 20 min
    questions:
    - What languages/frameworks are shown?
    - What databases and data stores?
    - What messaging/integration technologies?
    - What infrastructure components?
    expected_findings:
    - Technology inventory
    - Version information
  - id: '2'
    name: Identify integration points
    description: |
      Map where technologies must integrate.
    duration_estimate: 20 min
    questions:
    - Which components communicate with each other?
    - What protocols are implied?
    - What data formats are exchanged?
    expected_findings:
    - Integration point map
    - Protocol requirements
  - id: '3'
    name: Validate compatibility
    description: |
      Research compatibility of each integration point.
    duration_estimate: 40 min
    questions:
    - Are protocols compatible?
    - Are versions compatible?
    - Are there known integration issues?
    expected_findings:
    - Compatibility assessment
    - Known issues
  - id: '4'
    name: Check infrastructure requirements
    description: |
      Verify infrastructure needed for each technology is documented.
    duration_estimate: 20 min
    questions:
    - What infrastructure does each technology require?
    - Is that infrastructure shown in diagrams?
    - Is operational complexity acceptable?
    expected_findings:
    - Infrastructure gaps
    - Operational concerns
  - id: '5'
    name: Document findings
    description: |
      Compile compatibility issues and recommendations.
    duration_estimate: 20 min
    expected_findings:
    - Compatibility issues
    - Recommendations
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: compatibility_matrix
    format: tabular
    sections:
    - Technology A
    - Technology B
    - Integration Point
    - Compatibility Status
    - Notes
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Stack Assessment
    - Compatibility Issues
    - Recommendations
profiles:
  membership:
    quick:
      included: false
      reason: Requires research
    full:
      included: true
      priority: 1
    architecture:
      included: true
      priority: 1
    discovery:
      included: true
      priority: 1
closeout_checklist:
- id: tech-001
  item: All technology integrations are compatible
  level: CRITICAL
  verification: manual
  expected: No blocking incompatibilities
- id: tech-002
  item: Version matrix documented
  level: BLOCKING
  verification: manual
  expected: Compatible versions specified
- id: tech-003
  item: Infrastructure requirements explicit
  level: BLOCKING
  verification: manual
  expected: Required infrastructure documented
governance:
  applicable_to:
    archetypes:
    - all
relationships:
  commonly_combined:
  - architecture-design.system-decomposition.architecture-style-consistency
  - architecture-design.system-decomposition.deployment-topology
discovery:
  file_patterns:
  - glob: '**/*.md'
    purpose: Documentation files
  - glob: '**/*.yaml'
    purpose: Configuration files
  - glob: '**/*.json'
    purpose: JSON configuration
