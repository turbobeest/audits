audit:
  id: machine-learning-ai.model-monitoring.prediction-logging
  name: Prediction Logging Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: machine-learning-ai
  category_number: 37
  subcategory: model-monitoring
  tier: expert
  estimated_duration: 3-5 hours  # median: 4h
  completeness: requires_discovery
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: ml-systems
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates prediction logging practices including what data is captured, storage
    mechanisms, retention policies, and accessibility for analysis. Examines whether
    prediction logs enable debugging, monitoring, and compliance requirements.
  why_it_matters: |
    Prediction logs are essential for debugging production issues, computing delayed
    performance metrics, auditing decisions, and training new models. Without proper
    logging, many critical MLOps capabilities are impossible.
  when_to_run:
  - When setting up production ML systems
  - After logging gaps discovered
  - During compliance audits
  - Before model deployment
prerequisites:
  required_artifacts:
  - type: logging_infrastructure
    description: Access to prediction logging systems
  - type: log_schemas
    description: Prediction log schemas
  - type: retention_policies
    description: Data retention documentation
  access_requirements:
  - Access to logging infrastructure
  - Access to log storage
  - Access to log analysis tools
  - Access to retention configurations
discovery:
  file_patterns:
  - glob: '**/logging/**/*.py'
    purpose: Find logging code
  - glob: '**/prediction_log/**'
    purpose: Find prediction logging
  - glob: '**/schemas/**'
    purpose: Find log schemas
knowledge_sources:
  guides:
  - id: ml-logging
    name: ML Prediction Logging Guide
    url: https://ml-ops.org/content/mlops-principles
  - id: logging-best-practices
    name: Logging Best Practices
    url: https://cloud.google.com/logging/docs/best-practices
  standards:
  - id: ml-logging-standards
    name: ML Logging Standards
    relevance: Production ML logging requirements
tooling:
  analysis_tools:
  - tool: bigquery
    purpose: Log storage and analysis
  - tool: elasticsearch
    purpose: Log search and analysis
  - tool: s3
    purpose: Log storage
  - tool: whylogs
    purpose: Prediction profiling
signals:
  critical:
  - id: PL-CRIT-001
    signal: No prediction logging in production
    evidence_indicators:
    - Predictions not stored
    - Unable to debug production issues
    - No data for performance computation
    explanation: |
      Without prediction logging, debugging issues is nearly impossible and performance
      monitoring relies on real-time metrics only, missing delayed feedback.
    remediation: Implement comprehensive prediction logging
  - id: PL-CRIT-002
    signal: Sensitive data logged without protection
    evidence_indicators:
    - PII in prediction logs
    - No encryption or access controls
    - Retention exceeds requirements
    explanation: |
      Logging sensitive data without protection creates privacy and compliance risks,
      potentially violating regulations.
    remediation: Implement data protection and appropriate retention
  high:
  - id: PL-HIGH-001
    signal: Input features not logged
    remediation: Log input features for debugging and analysis
  - id: PL-HIGH-002
    signal: Model version not logged
    remediation: Include model version in all prediction logs
  - id: PL-HIGH-003
    signal: Logs not queryable
    remediation: Store logs in queryable format
  medium:
  - id: PL-MED-001
    signal: Log latency too high
    remediation: Reduce logging latency for timely analysis
  - id: PL-MED-002
    signal: Log schema not versioned
    remediation: Version log schemas for compatibility
  - id: PL-MED-003
    signal: No sampling for high-volume models
    remediation: Implement log sampling strategies
  low:
  - id: PL-LOW-001
    signal: Log documentation incomplete
    remediation: Document log schemas and meanings
  - id: PL-LOW-002
    signal: Log storage not optimized
    remediation: Optimize storage for cost and performance
  positive:
  - id: PL-POS-001
    signal: Comprehensive prediction logging with features
  - id: PL-POS-002
    signal: Proper data protection and retention
  - id: PL-POS-003
    signal: Queryable logs for analysis
procedure:
  context:
    cognitive_mode: evaluative
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Review Log Coverage
    description: Assess what data is logged
    duration_estimate: 45 minutes
  - id: '2'
    name: Check Data Protection
    description: Verify sensitive data handling
    duration_estimate: 45 minutes
  - id: '3'
    name: Assess Queryability
    description: Test log analysis capabilities
    duration_estimate: 30 minutes
  - id: '4'
    name: Review Retention
    description: Check retention policies and compliance
    duration_estimate: 30 minutes
  - id: '5'
    name: Test Log Access
    description: Verify ability to query and analyze logs
    duration_estimate: 30 minutes
  - id: '6'
    name: Evaluate Storage
    description: Review storage efficiency and costs
    duration_estimate: 30 minutes
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Logging Coverage
    - Data Protection Assessment
    - Storage Analysis
    - Recommendations
closeout_checklist:
- id: pl-001
  item: Log coverage verified
  level: CRITICAL
  verification: automated
- id: pl-002
  item: Data protection assessed
  level: CRITICAL
  verification: manual
- id: pl-003
  item: Retention compliance checked
  level: HIGH
  verification: manual
governance:
  applicable_to:
    archetypes:
    - ml-systems
    - ai-applications
  compliance_mappings:
  - framework: GDPR
    control: Data Protection
    description: Personal data logging requirements
  - framework: EU AI Act
    control: Logging
    description: AI system logging requirements
relationships:
  commonly_combined:
  - machine-learning-ai.model-monitoring.performance-monitoring
  - privacy-security.data-privacy
  depends_on:
  - machine-learning-ai.model-deployment.model-serving
  feeds_into:
  - machine-learning-ai.model-monitoring.performance-monitoring
