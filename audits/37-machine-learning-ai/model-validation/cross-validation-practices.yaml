audit:
  id: machine-learning-ai.model-validation.cross-validation-practices
  name: Cross-Validation Practices Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: machine-learning-ai
  category_number: 37
  subcategory: model-validation
  tier: expert
  estimated_duration: 3-4 hours  # median: 3h
  completeness: requires_discovery
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: ml-systems
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates cross-validation strategies including CV scheme selection, implementation
    correctness, data leakage prevention, and appropriate use for different data types.
    Examines whether CV provides reliable estimates of model generalization performance.
  why_it_matters: |
    Cross-validation is critical for reliable model evaluation, but improper implementation
    can lead to overly optimistic estimates that don't reflect real-world performance.
    Correct CV practices ensure models are evaluated fairly and selection decisions
    are based on reliable data.
  when_to_run:
  - During model development
  - When establishing validation practices
  - After CV-related bugs discovered
  - During model comparison reviews
prerequisites:
  required_artifacts:
  - type: cv_code
    description: Access to cross-validation implementations
  - type: data_characteristics
    description: Information about data structure
  - type: cv_results
    description: Historical CV results
  access_requirements:
  - Access to validation code
  - Access to data splitting logic
  - Access to CV results and analysis
discovery:
  file_patterns:
  - glob: '**/validation/**/*.py'
    purpose: Find validation code
  - glob: '**/cv/**'
    purpose: Find cross-validation code
  - glob: '**/split*.py'
    purpose: Find splitting logic
knowledge_sources:
  guides:
  - id: sklearn-cv
    name: Scikit-learn Cross-Validation Guide
    url: https://scikit-learn.org/stable/modules/cross_validation.html
  - id: nested-cv
    name: Nested Cross-Validation Guide
    url: https://machinelearningmastery.com/nested-cross-validation-for-machine-learning-with-python/
  standards:
  - id: cv-best-practices
    name: Cross-Validation Best Practices
    relevance: Reliable model validation strategies
tooling:
  analysis_tools:
  - tool: sklearn.model_selection
    purpose: Cross-validation utilities
  - tool: timeseries-cv
    purpose: Time series cross-validation
  - tool: stratified-kfold
    purpose: Stratified sampling
signals:
  critical:
  - id: CV-CRIT-001
    signal: Data leakage in cross-validation
    evidence_indicators:
    - Preprocessing fit on full data before CV
    - Feature selection using all data
    - Information leaking between folds
    explanation: |
      Data leakage in CV invalidates all performance estimates, making models appear
      better than they actually are and leading to poor production performance.
    remediation: Use pipelines to ensure preprocessing is fold-aware
  - id: CV-CRIT-002
    signal: Wrong CV scheme for data type
    evidence_indicators:
    - Random CV on time series data
    - Ignoring group structure in grouped data
    - Not accounting for spatial correlation
    explanation: |
      Using inappropriate CV schemes produces unreliable estimates that don't reflect
      how the model will perform on truly unseen data.
    remediation: Select CV scheme appropriate for data structure
  high:
  - id: CV-HIGH-001
    signal: No nested CV for hyperparameter tuning
    remediation: Implement nested CV to avoid selection bias
  - id: CV-HIGH-002
    signal: Too few CV folds for reliable estimates
    remediation: Increase number of folds or use repeated CV
  - id: CV-HIGH-003
    signal: CV variance not reported
    remediation: Report standard deviation across folds
  medium:
  - id: CV-MED-001
    signal: Stratification not used for imbalanced data
    remediation: Use stratified K-fold for imbalanced datasets
  - id: CV-MED-002
    signal: CV results not reproducible
    remediation: Fix random seeds for reproducible CV
  - id: CV-MED-003
    signal: No held-out test set after CV
    remediation: Reserve final test set for unbiased evaluation
  low:
  - id: CV-LOW-001
    signal: CV implementation not documented
    remediation: Document CV strategy and rationale
  - id: CV-LOW-002
    signal: Using deprecated CV utilities
    remediation: Update to current best practices
  positive:
  - id: CV-POS-001
    signal: Appropriate CV scheme with no leakage
  - id: CV-POS-002
    signal: Nested CV for model selection
  - id: CV-POS-003
    signal: Proper variance estimation reported
procedure:
  context:
    cognitive_mode: evaluative
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Review CV Strategy
    description: Assess appropriateness of CV scheme for data
    duration_estimate: 45 minutes
  - id: '2'
    name: Check for Data Leakage
    description: Verify no information leaks between folds
    duration_estimate: 45 minutes
  - id: '3'
    name: Validate Implementation
    description: Review CV code for correctness
    duration_estimate: 45 minutes
  - id: '4'
    name: Assess Statistical Rigor
    description: Check fold count and variance reporting
    duration_estimate: 30 minutes
  - id: '5'
    name: Review Nested CV
    description: Evaluate CV for hyperparameter selection
    duration_estimate: 30 minutes
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - CV Strategy Analysis
    - Leakage Assessment
    - Statistical Review
    - Recommendations
closeout_checklist:
- id: cv-001
  item: CV scheme appropriateness verified
  level: CRITICAL
  verification: manual
- id: cv-002
  item: Data leakage checked
  level: CRITICAL
  verification: manual
- id: cv-003
  item: Statistical rigor assessed
  level: HIGH
  verification: manual
governance:
  applicable_to:
    archetypes:
    - ml-systems
    - ai-applications
  compliance_mappings:
  - framework: EU AI Act
    control: Validation Methods
    description: Requirements for AI system validation approaches
relationships:
  commonly_combined:
  - machine-learning-ai.model-validation.model-testing
  - machine-learning-ai.data-quality.data-leakage-detection
  depends_on:
  - machine-learning-ai.data-quality.training-data-quality
  feeds_into:
  - machine-learning-ai.model-development.hyperparameter-tuning
