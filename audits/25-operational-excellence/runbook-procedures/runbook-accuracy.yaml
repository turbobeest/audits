audit:
  id: operational-excellence.runbook-procedures.runbook-accuracy
  name: Runbook Accuracy Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: operational-excellence
  category_number: 25
  subcategory: runbook-procedures
  tier: phd
  estimated_duration: 3-4 hours  # median: 3h
  completeness: complete
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: documentation
  default_profiles:
  - full
  - production
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines runbook accuracy including:
    - Commands and procedures match current systems
    - URLs and links are valid and accessible
    - Contact information is current
    - Screenshots and examples reflect current UI
    - Thresholds and values match actual configurations
    - Referenced tools and systems exist
    - Procedures have been validated recently
    - Version alignment with documented systems
  why_it_matters: |
    Inaccurate runbooks are worse than no runbooks:
    - Following outdated procedures can cause additional damage
    - Invalid contacts waste time during critical incidents
    - Wrong commands may not work or cause harm
    - Responders lose trust in documentation

    Google SRE emphasizes that runbooks must be maintained as living
    documents. Inaccurate documentation creates false confidence and
    can extend incident resolution time rather than reduce it.
  when_to_run:
  - Quarterly operational reviews
  - After system changes or upgrades
  - When runbook failures occur during incidents
  - Before on-call rotation changes
  - After post-incident reviews cite documentation issues
prerequisites:
  required_artifacts:
  - type: runbook_documentation
    description: Runbook files to be validated
  - type: system_access
    description: Access to validate commands and procedures
  - type: contact_directory
    description: Current contact information source
  access_requirements:
  - Read access to runbook documentation
  - Ability to validate commands (non-destructive)
  - Contact directory access
  - URL validation capability
discovery:
  code_patterns:
  - pattern: (last.updated|last.review|modified|validated)
    type: regex
    scope: docs
    purpose: Detect runbook update timestamps
  - pattern: (http|https)://[a-zA-Z0-9./-]+
    type: regex
    scope: docs
    purpose: Detect URLs for validation
  - pattern: '```(bash|shell|sh|command)'
    type: regex
    scope: docs
    purpose: Detect command blocks for validation
  file_patterns:
  - glob: '**/runbook*/**/*.md'
    purpose: Runbook files
  - glob: '**/playbook*/**/*.md'
    purpose: Playbook files
knowledge_sources:
  specifications:
  - id: google-sre-documentation
    name: Google SRE - Documentation Best Practices
    url: https://sre.google/workbook/documentation/
    offline_cache: true
    priority: required
  guides:
  - id: documentation-maintenance
    name: Technical Documentation Maintenance
    url: https://www.writethedocs.org/guide/docs-as-code/
    offline_cache: true
tooling:
  static_analysis:
  - tool: link-checker
    purpose: Validate URLs in runbooks
    offline_capable: false
  - tool: markdown-lint
    purpose: Validate markdown structure
    offline_capable: true
  scripts:
  - id: runbook-link-checker
    language: bash
    purpose: Extract and check URLs in runbooks
    source: inline
    code: |
      #!/bin/bash
      echo "=== Runbook URL Extraction ==="
      grep -rhnoE "(https?://[a-zA-Z0-9./_-]+)" \
        --include="*.md" . 2>/dev/null | sort -u | head -30
signals:
  critical:
  - id: RA-CRIT-001
    signal: Runbook procedures cause system damage when followed
    evidence_indicators:
    - Commands documented incorrectly
    - Procedures missing safety checks
    - Destructive commands not clearly marked
    explanation: |
      Runbooks with dangerous inaccuracies can turn minor incidents into
      major outages. Incorrect commands, missing safety steps, or outdated
      procedures can cause data loss, extended outages, or cascading failures.
    remediation: |
      - Immediately quarantine affected runbooks
      - Add warning banners for unvalidated content
      - Implement runbook validation testing
      - Require peer review for procedure changes
      - Add safety check reminders to all destructive operations
  - id: RA-CRIT-002
    signal: Critical contact information is invalid
    evidence_indicators:
    - Escalation contacts departed or changed roles
    - Phone numbers disconnected
    - Slack/Teams channels archived
    explanation: |
      Invalid contact information during incidents causes critical delays.
      When escalation contacts cannot be reached, incidents escalate in
      severity while responders search for current contacts.
    remediation: |
      - Validate all contact information immediately
      - Implement automated contact validation
      - Integrate with HR/directory systems
      - Remove departed employees
      - Schedule monthly contact audits
  high:
  - id: RA-HIGH-001
    signal: Runbooks not updated after system changes
    evidence_indicators:
    - Last updated date predates recent deployments
    - Referenced systems have been deprecated
    - Version numbers don't match current systems
    explanation: |
      System changes without corresponding runbook updates create drift
      between documentation and reality. Over time, runbooks become
      increasingly inaccurate and eventually useless.
    remediation: |
      - Link runbook updates to deployment process
      - Require runbook review for system changes
      - Track runbook-system version alignment
      - Flag stale runbooks automatically
      - Assign runbook maintenance ownership
  - id: RA-HIGH-002
    signal: Commands in runbooks fail or produce errors
    evidence_indicators:
    - CLI commands use deprecated syntax
    - Tool names or paths have changed
    - Required permissions not documented
    explanation: |
      Commands that fail during incidents frustrate responders and waste
      critical time. Every command in a runbook should be tested and
      validated against current systems.
    remediation: |
      - Test all runbook commands regularly
      - Implement automated command validation
      - Document required permissions
      - Update commands after tool upgrades
      - Include expected output examples
  medium:
  - id: RA-MED-001
    signal: URLs and links are broken
    evidence_indicators:
    - Dashboard links return 404
    - Documentation links redirect incorrectly
    - Tool URLs have changed
    explanation: |
      Broken links slow incident response and reduce confidence in
      documentation. Links to dashboards, related docs, and tools should
      be validated regularly.
    remediation: |
      - Implement automated link checking
      - Fix or remove broken links
      - Use stable URLs where possible
      - Set up redirects for moved resources
      - Check links during documentation review
  - id: RA-MED-002
    signal: Screenshots and examples are outdated
    evidence_indicators:
    - UI screenshots show old interface
    - Example outputs don't match current behavior
    - Configuration examples use deprecated settings
    explanation: |
      Outdated visual examples cause confusion when responders see different
      screens than documented. This slows diagnosis and may lead to incorrect
      actions based on misidentification.
    remediation: |
      - Update screenshots after UI changes
      - Regenerate examples with current systems
      - Date screenshots for context
      - Consider animated captures for dynamic content
      - Include version information in examples
  - id: RA-MED-003
    signal: No runbook review or validation process
    evidence_indicators:
    - No scheduled review cadence
    - No validation testing for procedures
    - Updates happen only after incidents
    explanation: |
      Without proactive review, runbooks drift toward inaccuracy over time.
      Regular validation catches issues before they impact incident response.
    remediation: |
      - Establish quarterly review cycle
      - Implement runbook testing (dry runs)
      - Track review dates and owners
      - Include review in on-call handoff
      - Use incident feedback for improvement
  low:
  - id: RA-LOW-001
    signal: Runbook metadata not maintained
    evidence_indicators:
    - Missing last_updated timestamps
    - No version information
    - Owner information missing
    explanation: |
      Metadata helps assess runbook reliability. Missing timestamps make
      it impossible to know if documentation is current, and missing
      ownership delays updates.
    remediation: |
      - Add required metadata fields
      - Automate last_updated on changes
      - Assign owners to all runbooks
      - Display metadata prominently
      - Track metadata compliance
  positive:
  - id: RA-POS-001
    signal: Runbooks validated regularly with automated testing
    evidence_indicators:
    - Automated link checking enabled
    - Command validation tests run regularly
    - Review dates are recent across all runbooks
  - id: RA-POS-002
    signal: Runbook updates linked to system changes
    evidence_indicators:
    - Deployment process includes runbook review
    - System changes trigger documentation updates
    - Version alignment maintained
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Currency Assessment
    description: |
      Evaluate runbook update dates and version alignment.
    duration_estimate: 30 min
    commands:
    - purpose: Find runbooks with update dates
      command: |
        grep -rniE "(last.updated|last.review|modified).*[0-9]{4}" \
          --include="*.md" . 2>/dev/null | head -30
    - purpose: Find old runbooks (not updated in 6+ months)
      command: |
        find . -name "*runbook*.md" -mtime +180 2>/dev/null | head -20
    expected_findings:
    - Last update timestamps
    - Stale runbooks identified
    - Version information
  - id: '2'
    name: Link Validation
    description: |
      Extract and validate URLs in runbooks.
    duration_estimate: 30 min
    commands:
    - purpose: Extract URLs from runbooks
      command: |
        grep -rhnoE "https?://[a-zA-Z0-9./_?&=-]+" \
          --include="*runbook*.md" . 2>/dev/null | sort -u | head -50
    expected_findings:
    - URL inventory
    - Broken link candidates
    - Internal vs external links
  - id: '3'
    name: Command Validation
    description: |
      Identify commands for validation against current systems.
    duration_estimate: 45 min
    commands:
    - purpose: Find command blocks in runbooks
      command: |
        grep -rniE "^\`\`\`(bash|shell|sh|command)" \
          --include="*.md" -A 5 . 2>/dev/null | head -50
    - purpose: Find kubectl/aws/gcloud commands
      command: |
        grep -rniE "(kubectl|aws|gcloud|terraform|docker)" \
          --include="*runbook*.md" . 2>/dev/null | head -30
    expected_findings:
    - Command inventory
    - Tool versions referenced
    - Commands for validation
  - id: '4'
    name: Contact Information Validation
    description: |
      Verify contact information is current.
    duration_estimate: 30 min
    commands:
    - purpose: Find contact information in runbooks
      command: |
        grep -rniE "(contact|escalat|owner|page|call|slack|email)" \
          --include="*runbook*.md" . 2>/dev/null | head -30
    - purpose: Find Slack channel references
      command: |
        grep -rniE "#[a-z0-9_-]+" \
          --include="*runbook*.md" . 2>/dev/null | head -20
    expected_findings:
    - Contact inventory
    - Slack channels
    - Email addresses
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Currency Assessment
    - Link Validation Results
    - Command Validation Status
    - Contact Information Audit
    - Recommendations
  - type: validation_report
    format: table
    description: Runbook validation status by file
  confidence_guidance:
    high: Full validation testing completed
    medium: Partial validation, some items require runtime check
    low: Static analysis only, runtime validation needed
offline:
  capability: partial
  runtime_required_for:
  - Link validation
  - Command testing
  - Contact verification
  cache_manifest:
    knowledge:
    - source_id: google-sre-documentation
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Accuracy audit requires thorough validation
    full:
      included: true
      priority: 2
    production:
      included: true
      priority: 2
closeout_checklist:
- id: ra-001
  item: Runbooks updated within last 6 months
  level: CRITICAL
  verification: |
    find . -name "*runbook*.md" -mtime +180 2>/dev/null | \
      wc -l | xargs -I{} test {} -eq 0 && echo "PASS" || echo "FAIL"
  expected: PASS
- id: ra-002
  item: Contact information validated
  level: CRITICAL
  verification: manual
  verification_notes: Verify escalation contacts are current and reachable
  expected: Confirmed by reviewer
- id: ra-003
  item: URLs and links are valid
  level: BLOCKING
  verification: manual
  verification_notes: Sample URLs verified as accessible
  expected: Confirmed by reviewer
- id: ra-004
  item: Commands tested against current systems
  level: WARNING
  verification: manual
  verification_notes: Sample commands validated in test environment
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: SOC 2
    controls:
    - CC7.4
  - framework: ISO 27001
    controls:
    - A.12.1.1
relationships:
  commonly_combined:
  - operational-excellence.runbook-procedures.runbook-completeness
  - operational-excellence.runbook-procedures.runbook-testing
  - operational-excellence.incident-management.incident-response-process
