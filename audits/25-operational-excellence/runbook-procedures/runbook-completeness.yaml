audit:
  id: operational-excellence.runbook-procedures.runbook-completeness
  name: Runbook Completeness Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: operational-excellence
  category_number: 25
  subcategory: runbook-procedures
  tier: phd
  estimated_duration: 3-4 hours  # median: 3h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: documentation
  default_profiles:
  - full
  - production
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines runbook completeness including:
    - Coverage of all production services and components
    - Common operational scenarios documented
    - Alert-to-runbook mapping completeness
    - Escalation and contact information inclusion
    - Recovery procedures for all failure modes
    - Runbook structure and consistency
    - Service dependency documentation
    - Required information presence (symptoms, diagnosis, remediation)
  why_it_matters: |
    Complete runbooks enable effective incident response:
    - On-call responders can handle unfamiliar issues
    - Consistent procedures reduce human error
    - Knowledge transfer between team members is simplified
    - Response time decreases when procedures are documented

    Google SRE emphasizes that runbooks are essential for managing toil
    and enabling consistent operations. Incomplete runbooks force responders
    to improvise during incidents, increasing both MTTR and stress.
  when_to_run:
  - Quarterly operational reviews
  - Before on-call rotation changes
  - When new services launch
  - After incidents without runbook coverage
  - During compliance audits
prerequisites:
  required_artifacts:
  - type: runbook_repository
    description: Runbook documentation location
  - type: service_inventory
    description: List of production services
  - type: alert_definitions
    description: Alert rule definitions
  access_requirements:
  - Read access to runbook documentation
  - Service inventory access
  - Alert configuration access
  - Monitoring system access
discovery:
  code_patterns:
  - pattern: (runbook|playbook|procedure|troubleshoot)
    type: regex
    scope: docs
    purpose: Detect runbook documentation
  - pattern: (symptom|diagnos|remediat|resolution|recovery)
    type: regex
    scope: docs
    purpose: Detect runbook content sections
  - pattern: (alert|alarm).*(runbook|link|url|doc)
    type: regex
    scope: config
    purpose: Detect alert-to-runbook links
  file_patterns:
  - glob: '**/runbook*/**/*.md'
    purpose: Runbook directories
  - glob: '**/playbook*/**/*.md'
    purpose: Playbook directories
  - glob: '**/ops/**/*.md'
    purpose: Operations documentation
  - glob: '**/troubleshoot*/**/*.md'
    purpose: Troubleshooting guides
knowledge_sources:
  specifications:
  - id: google-sre-runbooks
    name: Google SRE - Runbook Guidelines
    url: https://sre.google/sre-book/accelerating-sre-on-call/
    offline_cache: true
    priority: required
  guides:
  - id: pagerduty-runbooks
    name: PagerDuty Runbook Best Practices
    url: https://www.pagerduty.com/resources/learn/what-is-a-runbook/
    offline_cache: true
tooling:
  static_analysis:
  - tool: runbook-scanner
    purpose: Analyze runbook coverage and structure
    offline_capable: true
  scripts:
  - id: runbook-coverage-scanner
    language: bash
    purpose: Scan for runbook coverage
    source: inline
    code: |
      #!/bin/bash
      echo "=== Runbook Coverage Scan ==="
      echo "Runbook files found:"
      find . -type f \( -name "*runbook*" -o -name "*playbook*" \) -name "*.md" 2>/dev/null | wc -l
      echo ""
      echo "Alert references to runbooks:"
      grep -rniE "(runbook|playbook)" --include="*.yaml" --include="*.json" . 2>/dev/null | wc -l
signals:
  critical:
  - id: RC-CRIT-001
    signal: No runbooks exist for production services
    evidence_indicators:
    - No runbook documentation found
    - Zero runbook references in alerts
    - Operations rely on tribal knowledge
    explanation: |
      Production services without runbooks depend entirely on responder
      knowledge and improvisation. This is fragile, error-prone, and
      unsustainable as teams grow and rotate. Google SRE identifies
      runbooks as essential to reliable operations.
    remediation: |
      - Prioritize runbooks for critical services
      - Create runbook template
      - Assign runbook ownership per service
      - Schedule runbook creation sprints
      - Link alerts to runbooks
  - id: RC-CRIT-002
    signal: Critical alerts have no associated runbooks
    evidence_indicators:
    - High-severity alerts without runbook links
    - On-call cannot find relevant procedures
    - Alert annotations missing runbook URLs
    explanation: |
      Alerts without runbooks leave responders without guidance during
      critical situations. Every alert that can page someone should have
      associated documentation explaining symptoms, diagnosis, and remediation.
    remediation: |
      - Audit all critical/high severity alerts
      - Create runbook for each paging alert
      - Add runbook links to alert annotations
      - Block alert deployment without runbook
      - Review alert-runbook coverage regularly
  high:
  - id: RC-HIGH-001
    signal: Runbooks missing essential sections
    evidence_indicators:
    - No symptom descriptions
    - Missing diagnostic steps
    - Remediation procedures absent
    - No escalation information
    explanation: |
      Incomplete runbooks may exist but fail to provide actionable guidance.
      A complete runbook includes: symptoms, impact assessment, diagnostic
      commands, remediation steps, escalation contacts, and rollback procedures.
    remediation: |
      - Define required runbook sections
      - Create comprehensive template
      - Audit existing runbooks for gaps
      - Fill gaps with subject matter experts
      - Validate completeness during review
  - id: RC-HIGH-002
    signal: New services deployed without runbooks
    evidence_indicators:
    - Recent services have no documentation
    - No runbook requirement in deployment process
    - Launch checklist doesn't include runbooks
    explanation: |
      Services launched without runbooks create operational debt and risk.
      Runbook creation should be a mandatory part of production readiness,
      not an afterthought addressed during the first incident.
    remediation: |
      - Add runbook to production readiness checklist
      - Block deployment without runbook approval
      - Create runbook during service development
      - Review runbook before launch
      - Assign runbook ownership at launch
  medium:
  - id: RC-MED-001
    signal: Runbook structure inconsistent
    evidence_indicators:
    - Different formats across runbooks
    - Section names vary
    - Information location unpredictable
    explanation: |
      Inconsistent runbook structure increases cognitive load during incidents.
      Responders must learn each runbook's format instead of quickly finding
      needed information. Standardization improves usability.
    remediation: |
      - Define standard runbook template
      - Migrate existing runbooks to template
      - Enforce template in review process
      - Use automated linting for structure
      - Train authors on template usage
  - id: RC-MED-002
    signal: Service dependencies not documented in runbooks
    evidence_indicators:
    - Upstream/downstream services not listed
    - No architecture diagrams
    - Dependency failure impact unclear
    explanation: |
      Modern services have complex dependencies. Runbooks should document
      what the service depends on and what depends on it, enabling responders
      to quickly assess blast radius and identify root causes.
    remediation: |
      - Add dependency section to runbook template
      - Document upstream and downstream services
      - Include architecture diagrams
      - Note dependency failure symptoms
      - Update dependencies when architecture changes
  low:
  - id: RC-LOW-001
    signal: Runbook coverage metrics not tracked
    evidence_indicators:
    - Coverage percentage unknown
    - No runbook coverage dashboard
    - Gaps not systematically identified
    explanation: |
      Without coverage metrics, organizations cannot prioritize runbook
      creation or demonstrate improvement. Tracking coverage enables
      targeted investment in documentation.
    remediation: |
      - Calculate current coverage percentage
      - Create coverage dashboard
      - Set coverage targets
      - Track coverage trends
      - Report on coverage quarterly
  positive:
  - id: RC-POS-001
    signal: Comprehensive runbook coverage
    evidence_indicators:
    - Runbooks exist for all production services
    - All paging alerts linked to runbooks
    - Consistent structure across runbooks
  - id: RC-POS-002
    signal: Runbook completeness enforced in process
    evidence_indicators:
    - Runbook required for production launch
    - Alert-runbook linking mandatory
    - Regular coverage reviews conducted
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Runbook Inventory
    description: |
      Identify all runbook documentation and assess coverage.
    duration_estimate: 45 min
    commands:
    - purpose: Find all runbooks
      command: |
        find . -type f \( -name "*runbook*" -o -name "*playbook*" -o -name "*procedure*" \) \
          -name "*.md" 2>/dev/null | head -50
    - purpose: Count runbooks per directory
      command: |
        find . -type f -name "*.md" -path "*runbook*" 2>/dev/null | \
          xargs -I{} dirname {} | sort | uniq -c | sort -rn | head -20
    expected_findings:
    - Runbook file listing
    - Distribution across services
    - Runbook count
  - id: '2'
    name: Alert-Runbook Mapping Review
    description: |
      Verify alerts reference appropriate runbooks.
    duration_estimate: 30 min
    commands:
    - purpose: Find alert-runbook references
      command: |
        grep -rniE "(runbook|playbook|documentation).*(url|link|http)" \
          --include="*.yaml" --include="*.json" . 2>/dev/null | head -30
    - purpose: Find alerts without runbook links
      command: |
        grep -rniE "severity.*(critical|high|warning)" \
          --include="*.yaml" . 2>/dev/null | grep -v runbook | head -30
    expected_findings:
    - Alert-runbook mappings
    - Alerts without runbook links
    - Coverage gaps
  - id: '3'
    name: Runbook Structure Analysis
    description: |
      Assess runbook structure and completeness.
    duration_estimate: 30 min
    commands:
    - purpose: Check for standard sections
      command: |
        find . -name "*runbook*.md" -exec grep -l -iE "(symptom|diagnos|remediat)" {} \; 2>/dev/null | wc -l
    - purpose: Find runbooks missing key sections
      command: |
        find . -name "*runbook*.md" -exec sh -c 'grep -q -iE "remediat" "$1" || echo "$1"' _ {} \; 2>/dev/null | head -20
    expected_findings:
    - Structure compliance
    - Missing sections
    - Template adherence
  - id: '4'
    name: Service-Runbook Coverage Gap Analysis
    description: |
      Compare service inventory to runbook coverage.
    duration_estimate: 30 min
    commands:
    - purpose: Find service definitions
      command: |
        grep -rniE "(service|application).*name" \
          --include="*.yaml" --include="*.tf" . 2>/dev/null | head -30
    - purpose: List runbook service coverage
      command: |
        find . -name "*runbook*.md" -exec basename {} .md \; 2>/dev/null | sort | head -30
    expected_findings:
    - Service inventory
    - Runbook coverage list
    - Coverage gaps
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Coverage Assessment
    - Structure Analysis
    - Gap Inventory
    - Recommendations
  - type: coverage_matrix
    format: table
    description: Services and their runbook coverage status
  confidence_guidance:
    high: Runbook repository fully accessible and structured
    medium: Partial runbook access, some coverage inferred
    low: Runbook location or coverage unclear
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: google-sre-runbooks
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Completeness audit requires comprehensive review
    full:
      included: true
      priority: 2
    production:
      included: true
      priority: 1
closeout_checklist:
- id: rc-001
  item: Runbooks exist for all production services
  level: CRITICAL
  verification: manual
  verification_notes: Verify each production service has corresponding runbook
  expected: Confirmed by reviewer
- id: rc-002
  item: Critical alerts have runbook links
  level: CRITICAL
  verification: |
    grep -rniE "severity.*(critical|high)" --include="*.yaml" . 2>/dev/null | \
      grep -c runbook | xargs -I{} test {} -gt 0 && echo "PASS" || echo "FAIL"
  expected: PASS
- id: rc-003
  item: Runbooks contain required sections
  level: BLOCKING
  verification: manual
  verification_notes: Sample runbooks for symptoms, diagnosis, remediation sections
  expected: Confirmed by reviewer
- id: rc-004
  item: Runbook structure is consistent
  level: WARNING
  verification: manual
  verification_notes: Verify runbooks follow standard template
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: SOC 2
    controls:
    - CC7.4
  - framework: ISO 27001
    controls:
    - A.12.1.1
  - framework: ITIL 4
    controls:
    - Knowledge Management
relationships:
  commonly_combined:
  - operational-excellence.runbook-procedures.runbook-accuracy
  - operational-excellence.incident-management.incident-response-process
  - operational-excellence.production-readiness.documentation-readiness
