audit:
  id: operational-excellence.runbook-procedures.emergency-procedures
  name: Emergency Procedures Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: operational-excellence
  category_number: 25
  subcategory: runbook-procedures
  tier: phd
  estimated_duration: 2-3 hours  # median: 2h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: critical
  scope: process
  default_profiles:
  - full
  - production
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines emergency operational procedures including:
    - Major incident response procedures
    - Data breach response procedures
    - Security incident response
    - System failure emergency actions
    - Emergency shutdown procedures
    - Communication during emergencies
    - Emergency contact lists
    - Business continuity procedures
  why_it_matters: |
    Emergency procedures can mean the difference between containment and catastrophe:
    - Rapid response limits damage during critical events
    - Clear procedures reduce confusion under pressure
    - Regulatory compliance often requires documented emergency responses
    - Stakeholder confidence depends on prepared responses

    The Google SRE Workbook notes that emergency procedures must be
    "well-documented, well-tested, and well-understood" because
    emergencies are exactly when ad-hoc responses fail most severely.
  when_to_run:
  - Annual emergency preparedness review
  - After emergency events
  - During compliance audits
  - When critical systems change
  - Before peak traffic periods
prerequisites:
  required_artifacts:
  - type: emergency_documentation
    description: Emergency procedure documentation
  - type: contact_lists
    description: Emergency contact information
  - type: bcp_documentation
    description: Business continuity plans
  access_requirements:
  - Read access to emergency documentation
  - Contact list access
  - BCP documentation access
  - Security incident response access
discovery:
  code_patterns:
  - pattern: (emergency|critical|urgent|break.glass|crisis)
    type: regex
    scope: docs
    purpose: Detect emergency procedure documentation
  - pattern: (breach|security.incident|compromise|attack)
    type: regex
    scope: docs
    purpose: Detect security incident procedures
  - pattern: (shutdown|failover|disaster|recovery)
    type: regex
    scope: docs
    purpose: Detect disaster recovery procedures
  file_patterns:
  - glob: '**/emergency*/**/*.md'
    purpose: Emergency procedure directories
  - glob: '**/incident-response*/**/*.md'
    purpose: Incident response documentation
  - glob: '**/disaster-recovery*/**/*.md'
    purpose: Disaster recovery documentation
  - glob: '**/bcp*/**/*.md'
    purpose: Business continuity plans
knowledge_sources:
  specifications:
  - id: nist-incident-response
    name: NIST SP 800-61 - Incident Response
    url: https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final
    offline_cache: true
    priority: required
  - id: iso-22301
    name: ISO 22301 - Business Continuity
    url: https://www.iso.org/standard/75106.html
    offline_cache: true
    priority: required
  guides:
  - id: sans-incident-response
    name: SANS Incident Response Procedures
    url: https://www.sans.org/white-papers/
    offline_cache: true
tooling:
  static_analysis:
  - tool: emergency-procedure-scanner
    purpose: Scan for emergency procedure completeness
    offline_capable: true
  scripts:
  - id: emergency-doc-scanner
    language: bash
    purpose: Find emergency procedure documentation
    source: inline
    code: |
      #!/bin/bash
      echo "=== Emergency Procedure Documentation Scan ==="
      find . -type f \( -name "*emergency*" -o -name "*incident*" \
        -o -name "*disaster*" -o -name "*breach*" \) -name "*.md" 2>/dev/null | head -30
signals:
  critical:
  - id: EP-CRIT-001
    signal: No emergency procedures documented
    evidence_indicators:
    - No emergency runbooks exist
    - No security incident response plan
    - No disaster recovery procedures
    explanation: |
      Organizations without documented emergency procedures rely on
      improvisation during crises. This increases damage, extends
      recovery time, and may violate regulatory requirements.
    remediation: |
      - Create emergency response framework
      - Document major incident procedures
      - Develop security incident response plan
      - Establish disaster recovery procedures
      - Train all personnel on emergency protocols
  - id: EP-CRIT-002
    signal: No data breach response procedure
    evidence_indicators:
    - No breach notification procedure
    - No evidence preservation process
    - No communication templates for breaches
    explanation: |
      Data breaches have legal notification requirements (GDPR 72-hour
      notification, state breach laws). Without procedures, organizations
      risk non-compliance, extended exposure, and improper handling.
    remediation: |
      - Create breach response playbook
      - Document evidence preservation steps
      - Prepare notification templates
      - Identify legal and PR contacts
      - Define breach classification criteria
  high:
  - id: EP-HIGH-001
    signal: Emergency contact information incomplete
    evidence_indicators:
    - Missing key stakeholder contacts
    - No 24/7 reachability information
    - Contact list not verified recently
    explanation: |
      Incomplete contact information delays response during emergencies.
      Key decision-makers, legal counsel, PR, and technical experts
      must be reachable at any time.
    remediation: |
      - Create comprehensive emergency contact list
      - Include primary and backup contacts
      - Document 24/7 contact methods
      - Verify contacts quarterly
      - Distribute contact list securely
  - id: EP-HIGH-002
    signal: No emergency communication procedures
    evidence_indicators:
    - No crisis communication templates
    - Approval process unclear during emergencies
    - External communication roles undefined
    explanation: |
      Communication during emergencies is critical for stakeholders,
      customers, and regulators. Without procedures, messages may be
      delayed, inconsistent, or inappropriate.
    remediation: |
      - Create emergency communication templates
      - Define approval authority during crises
      - Establish communication channels
      - Assign communication responsibilities
      - Prepare holding statements
  - id: EP-HIGH-003
    signal: Emergency procedures not tested
    evidence_indicators:
    - No tabletop exercises conducted
    - Procedures never validated
    - Team unfamiliar with emergency protocols
    explanation: |
      Untested emergency procedures may fail when needed. Regular
      exercises validate procedures, train personnel, and identify
      gaps before actual emergencies.
    remediation: |
      - Conduct annual tabletop exercises
      - Test communication procedures
      - Practice emergency escalation
      - Document exercise findings
      - Update procedures based on lessons
  medium:
  - id: EP-MED-001
    signal: Emergency procedures not accessible during emergencies
    evidence_indicators:
    - Procedures in systems that may be down
    - No offline access to emergency docs
    - Access depends on affected systems
    explanation: |
      Emergency procedures must be accessible even when systems are down.
      If documentation is only available through affected systems,
      responders cannot access it when needed most.
    remediation: |
      - Ensure offline access to critical procedures
      - Distribute printed emergency procedures
      - Store procedures in multiple locations
      - Test access during system outages
      - Maintain mobile-accessible copies
  - id: EP-MED-002
    signal: No emergency shutdown procedures
    evidence_indicators:
    - No graceful shutdown process
    - Dependencies not documented
    - Data protection during shutdown unclear
    explanation: |
      Emergency situations may require rapid system shutdown. Without
      documented procedures, shutdowns may cause data loss, dependency
      failures, or incomplete protection.
    remediation: |
      - Document emergency shutdown procedures
      - Define shutdown order for dependencies
      - Include data protection steps
      - Test shutdown procedures
      - Document restart procedures
  low:
  - id: EP-LOW-001
    signal: Emergency procedures not regularly reviewed
    evidence_indicators:
    - Last review date >1 year ago
    - No scheduled review process
    - Procedures may be outdated
    explanation: |
      Emergency procedures require regular review to remain current.
      Organizational changes, system updates, and regulatory changes
      can invalidate existing procedures.
    remediation: |
      - Establish annual review schedule
      - Assign review ownership
      - Track review completion
      - Update procedures as needed
      - Document review dates
  positive:
  - id: EP-POS-001
    signal: Comprehensive emergency procedure coverage
    evidence_indicators:
    - Major incident procedures documented
    - Security incident response plan exists
    - Business continuity procedures in place
  - id: EP-POS-002
    signal: Emergency procedures tested and current
    evidence_indicators:
    - Regular tabletop exercises conducted
    - Procedures reviewed annually
    - Contact information validated
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Emergency Procedure Inventory
    description: |
      Identify all emergency procedure documentation.
    duration_estimate: 30 min
    commands:
    - purpose: Find emergency procedure documents
      command: |
        find . -type f \( -name "*emergency*" -o -name "*incident*response*" \
          -o -name "*disaster*" -o -name "*bcp*" \) -name "*.md" 2>/dev/null | head -30
    - purpose: Find security incident procedures
      command: |
        find . -type f \( -name "*breach*" -o -name "*security*incident*" \) \
          -name "*.md" 2>/dev/null | head -20
    expected_findings:
    - Emergency procedure documents
    - Security incident plans
    - Business continuity plans
  - id: '2'
    name: Contact Information Review
    description: |
      Verify emergency contact information completeness.
    duration_estimate: 30 min
    commands:
    - purpose: Find emergency contact lists
      command: |
        find . -type f \( -name "*contact*" -o -name "*escalat*" \) \
          -path "*emergency*" 2>/dev/null | head -20
    - purpose: Search for contact patterns
      command: |
        grep -rniE "(emergency|crisis).*(contact|phone|email)" \
          --include="*.md" . 2>/dev/null | head -30
    expected_findings:
    - Contact list documentation
    - Escalation contacts
    - 24/7 contact methods
  - id: '3'
    name: Procedure Completeness Assessment
    description: |
      Evaluate completeness of key emergency procedures.
    duration_estimate: 30 min
    commands:
    - purpose: Check for breach response
      command: |
        grep -rniE "(breach|data.loss|compromise).*(response|procedure|playbook)" \
          --include="*.md" . 2>/dev/null | head -20
    - purpose: Check for communication procedures
      command: |
        grep -rniE "(crisis|emergency).*(communication|notify|statement)" \
          --include="*.md" . 2>/dev/null | head -20
    expected_findings:
    - Breach response procedures
    - Communication protocols
    - Notification procedures
  - id: '4'
    name: Testing and Review Assessment
    description: |
      Verify emergency procedures are tested and current.
    duration_estimate: 30 min
    commands:
    - purpose: Find exercise documentation
      command: |
        find . -type f \( -name "*exercise*" -o -name "*drill*" -o -name "*tabletop*" \) \
          -name "*.md" 2>/dev/null | head -20
    - purpose: Find review dates
      command: |
        grep -rniE "(last.review|last.tested|updated)" \
          --include="*emergency*.md" --include="*incident*.md" . 2>/dev/null | head -30
    expected_findings:
    - Exercise records
    - Review dates
    - Update history
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Procedure Coverage Assessment
    - Contact Information Review
    - Testing and Currency Analysis
    - Recommendations
  - type: coverage_matrix
    format: table
    description: Emergency scenario coverage status
  confidence_guidance:
    high: Emergency procedures fully documented and accessible
    medium: Partial coverage, some gaps identified
    low: Emergency preparedness unclear, requires interviews
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: nist-incident-response
      priority: required
    - source_id: iso-22301
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Emergency audit requires thorough review
    full:
      included: true
      priority: 1
    production:
      included: true
      priority: 1
closeout_checklist:
- id: ep-001
  item: Major incident procedures documented
  level: CRITICAL
  verification: |
    find . -type f \( -name "*emergency*" -o -name "*incident*response*" \) \
      -name "*.md" 2>/dev/null | wc -l | \
      xargs -I{} test {} -gt 0 && echo "PASS" || echo "FAIL"
  expected: PASS
- id: ep-002
  item: Data breach response procedure exists
  level: CRITICAL
  verification: |
    grep -rniE "breach.*(response|playbook|procedure)" \
      --include="*.md" . 2>/dev/null | wc -l | \
      xargs -I{} test {} -gt 0 && echo "PASS" || echo "FAIL"
  expected: PASS
- id: ep-003
  item: Emergency contacts documented and current
  level: BLOCKING
  verification: manual
  verification_notes: Verify emergency contact list is complete and validated
  expected: Confirmed by reviewer
- id: ep-004
  item: Emergency procedures tested within 12 months
  level: WARNING
  verification: manual
  verification_notes: Verify tabletop or live exercises conducted recently
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: SOC 2
    controls:
    - CC7.4
    - CC7.5
  - framework: ISO 27001
    controls:
    - A.16.1
    - A.17.1
  - framework: ISO 22301
    controls:
    - '8.4'
    - '8.5'
  - framework: GDPR
    controls:
    - Article 33
    - Article 34
relationships:
  commonly_combined:
  - operational-excellence.incident-management.incident-response-process
  - operational-excellence.runbook-procedures.recovery-procedures
  - operational-excellence.production-readiness.rollback-readiness
