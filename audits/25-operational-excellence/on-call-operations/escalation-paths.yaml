audit:
  id: operational-excellence.on-call-operations.escalation-paths
  name: Escalation Paths Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: operational-excellence
  category_number: 25
  subcategory: on-call-operations
  tier: phd
  estimated_duration: 2-3 hours  # median: 2h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: process
  default_profiles:
  - full
  - production
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines on-call escalation paths including:
    - Escalation tier definitions
    - Automatic escalation timing
    - Cross-team escalation procedures
    - Management escalation criteria
    - Subject matter expert engagement
    - Vendor and third-party escalation
    - Escalation path testing
    - Contact information currency
  why_it_matters: |
    Clear escalation paths ensure incidents reach the right people:
    - Delayed escalation extends incident duration
    - Missing escalation paths leave responders without support
    - Untested paths may fail during actual incidents
    - Automatic escalation catches unacknowledged alerts

    Effective escalation is a critical component of incident response.
    When primary responders cannot resolve issues, escalation ensures
    appropriate expertise is engaged promptly.
  when_to_run:
  - Quarterly operational reviews
  - After escalation failures during incidents
  - When team structures change
  - During on-call rotation reviews
  - After vendor relationship changes
prerequisites:
  required_artifacts:
  - type: escalation_config
    description: Escalation policy configurations
  - type: contact_lists
    description: Escalation contact information
  - type: tool_configuration
    description: PagerDuty/Opsgenie escalation settings
  access_requirements:
  - Escalation policy configuration access
  - Contact list access
  - On-call tool admin access
  - Cross-team escalation documentation
discovery:
  code_patterns:
  - pattern: (escalat|notify|page).*(policy|rule|path)
    type: regex
    scope: config
    purpose: Detect escalation policy definitions
  - pattern: (timeout|delay|after).*(minute|hour|escalat)
    type: regex
    scope: config
    purpose: Detect escalation timing
  - pattern: (level|tier|stage)[_-]?[0-9]
    type: regex
    scope: config
    purpose: Detect escalation tiers
  file_patterns:
  - glob: '**/escalation*.{yaml,yml,json}'
    purpose: Escalation configurations
  - glob: '**/policy*.{yaml,yml,json}'
    purpose: Policy configurations
  - glob: '**/pagerduty/**/*.{yaml,tf}'
    purpose: PagerDuty configurations
knowledge_sources:
  specifications:
  - id: pagerduty-escalation
    name: PagerDuty Escalation Policies
    url: https://support.pagerduty.com/docs/escalation-policies
    offline_cache: true
    priority: required
  - id: google-sre-incident
    name: Google SRE - Managing Incidents
    url: https://sre.google/sre-book/managing-incidents/
    offline_cache: true
    priority: required
  guides:
  - id: opsgenie-escalation
    name: Opsgenie Escalation Guide
    url: https://support.atlassian.com/opsgenie/docs/what-is-escalation/
    offline_cache: true
tooling:
  infrastructure_tools:
  - tool: pagerduty
    purpose: Escalation policy management
    command: pd escalation-policy list
  - tool: opsgenie
    purpose: Escalation configuration
    command: opsgenie escalation list
  scripts:
  - id: escalation-scanner
    language: bash
    purpose: Find escalation configurations
    source: inline
    code: |
      #!/bin/bash
      echo "=== Escalation Configuration Scan ==="
      find . -type f \( -name "*escalat*" -o -name "*policy*" \) \
        \( -name "*.yaml" -o -name "*.json" -o -name "*.tf" \) 2>/dev/null | head -30
signals:
  critical:
  - id: ESP-CRIT-001
    signal: No escalation paths defined
    evidence_indicators:
    - On-call has no backup escalation
    - No escalation policies configured
    - Single point of contact for all incidents
    explanation: |
      Without escalation paths, incidents stall when primary responders
      are unavailable, overwhelmed, or lack expertise. Escalation ensures
      issues receive attention regardless of primary responder status.
    remediation: |
      - Define multi-tier escalation policies
      - Configure automatic escalation timeouts
      - Establish management escalation
      - Document SME escalation paths
      - Test escalation regularly
  - id: ESP-CRIT-002
    signal: No automatic escalation configured
    evidence_indicators:
    - All escalation requires manual action
    - Unacknowledged alerts don't escalate
    - No timeout-based escalation
    explanation: |
      Manual-only escalation fails when primary responders are unavailable
      or overwhelmed. Automatic escalation after acknowledgment timeout
      ensures incidents receive attention even if initial contacts fail.
    remediation: |
      - Configure automatic escalation timeouts
      - Set appropriate delays by severity
      - Enable escalation for unacknowledged alerts
      - Test automatic escalation
      - Monitor escalation policy execution
  high:
  - id: ESP-HIGH-001
    signal: Escalation timing inappropriate for severity
    evidence_indicators:
    - Same escalation delay for all severities
    - Critical alerts wait too long to escalate
    - Low-severity alerts escalate too quickly
    explanation: |
      Escalation timing should match incident severity. Critical incidents
      need rapid escalation (5-15 minutes) while lower severity can wait
      longer. One-size-fits-all delays either under-respond to critical
      issues or over-escalate routine matters.
    remediation: |
      - Configure severity-specific escalation delays
      - Set aggressive timing for critical (5-15 min)
      - Allow longer delays for lower severity
      - Review timing based on MTTR data
      - Document timing rationale
  - id: ESP-HIGH-002
    signal: Cross-team escalation paths missing
    evidence_indicators:
    - No inter-team escalation documented
    - Dependent service contacts unknown
    - Escalation stops at team boundaries
    explanation: |
      Incidents often involve multiple teams. Without cross-team
      escalation paths, responders cannot engage dependent service
      teams, extending resolution time.
    remediation: |
      - Map service dependencies to team contacts
      - Document cross-team escalation procedures
      - Configure cross-team escalation in tools
      - Establish inter-team communication protocols
      - Test cross-team escalation
  - id: ESP-HIGH-003
    signal: Escalation contacts outdated
    evidence_indicators:
    - Departed employees in escalation paths
    - Invalid contact information
    - Contacts not verified recently
    explanation: |
      Outdated contacts cause escalation failures during incidents.
      When escalation reaches invalid contacts, incidents stall
      while responders search for current information.
    remediation: |
      - Validate all escalation contacts
      - Implement automated contact verification
      - Integrate with HR for updates
      - Review contacts monthly
      - Test reachability regularly
  medium:
  - id: ESP-MED-001
    signal: No SME escalation paths defined
    evidence_indicators:
    - Subject matter experts not in escalation
    - No specialized expertise escalation
    - All escalation goes to same people
    explanation: |
      Some incidents require specialized expertise (database, security,
      network). Without SME escalation paths, responders cannot engage
      appropriate experts, relying on general escalation.
    remediation: |
      - Identify required SME categories
      - Define SME escalation paths
      - Configure skill-based routing
      - Document SME engagement criteria
      - Include SMEs in on-call where appropriate
  - id: ESP-MED-002
    signal: Management escalation criteria unclear
    evidence_indicators:
    - Unknown when to involve management
    - No executive notification thresholds
    - Management escalation ad-hoc
    explanation: |
      Major incidents often require management involvement for decisions,
      resources, or communication. Clear criteria define when management
      should be notified and engaged.
    remediation: |
      - Define management escalation criteria
      - Set severity-based notification rules
      - Document decision authority levels
      - Configure management notification channels
      - Test management escalation
  low:
  - id: ESP-LOW-001
    signal: Escalation metrics not tracked
    evidence_indicators:
    - Escalation frequency unknown
    - Escalation effectiveness not measured
    - No escalation performance data
    explanation: |
      Without metrics, organizations cannot optimize escalation timing
      or identify issues. Tracking escalation provides data for
      continuous improvement.
    remediation: |
      - Track escalation frequency
      - Measure time-to-escalation
      - Monitor escalation success rate
      - Report escalation metrics
      - Use data to optimize timing
  positive:
  - id: ESP-POS-001
    signal: Comprehensive escalation paths with automatic triggers
    evidence_indicators:
    - Multi-tier escalation defined
    - Automatic escalation configured
    - Cross-team paths documented
  - id: ESP-POS-002
    signal: Escalation paths regularly tested and validated
    evidence_indicators:
    - Escalation testing conducted
    - Contacts verified regularly
    - Cross-team coordination validated
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Escalation Policy Review
    description: |
      Examine escalation policy configurations.
    duration_estimate: 30 min
    commands:
    - purpose: Find escalation policies
      command: |
        find . -type f \( -name "*escalat*" -o -name "*policy*" \) \
          \( -name "*.yaml" -o -name "*.json" -o -name "*.tf" \) 2>/dev/null | head -20
    - purpose: Search for escalation tiers
      command: |
        grep -rniE "(escalat|level|tier).*(rule|target|user)" \
          --include="*.yaml" --include="*.tf" . 2>/dev/null | head -30
    expected_findings:
    - Escalation policy definitions
    - Tier configurations
    - Target assignments
  - id: '2'
    name: Timing Configuration Review
    description: |
      Assess escalation timing configurations.
    duration_estimate: 30 min
    commands:
    - purpose: Find escalation timing
      command: |
        grep -rniE "(timeout|delay|escalation_delay|minutes)" \
          --include="*.yaml" --include="*.tf" --include="*.json" . 2>/dev/null | head -30
    - purpose: Check severity-based timing
      command: |
        grep -rniE "(severity|urgency|priority).*(timeout|delay)" \
          --include="*.yaml" . 2>/dev/null | head -20
    expected_findings:
    - Timeout configurations
    - Severity-based timing
    - Escalation delays
  - id: '3'
    name: Contact Validation
    description: |
      Review escalation contact information.
    duration_estimate: 30 min
    commands:
    - purpose: Find contact configurations
      command: |
        grep -rniE "(user|contact|target|email|phone)" \
          --include="*escalat*.yaml" --include="*policy*.yaml" . 2>/dev/null | head -30
    - purpose: Find Slack/Teams channels
      command: |
        grep -rniE "(slack|teams|channel).*escalat" \
          --include="*.yaml" . 2>/dev/null | head -20
    expected_findings:
    - Contact configurations
    - Channel references
    - User assignments
  - id: '4'
    name: Cross-Team Escalation Review
    description: |
      Assess cross-team and SME escalation paths.
    duration_estimate: 30 min
    commands:
    - purpose: Find cross-team escalation
      command: |
        grep -rniE "(cross.team|inter.team|dependent|upstream)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    - purpose: Find SME escalation
      command: |
        grep -rniE "(sme|expert|specialist|database|security|network)" \
          --include="*escalat*.md" --include="*escalat*.yaml" . 2>/dev/null | head -20
    expected_findings:
    - Cross-team procedures
    - SME contacts
    - Specialized escalation
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Policy Configuration Assessment
    - Timing Analysis
    - Contact Validation
    - Recommendations
  - type: escalation_matrix
    format: table
    description: Escalation paths by severity and tier
  confidence_guidance:
    high: Escalation configurations fully documented
    medium: Partial configuration access, some verification needed
    low: Escalation setup unclear, requires tool access
offline:
  capability: partial
  runtime_required_for:
  - Contact validation
  - Policy verification
  - Timing confirmation
  cache_manifest:
    knowledge:
    - source_id: pagerduty-escalation
      priority: required
    - source_id: google-sre-incident
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Escalation audit requires thorough review
    full:
      included: true
      priority: 2
    production:
      included: true
      priority: 1
closeout_checklist:
- id: esp-001
  item: Escalation paths are defined
  level: CRITICAL
  verification: |
    find . -type f -name "*escalat*.yaml" 2>/dev/null | wc -l | \
      xargs -I{} test {} -gt 0 && echo "PASS" || echo "FAIL"
  expected: PASS
- id: esp-002
  item: Automatic escalation is configured
  level: CRITICAL
  verification: |
    grep -rniE "(timeout|delay|escalation_delay)" \
      --include="*.yaml" . 2>/dev/null | wc -l | \
      xargs -I{} test {} -gt 0 && echo "PASS" || echo "FAIL"
  expected: PASS
- id: esp-003
  item: Escalation contacts are current
  level: BLOCKING
  verification: manual
  verification_notes: Verify contacts validated within last 30 days
  expected: Confirmed by reviewer
- id: esp-004
  item: Cross-team escalation paths exist
  level: WARNING
  verification: manual
  verification_notes: Verify cross-team escalation documented
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: SOC 2
    controls:
    - CC7.4
    - CC7.5
  - framework: ISO 27001
    controls:
    - A.16.1.1
    - A.16.1.2
relationships:
  commonly_combined:
  - operational-excellence.on-call-operations.on-call-rotation
  - operational-excellence.incident-management.escalation-procedures
  - operational-excellence.incident-management.incident-response-process
