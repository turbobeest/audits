audit:
  id: operational-excellence.capacity-planning.capacity-forecasting
  name: Capacity Forecasting Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: operational-excellence
  category_number: 25
  subcategory: capacity-planning
  tier: phd
  estimated_duration: 3-4 hours  # median: 3h
  completeness: complete
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: metrics
  default_profiles:
  - full
  - production
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines capacity forecasting practices including:
    - Demand forecasting methodologies
    - Historical data analysis
    - Growth projection models
    - Seasonal pattern recognition
    - Event-driven capacity planning
    - Forecast accuracy tracking
    - Lead time for capacity changes
    - Business-aligned forecasting
  why_it_matters: |
    Accurate capacity forecasting prevents outages and waste:
    - Under-provisioning causes performance degradation and outages
    - Over-provisioning wastes resources and budget
    - Long lead times require early planning
    - Business events need proactive capacity

    Google SRE emphasizes capacity planning as a core reliability
    practice. Reactive capacity management causes incidents while
    proactive forecasting enables smooth scaling.
  when_to_run:
  - Quarterly capacity reviews
  - Before major business events
  - During budget planning
  - After forecast misses
  - When growth patterns change
prerequisites:
  required_artifacts:
  - type: capacity_data
    description: Historical capacity utilization data
  - type: forecasting_models
    description: Forecasting documentation
  - type: business_projections
    description: Business growth projections
  access_requirements:
  - Historical metrics access (12+ months)
  - Forecasting tool access
  - Business planning data
  - Resource utilization dashboards
discovery:
  code_patterns:
  - pattern: (forecast|predict|project|plan).*(capacity|resource|demand)
    type: regex
    scope: docs
    purpose: Detect forecasting documentation
  - pattern: (growth|trend|seasonal|pattern)
    type: regex
    scope: docs
    purpose: Detect growth analysis
  file_patterns:
  - glob: '**/capacity*/**/*.{md,yaml,yml}'
    purpose: Capacity planning documentation
  - glob: '**/forecast*/**/*.{md,yaml}'
    purpose: Forecasting documentation
knowledge_sources:
  specifications:
  - id: google-sre-capacity
    name: Google SRE - Software Engineering in SRE
    url: https://sre.google/sre-book/software-engineering-in-sre/
    offline_cache: true
    priority: required
  guides:
  - id: capacity-planning-guide
    name: Cloud Capacity Planning
    url: https://cloud.google.com/architecture/capacity-planning-and-sizing
    offline_cache: true
tooling:
  infrastructure_tools:
  - tool: prometheus
    purpose: Historical metrics for forecasting
    command: promql predict_linear
  - tool: cloudwatch
    purpose: AWS capacity metrics
    command: aws cloudwatch get-metric-statistics
  scripts:
  - id: forecast-scanner
    language: bash
    purpose: Find forecasting documentation
    source: inline
    code: |
      #!/bin/bash
      echo "=== Capacity Forecasting Documentation Scan ==="
      find . -type f \( -name "*forecast*" -o -name "*capacity*" -o -name "*planning*" \) \
        -name "*.md" 2>/dev/null | head -20
signals:
  critical:
  - id: CF-CRIT-001
    signal: No capacity forecasting process exists
    evidence_indicators:
    - No forecasting documentation
    - Capacity managed reactively
    - No demand prediction
    explanation: |
      Without forecasting, organizations react to capacity issues rather
      than preventing them. Reactive capacity management causes outages
      when demand exceeds capacity and lead times prevent quick fixes.
    remediation: |
      - Establish forecasting process
      - Analyze historical utilization
      - Create demand models
      - Project future requirements
      - Plan capacity acquisition
  - id: CF-CRIT-002
    signal: Lead times exceed forecasting horizon
    evidence_indicators:
    - Forecasts don't look far enough ahead
    - Cannot procure capacity in time
    - Hardware/contract lead times exceed forecast
    explanation: |
      If capacity acquisition takes 3 months but forecasts only look
      1 month ahead, organizations cannot respond to forecasted demand
      in time. Forecast horizon must exceed lead time.
    remediation: |
      - Identify capacity lead times
      - Extend forecast horizon beyond lead time
      - Build buffer for uncertainty
      - Expedite critical capacity
      - Pre-authorize capacity reserves
  high:
  - id: CF-HIGH-001
    signal: Forecast accuracy not tracked
    evidence_indicators:
    - Past forecasts not compared to actuals
    - Forecast errors unknown
    - No accuracy improvement
    explanation: |
      Tracking accuracy identifies systematic forecast errors and
      enables improvement. Without tracking, forecasts may be
      consistently wrong without correction.
    remediation: |
      - Compare forecasts to actuals
      - Track forecast error metrics
      - Identify error patterns
      - Adjust models based on accuracy
      - Report accuracy trends
  - id: CF-HIGH-002
    signal: Business events not incorporated
    evidence_indicators:
    - Marketing events not in forecast
    - Seasonal patterns ignored
    - Known demand spikes missed
    explanation: |
      Business events (marketing campaigns, seasonal peaks, product
      launches) significantly impact demand. Forecasts without these
      inputs miss predictable demand spikes.
    remediation: |
      - Integrate business planning
      - Include known events in forecast
      - Model seasonal patterns
      - Coordinate with marketing/sales
      - Create event capacity playbooks
  medium:
  - id: CF-MED-001
    signal: Forecasting based on single metric
    evidence_indicators:
    - Only CPU or memory considered
    - Bottleneck resources ignored
    - Network/storage not forecasted
    explanation: |
      Different resources may become bottlenecks. Forecasting should
      cover all potentially constraining resources including compute,
      memory, storage, network, and service limits.
    remediation: |
      - Identify all constrained resources
      - Forecast each resource type
      - Model resource interactions
      - Track per-resource utilization
      - Anticipate bottleneck shifts
  - id: CF-MED-002
    signal: No scenario planning for forecasts
    evidence_indicators:
    - Single forecast only
    - No best/worst case scenarios
    - Uncertainty not modeled
    explanation: |
      Single-point forecasts hide uncertainty. Scenario planning
      (optimistic, expected, pessimistic) enables appropriate
      risk-based capacity decisions.
    remediation: |
      - Create multiple scenarios
      - Model forecast uncertainty
      - Plan for pessimistic scenario
      - Document scenario assumptions
      - Update scenarios regularly
  low:
  - id: CF-LOW-001
    signal: Forecasts not automated
    evidence_indicators:
    - Manual forecasting only
    - No automated trend analysis
    - Forecasts created infrequently
    explanation: |
      Manual forecasting is time-consuming and may be done infrequently.
      Automated forecasting enables regular updates and rapid response
      to changing patterns.
    remediation: |
      - Implement automated forecasting
      - Use predictive analytics tools
      - Generate forecasts regularly
      - Alert on forecast changes
      - Enable ad-hoc forecasting
  positive:
  - id: CF-POS-001
    signal: Comprehensive capacity forecasting
    evidence_indicators:
    - Multiple resource forecasting
    - Business events incorporated
    - Accuracy tracked and improved
  - id: CF-POS-002
    signal: Automated forecasting with scenarios
    evidence_indicators:
    - Automated demand prediction
    - Multiple scenarios modeled
    - Forecasts updated regularly
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Forecasting Process Review
    description: |
      Examine capacity forecasting documentation and processes.
    duration_estimate: 45 min
    commands:
    - purpose: Find forecasting documentation
      command: |
        find . -type f \( -name "*forecast*" -o -name "*capacity*planning*" \) \
          -name "*.md" 2>/dev/null | head -20
    - purpose: Search for forecasting methodologies
      command: |
        grep -rniE "(forecast|predict|model).*(method|approach|algorithm)" \
          --include="*.md" . 2>/dev/null | head -30
    expected_findings:
    - Forecasting documentation
    - Methodology description
    - Process definition
  - id: '2'
    name: Data and Model Review
    description: |
      Assess data inputs and forecasting models.
    duration_estimate: 45 min
    commands:
    - purpose: Find metrics configurations
      command: |
        grep -rniE "(metric|utilization|usage).*(capacity|resource)" \
          --include="*.yaml" --include="*.md" . 2>/dev/null | head -30
    - purpose: Search for growth models
      command: |
        grep -rniE "(growth|trend|rate|projection)" \
          --include="*.md" . 2>/dev/null | head -20
    expected_findings:
    - Input metrics
    - Growth models
    - Data sources
  - id: '3'
    name: Accuracy Assessment
    description: |
      Evaluate forecast accuracy tracking.
    duration_estimate: 30 min
    commands:
    - purpose: Find accuracy tracking
      command: |
        grep -rniE "(accuracy|error|actual|variance).*(forecast|predict)" \
          --include="*.md" . 2>/dev/null | head -20
    expected_findings:
    - Accuracy metrics
    - Error tracking
    - Improvement processes
  - id: '4'
    name: Business Integration Review
    description: |
      Assess integration with business planning.
    duration_estimate: 30 min
    commands:
    - purpose: Find business integration
      command: |
        grep -rniE "(business|marketing|sales|event).*(capacity|forecast)" \
          --include="*.md" . 2>/dev/null | head -20
    expected_findings:
    - Business planning integration
    - Event incorporation
    - Cross-functional input
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Forecasting Process Assessment
    - Model and Accuracy Review
    - Business Integration Analysis
    - Recommendations
  - type: forecast_model
    format: specification
    description: Recommended forecasting approach
  confidence_guidance:
    high: Forecasting process documented with accuracy data
    medium: Some forecasting exists but informal
    low: Forecasting practices unclear
offline:
  capability: partial
  runtime_required_for:
  - Historical data analysis
  - Accuracy verification
  - Model validation
  cache_manifest:
    knowledge:
    - source_id: google-sre-capacity
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Forecasting audit requires data analysis
    full:
      included: true
      priority: 2
    production:
      included: true
      priority: 2
closeout_checklist:
- id: cf-001
  item: Capacity forecasting process exists
  level: CRITICAL
  verification: |
    find . -type f \( -name "*forecast*" -o -name "*capacity*" \) \
      -name "*.md" 2>/dev/null | wc -l | \
      xargs -I{} test {} -gt 0 && echo "PASS" || echo "FAIL"
  expected: PASS
- id: cf-002
  item: Forecast horizon exceeds lead time
  level: CRITICAL
  verification: manual
  verification_notes: Verify forecasts look ahead beyond procurement time
  expected: Confirmed by reviewer
- id: cf-003
  item: Forecast accuracy is tracked
  level: BLOCKING
  verification: manual
  verification_notes: Verify forecasts compared to actuals
  expected: Confirmed by reviewer
- id: cf-004
  item: Business events incorporated
  level: WARNING
  verification: manual
  verification_notes: Verify business planning integrated with forecasts
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: ITIL 4
    controls:
    - Capacity Management
  - framework: SOC 2
    controls:
    - A1.2
relationships:
  commonly_combined:
  - operational-excellence.capacity-planning.resource-headroom
  - operational-excellence.capacity-planning.growth-projections
  - operational-excellence.service-level-management.slo-definition
