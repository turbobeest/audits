audit:
  id: operational-excellence.change-management.change-approval-process
  name: Change Approval Process Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: operational-excellence
  category_number: 25
  subcategory: change-management
  tier: phd
  estimated_duration: 2-3 hours  # median: 2h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: process
  default_profiles:
  - full
  - production
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines change approval processes including:
    - Approval workflow definitions
    - Change categorization and authorization levels
    - Pre-approval requirements (testing, review)
    - Approval authority and delegation
    - Change Advisory Board (CAB) processes
    - Automated approval for standard changes
    - Approval documentation and audit trail
    - Approval SLAs and escalation
  why_it_matters: |
    Change approval prevents unauthorized or risky changes:
    - Unauthorized changes are a leading cause of outages
    - Appropriate review catches issues before production
    - Audit trail supports compliance and troubleshooting
    - Clear approval authority prevents confusion

    ITIL defines change management as critical for service reliability.
    Google SRE balances velocity with safety through progressive
    approval requirements based on change risk.
  when_to_run:
  - Quarterly operational reviews
  - After change-related incidents
  - During compliance audits
  - When modifying approval processes
  - Before major system changes
prerequisites:
  required_artifacts:
  - type: change_policy
    description: Change management policy documentation
  - type: approval_config
    description: Approval workflow configurations
  - type: change_records
    description: Historical change records
  access_requirements:
  - Change policy documentation access
  - Workflow configuration access
  - Change tracking system access
  - Historical change data
discovery:
  code_patterns:
  - pattern: (change|deploy|release).*(approv|review|authori)
    type: regex
    scope: config
    purpose: Detect change approval configurations
  - pattern: (cab|advisory|board|committee)
    type: regex
    scope: docs
    purpose: Detect CAB processes
  - pattern: (standard|normal|emergency).*(change|approval)
    type: regex
    scope: docs
    purpose: Detect change categories
  file_patterns:
  - glob: '**/change*policy*.{md,yaml,yml}'
    purpose: Change policy documentation
  - glob: '**/approval*/**/*.{yaml,yml}'
    purpose: Approval configurations
  - glob: '**/.github/workflows/*.yaml'
    purpose: CI/CD approval gates
knowledge_sources:
  specifications:
  - id: itil-change-management
    name: ITIL 4 - Change Enablement
    url: https://www.axelos.com/certifications/itil-service-management
    offline_cache: true
    priority: required
  guides:
  - id: google-sre-release
    name: Google SRE - Release Engineering
    url: https://sre.google/sre-book/release-engineering/
    offline_cache: true
tooling:
  infrastructure_tools:
  - tool: servicenow
    purpose: Change management and approval
    command: snow change list
  - tool: github
    purpose: Pull request approvals
    command: gh pr list --state merged
  scripts:
  - id: approval-scanner
    language: bash
    purpose: Find approval configurations
    source: inline
    code: |
      #!/bin/bash
      echo "=== Change Approval Configuration Scan ==="
      grep -rniE "(approv|review|authori).*(required|gate|check)" \
        --include="*.yaml" --include="*.yml" . 2>/dev/null | head -30
signals:
  critical:
  - id: CAP-CRIT-001
    signal: No change approval process exists
    evidence_indicators:
    - No approval requirements documented
    - Anyone can deploy to production
    - No change review mechanism
    explanation: |
      Without approval processes, any change can reach production without
      oversight. This significantly increases outage risk and violates
      compliance requirements. ITIL mandates change approval for
      production systems.
    remediation: |
      - Establish change approval policy
      - Define approval authority levels
      - Configure approval gates in CI/CD
      - Implement change tracking
      - Train team on approval process
  - id: CAP-CRIT-002
    signal: Production changes bypass approval
    evidence_indicators:
    - Approval gates can be skipped
    - Direct production access without review
    - Approval override available to all
    explanation: |
      Bypassable approval defeats the purpose of change control.
      Even emergency changes should go through expedited approval,
      not skip it entirely. Bypass capability should be extremely
      limited and audited.
    remediation: |
      - Enforce approval gates technically
      - Remove unnecessary bypass permissions
      - Audit all bypass usage
      - Implement emergency change process
      - Log all changes regardless of path
  high:
  - id: CAP-HIGH-001
    signal: Approval requirements don't match risk
    evidence_indicators:
    - Same approval for all change types
    - High-risk changes lack additional review
    - Low-risk changes delayed by heavy process
    explanation: |
      Approval requirements should be proportional to risk. High-risk
      changes need more scrutiny while low-risk standard changes can
      have streamlined approval. One-size-fits-all either over-processes
      routine changes or under-reviews risky ones.
    remediation: |
      - Categorize changes by risk level
      - Define approval requirements per category
      - Automate standard change approval
      - Require additional review for high-risk
      - Document categorization criteria
  - id: CAP-HIGH-002
    signal: No approval audit trail
    evidence_indicators:
    - Approvals not recorded
    - Who approved what is unknown
    - Approval decisions not documented
    explanation: |
      Audit trails support compliance, troubleshooting, and accountability.
      Without records, organizations cannot demonstrate proper change
      control or investigate change-related incidents.
    remediation: |
      - Implement approval logging
      - Record approver, timestamp, and decision
      - Link approvals to change records
      - Retain audit trail per compliance
      - Enable audit trail search
  medium:
  - id: CAP-MED-001
    signal: Approval authority unclear
    evidence_indicators:
    - Unknown who can approve what
    - Approval delegation not documented
    - Authority confusion causes delays
    explanation: |
      Clear approval authority prevents confusion and delays. Without
      documented authority, people either approve inappropriately or
      changes wait for unclear approvers.
    remediation: |
      - Define approval authority matrix
      - Document delegation rules
      - Publish approver list
      - Configure authority in tools
      - Review authority periodically
  - id: CAP-MED-002
    signal: No approval SLAs defined
    evidence_indicators:
    - Approvals take unpredictable time
    - No escalation for stalled approvals
    - Changes delayed indefinitely
    explanation: |
      Without SLAs, approval becomes a bottleneck. Defined turnaround
      expectations and escalation for delays keep changes moving while
      maintaining oversight.
    remediation: |
      - Set approval turnaround SLAs
      - Configure escalation for delays
      - Track approval wait time
      - Report on SLA compliance
      - Balance speed and oversight
  low:
  - id: CAP-LOW-001
    signal: Approval metrics not tracked
    evidence_indicators:
    - Approval volume unknown
    - Rejection rate not measured
    - Bottlenecks not identified
    explanation: |
      Metrics enable process optimization. Tracking approval volume,
      time, and rejection rates identifies improvement opportunities.
    remediation: |
      - Track approval volume and time
      - Measure rejection rate
      - Identify approval bottlenecks
      - Report metrics monthly
      - Use data to improve process
  positive:
  - id: CAP-POS-001
    signal: Risk-based approval process implemented
    evidence_indicators:
    - Changes categorized by risk
    - Approval requirements match risk level
    - Standard changes auto-approved
  - id: CAP-POS-002
    signal: Comprehensive approval audit trail
    evidence_indicators:
    - All approvals logged
    - Authority clearly defined
    - Audit trail searchable
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Policy Documentation Review
    description: |
      Examine change approval policy and procedures.
    duration_estimate: 30 min
    commands:
    - purpose: Find change policies
      command: |
        find . -type f \( -name "*change*" -o -name "*approval*" \) \
          -name "*.md" 2>/dev/null | head -20
    - purpose: Search for approval requirements
      command: |
        grep -rniE "(approv|authori).*(required|mandatory|must)" \
          --include="*.md" . 2>/dev/null | head -30
    expected_findings:
    - Change policy documentation
    - Approval requirements
    - Authority definitions
  - id: '2'
    name: Workflow Configuration Review
    description: |
      Examine approval workflow configurations.
    duration_estimate: 30 min
    commands:
    - purpose: Find CI/CD approval gates
      command: |
        grep -rniE "(approv|review|gate)" \
          --include="*.yaml" --include="*.yml" \
          -path "*workflow*" -path "*pipeline*" . 2>/dev/null | head -30
    - purpose: Find branch protection rules
      command: |
        grep -rniE "(protect|require|review)" \
          --include="*.yaml" --include="CODEOWNERS" . 2>/dev/null | head -20
    expected_findings:
    - Approval gates
    - Protection rules
    - Required reviewers
  - id: '3'
    name: Risk-Based Categorization Review
    description: |
      Assess change categorization and risk-based requirements.
    duration_estimate: 30 min
    commands:
    - purpose: Find change categories
      command: |
        grep -rniE "(standard|normal|emergency|expedit).*(change|approval)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -30
    - purpose: Search for risk assessment
      command: |
        grep -rniE "(risk|impact|urgency).*(assess|categor|level)" \
          --include="*.md" . 2>/dev/null | head -20
    expected_findings:
    - Change categories
    - Risk levels
    - Category-based requirements
  - id: '4'
    name: Audit Trail Assessment
    description: |
      Evaluate approval logging and audit trail.
    duration_estimate: 30 min
    commands:
    - purpose: Find audit logging
      command: |
        grep -rniE "(audit|log|record).*(approv|change)" \
          --include="*.yaml" --include="*.md" . 2>/dev/null | head -20
    expected_findings:
    - Audit configuration
    - Logging settings
    - Retention policies
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Policy Assessment
    - Workflow Configuration Review
    - Risk Categorization Analysis
    - Recommendations
  - type: approval_matrix
    format: table
    description: Change types and approval requirements
  confidence_guidance:
    high: Approval process fully documented and configured
    medium: Partial documentation, some configuration
    low: Approval process unclear, requires investigation
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: itil-change-management
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Approval audit requires thorough review
    full:
      included: true
      priority: 2
    production:
      included: true
      priority: 1
closeout_checklist:
- id: cap-001
  item: Change approval process is documented
  level: CRITICAL
  verification: |
    find . -type f \( -name "*change*" -o -name "*approval*" \) \
      -name "*.md" 2>/dev/null | wc -l | \
      xargs -I{} test {} -gt 0 && echo "PASS" || echo "FAIL"
  expected: PASS
- id: cap-002
  item: Approval gates are technically enforced
  level: CRITICAL
  verification: manual
  verification_notes: Verify CI/CD or deployment requires approval
  expected: Confirmed by reviewer
- id: cap-003
  item: Approval authority is defined
  level: BLOCKING
  verification: manual
  verification_notes: Verify who can approve what is documented
  expected: Confirmed by reviewer
- id: cap-004
  item: Audit trail exists for approvals
  level: WARNING
  verification: manual
  verification_notes: Verify approvals are logged and searchable
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: SOC 2
    controls:
    - CC8.1
  - framework: ISO 27001
    controls:
    - A.12.1.2
    - A.14.2.2
  - framework: ITIL 4
    controls:
    - Change Enablement
  - framework: PCI DSS
    controls:
    - 6.4.5
relationships:
  commonly_combined:
  - operational-excellence.change-management.change-risk-assessment
  - operational-excellence.change-management.change-audit-trail
  - operational-excellence.production-readiness.readiness-review
