audit:
  id: operational-excellence.change-management.emergency-change-process
  name: Emergency Change Process Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: operational-excellence
  category_number: 25
  subcategory: change-management
  tier: phd
  estimated_duration: 2 hours
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: process
  default_profiles:
  - full
  - production
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines emergency change processes including:
    - Emergency change definition and criteria
    - Expedited approval workflow
    - Post-change documentation requirements
    - Retrospective review process
    - Emergency change authorization
    - Audit trail for emergency changes
    - Abuse prevention mechanisms
    - Emergency change frequency tracking
  why_it_matters: |
    Emergency changes require special handling to balance speed and risk:
    - Genuine emergencies need rapid deployment
    - Abuse of emergency process undermines change control
    - Post-change review ensures learning
    - Audit trail supports compliance

    ITIL defines emergency changes as requiring expedited handling
    while maintaining appropriate controls. Google SRE balances velocity
    with post-hoc review for urgent changes.
  when_to_run:
  - Quarterly operational reviews
  - When emergency change frequency increases
  - After emergency change incidents
  - During compliance audits
  - When updating change policies
prerequisites:
  required_artifacts:
  - type: emergency_policy
    description: Emergency change policy documentation
  - type: change_records
    description: Historical emergency change records
  - type: review_records
    description: Post-emergency review documentation
  access_requirements:
  - Emergency change policy access
  - Change tracking system access
  - Historical change data
  - Review records access
discovery:
  code_patterns:
  - pattern: (emergency|urgent|critical|expedit).*(change|deploy|fix)
    type: regex
    scope: docs
    purpose: Detect emergency change documentation
  - pattern: (hotfix|patch|emergency).*(procedure|process|workflow)
    type: regex
    scope: docs
    purpose: Detect emergency procedures
  file_patterns:
  - glob: '**/emergency*/**/*.{md,yaml,yml}'
    purpose: Emergency documentation
  - glob: '**/hotfix*/**/*.md'
    purpose: Hotfix procedures
knowledge_sources:
  specifications:
  - id: itil-emergency-change
    name: ITIL 4 - Emergency Change Management
    url: https://www.axelos.com/certifications/itil-service-management
    offline_cache: true
    priority: required
  guides:
  - id: emergency-deployment
    name: Emergency Deployment Best Practices
    url: https://cloud.google.com/architecture/devops/devops-process-working-in-small-batches
    offline_cache: true
tooling:
  scripts:
  - id: emergency-scanner
    language: bash
    purpose: Find emergency change documentation
    source: inline
    code: |
      #!/bin/bash
      echo "=== Emergency Change Documentation Scan ==="
      find . -type f \( -name "*emergency*" -o -name "*hotfix*" \) \
        -name "*.md" 2>/dev/null | head -20
signals:
  critical:
  - id: ECP-CRIT-001
    signal: No emergency change process defined
    evidence_indicators:
    - No expedited approval path
    - Emergency changes follow normal process
    - Critical fixes delayed by process
    explanation: |
      Without an emergency process, critical fixes are delayed by
      normal approval cycles, extending incident duration. Alternatively,
      teams bypass all controls, creating risk and compliance issues.
    remediation: |
      - Define emergency change process
      - Create expedited approval workflow
      - Document emergency criteria
      - Establish authorization rules
      - Train team on emergency process
  - id: ECP-CRIT-002
    signal: No audit trail for emergency changes
    evidence_indicators:
    - Emergency changes not logged
    - Approval decisions not recorded
    - Changes untraceable
    explanation: |
      Emergency changes need audit trails even more than normal changes.
      Without documentation, organizations cannot demonstrate control
      or investigate emergency change-related issues.
    remediation: |
      - Log all emergency changes
      - Record approval and authorization
      - Document justification
      - Retain audit trail per compliance
      - Enable audit trail review
  high:
  - id: ECP-HIGH-001
    signal: No post-emergency review required
    evidence_indicators:
    - Emergency changes not reviewed retroactively
    - No learning from emergency changes
    - Process improvements not identified
    explanation: |
      Post-emergency review ensures learning and validates the
      emergency designation. Without review, emergency status may
      be abused and improvement opportunities are missed.
    remediation: |
      - Require post-emergency review
      - Validate emergency classification
      - Identify root cause of urgency
      - Document improvements needed
      - Track review completion
  - id: ECP-HIGH-002
    signal: Emergency criteria unclear
    evidence_indicators:
    - Subjective emergency designation
    - Inconsistent emergency classification
    - Routine changes marked emergency
    explanation: |
      Without clear criteria, emergency designation becomes subjective
      and may be abused to bypass controls. Clear criteria ensure
      only genuine emergencies use expedited process.
    remediation: |
      - Define emergency criteria objectively
      - Include impact thresholds
      - Specify time sensitivity requirements
      - Document example scenarios
      - Review questionable classifications
  medium:
  - id: ECP-MED-001
    signal: Emergency change frequency not tracked
    evidence_indicators:
    - Emergency change rate unknown
    - Trends not monitored
    - Abuse not detectable
    explanation: |
      Tracking frequency reveals process health. High emergency rates
      may indicate planning problems, infrastructure issues, or
      process abuse. Low rates validate effective normal process.
    remediation: |
      - Track emergency change frequency
      - Monitor trends over time
      - Alert on anomalies
      - Report metrics monthly
      - Investigate high frequency
  - id: ECP-MED-002
    signal: Emergency authorization overly broad
    evidence_indicators:
    - Too many people can authorize
    - Self-authorization permitted
    - No separation of duties
    explanation: |
      Broad authorization reduces control. Emergency changes should
      require authorization from appropriate management, not allow
      self-approval by the implementer.
    remediation: |
      - Define authorization roles
      - Require management approval
      - Prevent self-authorization
      - Document authorization matrix
      - Audit authorization usage
  low:
  - id: ECP-LOW-001
    signal: Emergency changes not integrated with normal process
    evidence_indicators:
    - Separate tracking systems
    - Emergency changes not in main records
    - Fragmented change history
    explanation: |
      Emergency changes should be integrated with normal change
      records for complete visibility and analysis. Separate tracking
      creates blind spots.
    remediation: |
      - Integrate emergency change records
      - Use same tracking system
      - Tag emergency status appropriately
      - Enable unified reporting
      - Maintain complete history
  positive:
  - id: ECP-POS-001
    signal: Well-defined emergency process with controls
    evidence_indicators:
    - Clear emergency criteria
    - Expedited approval defined
    - Post-emergency review required
  - id: ECP-POS-002
    signal: Emergency changes audited and reviewed
    evidence_indicators:
    - Complete audit trail
    - Frequency monitored
    - Retrospective reviews conducted
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Emergency Policy Review
    description: |
      Examine emergency change policy and criteria.
    duration_estimate: 30 min
    commands:
    - purpose: Find emergency documentation
      command: |
        find . -type f \( -name "*emergency*" -o -name "*hotfix*" \) \
          -name "*.md" 2>/dev/null | head -20
    - purpose: Search for emergency criteria
      command: |
        grep -rniE "(emergency|urgent).*(criteria|definition|when)" \
          --include="*.md" . 2>/dev/null | head -30
    expected_findings:
    - Emergency policy
    - Criteria definition
    - Process documentation
  - id: '2'
    name: Approval Workflow Review
    description: |
      Assess expedited approval workflow.
    duration_estimate: 30 min
    commands:
    - purpose: Find approval process
      command: |
        grep -rniE "(emergency|expedit).*(approv|authori)" \
          --include="*.md" . 2>/dev/null | head -20
    - purpose: Search for authorization rules
      command: |
        grep -rniE "(who|authori|permission).*(emergency|hotfix)" \
          --include="*.md" . 2>/dev/null | head -20
    expected_findings:
    - Approval workflow
    - Authorization matrix
    - Expedited process
  - id: '3'
    name: Post-Change Review Assessment
    description: |
      Evaluate post-emergency review requirements.
    duration_estimate: 30 min
    commands:
    - purpose: Find review requirements
      command: |
        grep -rniE "(post|after).*(emergency|review|retro)" \
          --include="*.md" . 2>/dev/null | head -20
    expected_findings:
    - Review requirements
    - Review process
    - Documentation needs
  - id: '4'
    name: Audit Trail and Metrics Review
    description: |
      Assess audit trail and tracking.
    duration_estimate: 30 min
    commands:
    - purpose: Find audit logging
      command: |
        grep -rniE "(audit|log|track).*(emergency|change)" \
          --include="*.yaml" --include="*.md" . 2>/dev/null | head -20
    expected_findings:
    - Audit configuration
    - Tracking mechanisms
    - Metrics definitions
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Policy Assessment
    - Workflow Review
    - Controls Analysis
    - Recommendations
  - type: emergency_workflow
    format: specification
    description: Emergency change workflow diagram
  confidence_guidance:
    high: Emergency process documented with controls
    medium: Process exists but controls unclear
    low: Emergency handling informal or undefined
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: itil-emergency-change
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Emergency process audit requires review
    full:
      included: true
      priority: 2
    production:
      included: true
      priority: 2
closeout_checklist:
- id: ecp-001
  item: Emergency change process is defined
  level: CRITICAL
  verification: |
    grep -rniE "(emergency|urgent).*(change|process)" \
      --include="*.md" . 2>/dev/null | wc -l | \
      xargs -I{} test {} -gt 0 && echo "PASS" || echo "FAIL"
  expected: PASS
- id: ecp-002
  item: Emergency criteria are documented
  level: BLOCKING
  verification: |
    grep -rniE "(emergency|urgent).*(criteria|when|qualif)" \
      --include="*.md" . 2>/dev/null | wc -l | \
      xargs -I{} test {} -gt 0 && echo "PASS" || echo "FAIL"
  expected: PASS
- id: ecp-003
  item: Post-emergency review required
  level: BLOCKING
  verification: manual
  verification_notes: Verify retrospective review is mandatory
  expected: Confirmed by reviewer
- id: ecp-004
  item: Emergency changes are tracked
  level: WARNING
  verification: manual
  verification_notes: Verify audit trail exists for emergency changes
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: SOC 2
    controls:
    - CC8.1
  - framework: ISO 27001
    controls:
    - A.12.1.2
  - framework: ITIL 4
    controls:
    - Change Enablement
  - framework: PCI DSS
    controls:
    - 6.4.5
relationships:
  commonly_combined:
  - operational-excellence.change-management.change-approval-process
  - operational-excellence.change-management.change-freeze-windows
  - operational-excellence.incident-management.incident-response-process
