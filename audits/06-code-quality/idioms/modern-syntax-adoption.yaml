audit:
  id: code-quality.idioms.modern-syntax-adoption
  name: Modern Syntax Adoption Audit
  version: 1.0.0
  last_updated: '2026-01-18'
  status: active
  category: code-quality
  category_number: 6
  subcategory: idioms
  tier: expert
  estimated_duration: 45 minutes
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: 'yes'
  severity: medium
  scope: codebase
  default_profiles:
  - full
  - quality
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates the codebase's adoption of modern language features and syntax
    introduced in recent language versions. This includes ES6+ features in
    JavaScript/TypeScript, Python 3.10+ features, modern Java features (records,
    pattern matching), and equivalent improvements in other languages.
  why_it_matters: |
    Modern syntax features often provide better performance, improved safety,
    and more expressive code. They reduce boilerplate, prevent common bugs,
    and make code more maintainable. Failure to adopt modern features indicates
    technical stagnation and may signal compatibility issues or lack of
    continuous improvement culture.
  when_to_run:
  - After language version upgrades
  - During technical debt assessments
  - Code review standardization
  - New project setup
prerequisites:
  required_artifacts:
  - type: source_code
    description: Application source code
  - type: config
    description: Language configuration files (tsconfig, pyproject.toml, etc.)
  access_requirements:
  - Read access to source code repository
discovery:
  code_patterns:
  - pattern: \bvar\s+\w+\s*=
    type: regex
    scope: source
    purpose: Detect legacy var usage in JavaScript
  - pattern: function\s+\w+\s*\(
    type: regex
    scope: source
    purpose: Detect function declarations vs arrow functions
  - pattern: \.then\s*\(
    type: regex
    scope: source
    purpose: Detect Promise chains vs async/await
  - pattern: format\s*\(|%\s*\(
    type: regex
    scope: source
    purpose: Detect old string formatting in Python
  file_patterns:
  - glob: '**/*.{js,ts,jsx,tsx}'
    purpose: JavaScript/TypeScript files
  - glob: '**/*.py'
    purpose: Python files
  - glob: '**/tsconfig.json'
    purpose: TypeScript configuration
  - glob: '**/pyproject.toml'
    purpose: Python project configuration
knowledge_sources:
  specifications:
  - id: ecmascript
    name: ECMAScript Language Specification
    url: https://tc39.es/ecma262/
    offline_cache: true
    priority: required
  guides:
  - id: python-whatsnew
    name: Python What's New Documentation
    url: https://docs.python.org/3/whatsnew/
    offline_cache: true
  - id: typescript-releases
    name: TypeScript Release Notes
    url: https://www.typescriptlang.org/docs/handbook/release-notes/overview.html
    offline_cache: true
  - id: design-patterns-gof
    name: 'Design Patterns: Elements of Reusable Object-Oriented Software'
    url: https://www.oreilly.com/library/view/design-patterns-elements/0201633612/
    offline_cache: false
  - id: effective-java
    name: Effective Java
    url: https://www.oreilly.com/library/view/effective-java-3rd/9780134686097/
    offline_cache: false
tooling:
  static_analysis:
  - tool: eslint
    purpose: JavaScript/TypeScript modern syntax enforcement
    offline_capable: true
  - tool: pyupgrade
    purpose: Automatic Python syntax modernization
    offline_capable: true
  - tool: ruff
    purpose: Python linting with modern syntax checks
    offline_capable: true
  scripts:
  - id: modern-syntax-scan
    language: bash
    purpose: Detect legacy syntax patterns
    source: inline
    code: |
      echo "=== JavaScript/TypeScript Legacy Patterns ==="
      echo "--- var usage (should be let/const) ---"
      grep -rn "\bvar\s" --include="*.js" --include="*.ts" . 2>/dev/null | grep -v node_modules | head -20

      echo "--- Promise chains (consider async/await) ---"
      grep -rn "\.then\s*(" --include="*.js" --include="*.ts" . 2>/dev/null | grep -v node_modules | wc -l

      echo "=== Python Legacy Patterns ==="
      echo "--- Old string formatting ---"
      grep -rn '"%.*%\|\.format(' --include="*.py" . 2>/dev/null | head -20
signals:
  critical:
  - id: MODERN-CRIT-001
    signal: Using deprecated language features scheduled for removal
    evidence_pattern: __future__ imports for Python 2|arguments\[|document\.all
    explanation: |
      Deprecated features may be removed in future versions, causing code
      to break during upgrades. This represents a ticking time bomb.
    remediation: Migrate to modern equivalents before feature removal
  - id: MODERN-CRIT-002
    signal: Target language version is end-of-life
    evidence_pattern: python_requires.*<3.8|target.*ES5
    explanation: |
      Targeting EOL language versions means no security patches and
      inability to use modern features that improve code quality.
    remediation: Upgrade target version to currently supported LTS
  high:
  - id: MODERN-HIGH-001
    signal: Extensive use of var instead of let/const
    evidence_pattern: \bvar\s+\w+\s*=
    explanation: |
      var has function scope and hoisting, leading to subtle bugs. let/const
      provide block scope and prevent accidental reassignment.
    remediation: Convert var to const (default) or let (when reassignment needed)
  - id: MODERN-HIGH-002
    signal: Promise chains instead of async/await
    evidence_pattern: \.then\s*\(.*\.then\s*\(
    explanation: |
      Nested promise chains are harder to read and error-prone compared
      to async/await. They also make error handling more complex.
    remediation: Refactor to async/await with try/catch
  medium:
  - id: MODERN-MED-001
    signal: Old-style string formatting
    evidence_pattern: '"%s"|\.format\\(|\\+.*\\+.*string'
    remediation: Use template literals (JS) or f-strings (Python)
  - id: MODERN-MED-002
    signal: Manual object property copying
    evidence_pattern: Object\.assign|for.*in.*obj
    remediation: Use spread operator for object operations
  - id: MODERN-MED-003
    signal: Traditional function expressions for callbacks
    evidence_pattern: function\s*\(\w*\)\s*\{
    remediation: Use arrow functions for concise callbacks
  low:
  - id: MODERN-LOW-001
    signal: Not using optional chaining
    evidence_pattern: '&&.*&&.*\.'
    remediation: Use optional chaining (?.) for nested property access
  - id: MODERN-LOW-002
    signal: Not using nullish coalescing
    evidence_pattern: \|\|.*default|!= null \?
    remediation: Use nullish coalescing (??) for default values
  positive:
  - id: MODERN-POS-001
    signal: Consistent use of const/let over var
    evidence_pattern: No var declarations found
  - id: MODERN-POS-002
    signal: Async/await for all async operations
    evidence_pattern: async function|await\s
  - id: MODERN-POS-003
    signal: Modern TypeScript strict mode enabled
    evidence_pattern: strict.*true
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Check Language Configuration
    description: |
      Examine configuration files to determine target language versions
      and compiler/interpreter settings.
    duration_estimate: 10 min
    commands:
    - purpose: Check TypeScript configuration
      command: |
        find . -name "tsconfig.json" -exec cat {} \; 2>/dev/null | grep -E "target|module|strict"
    - purpose: Check Python version requirements
      command: |
        find . \( find . -name "pyproject.toml" -o -name "setup.py" \) | xargs grep -l "python" 2>/dev/null | head -5
    expected_findings:
    - Target language versions
    - Strict mode settings
    - Module system configuration
  - id: '2'
    name: Scan for Legacy JavaScript Patterns
    description: |
      Identify outdated JavaScript/TypeScript patterns that should be
      modernized.
    duration_estimate: 15 min
    commands:
    - purpose: Count var usages
      command: |
        grep -rn "\bvar\s" --include="*.js" --include="*.ts" . 2>/dev/null | grep -v node_modules | wc -l
    - purpose: Count promise chains
      command: |
        grep -rn "\.then\s*(" --include="*.js" --include="*.ts" . 2>/dev/null | grep -v node_modules | wc -l
    - purpose: Find callback functions
      command: |
        grep -rn "function\s*(\w*)\s*{" --include="*.js" --include="*.ts" . 2>/dev/null | grep -v node_modules | head -30
    expected_findings:
    - Legacy pattern counts
    - Files with most legacy code
  - id: '3'
    name: Scan for Legacy Python Patterns
    description: |
      Identify outdated Python patterns that can be modernized.
    duration_estimate: 10 min
    commands:
    - purpose: Find old string formatting
      command: |
        grep -rn '"%.*%\|\.format(' --include="*.py" . 2>/dev/null | grep -v __pycache__ | head -30
    - purpose: Check for type hints
      command: |
        grep -rn "def.*->.*:" --include="*.py" . 2>/dev/null | wc -l
    expected_findings:
    - String formatting style
    - Type hint adoption level
  - id: '4'
    name: Run Automated Upgrade Tools
    description: |
      Use automated tools to identify and suggest modernization changes.
    duration_estimate: 10 min
    commands:
    - purpose: Run ESLint with modern rules
      command: |
        npx eslint --rule 'prefer-const: warn' --rule 'prefer-arrow-callback: warn' --format stylish . 2>/dev/null || echo "ESLint not configured"
    - purpose: Preview pyupgrade changes
      command: |
        find . -name "*.py" -not -path "*/__pycache__/*" | head -10 | xargs pyupgrade --py310-plus --diff 2>/dev/null || echo "pyupgrade not installed"
    expected_findings:
    - Automated upgrade suggestions
    - Modernization opportunity count
output:
  deliverables:
  - type: finding_list
    format: structured
    content:
    - legacy_pattern_inventory
    - modernization_opportunities
    - file_by_file_assessment
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Current vs Target Standards
    - Modernization Roadmap
  confidence_guidance:
    high: Automated detection with clear modern alternative
    medium: Pattern detected, context-dependent remediation
    low: Style preference without strong technical justification
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: ecmascript
      priority: recommended
    - source_id: python-whatsnew
      priority: recommended
profiles:
  membership:
    quick:
      included: true
      priority: 3
    full:
      included: true
      priority: 2
    quality:
      included: true
      priority: 1
closeout_checklist:
- id: modern-001
  item: Target language versions documented
  level: BLOCKING
  verification: Configuration files reviewed
  expected: Target versions identified
- id: modern-002
  item: Legacy pattern inventory complete
  level: BLOCKING
  verification: All legacy patterns counted
  expected: Quantified legacy pattern usage
- id: modern-003
  item: No deprecated features in use
  level: CRITICAL
  verification: No EOL or removed features
  expected: Zero deprecated feature usage
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: ISO 25010
    controls:
    - Maintainability
    - Portability
relationships:
  commonly_combined:
  - code-quality.idioms.idiomatic-code
  - code-quality.idioms.deprecated-api-usage
  - code-quality.technical-debt.debt-assessment
