audit:
  id: code-quality.dead-code.commented-out-code
  name: Commented-Out Code Detection Audit
  version: 1.0.0
  last_updated: '2026-01-18'
  status: active
  category: code-quality
  category_number: 6
  subcategory: dead-code
  tier: expert
  estimated_duration: 30 minutes
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: codebase
  default_profiles:
  - full
  - quality
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Identifies blocks of code that have been commented out rather than deleted.
    This includes single-line commented code, multi-line commented blocks,
    and code inside disabled preprocessor directives. Distinguishes between
    actual code comments and explanatory documentation.
  why_it_matters: |
    Commented-out code clutters the codebase, confuses developers about whether
    it should be restored, and creates maintenance burden. Version control makes
    commenting code unnecessary since history is preserved. It often becomes
    outdated and misleading as the surrounding code evolves.
  when_to_run:
  - During code reviews
  - During codebase cleanup
  - Before major releases
  - Technical debt assessments
prerequisites:
  required_artifacts:
  - type: source_code
    description: Application source code
  access_requirements:
  - Read access to source code repository
discovery:
  code_patterns:
  - pattern: ^\s*//\s*(if|for|while|function|return|const|let|var)\b
    type: regex
    scope: source
    purpose: Detect single-line commented code (JavaScript/C-style)
  - pattern: ^\s*#\s*(if|for|while|def|return|import|from|class)\b
    type: regex
    scope: source
    purpose: Detect single-line commented code (Python/Shell)
  - pattern: /\*[\s\S]*?(if|for|while|function|return)[\s\S]*?\*/
    type: regex
    scope: source
    purpose: Detect multi-line commented code blocks
  - pattern: ^\s*//\s*[a-zA-Z_][a-zA-Z0-9_]*\s*\([^)]*\)\s*;
    type: regex
    scope: source
    purpose: Detect commented function calls
  file_patterns:
  - glob: '**/*.{js,ts,py,java,go,rb,cs,cpp,c}'
    purpose: Source code files
knowledge_sources:
  guides:
  - id: clean-code
    name: Robert C. Martin - Clean Code
    url: https://www.oreilly.com/library/view/clean-code-a/9780136083238/
    offline_cache: false
    priority: recommended
  - id: eslint-no-warning-comments
    name: ESLint no-warning-comments Rule
    url: https://eslint.org/docs/latest/rules/no-warning-comments
    offline_cache: true
tooling:
  static_analysis:
  - tool: eslint
    purpose: JavaScript/TypeScript commented code detection
    offline_capable: true
  - tool: sonarqube
    purpose: Multi-language commented code detection
    offline_capable: false
  scripts:
  - id: commented-code-scan
    language: bash
    purpose: Detect commented code patterns
    source: inline
    code: |
      # Find commented JavaScript/TypeScript code
      grep -rn --include="*.{js,ts}" -E "^\s*//\s*(if|for|while|function|return|const|let|var)\b" . 2>/dev/null
      # Find commented Python code
      grep -rn --include="*.py" -E "^\s*#\s*(if|for|while|def|return|import|class)\b" . 2>/dev/null
signals:
  critical:
  - id: DC-COMMENT-CRIT-001
    signal: Commented-out security code
    evidence_pattern: //.*authenticate|//.*authorize|//.*validate|//.*sanitize
    explanation: |
      Commented security code may indicate disabled security controls
      that were intentionally or accidentally turned off.
    remediation: Review security intent and either restore or delete permanently
  - id: DC-COMMENT-CRIT-002
    signal: Commented-out error handling
    evidence_pattern: //.*try|//.*catch|//.*throw|//.*except
    explanation: |
      Commented error handling code may leave the application vulnerable
      to unhandled exceptions and crashes.
    remediation: Restore error handling or implement proper alternative
  high:
  - id: DC-COMMENT-HIGH-001
    signal: Large blocks of commented code (>10 lines)
    evidence_pattern: consecutive_commented_lines > 10
    explanation: |
      Large commented blocks significantly clutter the codebase and
      likely represent abandoned features or incomplete refactoring.
    remediation: Delete commented blocks - use version control for history
  - id: DC-COMMENT-HIGH-002
    signal: Commented code with TODO/FIXME annotations
    evidence_pattern: //.*(TODO|FIXME).*code|#.*(TODO|FIXME).*code
    explanation: |
      Commented code marked with TODO suggests intention to restore,
      but this intention is often forgotten.
    remediation: Either restore and fix, or delete entirely
  medium:
  - id: DC-COMMENT-MED-001
    signal: Scattered single-line commented code
    evidence_pattern: //\s*(if|for|return|const)
    remediation: Delete commented code lines
  - id: DC-COMMENT-MED-002
    signal: Commented imports/includes
    evidence_pattern: //\s*import|//\s*#include|#\s*import
    remediation: Remove commented imports
  low:
  - id: DC-COMMENT-LOW-001
    signal: Commented debug/logging statements
    evidence_pattern: //\s*console\.log|//\s*print\(
    remediation: Remove or convert to proper logging
  positive:
  - id: DC-COMMENT-POS-001
    signal: No commented code detected
    evidence_pattern: zero_commented_code
  - id: DC-COMMENT-POS-002
    signal: Lint rule prevents commented code
    evidence_pattern: eslint.*no-commented-out-code
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Scan for Commented Code Patterns
    description: |
      Search the codebase for patterns that indicate commented-out code
      rather than explanatory comments.
    duration_estimate: 10 min
    commands:
    - purpose: Find commented JavaScript code
      command: |
        grep -rn --include="*.{js,ts}" -E "^\s*//\s*(if|for|while|function|return|const|let|var|try|catch)\b" . 2>/dev/null | head -100
    - purpose: Find commented Python code
      command: |
        grep -rn --include="*.py" -E "^\s*#\s*(if|for|while|def|return|import|class|try|except)\b" . 2>/dev/null | head -100
    expected_findings:
    - List of commented code locations
    - Code pattern types
  - id: '2'
    name: Identify Large Blocks
    description: |
      Find consecutive commented lines that indicate large
      commented-out code blocks.
    duration_estimate: 10 min
    commands:
    - purpose: Find consecutive commented lines
      command: |
        # Look for files with many consecutive comments
        grep -rn --include="*.{js,ts}" "^\s*//" . 2>/dev/null | cut -d: -f1 | uniq -c | sort -rn | head -20
    expected_findings:
    - Files with large comment blocks
    - Block sizes
  - id: '3'
    name: Classify Severity
    description: |
      Review detected commented code and classify by risk level
      based on code type (security, error handling, etc.).
    duration_estimate: 10 min
    expected_findings:
    - Security-related commented code
    - Error handling commented code
    - General commented code
output:
  deliverables:
  - type: finding_list
    format: structured
    content:
    - commented_code_locations
    - code_type
    - block_size
    - severity_classification
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Commented Code Inventory
    - Risk Assessment
    - Cleanup Recommendations
  confidence_guidance:
    high: Pattern clearly indicates code (keywords, syntax)
    medium: Pattern suggests code but may be documentation
    low: Ambiguous - manual review needed
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: clean-code
      priority: recommended
profiles:
  membership:
    quick:
      included: true
      priority: 3
    full:
      included: true
      priority: 1
    quality:
      included: true
      priority: 1
closeout_checklist:
- id: commented-001
  item: Commented code scan completed
  level: BLOCKING
  verification: |
    grep -rn --include="*.{js,ts,py}" -E "^\s*(//|#)\s*(if|for|while|function|def|return)\b" . 2>/dev/null | wc -l
  expected: Scan complete, count documented
- id: commented-002
  item: No commented security code
  level: CRITICAL
  verification: |
    grep -rn --include="*.{js,ts,py}" -iE "^\s*(//|#).*(auth|security|valid|sanitize)" . 2>/dev/null | wc -l
  expected: '0'
- id: commented-003
  item: Large blocks documented
  level: WARNING
  verification: manual
  verification_notes: Review output for blocks > 10 lines
  expected: All large blocks documented
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: ISO 25010
    controls:
    - Maintainability
relationships:
  commonly_combined:
  - code-quality.dead-code.unreachable-code
  - code-quality.dead-code.todo-fixme
  - code-quality.maintainability.code-readability
