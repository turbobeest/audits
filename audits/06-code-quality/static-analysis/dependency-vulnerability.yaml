audit:
  id: code-quality.static-analysis.dependency-vulnerability
  name: Dependency Vulnerability
  version: 1.0.0
  last_updated: '2026-01-18'
  status: active
  category: code-quality
  category_number: 6
  subcategory: static-analysis
  tier: expert
  estimated_duration: 1-2 hours  # median: 1h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: 'yes'
  severity: critical
  scope: codebase
  default_profiles:
  - full
  - quick
  - security
  blocks_phase: true
  parallelizable: true
description:
  what: |
    Scans project dependencies for known security vulnerabilities using
    vulnerability databases (CVE, NVD, GitHub Advisory). Analyzes both
    direct and transitive dependencies across all package ecosystems.
  why_it_matters: |
    Vulnerable dependencies are a leading attack vector. A single
    compromised library can expose the entire application to exploitation.
    Supply chain attacks increasingly target popular packages, making
    continuous dependency monitoring essential.
  when_to_run:
  - Every build in CI/CD pipeline
  - Before deployments
  - Weekly scheduled scans
  - After dependency updates
prerequisites:
  required_artifacts:
  - type: dependency_manifest
    description: Package lock files (package-lock.json, Pipfile.lock, etc.)
  - type: source_code
    description: Source code for dependency resolution
  access_requirements:
  - Read access to dependency manifests
  - Internet access for vulnerability database queries (or cached database)
discovery:
  file_patterns:
  - glob: '**/package.json'
    purpose: Node.js dependencies
  - glob: '**/package-lock.json'
    purpose: Node.js locked dependencies
  - glob: '**/yarn.lock'
    purpose: Yarn locked dependencies
  - glob: '**/requirements.txt'
    purpose: Python dependencies
  - glob: '**/Pipfile.lock'
    purpose: Python Pipenv locked dependencies
  - glob: '**/poetry.lock'
    purpose: Python Poetry locked dependencies
  - glob: '**/go.mod'
    purpose: Go module dependencies
  - glob: '**/go.sum'
    purpose: Go dependency checksums
  - glob: '**/Gemfile.lock'
    purpose: Ruby locked dependencies
  - glob: '**/pom.xml'
    purpose: Maven Java dependencies
  - glob: '**/build.gradle'
    purpose: Gradle Java dependencies
  - glob: '**/Cargo.lock'
    purpose: Rust locked dependencies
knowledge_sources:
  specifications:
  - id: nvd
    name: National Vulnerability Database
    url: https://nvd.nist.gov/
    offline_cache: true
    priority: required
  - id: github-advisory
    name: GitHub Advisory Database
    url: https://github.com/advisories
    offline_cache: true
    priority: required
  guides:
  - id: owasp-dependency
    name: OWASP Dependency-Check
    url: https://owasp.org/www-project-dependency-check/
    offline_cache: true
  - id: nist-800-218
    name: NIST SP 800-218 - Secure Software Development Framework
    url: https://csrc.nist.gov/publications/detail/sp/800-218/final
    offline_cache: false
tooling:
  static_analysis:
  - tool: npm audit
    purpose: Node.js vulnerability scanning
    offline_capable: false
  - tool: pip-audit
    purpose: Python vulnerability scanning
    offline_capable: false
  - tool: safety
    purpose: Python safety check
    offline_capable: true
  - tool: snyk
    purpose: Multi-ecosystem vulnerability scanning
    offline_capable: false
  - tool: trivy
    purpose: Container and dependency scanning
    offline_capable: true
  - tool: OWASP Dependency-Check
    purpose: Java and multi-language scanning
    offline_capable: true
  - tool: govulncheck
    purpose: Go vulnerability scanning
    offline_capable: false
  scripts:
  - id: dep-vuln-scan
    language: bash
    purpose: Run multiple vulnerability scanners
    source: inline
    code: |
      #!/bin/bash
      echo "=== npm audit ===" && npm audit 2>/dev/null
      echo "=== pip-audit ===" && pip-audit 2>/dev/null
      echo "=== trivy ===" && trivy fs . 2>/dev/null
signals:
  critical:
  - id: DEPVULN-CRIT-001
    signal: Critical severity vulnerability in direct dependency
    evidence_pattern: CVSS score >= 9.0 in direct dependency
    explanation: |
      Critical vulnerabilities in direct dependencies pose immediate
      exploitation risk. These often include remote code execution,
      authentication bypass, or data exposure.
    remediation: Update dependency immediately; apply patch if update unavailable
  - id: DEPVULN-CRIT-002
    signal: Known exploited vulnerability (KEV) present
    evidence_pattern: Dependency listed in CISA KEV catalog
    explanation: |
      Vulnerabilities in the CISA Known Exploited Vulnerabilities
      catalog are actively being exploited in the wild.
    remediation: Emergency patch required; consider temporary mitigations
  high:
  - id: DEPVULN-HIGH-001
    signal: High severity vulnerability in direct dependency
    evidence_pattern: CVSS score 7.0-8.9 in direct dependency
    explanation: |
      High severity vulnerabilities require prompt attention
      and should be scheduled for near-term remediation.
    remediation: Schedule update within sprint; evaluate temporary mitigations
  - id: DEPVULN-HIGH-002
    signal: Critical vulnerability in transitive dependency
    evidence_pattern: CVSS >= 9.0 in transitive dependency
    explanation: |
      Transitive vulnerabilities may still be exploitable
      depending on how the parent dependency uses them.
    remediation: Update parent dependency or override transitive version
  medium:
  - id: DEPVULN-MED-001
    signal: Medium severity vulnerabilities present
    remediation: Include in regular update cycle
  - id: DEPVULN-MED-002
    signal: Dependencies significantly out of date
    remediation: Plan dependency update sprint to reduce exposure
  low:
  - id: DEPVULN-LOW-001
    signal: Low severity vulnerabilities in dev dependencies
  positive:
  - id: DEPVULN-POS-001
    signal: No known vulnerabilities detected
  - id: DEPVULN-POS-002
    signal: Automated dependency updates configured
procedure:
  context:
    cognitive_mode: critical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Inventory dependencies
    description: |
      Identify all dependency manifests and lock files to
      understand the full dependency tree.
    duration_estimate: 10 min
    commands:
    - purpose: Find all dependency files
      command: find . -name 'package*.json' -o -name '*.lock' -o -name 'requirements*.txt' -o -name 'go.mod'
        2>/dev/null
    expected_findings:
    - List of package ecosystems in use
    - Presence of lock files
  - id: '2'
    name: Run vulnerability scanners
    description: |
      Execute appropriate vulnerability scanners for each
      detected package ecosystem.
    duration_estimate: 15 min
    commands:
    - purpose: Node.js vulnerability scan
      command: npm audit --json 2>/dev/null | head -100
    - purpose: Python vulnerability scan
      command: pip-audit 2>/dev/null
    - purpose: Comprehensive scan with trivy
      command: trivy fs . --severity HIGH,CRITICAL 2>/dev/null | head -100
    expected_findings:
    - List of vulnerabilities by severity
    - Affected packages and versions
  - id: '3'
    name: Analyze severity and exploitability
    description: |
      Review detected vulnerabilities for actual exploitability
      in the context of this application.
    duration_estimate: 20 min
    expected_findings:
    - Prioritized vulnerability list
    - Exploitability assessment
  - id: '4'
    name: Check for available patches
    description: |
      Determine which vulnerabilities have available patches
      or updated versions.
    duration_estimate: 15 min
    commands:
    - purpose: Check for npm updates
      command: npm outdated 2>/dev/null | head -30
    expected_findings:
    - Available patch versions
    - Breaking change considerations
  - id: '5'
    name: Verify CI/CD integration
    description: |
      Ensure vulnerability scanning is integrated into the
      CI/CD pipeline for continuous monitoring.
    duration_estimate: 10 min
    commands:
    - purpose: Check for security scanning in CI
      command: grep -rn 'npm audit\|trivy\|snyk\|safety' .github/workflows/ 2>/dev/null
    expected_findings:
    - CI/CD security scan configuration
    - Blocking vs advisory behavior
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Critical Findings
    - Vulnerability Inventory
    - Remediation Plan
  - type: metrics
    format: table
    fields:
    - critical_count
    - high_count
    - medium_count
    - total_dependencies
    - vulnerable_percentage
  confidence_guidance:
    high: Multiple scanners confirm, CVE details verified
    medium: Single scanner detection, advisory available
    low: Heuristic detection, requires verification
offline:
  capability: partial
  cache_manifest:
    knowledge:
    - source_id: nvd
      priority: required
    - source_id: github-advisory
      priority: required
profiles:
  membership:
    quick:
      included: true
      priority: 1
    full:
      included: true
      priority: 1
    security:
      included: true
      priority: 1
closeout_checklist:
- id: dependency-vulnerability-001
  item: No critical vulnerabilities in direct dependencies
  level: CRITICAL
  verification: npm audit --audit-level=critical 2>/dev/null && echo PASS || echo FAIL
  expected: PASS
- id: dependency-vulnerability-002
  item: Vulnerability scanning in CI/CD pipeline
  level: BLOCKING
  verification: grep -rq 'audit\|trivy\|snyk' .github/workflows/ && echo PASS || echo FAIL
  expected: PASS
- id: dependency-vulnerability-003
  item: All high severity vulnerabilities have remediation plan
  level: BLOCKING
  verification: manual
  verification_notes: Review high severity findings and confirm remediation timeline
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: OWASP Top 10
    controls:
    - A06:2021 Vulnerable and Outdated Components
  - framework: SOC 2
    controls:
    - CC6.1
    - CC7.1
  - framework: PCI DSS
    controls:
    - '6.2'
relationships:
  commonly_combined:
  - code-quality.static-analysis.security-scanning
  - code-quality.static-analysis.static-analysis-ci
