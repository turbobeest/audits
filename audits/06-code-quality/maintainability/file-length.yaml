audit:
  id: code-quality.maintainability.file-length
  name: File Length Audit
  version: 1.0.0
  last_updated: '2026-01-18'
  status: active
  category: code-quality
  category_number: 6
  subcategory: maintainability
  tier: expert
  estimated_duration: 30 minutes
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: full
  severity: medium
  scope: codebase
  default_profiles:
  - full
  - quality
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Measures the size of source code files in lines of code. Identifies
    overly large files that may contain too many responsibilities, classes,
    or functions. Evaluates file size distribution across the codebase.
  why_it_matters: |
    Large files are navigation and maintenance challenges. They often indicate
    violation of separation of concerns. Files over 500 lines have higher
    merge conflict rates and longer review times. Most style guides recommend
    keeping files under 300-500 lines for optimal maintainability.
  when_to_run:
  - During code reviews
  - Codebase restructuring
  - Monolith decomposition
  - Technical debt assessments
prerequisites:
  required_artifacts:
  - type: source_code
    description: Application source code
  access_requirements:
  - Read access to source code
discovery:
  file_patterns:
  - glob: '**/*.{js,ts,py,java,go,rb,cs,cpp,c}'
    purpose: Source code files
knowledge_sources:
  guides:
  - id: clean-code
    name: Robert C. Martin - Clean Code
    url: https://www.oreilly.com/library/view/clean-code-a/9780136083238/
    offline_cache: false
  - id: pragmatic-programmer
    name: The Pragmatic Programmer
    url: https://pragprog.com/titles/tpp20/the-pragmatic-programmer-20th-anniversary-edition/
    offline_cache: false
tooling:
  static_analysis:
  - tool: eslint
    purpose: JavaScript/TypeScript file length
    offline_capable: true
  - tool: wc
    purpose: Line counting
    offline_capable: true
  scripts:
  - id: file-length-check
    language: bash
    purpose: Find large files
    source: inline
    code: |
      find . -name "*.ts" -o -name "*.js" -o -name "*.py" | \
        xargs wc -l | sort -rn | head -20
signals:
  critical:
  - id: FIL-CRIT-001
    signal: Files exceeding 2000 lines
    evidence_pattern: file_lines > 2000
    cwe: CWE-1080
    explanation: |
      Extremely large files are nearly impossible to navigate and
      understand as a whole. They create significant merge conflicts
      and impede team productivity.
    remediation: Split into multiple focused modules immediately
  high:
  - id: FIL-HIGH-001
    signal: Files between 1000-2000 lines
    evidence_pattern: 1000 < file_lines <= 2000
    cwe: CWE-1080
    explanation: |
      Large files likely contain multiple concerns and would benefit
      from decomposition into smaller, focused modules.
    remediation: Identify logical boundaries and extract to separate files
  medium:
  - id: FIL-MED-001
    signal: Files between 500-1000 lines
    evidence_pattern: 500 < file_lines <= 1000
    remediation: Consider splitting when making significant changes
  - id: FIL-MED-002
    signal: More than 10% of files exceed 500 lines
    evidence_pattern: large_file_ratio > 10%
    remediation: Establish file size guidelines and refactor gradually
  low:
  - id: FIL-LOW-001
    signal: No file length limits configured
    evidence_pattern: no_length_rules
    remediation: Add max-lines to linting configuration
  positive:
  - id: FIL-POS-001
    signal: Average file length under 200 lines
    evidence_pattern: avg_length < 200
  - id: FIL-POS-002
    signal: No files exceed 500 lines
    evidence_pattern: max_length <= 500
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Measure File Sizes
    description: |
      Count lines of code for all source files in the repository.
    duration_estimate: 10 min
    commands:
    - purpose: Count lines in all source files
      command: |
        find . -name "*.ts" -o -name "*.js" -o -name "*.py" -o -name "*.java" | \
          xargs wc -l | sort -rn | head -50
    expected_findings:
    - Per-file line counts
    - Largest files identified
  - id: '2'
    name: Calculate Distribution
    description: |
      Analyze the distribution of file sizes to understand
      codebase-wide patterns.
    duration_estimate: 10 min
    expected_findings:
    - Average and median file size
    - Size category distribution
  - id: '3'
    name: Identify Restructuring Candidates
    description: |
      Flag files that would benefit from splitting based on
      size and logical cohesion.
    duration_estimate: 10 min
    expected_findings:
    - Files with multiple classes/modules
    - Split point recommendations
output:
  deliverables:
  - type: metrics
    format: structured
    content:
    - file_size_list
    - avg_file_size
    - max_file_size
    - size_distribution
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Size Distribution
    - Restructuring Candidates
    - Recommendations
  confidence_guidance:
    high: Complete file inventory analyzed
    medium: Sampling-based analysis
    low: Limited file access
offline:
  capability: full
profiles:
  membership:
    quick:
      included: true
      priority: 2
    full:
      included: true
      priority: 1
    quality:
      included: true
      priority: 1
closeout_checklist:
- id: fil-001
  item: File size analysis complete
  level: BLOCKING
  verification: All files measured
  expected: Size inventory available
- id: fil-002
  item: Large files documented
  level: WARNING
  verification: List of files > 500 lines
  expected: Restructuring candidates identified
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: ISO 25010
    controls:
    - Maintainability
    - Modularity
relationships:
  commonly_combined:
  - code-quality.maintainability.function-length
  - code-quality.maintainability.cohesion
  - code-quality.architecture-design.modularity
