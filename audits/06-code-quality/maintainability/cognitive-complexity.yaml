audit:
  id: code-quality.maintainability.cognitive-complexity
  name: Cognitive Complexity Audit
  version: 1.0.0
  last_updated: '2026-01-18'
  status: active
  category: code-quality
  category_number: 6
  subcategory: maintainability
  tier: expert
  estimated_duration: 45 minutes
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: full
  severity: high
  scope: codebase
  default_profiles:
  - full
  - quality
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Measures cognitive complexity, a metric developed by SonarSource that
    evaluates how difficult code is for humans to understand. Unlike cyclomatic
    complexity, it penalizes nested structures more heavily, recognizes
    shorthand patterns, and ignores structures that don't impair understanding.
  why_it_matters: |
    Cognitive complexity better correlates with developer comprehension time
    than cyclomatic complexity. High cognitive complexity leads to longer
    onboarding times, more bugs during modification, and higher review burden.
    SonarSource research shows 15 is the threshold beyond which understanding
    drops significantly.
  when_to_run:
  - During code reviews
  - Before major releases
  - During refactoring initiatives
  - Technical debt assessments
prerequisites:
  required_artifacts:
  - type: source_code
    description: Application source code
  access_requirements:
  - Read access to source code
discovery:
  code_patterns:
  - pattern: if|else|while|for|switch|catch|break|continue|goto
    type: regex
    scope: source
    purpose: Identify control flow constructs
  - pattern: '&&|\|\||\?.*:'
    type: regex
    scope: source
    purpose: Identify compound conditions
  file_patterns:
  - glob: '**/*.{js,ts,py,java,go,rb,cs}'
    purpose: Source code files
knowledge_sources:
  specifications:
  - id: sonar-cognitive
    name: Cognitive Complexity White Paper
    url: https://www.sonarsource.com/resources/white-papers/cognitive-complexity/
    offline_cache: true
    priority: required
  guides:
  - id: clean-code
    name: Robert C. Martin - Clean Code
    url: https://www.oreilly.com/library/view/clean-code-a/9780136083238/
    offline_cache: false
  - id: pragmatic-programmer
    name: The Pragmatic Programmer
    url: https://pragprog.com/titles/tpp20/the-pragmatic-programmer-20th-anniversary-edition/
    offline_cache: false
tooling:
  static_analysis:
  - tool: sonarqube
    purpose: Comprehensive cognitive complexity analysis
    offline_capable: true
  - tool: eslint-plugin-sonarjs
    purpose: JavaScript/TypeScript cognitive complexity
    offline_capable: true
  scripts:
  - id: cognitive-check
    language: bash
    purpose: Check cognitive complexity with ESLint
    source: inline
    code: |
      npx eslint --rule 'sonarjs/cognitive-complexity: [warn, 15]' . 2>/dev/null
signals:
  critical:
  - id: COGC-CRIT-001
    signal: Functions with cognitive complexity > 50
    evidence_pattern: cognitive_complexity > 50
    explanation: |
      Extremely high cognitive load makes functions virtually
      incomprehensible. New developers will struggle significantly
      to understand or safely modify this code.
    remediation: Major refactoring required - extract sub-functions
  high:
  - id: COGC-HIGH-001
    signal: Functions with cognitive complexity between 25-50
    evidence_pattern: 25 <= cognitive_complexity <= 50
    explanation: |
      High cognitive load impairs understanding. Multiple reads
      and significant mental effort required to comprehend logic.
    remediation: Reduce nesting, extract helper functions
  - id: COGC-HIGH-002
    signal: Deep nesting (>4 levels) in functions
    evidence_pattern: nesting_depth > 4
    explanation: |
      Deep nesting is a major contributor to cognitive complexity,
      forcing readers to maintain extensive mental context.
    remediation: Use early returns, guard clauses, or extract functions
  medium:
  - id: COGC-MED-001
    signal: Functions with cognitive complexity between 15-25
    evidence_pattern: 15 <= cognitive_complexity < 25
    remediation: Prioritize simplification when modifying
  low:
  - id: COGC-LOW-001
    signal: No cognitive complexity tooling
    evidence_pattern: no_cognitive_tools
    remediation: Add SonarJS or equivalent to CI
  positive:
  - id: COGC-POS-001
    signal: Average cognitive complexity below 8
    evidence_pattern: avg_cognitive < 8
  - id: COGC-POS-002
    signal: No functions exceed cognitive complexity 15
    evidence_pattern: max_cognitive <= 15
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Run Cognitive Complexity Analysis
    description: |
      Execute cognitive complexity analysis using SonarQube or
      equivalent tooling.
    duration_estimate: 15 min
    commands:
    - purpose: Run SonarJS ESLint plugin
      command: |
        npx eslint --plugin sonarjs --rule 'sonarjs/cognitive-complexity: [error, 15]' . 2>/dev/null
    expected_findings:
    - Per-function cognitive complexity scores
    - Nesting depth analysis
  - id: '2'
    name: Identify Comprehension Hotspots
    description: |
      Find the functions that will be hardest for developers
      to understand and safely modify.
    duration_estimate: 15 min
    expected_findings:
    - Top 20 most complex functions
    - Deeply nested code sections
  - id: '3'
    name: Analyze Patterns Contributing to Complexity
    description: |
      Identify which coding patterns are driving up cognitive
      complexity to target specific improvements.
    duration_estimate: 10 min
    expected_findings:
    - Common complexity patterns
    - Nesting vs branching analysis
  - id: '4'
    name: Prioritize Remediation
    description: |
      Rank complex functions by modification frequency and
      criticality to prioritize refactoring efforts.
    duration_estimate: 5 min
    expected_findings:
    - High-priority refactoring targets
    - Quick wins for complexity reduction
output:
  deliverables:
  - type: metrics
    format: structured
    content:
    - function_cognitive_complexity
    - avg_cognitive_complexity
    - max_cognitive_complexity
    - nesting_analysis
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Cognitive Complexity Distribution
    - Pattern Analysis
    - Recommendations
  confidence_guidance:
    high: SonarQube or equivalent full analysis
    medium: ESLint plugin analysis
    low: Manual assessment only
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: sonar-cognitive
      priority: required
profiles:
  membership:
    quick:
      included: true
      priority: 2
    full:
      included: true
      priority: 1
    quality:
      included: true
      priority: 1
closeout_checklist:
- id: cogc-001
  item: Cognitive complexity analyzed
  level: BLOCKING
  verification: All functions scored
  expected: Complete coverage
- id: cogc-002
  item: High complexity functions documented
  level: WARNING
  verification: List of functions > 15
  expected: Prioritized remediation list
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: ISO 25010
    controls:
    - Maintainability
    - Analysability
relationships:
  commonly_combined:
  - code-quality.maintainability.cyclomatic-complexity
  - code-quality.maintainability.function-length
  - code-quality.maintainability.coupling
