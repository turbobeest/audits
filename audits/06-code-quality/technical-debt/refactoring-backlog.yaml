audit:
  id: code-quality.technical-debt.refactoring-backlog
  name: Refactoring Backlog Audit
  version: 1.0.0
  last_updated: '2026-01-18'
  status: active
  category: code-quality
  category_number: 6
  subcategory: technical-debt
  tier: expert
  estimated_duration: 1.5 hours
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: codebase
  default_profiles:
  - full
  - maintenance
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Reviews and evaluates the refactoring backlog including queued improvements,
    code restructuring tasks, and architectural cleanup work. Assesses whether
    the backlog is well-organized, prioritized, and actionable. Identifies
    stale items, missing refactoring opportunities, and backlog health.
  why_it_matters: |
    A healthy refactoring backlog enables continuous code improvement without
    disrupting feature delivery. Martin Fowler notes that refactoring should
    be an ongoing practice, not a separate phase. Without a managed backlog,
    refactoring opportunities are lost, and code quality degrades over time.
    An actionable backlog with clear priorities enables teams to allocate
    appropriate time for improvement work.
  when_to_run:
  - Sprint planning
  - Quarterly backlog grooming
  - After major feature releases
  - Before architectural changes
prerequisites:
  required_artifacts:
  - type: issue_tracker
    description: Access to backlog management system
  - type: source_code
    description: Codebase to identify refactoring needs
  - type: documentation
    description: Architecture documentation
  access_requirements:
  - Read access to issue tracker
  - Read access to source code
  - Access to backlog management tools
discovery:
  code_patterns:
  - pattern: refactor|REFACTOR|Refactor
    type: regex
    scope: comments
    purpose: Find refactoring markers
  - pattern: needs.?cleanup|cleanup.?needed
    type: regex
    scope: comments
    purpose: Find cleanup markers
  - pattern: '@refactor|@cleanup'
    type: regex
    scope: comments
    purpose: Find tagged refactoring needs
  file_patterns:
  - glob: '**/REFACTORING.md'
    purpose: Refactoring documentation
  - glob: '**/ARCHITECTURE.md'
    purpose: Architecture decisions
  - glob: '**/ADR/**'
    purpose: Architecture decision records
knowledge_sources:
  specifications:
  - id: fowler-refactoring
    name: 'Martin Fowler: Refactoring'
    url: https://refactoring.com/
    offline_cache: true
    priority: required
  guides:
  - id: refactoring-patterns
    name: Refactoring Patterns Catalog
    url: https://refactoring.guru/refactoring
    offline_cache: true
  - id: refactoring-fowler
    name: Martin Fowler - Refactoring
    url: https://refactoring.com/
    offline_cache: false
  - id: refactoring-catalog
    name: Refactoring Catalog
    url: https://refactoring.com/catalog/
    offline_cache: false
  - id: clean-code
    name: Robert C. Martin - Clean Code
    url: https://www.oreilly.com/library/view/clean-code-a/9780136083238/
    offline_cache: false
tooling:
  static_analysis:
  - tool: sonarqube
    purpose: Identify code smells needing refactoring
    offline_capable: false
  - tool: codeclimate
    purpose: Complexity and duplication analysis
    offline_capable: false
  scripts:
  - id: refactor-scan
    language: bash
    purpose: Find refactoring markers
    source: inline
    code: |
      # Find refactoring-related comments
      grep -rn --include="*.{js,ts,py,java,go,rb,cs}" \
        -i "refactor\|cleanup\|rewrite" .
signals:
  critical:
  - id: REFAC-CRIT-001
    signal: No refactoring backlog exists
    evidence_pattern: absence of refactoring tracking
    explanation: |
      Team has no mechanism for tracking refactoring needs.
      This leads to ad-hoc improvements and lost opportunities.
    remediation: Create dedicated refactoring backlog with prioritization
  high:
  - id: REFAC-HIGH-001
    signal: Stale backlog items (over 6 months)
    evidence_pattern: refactoring items older than 6 months
    explanation: |
      Old refactoring items indicate either incorrect prioritization
      or scope creep. Stale items reduce backlog credibility.
    remediation: Review and either act on or remove stale items
  - id: REFAC-HIGH-002
    signal: Unprioritized refactoring work
    evidence_pattern: refactoring items without priority
    explanation: |
      Without prioritization, teams cannot make informed decisions
      about which refactoring to tackle during available time.
    remediation: Prioritize all backlog items using consistent criteria
  medium:
  - id: REFAC-MED-001
    signal: Missing effort estimates
    evidence_pattern: refactoring items without size/effort
    remediation: Add effort estimates to enable sprint planning
  - id: REFAC-MED-002
    signal: No acceptance criteria
    evidence_pattern: refactoring items without done definition
    remediation: Define clear acceptance criteria for refactoring work
  low:
  - id: REFAC-LOW-001
    signal: Disconnected from code markers
    evidence_pattern: code REFACTOR markers not in backlog
    remediation: Sync code markers with backlog items
  positive:
  - id: REFAC-POS-001
    signal: Well-organized refactoring backlog
    evidence_pattern: categorized and prioritized items
  - id: REFAC-POS-002
    signal: Regular backlog grooming
    evidence_pattern: recent updates and activity
  - id: REFAC-POS-003
    signal: Linked to code locations
    evidence_pattern: backlog items reference specific code
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: backlog-auditor
  steps:
  - id: '1'
    name: Review Existing Backlog
    description: |
      Examine the current refactoring backlog in
      issue tracking system.
    duration_estimate: 20 min
    commands:
    - purpose: Find refactoring issues
      command: |
        gh issue list --label "refactor" --state all --json number,title,createdAt
    - purpose: Check for cleanup issues
      command: |
        gh issue list --label "cleanup" --state all --json number,title,createdAt
    expected_findings:
    - Backlog item count
    - Age distribution
  - id: '2'
    name: Scan Code for Refactoring Markers
    description: |
      Search codebase for refactoring comments and
      markers not yet in backlog.
    duration_estimate: 20 min
    commands:
    - purpose: Find REFACTOR markers
      command: |
        grep -rn --include="*.{js,ts,py,java,go,rb,cs}" \
          -i "refactor" .
    - purpose: Find cleanup markers
      command: |
        grep -rn --include="*.{js,ts,py,java,go,rb,cs}" \
          -i "needs.*cleanup\|cleanup.*needed" .
    expected_findings:
    - Code markers catalog
    - Gap analysis vs backlog
  - id: '3'
    name: Analyze Backlog Health
    description: |
      Evaluate age, completeness, and organization
      of backlog items.
    duration_estimate: 20 min
    commands:
    - purpose: Check item age distribution
      command: |
        gh issue list --label "refactor" --state open --json createdAt | \
          jq '.[].createdAt'
    - purpose: Check for estimates
      command: |
        gh issue list --label "refactor" --state open --json labels | \
          jq '.[].labels[].name' | grep -i "size\|effort"
    expected_findings:
    - Age distribution
    - Estimation coverage
  - id: '4'
    name: Assess Prioritization
    description: |
      Review how refactoring items are prioritized
      and selected for work.
    duration_estimate: 15 min
    commands:
    - purpose: Check priority labels
      command: |
        gh issue list --label "refactor" --json labels | \
          jq '.[].labels[].name' | grep -i "priority\|p0\|p1\|p2"
    expected_findings:
    - Prioritization scheme
    - Coverage of priorities
  - id: '5'
    name: Review Completion History
    description: |
      Analyze recently completed refactoring work
      to assess velocity and patterns.
    duration_estimate: 15 min
    commands:
    - purpose: Find completed refactoring
      command: |
        gh issue list --label "refactor" --state closed \
          --json number,title,closedAt | head -20
    expected_findings:
    - Completion rate
    - Recent activity
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Backlog Health Assessment
    - Gap Analysis
    - Prioritization Review
    - Recommendations
  confidence_guidance:
    high: Well-organized backlog with regular activity
    medium: Backlog exists but needs grooming
    low: Ad-hoc or missing backlog
offline:
  capability: partial
  cache_manifest:
    knowledge:
    - source_id: fowler-refactoring
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires backlog analysis
    full:
      included: true
      priority: 2
    maintenance:
      included: true
      priority: 1
closeout_checklist:
- id: refac-001
  item: Refactoring backlog exists
  level: REQUIRED
  verification: |
    gh label list | grep -i refactor | wc -l
  expected: Greater than 0
- id: refac-002
  item: Backlog items are prioritized
  level: WARNING
  verification: Manual review of backlog
  agent_alternative: Use static analysis tools to generate metrics; check for existing code review comments
  expected: All items have priority
- id: refac-003
  item: Code markers synced with backlog
  level: WARNING
  verification: Compare code markers with issues
  expected: All markers tracked
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: ISO 25010
    controls:
    - Maintainability
relationships:
  commonly_combined:
  - code-quality.technical-debt.tech-debt-inventory
  - code-quality.technical-debt.debt-prioritization
  - code-quality.maintainability.code-complexity
