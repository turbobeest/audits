audit:
  id: code-quality.code-smells.long-parameter-list
  name: Long Parameter List Detection Audit
  version: 1.0.0
  last_updated: '2026-01-18'
  status: active
  category: code-quality
  category_number: 6
  subcategory: code-smells
  tier: expert
  estimated_duration: 30 minutes
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: full
  severity: medium
  scope: codebase
  default_profiles:
  - full
  - quality
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Identifies functions and methods with excessive numbers of parameters.
    Long parameter lists are typically defined as having more than 3-4
    parameters, though thresholds vary by coding standards. This includes
    both positional and named parameters.
  why_it_matters: |
    Long parameter lists make functions hard to understand, call correctly,
    and maintain. They often indicate that a function is doing too much or
    that related parameters should be grouped into objects. They increase
    the likelihood of parameter ordering errors and make testing more complex.
  when_to_run:
  - During code reviews
  - When adding new parameters
  - API design reviews
  - Refactoring initiatives
prerequisites:
  required_artifacts:
  - type: source_code
    description: Application source code
  access_requirements:
  - Read access to source code repository
discovery:
  code_patterns:
  - pattern: \([^)]*,\s*[^)]*,\s*[^)]*,\s*[^)]*,\s*[^)]*\)
    type: regex
    scope: source
    purpose: Functions with 5+ parameters
  - pattern: function\s+\w+\s*\([^)]{50,}\)
    type: regex
    scope: source
    purpose: Functions with long parameter strings
  - pattern: def\s+\w+\s*\(self,\s*[^)]*,\s*[^)]*,\s*[^)]*,\s*[^)]*\)
    type: regex
    scope: source
    purpose: Python methods with 4+ parameters (excluding self)
  file_patterns:
  - glob: '**/*.{js,ts,py,java,go,rb,cs,cpp,c}'
    purpose: Source code files
knowledge_sources:
  specifications:
  - id: cwe-1064
    name: 'CWE-1064: Invokable Control Element with Signature Containing Excessive Parameters'
    url: https://cwe.mitre.org/data/definitions/1064.html
    offline_cache: true
    priority: required
  guides:
  - id: fowler-long-params
    name: Martin Fowler - Long Parameter List
    url: https://refactoring.guru/smells/long-parameter-list
    offline_cache: true
  - id: clean-code
    name: Robert C. Martin - Clean Code (Functions)
    url: https://www.oreilly.com/library/view/clean-code-a/9780136083238/
    offline_cache: false
  - id: refactoring-fowler
    name: Martin Fowler - Refactoring
    url: https://refactoring.com/
    offline_cache: false
  - id: refactoring-catalog
    name: Refactoring Catalog
    url: https://refactoring.com/catalog/
    offline_cache: false
tooling:
  static_analysis:
  - tool: eslint
    purpose: JavaScript/TypeScript max-params rule
    offline_capable: true
  - tool: pylint
    purpose: Python too-many-arguments rule
    offline_capable: true
  - tool: pmd
    purpose: Java ExcessiveParameterList rule
    offline_capable: true
  - tool: checkstyle
    purpose: Java ParameterNumber rule
    offline_capable: true
  scripts:
  - id: long-params-scan
    language: bash
    purpose: Detect functions with many parameters
    source: inline
    code: |
      # Find functions with 5+ commas in parameter list
      grep -rn --include="*.{ts,java}" -E "function\s+\w+\s*\([^)]*,[^)]*,[^)]*,[^)]*,[^)]*\)" . 2>/dev/null | head -50
signals:
  critical:
  - id: CS-PARAMS-CRIT-001
    signal: Functions with 10+ parameters
    evidence_pattern: param_count >= 10
    cwe: CWE-1064
    explanation: |
      Functions with 10+ parameters are virtually impossible to use
      correctly without extensive documentation. They indicate severe
      design problems.
    remediation: Apply Introduce Parameter Object or Builder pattern
  - id: CS-PARAMS-CRIT-002
    signal: Public API methods with 8+ parameters
    evidence_pattern: public.*param_count >= 8
    cwe: CWE-1064
    explanation: |
      Public APIs with many parameters create poor developer experience
      and high error rates for consumers.
    remediation: Refactor to options object or builder pattern
  high:
  - id: CS-PARAMS-HIGH-001
    signal: Functions with 6-9 parameters
    evidence_pattern: 6 <= param_count <= 9
    cwe: CWE-1064
    explanation: |
      Functions in this range are difficult to call correctly and
      often contain related parameters that should be grouped.
    remediation: Group related parameters into objects
  - id: CS-PARAMS-HIGH-002
    signal: Constructors with 5+ parameters
    evidence_pattern: constructor.*param_count >= 5
    explanation: |
      Complex constructors make object creation error-prone.
      Builder pattern or factory methods improve usability.
    remediation: Apply Builder pattern or Factory Method
  medium:
  - id: CS-PARAMS-MED-001
    signal: Functions with 4-5 parameters
    evidence_pattern: 4 <= param_count <= 5
    remediation: Consider grouping related parameters
  - id: CS-PARAMS-MED-002
    signal: Boolean parameters (flag arguments)
    evidence_pattern: param.*:\s*(boolean|bool)
    remediation: Consider separate methods or enum instead
  low:
  - id: CS-PARAMS-LOW-001
    signal: Internal helper functions with many params
    evidence_pattern: private.*helper.*params > 4
    remediation: Review for potential simplification
  positive:
  - id: CS-PARAMS-POS-001
    signal: All functions have 3 or fewer parameters
    evidence_pattern: max_params <= 3
  - id: CS-PARAMS-POS-002
    signal: Parameter object pattern used
    evidence_pattern: (options|config|params|args)\s*:\s*\w+Options
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Scan for Long Parameter Lists
    description: |
      Search the codebase for functions with excessive numbers of
      parameters.
    duration_estimate: 10 min
    commands:
    - purpose: Find functions with 5+ parameters
      command: |
        grep -rn --include="*.{ts,js}" -E "function\s+\w+\s*\([^)]*,[^)]*,[^)]*,[^)]*,[^)]*\)" . 2>/dev/null | head -50
    - purpose: Find Python functions with many params
      command: |
        grep -rn --include="*.py" -E "def\s+\w+\s*\([^)]*,[^)]*,[^)]*,[^)]*,[^)]*\)" . 2>/dev/null | head -50
    - purpose: Run ESLint max-params
      command: |
        npx eslint --rule 'max-params: [warn, 4]' . 2>/dev/null | head -50
    expected_findings:
    - Functions exceeding thresholds
    - Parameter counts
  - id: '2'
    name: Count Parameters Precisely
    description: |
      For identified functions, count exact parameter numbers
      and categorize by severity.
    duration_estimate: 10 min
    expected_findings:
    - Exact parameter counts
    - Severity classification
  - id: '3'
    name: Identify Grouping Opportunities
    description: |
      Analyze related parameters that could be combined into
      parameter objects.
    duration_estimate: 5 min
    expected_findings:
    - Related parameter groups
    - Suggested value objects
  - id: '4'
    name: Generate Refactoring Plan
    description: |
      Create prioritized list of functions to refactor with
      suggested approaches.
    duration_estimate: 5 min
    expected_findings:
    - Functions to refactor
    - Recommended patterns
output:
  deliverables:
  - type: finding_list
    format: structured
    content:
    - function_name
    - file_path
    - parameter_count
    - severity
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Long Parameter List Inventory
    - Analysis
    - Refactoring Recommendations
  confidence_guidance:
    high: Parameter count clearly exceeds threshold
    medium: Borderline case, context-dependent
    low: May be justified by design
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: cwe-1064
      priority: required
profiles:
  membership:
    quick:
      included: true
      priority: 3
    full:
      included: true
      priority: 1
    quality:
      included: true
      priority: 1
closeout_checklist:
- id: long-params-001
  item: Parameter count scan completed
  level: BLOCKING
  verification: |
    grep -rn --include="*.{ts,js,java}" -E "\([^)]*,[^)]*,[^)]*,[^)]*,[^)]*\)" . 2>/dev/null | wc -l
  expected: Analysis complete
- id: long-params-002
  item: No functions with 10+ parameters
  level: CRITICAL
  verification: |
    grep -rn --include="*.{ts,js}" -E "\([^)]*,[^)]*,[^)]*,[^)]*,[^)]*,[^)]*,[^)]*,[^)]*,[^)]*,[^)]*\)" . 2>/dev/null | wc -l
  expected: '0'
- id: long-params-003
  item: Functions with 6+ params documented
  level: WARNING
  verification: manual
  verification_notes: Review output for high severity items
  expected: All documented
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: CWE
    controls:
    - CWE-1064
  - framework: ISO 25010
    controls:
    - Maintainability
    - Usability
relationships:
  commonly_combined:
  - code-quality.code-smells.data-clump
  - code-quality.code-smells.primitive-obsession
  - code-quality.maintainability.function-length
