# ============================================================
# AUDIT: Vendor Security Questionnaire Audit
# ============================================================
# Evaluates the effectiveness and completeness of vendor security
# questionnaire processes and response analysis.

audit:
  id: "vendor-third-party.vendor-risk-assessment.vendor-security-questionnaire"

  name: "Vendor Security Questionnaire Audit"

  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "vendor-third-party"
  category_number: 20
  subcategory: "vendor-risk-assessment"

  tier: "expert"
  estimated_duration: "4-6 hours"  # median: 5h

  completeness: "requires_discovery"
  requires_runtime: false
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "organizational"

  default_profiles:
    - "full"
    - "security"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Comprehensive evaluation of vendor security questionnaire processes including
    questionnaire design, distribution methods, response collection, answer
    validation, evidence requirements, and findings analysis. Assesses whether
    questionnaires effectively capture vendor security posture and inform risk
    decisions.

  why_it_matters: |
    Security questionnaires are primary tools for assessing vendor security
    controls before and during engagements. Poorly designed questionnaires or
    inadequate response analysis can miss critical security gaps, creating false
    confidence in vendor security posture. Effective questionnaires drive vendor
    improvements and support informed risk acceptance.

  when_to_run:
    - "Annual vendor management program review"
    - "When updating questionnaire content"
    - "After vendor security incidents"
    - "During program maturity assessments"
    - "When adopting new questionnaire standards"

prerequisites:
  required_artifacts:
    - type: "questionnaire_templates"
      description: "Security questionnaire templates"
    - type: "completed_questionnaires"
      description: "Sample of completed vendor responses"
    - type: "analysis_procedures"
      description: "Response evaluation procedures"

  access_requirements:
    - "Security questionnaire templates"
    - "Completed questionnaire responses"
    - "Response analysis documentation"
    - "Vendor management team"
    - "Historical questionnaire data"

discovery:
  file_patterns:
    - glob: "**/questionnaire*/**"
      purpose: "Find questionnaire templates"
    - glob: "**/vendor*assessment*/**"
      purpose: "Locate assessment materials"
    - glob: "**/security*survey*/**"
      purpose: "Find security survey documents"

  documents_to_review:
    - type: "Questionnaire Templates"
      purpose: "Evaluate question coverage and quality"
    - type: "Response Analysis Guidelines"
      purpose: "Assess evaluation methodology"
    - type: "Completed Questionnaires"
      purpose: "Review response quality and validation"

  interviews:
    - role: "Vendor Security Analysts"
      questions:
        - "How do you validate questionnaire responses?"
        - "What evidence is required for critical controls?"
        - "How are questionnaire findings acted upon?"
      purpose: "Understand analysis process"
    - role: "Procurement Team"
      questions:
        - "When are questionnaires sent to vendors?"
        - "How are response delays handled?"
        - "Are questionnaires mandatory for all vendors?"
      purpose: "Understand distribution process"

knowledge_sources:
  specifications:
    - id: "sig-questionnaire"
      name: "Standardized Information Gathering (SIG) Questionnaire"
      url: "https://sharedassessments.org/sig/"
      offline_cache: true
      priority: "required"
    - id: "caiq"
      name: "Consensus Assessment Initiative Questionnaire (CAIQ)"
      url: "https://cloudsecurityalliance.org/star/registry/"
      offline_cache: true
      priority: "recommended"

  guides:
    - id: "vsaq"
      name: "Vendor Security Assessment Questionnaire Guidelines"
      url: "https://vsaq-demo.withgoogle.com/"
      offline_cache: true

tooling:
  assessment_tools:
    - tool: "Questionnaire completeness checker"
      purpose: "Verify coverage of security domains"
    - tool: "Response validation framework"
      purpose: "Assess answer quality and evidence"

signals:
  critical:
    - id: "VSQ-CRIT-001"
      signal: "No security questionnaire process exists"
      evidence_indicators:
        - "Vendors not assessed via questionnaire"
        - "No questionnaire templates available"
        - "Security posture unknown before engagement"
      explanation: |
        Without security questionnaires, organizations have no systematic
        method to assess vendor security controls before engagement,
        potentially onboarding high-risk vendors unknowingly.
      remediation: "Implement comprehensive security questionnaire process"

    - id: "VSQ-CRIT-002"
      signal: "Questionnaire responses not validated"
      evidence_indicators:
        - "Responses accepted without verification"
        - "No evidence requirements"
        - "Self-attestations not challenged"
      explanation: |
        Unvalidated questionnaire responses provide false assurance.
        Vendors may provide inaccurate or aspirational answers without
        accountability.
      remediation: "Implement response validation with evidence requirements"

  high:
    - id: "VSQ-HIGH-001"
      signal: "Questionnaire does not cover critical security domains"
      explanation: "Incomplete coverage leaves security gaps unassessed"
      remediation: "Expand questionnaire to cover all relevant security domains"

    - id: "VSQ-HIGH-002"
      signal: "Questionnaire findings not actioned"
      explanation: "Identified gaps remain unaddressed"
      remediation: "Implement findings tracking and remediation workflow"

    - id: "VSQ-HIGH-003"
      signal: "High-risk vendors not receiving enhanced questionnaires"
      explanation: "Critical vendors need deeper assessment"
      remediation: "Implement tiered questionnaire approach based on risk"

  medium:
    - id: "VSQ-MED-001"
      signal: "Questionnaires not refreshed periodically"
      remediation: "Establish periodic re-assessment schedule"

    - id: "VSQ-MED-002"
      signal: "No standard scoring methodology"
      remediation: "Implement consistent response scoring framework"

    - id: "VSQ-MED-003"
      signal: "Questionnaire process not integrated with vendor lifecycle"
      remediation: "Embed questionnaires in onboarding and renewal processes"

  low:
    - id: "VSQ-LOW-001"
      signal: "Questionnaire completion rates not tracked"
      remediation: "Implement response rate metrics and follow-up process"

  positive:
    - id: "VSQ-POS-001"
      signal: "Comprehensive questionnaire covering all security domains"
    - id: "VSQ-POS-002"
      signal: "Evidence-based response validation process"
    - id: "VSQ-POS-003"
      signal: "Automated questionnaire distribution and tracking"

procedure:
  context:
    cognitive_mode: "evaluative"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Review questionnaire templates"
      description: |
        Evaluate questionnaire content for coverage of security domains,
        question quality, and alignment with industry standards.
      duration_estimate: "60 min"
      questions:
        - "Are all security domains covered?"
        - "Are questions clear and specific?"
        - "Is the questionnaire aligned with standards (SIG, CAIQ)?"
      expected_findings:
        - "Coverage assessment"
        - "Question quality evaluation"

    - id: "2"
      name: "Assess distribution and collection process"
      description: |
        Review how questionnaires are distributed, tracked, and
        collected from vendors.
      duration_estimate: "45 min"
      questions:
        - "When are questionnaires sent?"
        - "How are responses tracked?"
        - "What happens with non-responses?"
      expected_findings:
        - "Process effectiveness"
        - "Completion rates"

    - id: "3"
      name: "Evaluate response validation"
      description: |
        Assess how questionnaire responses are validated and what
        evidence is required.
      duration_estimate: "60 min"
      expected_findings:
        - "Validation rigor"
        - "Evidence requirements"

    - id: "4"
      name: "Review findings analysis and action"
      description: |
        Evaluate how questionnaire findings are analyzed, scored,
        and actioned.
      duration_estimate: "45 min"
      expected_findings:
        - "Analysis methodology"
        - "Action tracking"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "questionnaire_assessment"
      format: "structured"
      sections:
        - "Template Evaluation"
        - "Process Assessment"
        - "Validation Review"
        - "Findings Management"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Key Findings"
        - "Recommendations"

  confidence_guidance:
    high: "Full process review with sample response analysis"
    medium: "Template and process review"
    low: "Documentation review only"

offline:
  capability: "full"

  cache_manifest:
    knowledge:
      - source_id: "sig-questionnaire"
        priority: "required"
      - source_id: "caiq"
        priority: "recommended"

profiles:
  membership:
    quick:
      included: false
      reason: "Requires comprehensive questionnaire and response review"
    full:
      included: true
      priority: 1

closeout_checklist:
  - id: "vsq-001"
    item: "Security questionnaire templates comprehensive"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "All security domains covered"
    expected: "Confirmed by reviewer"

  - id: "vsq-002"
    item: "Response validation process documented and followed"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Evidence requirements defined and enforced"
    expected: "Confirmed by reviewer"

  - id: "vsq-003"
    item: "Questionnaire findings tracked and actioned"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Findings workflow operational"
    expected: "Confirmed by reviewer"

  - id: "vsq-004"
    item: "Periodic re-assessment process in place"
    level: "WARNING"
    verification: "manual"
    verification_notes: "Refresh schedule defined"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["all"]

  compliance_frameworks:
    - framework: "NIST CSF"
      controls: ["ID.SC-2", "ID.SC-4"]
    - framework: "ISO 27001"
      controls: ["A.15.2.1", "A.15.2.2"]
    - framework: "SOC 2"
      controls: ["CC9.2"]

relationships:
  commonly_combined:
    - "vendor-third-party.vendor-risk-assessment.vendor-risk-scoring"
    - "vendor-third-party.third-party-security.third-party-compliance-verification"
    - "vendor-third-party.vendor-due-diligence.vendor-certification-verification"
