# ============================================================
# AUDIT: Vendor Risk Classification Audit
# ============================================================
# Evaluates the organization's vendor risk classification methodology
# and the accuracy of vendor tier assignments.

audit:
  id: "vendor-third-party.vendor-risk-assessment.vendor-risk-classification"

  name: "Vendor Risk Classification Audit"

  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "vendor-third-party"
  category_number: 20
  subcategory: "vendor-risk-assessment"

  tier: "expert"
  estimated_duration: "4-6 hours"  # median: 5h

  completeness: "requires_discovery"
  requires_runtime: false
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "organizational"

  default_profiles:
    - "full"
    - "security"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Comprehensive evaluation of vendor risk classification framework including
    tiering methodology, risk criteria definitions, data sensitivity assessments,
    business criticality ratings, and classification accuracy. Reviews whether
    vendors are appropriately categorized based on access levels, data handling,
    and operational dependencies.

  why_it_matters: |
    Accurate vendor risk classification drives proportionate security controls and
    oversight levels. Misclassification can lead to over-investment in low-risk
    vendors or dangerous under-protection of high-risk relationships. Proper
    classification ensures resources focus where risk is greatest and satisfies
    regulatory requirements for risk-based vendor management.

  when_to_run:
    - "During annual vendor management program review"
    - "When onboarding new critical vendors"
    - "After significant changes to vendor relationships"
    - "Following security incidents involving vendors"
    - "During regulatory examinations"

prerequisites:
  required_artifacts:
    - type: "vendor_inventory"
      description: "Complete list of active vendors"
    - type: "classification_framework"
      description: "Vendor risk classification methodology"
    - type: "risk_criteria"
      description: "Risk assessment criteria documentation"

  access_requirements:
    - "Vendor management database or system"
    - "Risk classification documentation"
    - "Vendor contract repository"
    - "Data flow documentation"
    - "Vendor management team"

discovery:
  file_patterns:
    - glob: "**/vendor*/**"
      purpose: "Find vendor management documentation"
    - glob: "**/third-party*/**"
      purpose: "Locate third-party risk materials"
    - glob: "**/risk*classification*"
      purpose: "Find classification frameworks"

  documents_to_review:
    - type: "Vendor Risk Classification Policy"
      purpose: "Understand classification methodology"
    - type: "Vendor Inventory"
      purpose: "Review vendor population and assignments"
    - type: "Risk Tier Definitions"
      purpose: "Evaluate tier criteria"

  interviews:
    - role: "Vendor Risk Manager"
      questions:
        - "How are vendor risk tiers defined?"
        - "What criteria drive classification decisions?"
        - "How often are classifications reviewed?"
      purpose: "Understand classification process"
    - role: "Business Unit Leaders"
      questions:
        - "How do you communicate vendor criticality?"
        - "Are classification decisions transparent?"
        - "Do you agree with your vendors' risk tiers?"
      purpose: "Validate classification accuracy"

knowledge_sources:
  specifications:
    - id: "nist-csf"
      name: "NIST Cybersecurity Framework"
      url: "https://www.nist.gov/cyberframework"
      offline_cache: true
      priority: "required"
    - id: "iso27036"
      name: "ISO/IEC 27036 Supplier Relationships"
      url: "https://www.iso.org/standard/59648.html"
      offline_cache: true
      priority: "recommended"

  guides:
    - id: "shared-assessments"
      name: "Shared Assessments Third Party Risk Management Guide"
      url: "https://sharedassessments.org/"
      offline_cache: true

tooling:
  assessment_tools:
    - tool: "Vendor classification matrix"
      purpose: "Evaluate tier assignments against criteria"
    - tool: "Risk scoring calculator"
      purpose: "Validate quantitative risk scores"

signals:
  critical:
    - id: "VRC-CRIT-001"
      signal: "No vendor risk classification framework exists"
      evidence_indicators:
        - "Vendors not categorized by risk level"
        - "No tier definitions documented"
        - "All vendors treated identically"
      explanation: |
        Without classification, organizations cannot apply proportionate controls
        or focus resources on highest-risk relationships. This represents a
        fundamental gap in vendor risk management.
      remediation: "Develop and implement vendor risk classification framework"

    - id: "VRC-CRIT-002"
      signal: "Critical vendors misclassified as low risk"
      evidence_indicators:
        - "Vendors with system access classified as low risk"
        - "Data processors not classified as high risk"
        - "Critical service providers undertiered"
      explanation: |
        Misclassification of critical vendors leads to inadequate security
        oversight, potentially exposing the organization to significant
        unmanaged risk.
      remediation: "Re-evaluate and correct vendor classifications"

  high:
    - id: "VRC-HIGH-001"
      signal: "Classification criteria not consistently applied"
      explanation: "Inconsistent application leads to arbitrary tier assignments"
      remediation: "Standardize classification process with clear criteria"

    - id: "VRC-HIGH-002"
      signal: "Classifications not reviewed periodically"
      explanation: "Vendor risk profiles change over time"
      remediation: "Implement annual classification review process"

    - id: "VRC-HIGH-003"
      signal: "Data sensitivity not considered in classification"
      explanation: "Data access is key risk factor"
      remediation: "Incorporate data classification into vendor tiering"

  medium:
    - id: "VRC-MED-001"
      signal: "Classification documentation incomplete"
      remediation: "Document classification rationale for each vendor"

    - id: "VRC-MED-002"
      signal: "Business criticality not factored into classification"
      remediation: "Add business impact assessment to classification criteria"

    - id: "VRC-MED-003"
      signal: "Classification changes not tracked"
      remediation: "Implement change tracking for classification modifications"

  low:
    - id: "VRC-LOW-001"
      signal: "Classification framework not communicated to stakeholders"
      remediation: "Publish and communicate classification methodology"

  positive:
    - id: "VRC-POS-001"
      signal: "Well-defined risk tier criteria with clear thresholds"
    - id: "VRC-POS-002"
      signal: "Regular classification reviews with stakeholder input"
    - id: "VRC-POS-003"
      signal: "Automated classification based on data feeds"

procedure:
  context:
    cognitive_mode: "evaluative"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Review classification framework"
      description: |
        Evaluate the vendor risk classification methodology including tier
        definitions, criteria, and decision processes.
      duration_estimate: "60 min"
      questions:
        - "Are risk tiers clearly defined?"
        - "What criteria determine classification?"
        - "Is the framework documented?"
      expected_findings:
        - "Framework completeness assessment"
        - "Tier definition clarity"

    - id: "2"
      name: "Assess classification criteria"
      description: |
        Review the specific criteria used for classification including
        data access, system connectivity, business criticality, and
        regulatory requirements.
      duration_estimate: "45 min"
      questions:
        - "Are all relevant risk factors considered?"
        - "Are criteria weighted appropriately?"
        - "Is scoring methodology clear?"
      expected_findings:
        - "Criteria completeness"
        - "Weighting appropriateness"

    - id: "3"
      name: "Sample classification accuracy"
      description: |
        Select sample vendors from each tier and validate classification
        accuracy against actual risk profile.
      duration_estimate: "90 min"
      expected_findings:
        - "Classification accuracy rate"
        - "Misclassification patterns"

    - id: "4"
      name: "Review classification governance"
      description: |
        Evaluate processes for classification decisions, approvals,
        reviews, and updates.
      duration_estimate: "45 min"
      expected_findings:
        - "Governance process assessment"
        - "Review cycle effectiveness"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "classification_assessment"
      format: "structured"
      sections:
        - "Framework Evaluation"
        - "Criteria Assessment"
        - "Accuracy Analysis"
        - "Governance Review"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Key Findings"
        - "Recommendations"

  confidence_guidance:
    high: "Full framework review and vendor sample validation completed"
    medium: "Framework reviewed with limited sampling"
    low: "Documentation review only"

offline:
  capability: "full"

  cache_manifest:
    knowledge:
      - source_id: "nist-csf"
        priority: "required"
      - source_id: "iso27036"
        priority: "recommended"

profiles:
  membership:
    quick:
      included: false
      reason: "Requires comprehensive framework and sample review"
    full:
      included: true
      priority: 1

closeout_checklist:
  - id: "vrc-001"
    item: "Vendor risk classification framework documented"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Framework exists with tier definitions"
    expected: "Confirmed by reviewer"

  - id: "vrc-002"
    item: "Classification criteria comprehensive and documented"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "All relevant risk factors included"
    expected: "Confirmed by reviewer"

  - id: "vrc-003"
    item: "Vendor classification accuracy validated"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Sample vendors correctly classified"
    expected: "Confirmed by reviewer"

  - id: "vrc-004"
    item: "Classification review process operational"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Periodic reviews scheduled and executed"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["all"]

  compliance_frameworks:
    - framework: "NIST CSF"
      controls: ["ID.SC-1", "ID.SC-2"]
    - framework: "ISO 27001"
      controls: ["A.15.1.1", "A.15.1.2"]
    - framework: "SOC 2"
      controls: ["CC9.2"]

relationships:
  commonly_combined:
    - "vendor-third-party.vendor-risk-assessment.vendor-risk-scoring"
    - "vendor-third-party.vendor-risk-assessment.vendor-risk-register"
    - "vendor-third-party.vendor-due-diligence.vendor-background-check"
