audit:
  id: vendor-third-party.supply-chain-security.software-supply-chain
  name: Software Supply Chain Audit
  version: 1.0.0
  last_updated: '2026-01-19'
  status: active
  category: vendor-third-party
  category_number: 20
  subcategory: supply-chain-security
  tier: phd
  estimated_duration: 6-8 hours  # median: 7h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: critical
  scope: security
  default_profiles:
  - full
  - security
  blocks_phase: true
  parallelizable: true
description:
  what: |
    Comprehensive evaluation of software supply chain security including
    source code provenance, dependency management, build system integrity,
    code signing, artifact verification, and distribution security. Reviews
    the entire software delivery pipeline from development to deployment
    for supply chain attack vectors.
  why_it_matters: |
    Software supply chain attacks have become increasingly sophisticated,
    targeting dependencies, build systems, and distribution channels. High-profile
    attacks like SolarWinds, Codecov, and Log4j demonstrate catastrophic impact.
    Securing the software supply chain is essential to prevent compromise
    propagation and maintain software integrity.
  when_to_run:
  - During security architecture reviews
  - Annual software supply chain assessments
  - After supply chain security incidents
  - When adopting new build systems or package managers
  - Before major software releases
prerequisites:
  required_artifacts:
  - type: build_system_documentation
    description: CI/CD pipeline documentation
  - type: dependency_inventory
    description: Software dependency list
  - type: signing_configuration
    description: Code signing configuration
  access_requirements:
  - CI/CD system configuration
  - Package manager configurations
  - Dependency manifest files
  - Build system logs
  - Development and DevOps teams
discovery:
  code_patterns:
  - pattern: (npm|pip|maven|gradle|cargo|go\.mod)
    type: regex
    scope: config
    purpose: Identify package manager configurations
  - pattern: (lock|lockfile|.lock)
    type: keyword
    scope: config
    purpose: Find dependency lock files
  - pattern: (sign|verify|checksum|hash)
    type: keyword
    scope: config
    purpose: Identify integrity verification
  file_patterns:
  - glob: '**/package*.json'
    purpose: Find npm configurations
  - glob: '**/requirements*.txt'
    purpose: Locate Python dependencies
  - glob: '**/.github/workflows/**'
    purpose: Find CI/CD workflows
  - glob: '**/Dockerfile*'
    purpose: Locate container build files
  documents_to_review:
  - type: CI/CD Pipeline Documentation
    purpose: Understand build process
  - type: Dependency Management Policy
    purpose: Review dependency practices
  - type: Release Process Documentation
    purpose: Evaluate release security
  interviews:
  - role: DevOps/Platform Team
    questions:
    - How is the build environment secured?
    - What controls exist for pipeline modifications?
    - How are build artifacts verified?
    purpose: Understand build security
  - role: Development Team
    questions:
    - How are dependencies selected and approved?
    - How are dependency updates managed?
    - What vulnerability scanning is performed?
    purpose: Assess dependency practices
knowledge_sources:
  specifications:
  - id: slsa
    name: Supply-chain Levels for Software Artifacts (SLSA)
    url: https://slsa.dev/
    offline_cache: true
    priority: required
  - id: nist-ssdf
    name: NIST Secure Software Development Framework
    url: https://csrc.nist.gov/Projects/ssdf
    offline_cache: true
    priority: required
  - id: nsa-supply-chain
    name: 'NSA: Securing the Software Supply Chain'
    url: https://media.defense.gov/2022/Sep/01/2003068942/-1/-1/0/ESF_SECURING_THE_SOFTWARE_SUPPLY_CHAIN_DEVELOPERS.PDF
    offline_cache: true
    priority: required
  - id: cisa-known-exploited
    name: CISA Known Exploited Vulnerabilities
    url: https://www.cisa.gov/known-exploited-vulnerabilities-catalog
    offline_cache: true
    priority: recommended
  guides:
  - id: cncf-supply-chain
    name: CNCF Software Supply Chain Best Practices
    url: https://github.com/cncf/tag-security
    offline_cache: true
  - id: sigstore
    name: Sigstore Signing Guidelines
    url: https://www.sigstore.dev/
    offline_cache: true
tooling:
  static_analysis:
  - tool: Dependency check tools (Snyk, Dependabot, etc.)
    purpose: Identify vulnerable dependencies
    offline_capable: true
  - tool: SLSA verification tools
    purpose: Verify SLSA provenance
    offline_capable: true
  scripts:
  - id: supply-chain-check
    language: bash
    purpose: Check software supply chain configurations
    source: inline
    code: |
      #!/bin/bash
      echo "=== Lock Files ==="
      find . -name "*.lock" -o -name "package-lock.json" -o -name "yarn.lock" 2>/dev/null

      echo "=== Dependency Files ==="
      find . -name "requirements*.txt" -o -name "package.json" -o -name "go.mod" 2>/dev/null

      echo "=== CI/CD Configs ==="
      find . -name ".github" -o -name "Jenkinsfile" -o -name ".gitlab-ci.yml" 2>/dev/null
signals:
  critical:
  - id: SSC-CRIT-001
    signal: No dependency lock files used
    evidence_pattern: Missing package-lock.json, yarn.lock, or equivalent
    explanation: |
      Without lock files, builds may pull different dependency versions,
      allowing dependency confusion attacks or unintended vulnerable
      version introduction.
    remediation: Implement and commit dependency lock files
  - id: SSC-CRIT-002
    signal: Dependencies from untrusted sources
    evidence_indicators:
    - Private registries without authentication
    - Dependencies from unknown registries
    - HTTP-only package sources
    explanation: |
      Untrusted dependency sources may serve malicious packages,
      enabling supply chain compromise.
    remediation: Use only trusted, authenticated package registries
  - id: SSC-CRIT-003
    signal: Build environment compromisable
    evidence_indicators:
    - Build systems accessible to untrusted code
    - No isolation between build jobs
    - Secrets exposed in build logs
    explanation: |
      Compromised build environments can inject malicious code into
      all software built through them.
    remediation: Implement isolated, hardened build environments
  high:
  - id: SSC-HIGH-001
    signal: No artifact signing implemented
    explanation: Unsigned artifacts cannot be verified for integrity
    remediation: Implement code signing for all release artifacts
  - id: SSC-HIGH-002
    signal: No dependency vulnerability scanning
    explanation: Vulnerable dependencies may go undetected
    remediation: Implement automated dependency vulnerability scanning
  - id: SSC-HIGH-003
    signal: Build pipeline modifications uncontrolled
    explanation: Attackers can modify pipelines to inject malicious code
    remediation: Implement pipeline-as-code with code review
  medium:
  - id: SSC-MED-001
    signal: No SBOM generation
    remediation: Generate SBOM for all releases
  - id: SSC-MED-002
    signal: Dependency updates not automated
    remediation: Implement automated dependency update monitoring
  - id: SSC-MED-003
    signal: No reproducible builds
    remediation: Implement reproducible build processes
  low:
  - id: SSC-LOW-001
    signal: Supply chain metrics not tracked
    remediation: Implement supply chain security metrics
  positive:
  - id: SSC-POS-001
    signal: SLSA Level 2+ compliance achieved
  - id: SSC-POS-002
    signal: All artifacts signed and verified
  - id: SSC-POS-003
    signal: Comprehensive SBOM with provenance attestations
procedure:
  context:
    cognitive_mode: critical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Review dependency management
    description: |
      Evaluate dependency management practices including sourcing,
      versioning, and lock file usage.
    duration_estimate: 60 min
    commands:
    - purpose: Find dependency configurations
      command: find . -name 'package.json' -o -name 'requirements.txt' -o -name 'go.mod' 2>/dev/null |
        head -20
    expected_findings:
    - Dependency management practices
    - Lock file usage
  - id: '2'
    name: Assess build system security
    description: |
      Review CI/CD pipeline security including isolation, access
      controls, and secret management.
    duration_estimate: 90 min
    questions:
    - How is the build environment secured?
    - What access controls exist?
    - How are secrets managed?
    expected_findings:
    - Build security assessment
    - Access control review
  - id: '3'
    name: Evaluate artifact integrity
    description: |
      Review artifact signing, verification, and distribution
      practices.
    duration_estimate: 60 min
    expected_findings:
    - Signing implementation
    - Verification practices
  - id: '4'
    name: Review vulnerability management
    description: |
      Assess dependency vulnerability scanning and remediation
      processes.
    duration_estimate: 45 min
    expected_findings:
    - Scanning coverage
    - Remediation effectiveness
  - id: '5'
    name: Assess SLSA compliance
    description: |
      Evaluate compliance with SLSA framework requirements.
    duration_estimate: 45 min
    expected_findings:
    - SLSA level assessment
    - Gap identification
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: supply_chain_assessment
    format: structured
    sections:
    - Dependency Management Review
    - Build Security Assessment
    - Artifact Integrity Review
    - Vulnerability Management
    - SLSA Compliance
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Key Findings
    - Recommendations
  confidence_guidance:
    high: Full pipeline and configuration review
    medium: Configuration review with limited runtime analysis
    low: Documentation review only
offline:
  capability: partial
  cache_manifest:
    knowledge:
    - source_id: slsa
      priority: required
    - source_id: nist-ssdf
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires comprehensive supply chain review
    full:
      included: true
      priority: 1
closeout_checklist:
- id: ssc-001
  item: Dependency lock files used and committed
  level: CRITICAL
  verification: bash
  command: find . -name '*.lock' -o -name 'package-lock.json' | head -1 | xargs test -f && echo PASS ||
    echo FAIL
  expected: PASS
- id: ssc-002
  item: Dependencies from trusted sources only
  level: CRITICAL
  verification: manual
  verification_notes: Package registries verified as trusted
  expected: Confirmed by reviewer
- id: ssc-003
  item: Build artifacts signed
  level: CRITICAL
  verification: manual
  verification_notes: Code signing implemented for releases
  expected: Confirmed by reviewer
- id: ssc-004
  item: Dependency vulnerability scanning active
  level: BLOCKING
  verification: manual
  verification_notes: Scanning configured and operational
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: NIST CSF
    controls:
    - ID.SC-1
    - ID.SC-3
    - PR.DS-6
  - framework: ISO 27001
    controls:
    - A.14.2.7
    - A.14.2.8
  - framework: SLSA
    controls:
    - Level 1-4 Requirements
  - framework: SOC 2
    controls:
    - CC6.6
    - CC8.1
relationships:
  commonly_combined:
  - vendor-third-party.supply-chain-security.sbom-management
  - vendor-third-party.supply-chain-security.dependency-vulnerability
  - software-development.secure-coding.secure-build
