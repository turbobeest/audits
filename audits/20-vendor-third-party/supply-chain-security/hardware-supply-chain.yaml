# ============================================================
# AUDIT: Hardware Supply Chain Audit
# ============================================================
# Evaluates security practices for the hardware supply chain
# including procurement, validation, and lifecycle management.

audit:
  id: "vendor-third-party.supply-chain-security.hardware-supply-chain"

  name: "Hardware Supply Chain Audit"

  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "vendor-third-party"
  category_number: 20
  subcategory: "supply-chain-security"

  tier: "expert"
  estimated_duration: "5-7 hours"  # median: 6h

  completeness: "requires_discovery"
  requires_runtime: false
  destructive: false

execution:
  automatable: "manual"
  severity: "high"
  scope: "infrastructure"

  default_profiles:
    - "full"
    - "security"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Comprehensive evaluation of hardware supply chain security including
    vendor selection, procurement validation, chain of custody, firmware
    integrity, hardware authentication, and secure decommissioning. Reviews
    controls protecting against hardware tampering, counterfeiting, and
    supply chain interdiction.

  why_it_matters: |
    Hardware supply chain attacks can implant persistent backdoors that
    survive software reinstallation and are extremely difficult to detect.
    Counterfeit components may contain vulnerabilities or fail at critical
    moments. Proper hardware supply chain security ensures infrastructure
    integrity from procurement through disposal.

  when_to_run:
    - "When establishing new hardware suppliers"
    - "Annual supply chain security reviews"
    - "After hardware security incidents"
    - "When procuring critical infrastructure"
    - "During datacenter builds or expansions"

prerequisites:
  required_artifacts:
    - type: "procurement_policy"
      description: "Hardware procurement policy"
    - type: "supplier_list"
      description: "Approved hardware suppliers"
    - type: "hardware_inventory"
      description: "Hardware asset inventory"

  access_requirements:
    - "Hardware procurement documentation"
    - "Supplier qualification records"
    - "Hardware inventory system"
    - "IT/Infrastructure procurement team"
    - "Security team"

discovery:
  file_patterns:
    - glob: "**/procurement*/**"
      purpose: "Find procurement documentation"
    - glob: "**/hardware*inventory*/**"
      purpose: "Locate hardware inventory"
    - glob: "**/supplier*/**"
      purpose: "Find supplier documentation"

  documents_to_review:
    - type: "Hardware Procurement Policy"
      purpose: "Understand procurement requirements"
    - type: "Approved Supplier List"
      purpose: "Review supplier qualification"
    - type: "Hardware Validation Procedures"
      purpose: "Assess validation practices"

  interviews:
    - role: "IT Procurement"
      questions:
        - "How are hardware suppliers qualified?"
        - "What validation is performed on hardware receipt?"
        - "How is chain of custody maintained?"
      purpose: "Understand procurement practices"
    - role: "Infrastructure/Security Team"
      questions:
        - "How is hardware authenticated?"
        - "What firmware validation is performed?"
        - "How is hardware decommissioned?"
      purpose: "Assess technical controls"

knowledge_sources:
  specifications:
    - id: "nist-scrm"
      name: "NIST SP 800-161 Supply Chain Risk Management"
      url: "https://csrc.nist.gov/publications/detail/sp/800-161/rev-1/final"
      offline_cache: true
      priority: "required"
    - id: "c-scrm"
      name: "NIST Cybersecurity Supply Chain Risk Management"
      url: "https://csrc.nist.gov/projects/cyber-supply-chain-risk-management"
      offline_cache: true
      priority: "required"

  guides:
    - id: "hardware-security-guide"
      name: "Hardware Security Best Practices"
      url: "https://www.nist.gov/"
      offline_cache: true

tooling:
  assessment_tools:
    - tool: "Hardware verification checklist"
      purpose: "Validate hardware authenticity"
    - tool: "Firmware integrity tools"
      purpose: "Verify firmware integrity"

signals:
  critical:
    - id: "HSC-CRIT-001"
      signal: "Hardware from untrusted/unqualified suppliers"
      evidence_indicators:
        - "Critical hardware from unknown sources"
        - "No supplier qualification process"
        - "Grey market hardware in use"
      explanation: |
        Untrusted hardware sources may provide counterfeit or compromised
        equipment, enabling hardware-level attacks.
      remediation: "Source hardware only from qualified, trusted suppliers"

    - id: "HSC-CRIT-002"
      signal: "No hardware validation on receipt"
      evidence_indicators:
        - "Hardware deployed without inspection"
        - "No authenticity verification"
        - "Firmware not validated"
      explanation: |
        Unvalidated hardware may be counterfeit or tampered with during
        shipping.
      remediation: "Implement hardware validation procedures"

    - id: "HSC-CRIT-003"
      signal: "Hardware disposed without data destruction"
      evidence_indicators:
        - "Storage media not wiped"
        - "No destruction certificates"
        - "Hardware sold without sanitization"
      explanation: |
        Improperly disposed hardware may leak sensitive data or be
        refurbished with backdoors.
      remediation: "Implement secure hardware disposal with verification"

  high:
    - id: "HSC-HIGH-001"
      signal: "No chain of custody for critical hardware"
      explanation: "Hardware may be tampered with in transit"
      remediation: "Implement chain of custody controls"

    - id: "HSC-HIGH-002"
      signal: "Firmware integrity not verified"
      explanation: "Compromised firmware persists undetected"
      remediation: "Implement firmware validation processes"

    - id: "HSC-HIGH-003"
      signal: "No approved supplier list"
      explanation: "Cannot enforce trusted sourcing without list"
      remediation: "Establish and maintain approved supplier list"

  medium:
    - id: "HSC-MED-001"
      signal: "Supplier security not assessed"
      remediation: "Assess security practices of hardware suppliers"

    - id: "HSC-MED-002"
      signal: "Hardware inventory incomplete"
      remediation: "Implement comprehensive hardware inventory"

    - id: "HSC-MED-003"
      signal: "No counterfeit detection procedures"
      remediation: "Implement counterfeit detection processes"

  low:
    - id: "HSC-LOW-001"
      signal: "Hardware supply chain metrics not tracked"
      remediation: "Implement supply chain metrics"

  positive:
    - id: "HSC-POS-001"
      signal: "Comprehensive supplier qualification program"
    - id: "HSC-POS-002"
      signal: "Hardware authentication with TPM/attestation"
    - id: "HSC-POS-003"
      signal: "Certified secure disposal with verification"

procedure:
  context:
    cognitive_mode: "evaluative"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Review procurement practices"
      description: |
        Evaluate hardware procurement policies, supplier qualification,
        and approved supplier list.
      duration_estimate: "60 min"
      questions:
        - "How are suppliers qualified?"
        - "What is the approved supplier list?"
        - "How are procurement decisions made?"
      expected_findings:
        - "Procurement assessment"
        - "Supplier qualification review"

    - id: "2"
      name: "Assess validation procedures"
      description: |
        Review hardware validation on receipt including authenticity
        verification and firmware validation.
      duration_estimate: "60 min"
      questions:
        - "What validation is performed?"
        - "How is authenticity verified?"
        - "Is firmware validated?"
      expected_findings:
        - "Validation effectiveness"
        - "Gap identification"

    - id: "3"
      name: "Evaluate chain of custody"
      description: |
        Review chain of custody controls for hardware from procurement
        through deployment.
      duration_estimate: "45 min"
      expected_findings:
        - "Custody controls"
        - "Tracking effectiveness"

    - id: "4"
      name: "Review disposal procedures"
      description: |
        Evaluate hardware decommissioning and disposal procedures
        including data destruction.
      duration_estimate: "45 min"
      expected_findings:
        - "Disposal security"
        - "Destruction verification"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "hardware_supply_chain_assessment"
      format: "structured"
      sections:
        - "Procurement Review"
        - "Validation Assessment"
        - "Chain of Custody Review"
        - "Disposal Assessment"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Key Findings"
        - "Recommendations"

  confidence_guidance:
    high: "Full process review with physical inspection"
    medium: "Process review with documentation"
    low: "Documentation review only"

offline:
  capability: "full"

  cache_manifest:
    knowledge:
      - source_id: "nist-scrm"
        priority: "required"

profiles:
  membership:
    quick:
      included: false
      reason: "Requires comprehensive hardware supply chain review"
    full:
      included: true
      priority: 2

closeout_checklist:
  - id: "hsc-001"
    item: "Approved supplier list maintained"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Supplier qualification process documented"
    expected: "Confirmed by reviewer"

  - id: "hsc-002"
    item: "Hardware validation performed on receipt"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Validation procedures documented and followed"
    expected: "Confirmed by reviewer"

  - id: "hsc-003"
    item: "Chain of custody maintained"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Custody records available"
    expected: "Confirmed by reviewer"

  - id: "hsc-004"
    item: "Secure disposal procedures implemented"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Destruction certificates available"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["all"]

  compliance_frameworks:
    - framework: "NIST CSF"
      controls: ["ID.SC-1", "ID.SC-2", "ID.SC-3"]
    - framework: "ISO 27001"
      controls: ["A.15.1.1", "A.15.1.2"]
    - framework: "NIST SP 800-161"
      controls: ["Full framework"]

relationships:
  commonly_combined:
    - "vendor-third-party.vendor-due-diligence.vendor-background-check"
    - "vendor-third-party.supply-chain-security.supplier-continuity"
    - "asset-management.hardware.hardware-lifecycle"
