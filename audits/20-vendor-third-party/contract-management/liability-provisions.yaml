# ============================================================
# AUDIT: Liability Provisions Audit
# ============================================================
# Evaluates liability and indemnification provisions in
# vendor contracts for adequacy and enforceability.
# ============================================================

audit:
  id: "vendor-third-party.contract-management.liability-provisions"

  name: "Liability Provisions Audit"

  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "vendor-third-party"
  category_number: 20
  subcategory: "contract-management"

  tier: "expert"
  estimated_duration: "3-4 hours"  # median: 3h

  completeness: "requires_discovery"
  requires_runtime: false
  destructive: false

execution:
  automatable: "manual"
  severity: "high"
  scope: "documentation"

  default_profiles:
    - "full"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Evaluates liability provisions in vendor contracts including:
    - Limitation of liability clauses
    - Liability caps and carve-outs
    - Indemnification obligations
    - Insurance requirements
    - Warranty provisions
    - Consequential damages exclusions
    - Mutual vs. one-sided provisions
    - Survival of liability obligations
    - Proportionality to contract value and risk

  why_it_matters: |
    Liability provisions define financial exposure and recourse.
    Inadequate liability provisions result in:
    - Unlimited organizational liability exposure
    - Insufficient vendor accountability
    - Unrecoverable losses from vendor failures
    - Gaps in insurance coverage
    - Disputes over liability allocation
    - Unfavorable risk distribution
    - Inadequate protection for critical risks
    Appropriate liability provisions balance risk and accountability.

  when_to_run:
    - "During contract negotiation"
    - "Annual contract reviews"
    - "After vendor incidents or disputes"
    - "When renewing significant contracts"
    - "During enterprise risk assessments"

prerequisites:
  required_artifacts:
    - type: "vendor_contracts"
      description: "Contracts for liability review"
    - type: "risk_assessments"
      description: "Vendor risk assessments"
    - type: "insurance_requirements"
      description: "Organizational insurance standards"

  access_requirements:
    - "Vendor contracts"
    - "Legal team"
    - "Risk management"
    - "Insurance certificates"

discovery:
  file_patterns:
    - glob: "**/contracts/**"
      purpose: "Find vendor contracts"
    - glob: "**/legal/**liability**"
      purpose: "Locate liability standards"

  documents_to_review:
    - type: "Contract liability sections"
      purpose: "Review limitation and indemnity provisions"
    - type: "Insurance certificates"
      purpose: "Verify vendor insurance coverage"
    - type: "Risk assessments"
      purpose: "Understand risk exposure"

  interviews:
    - role: "Legal"
      questions:
        - "What are standard liability provisions?"
        - "How are liability caps determined?"
        - "What indemnification is required?"
      purpose: "Understand liability standards"
    - role: "Risk Management"
      questions:
        - "What risks need liability protection?"
        - "Are current provisions adequate?"
        - "What incidents have tested liability clauses?"
      purpose: "Assess risk coverage"

knowledge_sources:
  specifications:
    - id: "ucc"
      name: "Uniform Commercial Code"
      url: "https://www.law.cornell.edu/ucc"
      offline_cache: true
      priority: "required"

  guides:
    - id: "contract-risk"
      name: "Contract Risk Management Guide"
      url: "https://www.ncmahq.org/"
      offline_cache: true

tooling:
  assessment_tools:
    - tool: "Liability Clause Checklist"
      purpose: "Verify liability elements"
    - tool: "Risk Exposure Calculator"
      purpose: "Assess liability adequacy"

signals:
  critical:
    - id: "LP-CRIT-001"
      signal: "No limitation of liability for organization"
      evidence_indicators:
        - "Organization accepts unlimited liability"
        - "No liability cap defined"
        - "Broad liability assumptions"
      explanation: |
        Unlimited liability exposes organization to uncapped
        financial risk from vendor relationship.
      remediation: "Negotiate appropriate liability caps"

    - id: "LP-CRIT-002"
      signal: "No vendor indemnification"
      evidence_indicators:
        - "No indemnification clause"
        - "Vendor not liable for third-party claims"
        - "Organization bears all claim risk"
      explanation: |
        Without vendor indemnification, organization bears
        costs of vendor-caused third-party claims.
      remediation: "Include vendor indemnification requirements"

    - id: "LP-CRIT-003"
      signal: "Liability cap inadequate for risk"
      evidence_indicators:
        - "Cap far below potential exposure"
        - "Critical services with minimal caps"
        - "High-risk activities under-protected"
      explanation: |
        Liability caps must be proportionate to risk exposure.
        Inadequate caps leave significant risk unaddressed.
      remediation: "Negotiate caps appropriate to risk level"

  high:
    - id: "LP-HIGH-001"
      signal: "No insurance requirements"
      explanation: "Insurance provides financial backing for liability"
      remediation: "Require appropriate vendor insurance coverage"

    - id: "LP-HIGH-002"
      signal: "Broad exclusions undermine liability provisions"
      explanation: "Excessive exclusions may eliminate meaningful protection"
      remediation: "Review and limit liability exclusions"

    - id: "LP-HIGH-003"
      signal: "Indemnification not mutual or balanced"
      explanation: "One-sided provisions create unfair risk distribution"
      remediation: "Negotiate balanced indemnification"

  medium:
    - id: "LP-MED-001"
      signal: "Survival period for liability not specified"
      remediation: "Define liability survival period"

    - id: "LP-MED-002"
      signal: "No carve-outs for critical risks"
      remediation: "Add carve-outs for IP, data breach, gross negligence"

    - id: "LP-MED-003"
      signal: "Insurance verification not performed"
      remediation: "Implement insurance certificate review process"

  low:
    - id: "LP-LOW-001"
      signal: "Liability provisions could be clearer"

  positive:
    - id: "LP-POS-001"
      signal: "Balanced liability provisions appropriate to risk"
    - id: "LP-POS-002"
      signal: "Comprehensive insurance requirements with verification"
    - id: "LP-POS-003"
      signal: "Clear carve-outs for critical risks"

procedure:
  context:
    cognitive_mode: "critical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Contract Risk Assessment"
      description: |
        Identify contracts requiring liability review based
        on risk exposure and contract value.
      duration_estimate: "30 min"

      questions:
        - "What are the highest risk vendor relationships?"
        - "What is the potential exposure for each?"
        - "Which contracts warrant detailed review?"

      expected_findings:
        - "Prioritized contract list"
        - "Risk exposure assessment"

    - id: "2"
      name: "Liability Clause Review"
      description: |
        Analyze limitation of liability provisions including
        caps, exclusions, and carve-outs.
      duration_estimate: "60 min"

      questions:
        - "What are the liability caps?"
        - "What exclusions exist?"
        - "Are carve-outs appropriate?"

      expected_findings:
        - "Liability cap analysis"
        - "Exclusion review"

    - id: "3"
      name: "Indemnification Assessment"
      description: |
        Evaluate indemnification obligations for both parties.
      duration_estimate: "45 min"

      questions:
        - "What indemnification exists?"
        - "Is it mutual or one-sided?"
        - "What triggers indemnification?"

      expected_findings:
        - "Indemnification analysis"
        - "Balance assessment"

    - id: "4"
      name: "Insurance Verification"
      description: |
        Review insurance requirements and verify
        current certificates.
      duration_estimate: "30 min"

      expected_findings:
        - "Insurance requirements"
        - "Certificate verification"

    - id: "5"
      name: "Proportionality Analysis"
      description: |
        Assess whether liability provisions are proportionate
        to risk exposure and contract value.
      duration_estimate: "30 min"

      expected_findings:
        - "Proportionality assessment"
        - "Gap identification"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "liability_assessment"
      format: "structured"
      sections:
        - "Risk Assessment"
        - "Liability Analysis"
        - "Indemnification Review"
        - "Insurance Verification"
        - "Recommendations"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Key Findings"
        - "Recommendations"

  confidence_guidance:
    high: "All contracts reviewed with legal consultation"
    medium: "Key contracts reviewed"
    low: "Sample contract review only"

offline:
  capability: "full"

profiles:
  membership:
    quick:
      included: false
      reason: "Requires detailed legal analysis"
    full:
      included: true
      priority: 2

closeout_checklist:
  - id: "lp-001"
    item: "High-risk contracts identified"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Confirm risk-based prioritization complete"
    expected: "Confirmed by reviewer"

  - id: "lp-002"
    item: "Liability provisions reviewed"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Verify liability clause analysis complete"
    expected: "Confirmed by reviewer"

  - id: "lp-003"
    item: "Indemnification assessed"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Confirm indemnification review complete"
    expected: "Confirmed by reviewer"

  - id: "lp-004"
    item: "Recommendations documented"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Verify improvement recommendations provided"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["all"]

  compliance_frameworks:
    - framework: "ISO 27001"
      controls: ["A.15.1.2"]
    - framework: "SOC 2"
      controls: ["CC9.2"]
    - framework: "NIST CSF"
      controls: ["ID.SC-3"]

relationships:
  commonly_combined:
    - "vendor-third-party.contract-management.vendor-contract-review"
    - "vendor-third-party.contract-management.termination-clauses"
    - "vendor-third-party.fourth-party-risk.cascading-risk-assessment"
