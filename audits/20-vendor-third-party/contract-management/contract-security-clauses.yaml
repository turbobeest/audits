# ============================================================
# AUDIT: Contract Security Clauses Audit
# ============================================================
# Evaluates security-related provisions in vendor contracts
# for completeness and adequacy.
# ============================================================

audit:
  id: "vendor-third-party.contract-management.contract-security-clauses"

  name: "Contract Security Clauses Audit"

  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "vendor-third-party"
  category_number: 20
  subcategory: "contract-management"

  tier: "expert"
  estimated_duration: "3-5 hours"  # median: 4h

  completeness: "requires_discovery"
  requires_runtime: false
  destructive: false

execution:
  automatable: "manual"
  severity: "critical"
  scope: "documentation"

  default_profiles:
    - "full"
    - "security"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Evaluates security clauses in vendor contracts including:
    - Data protection and confidentiality
    - Security controls and standards
    - Access management requirements
    - Incident notification obligations
    - Breach response responsibilities
    - Audit and assessment rights
    - Subcontractor security requirements
    - Security certifications and attestations
    - Personnel security requirements
    - Security during and after termination

  why_it_matters: |
    Security clauses define vendor security obligations and recourse.
    Inadequate security clauses result in:
    - Unclear security expectations
    - No contractual basis for security requirements
    - Limited recourse for security failures
    - Gaps in data protection coverage
    - Delayed incident notification
    - Uncontrolled subcontractor access
    - Security gaps during vendor transitions
    Strong security clauses protect organizational data and systems.

  when_to_run:
    - "During vendor security assessments"
    - "Before onboarding vendors with data access"
    - "During contract renewals"
    - "After security incidents"
    - "When security requirements change"

prerequisites:
  required_artifacts:
    - type: "vendor_contracts"
      description: "Contracts with security-relevant vendors"
    - type: "security_requirements"
      description: "Organizational security requirements"
    - type: "security_standards"
      description: "Applicable security standards"

  access_requirements:
    - "Vendor contracts"
    - "Security policies"
    - "Information security team"
    - "Legal team"

discovery:
  file_patterns:
    - glob: "**/contracts/**security**"
      purpose: "Find security schedules"
    - glob: "**/security/**vendor**"
      purpose: "Locate vendor security requirements"

  documents_to_review:
    - type: "Security schedules"
      purpose: "Review contractual security requirements"
    - type: "Data protection addenda"
      purpose: "Assess data protection provisions"
    - type: "Security questionnaires"
      purpose: "Verify vendor security capabilities"

  interviews:
    - role: "Information Security"
      questions:
        - "What security requirements are standard?"
        - "How are vendor security obligations verified?"
        - "What security gaps exist in contracts?"
      purpose: "Understand security requirements"
    - role: "Legal"
      questions:
        - "How are security clauses negotiated?"
        - "What is the liability for security breaches?"
        - "Are security terms enforceable?"
      purpose: "Assess legal adequacy"

knowledge_sources:
  specifications:
    - id: "iso-27001-a15"
      name: "ISO 27001 A.15 Supplier Relationships"
      url: "https://www.iso.org/isoiec-27001-information-security.html"
      offline_cache: true
      priority: "required"
    - id: "nist-csf-supply"
      name: "NIST CSF Supply Chain Risk Management"
      url: "https://www.nist.gov/cyberframework"
      offline_cache: true
      priority: "required"

  guides:
    - id: "cloud-security-alliance"
      name: "CSA Cloud Controls Matrix"
      url: "https://cloudsecurityalliance.org/research/cloud-controls-matrix/"
      offline_cache: true

tooling:
  assessment_tools:
    - tool: "Security Clause Checklist"
      purpose: "Verify required security provisions"
    - tool: "Gap Analysis Template"
      purpose: "Identify missing security requirements"

signals:
  critical:
    - id: "CSC-CRIT-001"
      signal: "No security requirements in data-access contract"
      evidence_indicators:
        - "Vendor accesses sensitive data"
        - "No security obligations defined"
        - "Standard terms only with no security addendum"
      explanation: |
        Vendors with data access must have contractual security
        obligations. Without them, no enforceable security exists.
      remediation: "Add comprehensive security requirements to contract"

    - id: "CSC-CRIT-002"
      signal: "No breach notification requirement"
      evidence_indicators:
        - "No incident notification clause"
        - "No notification timeline defined"
        - "No cooperation requirements"
      explanation: |
        Without breach notification requirements, organization may
        not learn of incidents affecting their data in time to respond.
      remediation: "Add breach notification with specific timelines"

    - id: "CSC-CRIT-003"
      signal: "No audit or assessment rights"
      evidence_indicators:
        - "Cannot verify vendor security"
        - "No right to audit or inspect"
        - "No assessment questionnaire requirements"
      explanation: |
        Without audit rights, vendor security claims cannot be verified.
        Trust without verification creates unmitigated risk.
      remediation: "Include audit rights and assessment obligations"

  high:
    - id: "CSC-HIGH-001"
      signal: "Subcontractor security not addressed"
      explanation: "Security chain extends to subcontractors"
      remediation: "Add subcontractor security flow-down requirements"

    - id: "CSC-HIGH-002"
      signal: "No security certification requirements"
      explanation: "Certifications provide baseline assurance"
      remediation: "Require relevant security certifications"

    - id: "CSC-HIGH-003"
      signal: "Data handling at termination not specified"
      explanation: "Data must be protected through relationship end"
      remediation: "Define data return/destruction requirements"

  medium:
    - id: "CSC-MED-001"
      signal: "Security requirements too generic"
      remediation: "Specify detailed security controls"

    - id: "CSC-MED-002"
      signal: "Personnel security not addressed"
      remediation: "Add background check and training requirements"

    - id: "CSC-MED-003"
      signal: "Security review mechanism not defined"
      remediation: "Establish periodic security review process"

  low:
    - id: "CSC-LOW-001"
      signal: "Security clause references outdated standards"

  positive:
    - id: "CSC-POS-001"
      signal: "Comprehensive security schedule with specific controls"
    - id: "CSC-POS-002"
      signal: "Regular security assessment requirements"
    - id: "CSC-POS-003"
      signal: "Clear breach notification with defined timelines"

procedure:
  context:
    cognitive_mode: "critical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Contract Security Inventory"
      description: |
        Identify contracts requiring security clauses based on
        data access and system connectivity.
      duration_estimate: "30 min"

      questions:
        - "Which vendors access sensitive data?"
        - "What system access do vendors have?"
        - "What are the security criticality levels?"

      expected_findings:
        - "Prioritized contract list"
        - "Data access mapping"

    - id: "2"
      name: "Security Clause Assessment"
      description: |
        Review security provisions in each contract against
        required security elements.
      duration_estimate: "90 min"

      questions:
        - "What security clauses exist?"
        - "Are required elements present?"
        - "Are clauses specific and enforceable?"

      expected_findings:
        - "Security clause inventory"
        - "Gap identification"

    - id: "3"
      name: "Incident and Breach Review"
      description: |
        Assess incident notification and breach response
        provisions.
      duration_estimate: "30 min"

      expected_findings:
        - "Notification requirements"
        - "Response obligations"

    - id: "4"
      name: "Audit Rights Verification"
      description: |
        Verify audit, assessment, and certification
        requirements.
      duration_estimate: "30 min"

      expected_findings:
        - "Audit rights assessment"
        - "Certification requirements"

    - id: "5"
      name: "Termination Security Review"
      description: |
        Assess data handling and security obligations
        at contract termination.
      duration_estimate: "20 min"

      expected_findings:
        - "Termination security provisions"
        - "Data handling requirements"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "security_clause_assessment"
      format: "structured"
      sections:
        - "Contract Inventory"
        - "Security Clause Analysis"
        - "Incident Provisions"
        - "Audit Rights"
        - "Termination Security"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Key Findings"
        - "Recommendations"

  confidence_guidance:
    high: "All relevant contracts reviewed with security team"
    medium: "Key contracts reviewed"
    low: "Sample contract review only"

offline:
  capability: "full"

  cache_manifest:
    knowledge:
      - source_id: "iso-27001-a15"
        priority: "required"
      - source_id: "nist-csf-supply"
        priority: "required"

profiles:
  membership:
    quick:
      included: false
      reason: "Requires detailed security analysis"
    full:
      included: true
      priority: 1
    security:
      included: true
      priority: 1

closeout_checklist:
  - id: "csc-001"
    item: "Security-relevant contracts identified"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Confirm data access contracts identified"
    expected: "Confirmed by reviewer"

  - id: "csc-002"
    item: "Security clauses assessed"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Verify security provisions reviewed"
    expected: "Confirmed by reviewer"

  - id: "csc-003"
    item: "Breach notification verified"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Confirm notification requirements present"
    expected: "Confirmed by reviewer"

  - id: "csc-004"
    item: "Recommendations documented"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Verify improvement recommendations provided"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["all"]

  compliance_frameworks:
    - framework: "ISO 27001"
      controls: ["A.15.1.1", "A.15.1.2", "A.15.1.3"]
    - framework: "NIST CSF"
      controls: ["ID.SC-3", "PR.AT-3", "DE.CM-6"]
    - framework: "SOC 2"
      controls: ["CC9.2", "CC2.3"]
    - framework: "GDPR"
      controls: ["Article 28", "Article 32"]

relationships:
  commonly_combined:
    - "vendor-third-party.contract-management.vendor-contract-review"
    - "vendor-third-party.contract-management.data-ownership-clauses"
    - "vendor-third-party.vendor-lifecycle.vendor-onboarding"
