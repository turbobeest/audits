# ============================================================
# AUDIT: Vendor Offboarding Audit
# ============================================================
# Evaluates vendor offboarding and exit processes for
# completeness and security.
# ============================================================

audit:
  id: "vendor-third-party.vendor-lifecycle.vendor-offboarding"

  name: "Vendor Offboarding Audit"

  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "vendor-third-party"
  category_number: 20
  subcategory: "vendor-lifecycle"

  tier: "expert"
  estimated_duration: "3-5 hours"  # median: 4h

  completeness: "requires_discovery"
  requires_runtime: false
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "process"

  default_profiles:
    - "full"
    - "security"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Evaluates vendor offboarding processes including:
    - Access revocation procedures
    - Data return and destruction
    - Knowledge transfer requirements
    - Transition assistance execution
    - Contract close-out
    - Financial settlement
    - Equipment and asset return
    - Documentation archival
    - Security clearance termination
    - Post-termination obligations

  why_it_matters: |
    Proper offboarding protects organizational assets at exit.
    Poor offboarding processes result in:
    - Residual access creating security risks
    - Data retention by former vendors
    - Knowledge loss without transfer
    - Financial exposure from incomplete settlement
    - Compliance violations from retained data
    - Asset loss from unreturned equipment
    - Difficulty with future audits
    Comprehensive offboarding ensures clean relationship termination.

  when_to_run:
    - "Before vendor terminations"
    - "After vendor exits"
    - "During vendor management assessments"
    - "When implementing offboarding procedures"
    - "Annual process reviews"

prerequisites:
  required_artifacts:
    - type: "offboarding_procedures"
      description: "Documented vendor offboarding process"
    - type: "offboarding_records"
      description: "Sample vendor offboarding documentation"
    - type: "exit_checklists"
      description: "Offboarding checklists and templates"

  access_requirements:
    - "Offboarding procedures"
    - "Vendor exit records"
    - "IT security team"
    - "Procurement/legal team"

discovery:
  file_patterns:
    - glob: "**/vendor/**offboarding**"
      purpose: "Find offboarding documentation"
    - glob: "**/exit/**"
      purpose: "Locate exit procedures"

  documents_to_review:
    - type: "Offboarding procedures"
      purpose: "Review process documentation"
    - type: "Exit records"
      purpose: "Assess actual compliance"
    - type: "Access revocation logs"
      purpose: "Verify access removal"

  interviews:
    - role: "IT Security"
      questions:
        - "How is vendor access revoked?"
        - "How is revocation verified?"
        - "What access remains after exit?"
      purpose: "Understand access management"
    - role: "Vendor Management"
      questions:
        - "What is the offboarding process?"
        - "How is data handled?"
        - "What challenges occur?"
      purpose: "Assess offboarding process"

knowledge_sources:
  specifications:
    - id: "iso-27001-a15"
      name: "ISO 27001 A.15 Supplier Relationships"
      url: "https://www.iso.org/isoiec-27001-information-security.html"
      offline_cache: true
      priority: "required"

  guides:
    - id: "vendor-exit"
      name: "Vendor Exit Management Guide"
      url: "https://www.sharedassessments.org/"
      offline_cache: true

tooling:
  assessment_tools:
    - tool: "Offboarding Checklist Review"
      purpose: "Verify process completeness"
    - tool: "Access Audit Tool"
      purpose: "Verify access revocation"

signals:
  critical:
    - id: "VOB-CRIT-001"
      signal: "No formal offboarding process"
      evidence_indicators:
        - "Vendor exits without formal process"
        - "No offboarding checklist exists"
        - "Ad-hoc vendor terminations"
      explanation: |
        Without formal offboarding, security risks and data
        exposure persist after vendor relationships end.
      remediation: "Implement formal vendor offboarding procedures"

    - id: "VOB-CRIT-002"
      signal: "Vendor access not revoked"
      evidence_indicators:
        - "Former vendors retain access"
        - "Access revocation delayed"
        - "No verification of revocation"
      explanation: |
        Retained access after termination creates significant
        security risk from unauthorized access.
      remediation: "Implement immediate access revocation with verification"

    - id: "VOB-CRIT-003"
      signal: "Data not returned or destroyed"
      evidence_indicators:
        - "No data return received"
        - "No destruction certification"
        - "Vendor retaining organizational data"
      explanation: |
        Unreturned data remains exposed to risk and may
        violate data protection requirements.
      remediation: "Enforce data return/destruction with certification"

  high:
    - id: "VOB-HIGH-001"
      signal: "Knowledge transfer not completed"
      explanation: "Knowledge must be transferred before exit"
      remediation: "Include knowledge transfer in offboarding"

    - id: "VOB-HIGH-002"
      signal: "Financial settlement incomplete"
      explanation: "All financial obligations must be settled"
      remediation: "Complete financial close-out before exit"

    - id: "VOB-HIGH-003"
      signal: "Assets not returned"
      explanation: "All organizational assets must be recovered"
      remediation: "Track and recover all assets"

  medium:
    - id: "VOB-MED-001"
      signal: "Offboarding documentation incomplete"
      remediation: "Enforce documentation requirements"

    - id: "VOB-MED-002"
      signal: "Transition assistance not utilized"
      remediation: "Plan and execute transition assistance"

    - id: "VOB-MED-003"
      signal: "Post-termination obligations not tracked"
      remediation: "Track and verify post-termination obligations"

  low:
    - id: "VOB-LOW-001"
      signal: "Offboarding process could be streamlined"

  positive:
    - id: "VOB-POS-001"
      signal: "Comprehensive offboarding with verification"
    - id: "VOB-POS-002"
      signal: "Immediate access revocation with audit"
    - id: "VOB-POS-003"
      signal: "Certified data destruction process"

procedure:
  context:
    cognitive_mode: "critical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Process Documentation Review"
      description: |
        Review documented offboarding procedures and
        requirements.
      duration_estimate: "30 min"

      questions:
        - "Are procedures documented?"
        - "What steps are required?"
        - "Is there a checklist?"

      expected_findings:
        - "Process documentation"
        - "Requirement completeness"

    - id: "2"
      name: "Access Management Assessment"
      description: |
        Evaluate access revocation procedures and
        verification.
      duration_estimate: "45 min"

      commands:
        - purpose: "Check for residual vendor access"
          command: "grep -r 'vendor' /etc/access/*.conf 2>/dev/null || echo 'Check access manually'"

      expected_findings:
        - "Revocation process"
        - "Verification effectiveness"

    - id: "3"
      name: "Data Handling Review"
      description: |
        Assess data return and destruction processes.
      duration_estimate: "45 min"

      questions:
        - "How is data handled at exit?"
        - "Is destruction certified?"
        - "Is return verified?"

      expected_findings:
        - "Data handling process"
        - "Certification compliance"

    - id: "4"
      name: "Sample Exit Review"
      description: |
        Review sample vendor exit records for
        process compliance.
      duration_estimate: "45 min"

      expected_findings:
        - "Compliance assessment"
        - "Exception identification"

    - id: "5"
      name: "Financial and Asset Review"
      description: |
        Assess financial settlement and asset
        recovery processes.
      duration_estimate: "30 min"

      expected_findings:
        - "Settlement process"
        - "Asset recovery"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "offboarding_assessment"
      format: "structured"
      sections:
        - "Process Review"
        - "Access Management"
        - "Data Handling"
        - "Sample Review"
        - "Financial Assessment"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Key Findings"
        - "Recommendations"

  confidence_guidance:
    high: "Full process review with sample testing"
    medium: "Process review with limited samples"
    low: "Documentation review only"

offline:
  capability: "full"

  cache_manifest:
    knowledge:
      - source_id: "iso-27001-a15"
        priority: "required"

profiles:
  membership:
    quick:
      included: false
      reason: "Requires detailed process assessment"
    full:
      included: true
      priority: 1
    security:
      included: true
      priority: 1

closeout_checklist:
  - id: "vob-001"
    item: "Offboarding process reviewed"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Confirm process documentation assessed"
    expected: "Confirmed by reviewer"

  - id: "vob-002"
    item: "Access revocation verified"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Verify access management assessed"
    expected: "Confirmed by reviewer"

  - id: "vob-003"
    item: "Data handling evaluated"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Confirm data handling process assessed"
    expected: "Confirmed by reviewer"

  - id: "vob-004"
    item: "Recommendations documented"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Verify improvement recommendations provided"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["all"]

  compliance_frameworks:
    - framework: "ISO 27001"
      controls: ["A.15.1.2", "A.9.2.6"]
    - framework: "NIST CSF"
      controls: ["PR.AC-1", "ID.SC-4"]
    - framework: "SOC 2"
      controls: ["CC6.1", "CC9.2"]
    - framework: "GDPR"
      controls: ["Article 28"]

relationships:
  commonly_combined:
    - "vendor-third-party.contract-management.termination-clauses"
    - "vendor-third-party.contract-management.data-ownership-clauses"
    - "vendor-third-party.vendor-governance.vendor-inventory"
