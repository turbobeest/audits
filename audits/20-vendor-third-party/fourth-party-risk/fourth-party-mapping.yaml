# ============================================================
# AUDIT: Fourth-Party Mapping Audit
# ============================================================
# Evaluates the identification and mapping of fourth-party
# relationships throughout the vendor supply chain.
# ============================================================

audit:
  id: "vendor-third-party.fourth-party-risk.fourth-party-mapping"

  name: "Fourth-Party Mapping Audit"

  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "vendor-third-party"
  category_number: 20
  subcategory: "fourth-party-risk"

  tier: "expert"
  estimated_duration: "4-6 hours"  # median: 5h

  completeness: "requires_discovery"
  requires_runtime: false
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "organizational"

  default_profiles:
    - "full"
    - "security"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Evaluates fourth-party mapping including:
    - Supply chain visibility depth
    - Fourth-party identification methods
    - Dependency mapping and documentation
    - Service flow documentation
    - Data flow through supply chain
    - Critical path identification
    - Geographic distribution
    - Technology dependencies
    - Shared service providers
    - Supply chain visualization

  why_it_matters: |
    Fourth-party mapping provides supply chain visibility.
    Without mapping, organizations face:
    - Hidden dependencies creating risk
    - Unknown parties with data access
    - Blind spots in risk assessments
    - Surprise supply chain disruptions
    - Concentration risk not identified
    - Compliance gaps in processing chain
    - Difficulty in incident response
    - Ineffective business continuity planning
    Comprehensive mapping enables proactive risk management.

  when_to_run:
    - "During vendor onboarding"
    - "Annual supply chain reviews"
    - "After supply chain incidents"
    - "During business continuity planning"
    - "When implementing supply chain risk programs"

prerequisites:
  required_artifacts:
    - type: "vendor_inventory"
      description: "Complete vendor inventory"
    - type: "subcontractor_disclosures"
      description: "Vendor subcontractor information"
    - type: "service_documentation"
      description: "Service and data flow documentation"

  access_requirements:
    - "Vendor inventory"
    - "Subcontractor disclosures"
    - "Architecture documentation"
    - "Vendor management team"

discovery:
  file_patterns:
    - glob: "**/vendor/**mapping**"
      purpose: "Find mapping documentation"
    - glob: "**/supply-chain/**"
      purpose: "Locate supply chain documentation"

  documents_to_review:
    - type: "Vendor inventory"
      purpose: "Identify direct vendors"
    - type: "Subcontractor lists"
      purpose: "Map fourth parties"
    - type: "Service flows"
      purpose: "Understand dependencies"

  interviews:
    - role: "Vendor Management"
      questions:
        - "How is supply chain mapped?"
        - "What visibility depth exists?"
        - "How are dependencies tracked?"
      purpose: "Understand mapping approach"
    - role: "Enterprise Architecture"
      questions:
        - "What technology dependencies exist?"
        - "How is the supply chain documented?"
        - "What critical paths are known?"
      purpose: "Assess technical mapping"

knowledge_sources:
  specifications:
    - id: "nist-scrm"
      name: "NIST SP 800-161 Supply Chain Risk Management"
      url: "https://csrc.nist.gov/publications/detail/sp/800-161/rev-1/final"
      offline_cache: true
      priority: "required"

  guides:
    - id: "supply-chain-mapping"
      name: "Supply Chain Mapping Best Practices"
      url: "https://www.sharedassessments.org/"
      offline_cache: true

tooling:
  assessment_tools:
    - tool: "Supply Chain Mapping Template"
      purpose: "Document supply chain relationships"
    - tool: "Dependency Visualization"
      purpose: "Visualize supply chain"

signals:
  critical:
    - id: "FPM-CRIT-001"
      signal: "No fourth-party visibility"
      evidence_indicators:
        - "Supply chain unknown beyond direct vendors"
        - "No subcontractor information collected"
        - "Cannot identify fourth parties"
      explanation: |
        Without visibility, fourth-party risks are unknown and
        unmanaged. Supply chain attacks exploit these blind spots.
      remediation: "Implement fourth-party identification program"

    - id: "FPM-CRIT-002"
      signal: "Critical service dependencies unmapped"
      evidence_indicators:
        - "Critical services with unknown dependencies"
        - "No dependency documentation"
        - "Service paths not understood"
      explanation: |
        Unknown dependencies for critical services create
        significant business continuity and security risks.
      remediation: "Map dependencies for all critical services"

    - id: "FPM-CRIT-003"
      signal: "Data flows through unknown parties"
      evidence_indicators:
        - "Data processing chain not documented"
        - "Unknown parties handling data"
        - "No data flow mapping"
      explanation: |
        Data flowing through unknown parties cannot be protected
        and creates compliance violations.
      remediation: "Map data flows through complete supply chain"

  high:
    - id: "FPM-HIGH-001"
      signal: "Technology dependencies not mapped"
      explanation: "Technology dependencies can create widespread impact"
      remediation: "Identify shared technology providers"

    - id: "FPM-HIGH-002"
      signal: "Geographic distribution unknown"
      explanation: "Location affects regulatory and risk considerations"
      remediation: "Map geographic distribution of supply chain"

    - id: "FPM-HIGH-003"
      signal: "Mapping not maintained"
      explanation: "Supply chains change and mapping must be current"
      remediation: "Establish mapping update process"

  medium:
    - id: "FPM-MED-001"
      signal: "Mapping depth insufficient"
      remediation: "Extend mapping beyond immediate fourth parties"

    - id: "FPM-MED-002"
      signal: "Mapping not integrated with risk assessment"
      remediation: "Use mapping to inform risk assessments"

    - id: "FPM-MED-003"
      signal: "Visualization tools not used"
      remediation: "Implement supply chain visualization"

  low:
    - id: "FPM-LOW-001"
      signal: "Mapping documentation format inconsistent"

  positive:
    - id: "FPM-POS-001"
      signal: "Comprehensive multi-tier supply chain mapping"
    - id: "FPM-POS-002"
      signal: "Real-time mapping with automated updates"
    - id: "FPM-POS-003"
      signal: "Mapping integrated with risk management"

procedure:
  context:
    cognitive_mode: "critical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Current Mapping Assessment"
      description: |
        Review existing supply chain mapping and
        documentation.
      duration_estimate: "45 min"

      questions:
        - "What mapping exists?"
        - "How deep is visibility?"
        - "Is documentation current?"

      expected_findings:
        - "Mapping status"
        - "Coverage assessment"

    - id: "2"
      name: "Vendor Disclosure Review"
      description: |
        Assess fourth-party information disclosed
        by vendors.
      duration_estimate: "45 min"

      questions:
        - "What disclosures have been received?"
        - "Are disclosures complete?"
        - "How current is the information?"

      expected_findings:
        - "Disclosure completeness"
        - "Information quality"

    - id: "3"
      name: "Critical Path Analysis"
      description: |
        Identify and map critical service paths
        and dependencies.
      duration_estimate: "60 min"

      questions:
        - "What are critical services?"
        - "What are their dependencies?"
        - "What are single points of failure?"

      expected_findings:
        - "Critical path mapping"
        - "Dependency identification"

    - id: "4"
      name: "Data Flow Mapping"
      description: |
        Map data flows through the supply chain.
      duration_estimate: "45 min"

      expected_findings:
        - "Data flow documentation"
        - "Processing chain"

    - id: "5"
      name: "Mapping Process Assessment"
      description: |
        Evaluate the process for maintaining and
        updating supply chain maps.
      duration_estimate: "30 min"

      expected_findings:
        - "Process effectiveness"
        - "Update mechanisms"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "mapping_assessment"
      format: "structured"
      sections:
        - "Current Mapping Review"
        - "Disclosure Assessment"
        - "Critical Path Analysis"
        - "Data Flow Mapping"
        - "Process Assessment"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Key Findings"
        - "Recommendations"

  confidence_guidance:
    high: "Full mapping review with disclosure verification"
    medium: "Mapping review with sample verification"
    low: "Documentation review only"

offline:
  capability: "full"

  cache_manifest:
    knowledge:
      - source_id: "nist-scrm"
        priority: "required"

profiles:
  membership:
    quick:
      included: false
      reason: "Requires detailed supply chain assessment"
    full:
      included: true
      priority: 1
    security:
      included: true
      priority: 1

closeout_checklist:
  - id: "fpm-001"
    item: "Current mapping assessed"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Confirm existing mapping reviewed"
    expected: "Confirmed by reviewer"

  - id: "fpm-002"
    item: "Critical paths identified"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Verify critical path analysis complete"
    expected: "Confirmed by reviewer"

  - id: "fpm-003"
    item: "Data flows mapped"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Confirm data flow mapping assessed"
    expected: "Confirmed by reviewer"

  - id: "fpm-004"
    item: "Recommendations documented"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Verify improvement recommendations provided"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["all"]

  compliance_frameworks:
    - framework: "NIST CSF"
      controls: ["ID.SC-1", "ID.SC-2"]
    - framework: "ISO 27001"
      controls: ["A.15.1.1"]
    - framework: "SOC 2"
      controls: ["CC9.2"]

relationships:
  commonly_combined:
    - "vendor-third-party.fourth-party-risk.subcontractor-oversight"
    - "vendor-third-party.fourth-party-risk.concentration-risk"
    - "vendor-third-party.vendor-governance.vendor-inventory"
