# ============================================================
# AUDIT: Subcontractor Oversight Audit
# ============================================================
# Evaluates oversight of vendor subcontractors and fourth
# parties involved in service delivery.
# ============================================================

audit:
  id: "vendor-third-party.fourth-party-risk.subcontractor-oversight"

  name: "Subcontractor Oversight Audit"

  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "vendor-third-party"
  category_number: 20
  subcategory: "fourth-party-risk"

  tier: "expert"
  estimated_duration: "4-6 hours"  # median: 5h

  completeness: "requires_discovery"
  requires_runtime: false
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "organizational"

  default_profiles:
    - "full"
    - "security"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Evaluates subcontractor oversight including:
    - Subcontractor identification and disclosure
    - Authorization and approval processes
    - Contractual flow-down requirements
    - Security requirements for subcontractors
    - Performance monitoring of subcontractors
    - Change notification processes
    - Audit rights over subcontractors
    - Incident reporting from subcontractors
    - Geographic and jurisdictional considerations
    - Subcontractor risk assessment

  why_it_matters: |
    Subcontractors extend the vendor risk chain to fourth parties.
    Poor subcontractor oversight results in:
    - Unknown parties accessing organizational data
    - Security controls bypassed through subcontractors
    - Compliance violations from unvetted parties
    - No recourse for subcontractor failures
    - Supply chain vulnerabilities
    - Regulatory violations for unauthorized processing
    - Hidden concentration risk
    Effective oversight extends controls to the full supply chain.

  when_to_run:
    - "During vendor due diligence"
    - "Annual vendor reviews"
    - "After subcontractor-related incidents"
    - "When regulations change"
    - "During supply chain assessments"

prerequisites:
  required_artifacts:
    - type: "vendor_contracts"
      description: "Contracts with subcontractor provisions"
    - type: "subcontractor_lists"
      description: "Vendor subcontractor disclosures"
    - type: "flow_down_requirements"
      description: "Subcontractor requirement documentation"

  access_requirements:
    - "Vendor contracts"
    - "Subcontractor disclosures"
    - "Vendor management team"
    - "Information security team"

discovery:
  file_patterns:
    - glob: "**/vendor/**subcontractor**"
      purpose: "Find subcontractor documentation"
    - glob: "**/contracts/**sub**"
      purpose: "Locate subcontract provisions"

  documents_to_review:
    - type: "Subcontractor provisions"
      purpose: "Review contractual requirements"
    - type: "Subcontractor lists"
      purpose: "Identify fourth parties"
    - type: "Flow-down requirements"
      purpose: "Assess requirement extension"

  interviews:
    - role: "Vendor Management"
      questions:
        - "How are subcontractors identified?"
        - "What approval is required?"
        - "How are changes communicated?"
      purpose: "Understand oversight process"
    - role: "Information Security"
      questions:
        - "What security requirements flow down?"
        - "How is subcontractor security verified?"
        - "What audit rights exist?"
      purpose: "Assess security oversight"

knowledge_sources:
  specifications:
    - id: "gdpr-art28"
      name: "GDPR Article 28 Sub-processor Requirements"
      url: "https://gdpr-info.eu/art-28-gdpr/"
      offline_cache: true
      priority: "required"
    - id: "nist-scrm"
      name: "NIST SP 800-161 Supply Chain Risk Management"
      url: "https://csrc.nist.gov/publications/detail/sp/800-161/rev-1/final"
      offline_cache: true
      priority: "required"

  guides:
    - id: "fourth-party"
      name: "Fourth Party Risk Management"
      url: "https://www.sharedassessments.org/"
      offline_cache: true

tooling:
  assessment_tools:
    - tool: "Subcontractor Oversight Checklist"
      purpose: "Verify oversight elements"
    - tool: "Flow-down Assessment"
      purpose: "Evaluate requirement extension"

signals:
  critical:
    - id: "SO-CRIT-001"
      signal: "Subcontractors not identified or disclosed"
      evidence_indicators:
        - "No subcontractor list available"
        - "Vendor refuses to disclose"
        - "Unknown parties processing data"
      explanation: |
        Unknown subcontractors cannot be assessed or controlled.
        Full supply chain visibility is required for risk management.
      remediation: "Require and verify subcontractor disclosures"

    - id: "SO-CRIT-002"
      signal: "No authorization for subcontractor use"
      evidence_indicators:
        - "Subcontractors engaged without approval"
        - "No authorization process exists"
        - "Contract lacks authorization requirements"
      explanation: |
        GDPR and other regulations require authorization before
        subcontractor engagement. Unauthorized use creates liability.
      remediation: "Implement subcontractor authorization process"

    - id: "SO-CRIT-003"
      signal: "Security requirements not extended to subcontractors"
      evidence_indicators:
        - "No flow-down of security requirements"
        - "Subcontractors not bound to security terms"
        - "Security chain broken at subcontractor level"
      explanation: |
        Security controls must extend to all parties with access.
        Gaps at subcontractor level create vulnerabilities.
      remediation: "Require security flow-down to all subcontractors"

  high:
    - id: "SO-HIGH-001"
      signal: "No audit rights over subcontractors"
      explanation: "Audit rights enable verification of compliance"
      remediation: "Ensure audit rights extend to subcontractors"

    - id: "SO-HIGH-002"
      signal: "Subcontractor changes not notified"
      explanation: "Changes must be communicated for assessment"
      remediation: "Require timely notification of subcontractor changes"

    - id: "SO-HIGH-003"
      signal: "No incident reporting from subcontractors"
      explanation: "Incidents at subcontractor level affect organization"
      remediation: "Require incident reporting through supply chain"

  medium:
    - id: "SO-MED-001"
      signal: "Subcontractor risk not assessed"
      remediation: "Include subcontractors in risk assessments"

    - id: "SO-MED-002"
      signal: "Geographic location of subcontractors unknown"
      remediation: "Require location disclosure for compliance"

    - id: "SO-MED-003"
      signal: "Subcontractor performance not monitored"
      remediation: "Extend performance monitoring to subcontractors"

  low:
    - id: "SO-LOW-001"
      signal: "Subcontractor documentation could be improved"

  positive:
    - id: "SO-POS-001"
      signal: "Complete subcontractor visibility and authorization"
    - id: "SO-POS-002"
      signal: "Full security flow-down with verification"
    - id: "SO-POS-003"
      signal: "Proactive subcontractor change management"

procedure:
  context:
    cognitive_mode: "critical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Contractual Review"
      description: |
        Review subcontractor provisions in vendor
        contracts.
      duration_estimate: "45 min"

      questions:
        - "What subcontractor terms exist?"
        - "Is authorization required?"
        - "What flow-down is required?"

      expected_findings:
        - "Contractual provisions"
        - "Gap identification"

    - id: "2"
      name: "Subcontractor Inventory"
      description: |
        Obtain and verify subcontractor lists from
        vendors.
      duration_estimate: "45 min"

      questions:
        - "What subcontractors are disclosed?"
        - "What services do they provide?"
        - "Where are they located?"

      expected_findings:
        - "Subcontractor inventory"
        - "Service mapping"

    - id: "3"
      name: "Authorization Assessment"
      description: |
        Evaluate subcontractor authorization and
        approval processes.
      duration_estimate: "30 min"

      expected_findings:
        - "Authorization process"
        - "Compliance assessment"

    - id: "4"
      name: "Security Flow-down Review"
      description: |
        Assess extension of security requirements
        to subcontractors.
      duration_estimate: "45 min"

      expected_findings:
        - "Security flow-down"
        - "Gap identification"

    - id: "5"
      name: "Monitoring and Change Assessment"
      description: |
        Evaluate ongoing monitoring and change
        notification processes.
      duration_estimate: "30 min"

      expected_findings:
        - "Monitoring effectiveness"
        - "Change management"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "subcontractor_assessment"
      format: "structured"
      sections:
        - "Contractual Review"
        - "Subcontractor Inventory"
        - "Authorization Assessment"
        - "Security Flow-down"
        - "Monitoring Review"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Key Findings"
        - "Recommendations"

  confidence_guidance:
    high: "Full review with subcontractor verification"
    medium: "Contractual and disclosure review"
    low: "Documentation review only"

offline:
  capability: "full"

  cache_manifest:
    knowledge:
      - source_id: "gdpr-art28"
        priority: "required"
      - source_id: "nist-scrm"
        priority: "required"

profiles:
  membership:
    quick:
      included: false
      reason: "Requires detailed supply chain assessment"
    full:
      included: true
      priority: 1
    security:
      included: true
      priority: 1

closeout_checklist:
  - id: "so-001"
    item: "Contractual provisions reviewed"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Confirm subcontractor terms assessed"
    expected: "Confirmed by reviewer"

  - id: "so-002"
    item: "Subcontractor inventory verified"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Verify subcontractor disclosure reviewed"
    expected: "Confirmed by reviewer"

  - id: "so-003"
    item: "Security flow-down assessed"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Confirm security requirements reviewed"
    expected: "Confirmed by reviewer"

  - id: "so-004"
    item: "Recommendations documented"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Verify improvement recommendations provided"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["all"]

  compliance_frameworks:
    - framework: "GDPR"
      controls: ["Article 28"]
    - framework: "ISO 27001"
      controls: ["A.15.1.1", "A.15.1.2"]
    - framework: "NIST CSF"
      controls: ["ID.SC-1", "ID.SC-3"]
    - framework: "SOC 2"
      controls: ["CC9.2"]

relationships:
  commonly_combined:
    - "vendor-third-party.fourth-party-risk.fourth-party-mapping"
    - "vendor-third-party.fourth-party-risk.concentration-risk"
    - "vendor-third-party.contract-management.contract-security-clauses"
