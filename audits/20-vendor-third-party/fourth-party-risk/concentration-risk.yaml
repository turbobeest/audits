# ============================================================
# AUDIT: Concentration Risk Audit
# ============================================================
# Evaluates vendor concentration risk and dependency on
# single vendors or shared providers.
# ============================================================

audit:
  id: "vendor-third-party.fourth-party-risk.concentration-risk"

  name: "Concentration Risk Audit"

  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "vendor-third-party"
  category_number: 20
  subcategory: "fourth-party-risk"

  tier: "expert"
  estimated_duration: "4-5 hours"  # median: 4h

  completeness: "requires_discovery"
  requires_runtime: false
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "organizational"

  default_profiles:
    - "full"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Evaluates vendor concentration risk including:
    - Single vendor dependencies
    - Shared technology providers
    - Cloud platform concentration
    - Geographic concentration
    - Critical service single-sourcing
    - Fourth-party concentration
    - Industry-wide dependencies
    - Financial concentration
    - Exit strategy viability
    - Alternative provider availability

  why_it_matters: |
    Concentration risk amplifies vendor failure impact.
    Poor concentration management results in:
    - Single points of failure
    - Widespread outage impact
    - Vendor lock-in
    - Reduced negotiating leverage
    - Industry-wide vulnerabilities
    - Limited exit options
    - Cascading failure potential
    - Regulatory concentration concerns
    Managed concentration limits systemic risk.

  when_to_run:
    - "Annual supply chain reviews"
    - "Before major vendor commitments"
    - "During business continuity planning"
    - "After vendor concentration incidents"
    - "During vendor strategy planning"

prerequisites:
  required_artifacts:
    - type: "vendor_inventory"
      description: "Complete vendor inventory"
    - type: "fourth_party_mapping"
      description: "Supply chain mapping"
    - type: "spend_data"
      description: "Vendor spend analysis"

  access_requirements:
    - "Vendor inventory"
    - "Supply chain mapping"
    - "Architecture documentation"
    - "Procurement data"

discovery:
  file_patterns:
    - glob: "**/vendor/**concentration**"
      purpose: "Find concentration analysis"
    - glob: "**/risk/**dependency**"
      purpose: "Locate dependency assessments"

  documents_to_review:
    - type: "Vendor inventory"
      purpose: "Identify vendor landscape"
    - type: "Supply chain mapping"
      purpose: "Assess concentration"
    - type: "Spend analysis"
      purpose: "Evaluate financial concentration"

  interviews:
    - role: "Vendor Management"
      questions:
        - "What concentration concerns exist?"
        - "Are alternatives available?"
        - "What exit strategies exist?"
      purpose: "Understand concentration awareness"
    - role: "Enterprise Architecture"
      questions:
        - "What technology concentrations exist?"
        - "What are single points of failure?"
        - "How is concentration managed?"
      purpose: "Assess technical concentration"

knowledge_sources:
  specifications:
    - id: "nist-scrm"
      name: "NIST SP 800-161 Supply Chain Risk Management"
      url: "https://csrc.nist.gov/publications/detail/sp/800-161/rev-1/final"
      offline_cache: true
      priority: "required"

  guides:
    - id: "concentration-risk"
      name: "Vendor Concentration Risk Management"
      url: "https://www.sharedassessments.org/"
      offline_cache: true

tooling:
  assessment_tools:
    - tool: "Concentration Analysis Template"
      purpose: "Document concentration risks"
    - tool: "Dependency Heat Map"
      purpose: "Visualize concentration"

signals:
  critical:
    - id: "CR-CRIT-001"
      signal: "Critical service single-sourced with no alternative"
      evidence_indicators:
        - "Critical service from single vendor"
        - "No alternative providers identified"
        - "No exit strategy exists"
      explanation: |
        Single-sourced critical services create unacceptable
        business continuity risk without alternatives.
      remediation: "Identify and qualify alternative providers"

    - id: "CR-CRIT-002"
      signal: "Hidden concentration through shared fourth party"
      evidence_indicators:
        - "Multiple vendors using same fourth party"
        - "Critical infrastructure single-sourced upstream"
        - "Concentration not visible at vendor level"
      explanation: |
        Shared fourth parties create hidden concentration that
        can cause widespread failures.
      remediation: "Map and assess fourth-party concentration"

    - id: "CR-CRIT-003"
      signal: "Cloud platform concentration without mitigation"
      evidence_indicators:
        - "Critical workloads on single cloud provider"
        - "No multi-cloud capability"
        - "Cloud outage would cause major impact"
      explanation: |
        Cloud platform concentration creates significant risk
        from provider outages.
      remediation: "Implement cloud concentration mitigation strategy"

  high:
    - id: "CR-HIGH-001"
      signal: "Geographic concentration in high-risk areas"
      explanation: "Geographic concentration amplifies regional risks"
      remediation: "Assess and mitigate geographic concentration"

    - id: "CR-HIGH-002"
      signal: "Financial concentration with single vendor"
      explanation: "High spend concentration increases dependency"
      remediation: "Evaluate spend diversification"

    - id: "CR-HIGH-003"
      signal: "No concentration monitoring"
      explanation: "Concentration must be tracked and managed"
      remediation: "Implement concentration monitoring"

  medium:
    - id: "CR-MED-001"
      signal: "Exit strategies not documented"
      remediation: "Document exit strategies for critical vendors"

    - id: "CR-MED-002"
      signal: "Alternative providers not qualified"
      remediation: "Pre-qualify alternative providers"

    - id: "CR-MED-003"
      signal: "Concentration limits not defined"
      remediation: "Establish concentration thresholds and limits"

  low:
    - id: "CR-LOW-001"
      signal: "Concentration documentation could be improved"

  positive:
    - id: "CR-POS-001"
      signal: "Proactive concentration monitoring and management"
    - id: "CR-POS-002"
      signal: "Documented exit strategies with qualified alternatives"
    - id: "CR-POS-003"
      signal: "Multi-vendor strategy for critical services"

procedure:
  context:
    cognitive_mode: "critical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Vendor Inventory Analysis"
      description: |
        Analyze vendor inventory for concentration
        patterns.
      duration_estimate: "45 min"

      questions:
        - "What vendors provide critical services?"
        - "Are there single-source dependencies?"
        - "What is the spend distribution?"

      expected_findings:
        - "Vendor concentration"
        - "Single-source identification"

    - id: "2"
      name: "Fourth-Party Concentration"
      description: |
        Assess concentration in fourth-party
        relationships.
      duration_estimate: "45 min"

      questions:
        - "Do vendors share fourth parties?"
        - "What upstream concentration exists?"
        - "Are critical dependencies shared?"

      expected_findings:
        - "Fourth-party concentration"
        - "Hidden dependencies"

    - id: "3"
      name: "Technology Concentration"
      description: |
        Evaluate technology and platform
        concentration.
      duration_estimate: "45 min"

      questions:
        - "What platform concentrations exist?"
        - "Are there technology single points of failure?"
        - "What cloud concentration exists?"

      expected_findings:
        - "Technology concentration"
        - "Platform dependencies"

    - id: "4"
      name: "Geographic Analysis"
      description: |
        Assess geographic concentration and
        regional risks.
      duration_estimate: "30 min"

      expected_findings:
        - "Geographic concentration"
        - "Regional risk assessment"

    - id: "5"
      name: "Exit Strategy Review"
      description: |
        Evaluate exit strategies and alternative
        provider availability.
      duration_estimate: "30 min"

      expected_findings:
        - "Exit strategy assessment"
        - "Alternative availability"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "concentration_assessment"
      format: "structured"
      sections:
        - "Vendor Concentration"
        - "Fourth-Party Analysis"
        - "Technology Assessment"
        - "Geographic Analysis"
        - "Exit Strategy Review"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Key Findings"
        - "Recommendations"

  confidence_guidance:
    high: "Full concentration analysis with supply chain mapping"
    medium: "Direct vendor concentration analysis"
    low: "High-level concentration review"

offline:
  capability: "full"

  cache_manifest:
    knowledge:
      - source_id: "nist-scrm"
        priority: "required"

profiles:
  membership:
    quick:
      included: false
      reason: "Requires detailed concentration assessment"
    full:
      included: true
      priority: 1

closeout_checklist:
  - id: "cr-001"
    item: "Vendor concentration analyzed"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Confirm direct vendor concentration assessed"
    expected: "Confirmed by reviewer"

  - id: "cr-002"
    item: "Fourth-party concentration assessed"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Verify fourth-party analysis complete"
    expected: "Confirmed by reviewer"

  - id: "cr-003"
    item: "Exit strategies reviewed"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Confirm exit strategy assessment complete"
    expected: "Confirmed by reviewer"

  - id: "cr-004"
    item: "Recommendations documented"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Verify improvement recommendations provided"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["all"]

  compliance_frameworks:
    - framework: "NIST CSF"
      controls: ["ID.SC-1", "ID.BE-4"]
    - framework: "ISO 27001"
      controls: ["A.15.1.1"]
    - framework: "SOC 2"
      controls: ["CC9.2", "A1.2"]

relationships:
  commonly_combined:
    - "vendor-third-party.fourth-party-risk.fourth-party-mapping"
    - "vendor-third-party.fourth-party-risk.cascading-risk-assessment"
    - "vendor-third-party.contract-management.termination-clauses"
