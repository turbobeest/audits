# ============================================================
# AUDIT: Vendor Certification Verification Audit
# ============================================================
# Evaluates the verification of vendor certifications, attestations,
# and compliance credentials.

audit:
  id: "vendor-third-party.vendor-due-diligence.vendor-certification-verification"

  name: "Vendor Certification Verification Audit"

  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "vendor-third-party"
  category_number: 20
  subcategory: "vendor-due-diligence"

  tier: "expert"
  estimated_duration: "3-5 hours"  # median: 4h

  completeness: "requires_discovery"
  requires_runtime: false
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "organizational"

  default_profiles:
    - "full"
    - "security"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Comprehensive evaluation of vendor certification verification processes
    including certification authenticity validation, scope verification,
    expiration tracking, and ongoing monitoring. Reviews whether claimed
    certifications (ISO 27001, SOC 2, PCI DSS, etc.) are valid, current,
    and applicable to services provided.

  why_it_matters: |
    Vendors may claim certifications they do not possess, certifications
    with expired validity, or certifications that do not cover the specific
    services being provided. Relying on unverified certifications creates
    false assurance about vendor security posture. Proper verification
    ensures certifications provide intended assurance.

  when_to_run:
    - "During vendor onboarding"
    - "Annual certification reviews"
    - "Before contract renewals"
    - "When certification requirements change"
    - "After vendor claims new certifications"

prerequisites:
  required_artifacts:
    - type: "certification_requirements"
      description: "Required vendor certifications by tier"
    - type: "verification_procedures"
      description: "Certification verification procedures"
    - type: "certification_records"
      description: "Vendor certification documentation"

  access_requirements:
    - "Vendor certification requirements"
    - "Verification procedures"
    - "Vendor certificates and audit reports"
    - "Certification body registries"
    - "Vendor management team"

discovery:
  file_patterns:
    - glob: "**/certification*/**"
      purpose: "Find certification documentation"
    - glob: "**/iso*27001*/**"
      purpose: "Locate ISO certifications"
    - glob: "**/soc*report*/**"
      purpose: "Find SOC reports"

  documents_to_review:
    - type: "Certification Requirements"
      purpose: "Understand required certifications"
    - type: "Vendor Certificates"
      purpose: "Review certification validity"
    - type: "Verification Records"
      purpose: "Assess verification process"

  interviews:
    - role: "Vendor Management Team"
      questions:
        - "How are certifications verified?"
        - "What certifications are required?"
        - "How is expiration tracked?"
      purpose: "Understand verification process"
    - role: "Security/Compliance Team"
      questions:
        - "How do you verify SOC report scope?"
        - "How are certification bodies validated?"
        - "What happens when certifications expire?"
      purpose: "Assess verification rigor"

knowledge_sources:
  specifications:
    - id: "iso-certification"
      name: "ISO Certification Process"
      url: "https://www.iso.org/certification.html"
      offline_cache: true
      priority: "required"
    - id: "soc-reporting"
      name: "AICPA SOC Reporting"
      url: "https://www.aicpa.org/"
      offline_cache: true
      priority: "required"

  guides:
    - id: "certification-verification-guide"
      name: "Vendor Certification Verification Best Practices"
      url: "https://sharedassessments.org/"
      offline_cache: true

tooling:
  assessment_tools:
    - tool: "Certification body registries"
      purpose: "Verify certification authenticity"
    - tool: "Certificate tracking system"
      purpose: "Track expiration dates"

signals:
  critical:
    - id: "VCV-CRIT-001"
      signal: "Vendor certifications not verified"
      evidence_indicators:
        - "Certificates accepted without validation"
        - "No verification against issuer records"
        - "Self-attestations accepted as proof"
      explanation: |
        Unverified certifications may be fraudulent, expired, or inapplicable,
        providing false assurance about vendor security.
      remediation: "Implement certification verification process"

    - id: "VCV-CRIT-002"
      signal: "Critical vendor operating with expired certification"
      evidence_indicators:
        - "ISO 27001 or SOC 2 expired"
        - "No renewal in progress"
        - "Continued reliance on expired certification"
      explanation: |
        Expired certifications no longer provide assurance and may indicate
        vendor no longer meets certification requirements.
      remediation: "Require renewal or conduct alternative assessment"

    - id: "VCV-CRIT-003"
      signal: "Certification scope does not cover services used"
      evidence_indicators:
        - "Certificate lists different services"
        - "Geographic scope mismatch"
        - "Services explicitly excluded"
      explanation: |
        Certifications that do not cover the specific services being used
        provide no assurance for those services.
      remediation: "Verify certification scope matches services"

  high:
    - id: "VCV-HIGH-001"
      signal: "No certification expiration tracking"
      explanation: "Expirations may go unnoticed"
      remediation: "Implement certification expiration tracking"

    - id: "VCV-HIGH-002"
      signal: "Certification body not validated"
      explanation: "May be fraudulent or unaccredited certifier"
      remediation: "Verify certification body accreditation"

    - id: "VCV-HIGH-003"
      signal: "SOC report exceptions not reviewed"
      explanation: "Exceptions may indicate control failures"
      remediation: "Review and assess SOC report exceptions"

  medium:
    - id: "VCV-MED-001"
      signal: "Certification records not centralized"
      remediation: "Centralize certification documentation"

    - id: "VCV-MED-002"
      signal: "No certification requirements by vendor tier"
      remediation: "Define certification requirements by risk tier"

    - id: "VCV-MED-003"
      signal: "Bridge letters not obtained for SOC reports"
      remediation: "Obtain bridge letters for SOC report gaps"

  low:
    - id: "VCV-LOW-001"
      signal: "Certification metrics not tracked"
      remediation: "Track certification compliance rates"

  positive:
    - id: "VCV-POS-001"
      signal: "All certifications verified against issuer"
    - id: "VCV-POS-002"
      signal: "Automated expiration tracking and alerts"
    - id: "VCV-POS-003"
      signal: "Comprehensive SOC report review process"

procedure:
  context:
    cognitive_mode: "evaluative"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Review certification requirements"
      description: |
        Evaluate certification requirements for vendors including
        required certifications by risk tier.
      duration_estimate: "30 min"
      questions:
        - "What certifications are required?"
        - "Are requirements tiered by risk?"
        - "Are requirements documented?"
      expected_findings:
        - "Requirements assessment"
        - "Coverage evaluation"

    - id: "2"
      name: "Assess verification procedures"
      description: |
        Review certification verification procedures including
        authenticity validation and scope verification.
      duration_estimate: "45 min"
      questions:
        - "How is authenticity verified?"
        - "How is scope validated?"
        - "Who performs verification?"
      expected_findings:
        - "Procedure effectiveness"
        - "Verification rigor"

    - id: "3"
      name: "Sample certification records"
      description: |
        Review sample vendor certifications for validity,
        currency, and scope applicability.
      duration_estimate: "60 min"
      expected_findings:
        - "Certification validity"
        - "Scope appropriateness"

    - id: "4"
      name: "Review expiration management"
      description: |
        Evaluate tracking and management of certification
        expirations.
      duration_estimate: "30 min"
      expected_findings:
        - "Tracking effectiveness"
        - "Renewal process"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "certification_assessment"
      format: "structured"
      sections:
        - "Requirements Review"
        - "Verification Assessment"
        - "Sample Analysis"
        - "Expiration Management Review"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Key Findings"
        - "Recommendations"

  confidence_guidance:
    high: "Full verification with issuer confirmation"
    medium: "Document review with sample verification"
    low: "Documentation review only"

offline:
  capability: "partial"

  cache_manifest:
    knowledge:
      - source_id: "iso-certification"
        priority: "required"

profiles:
  membership:
    quick:
      included: false
      reason: "Requires comprehensive certification review"
    full:
      included: true
      priority: 1

closeout_checklist:
  - id: "vcv-001"
    item: "Certification verification process documented"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Verification procedures exist"
    expected: "Confirmed by reviewer"

  - id: "vcv-002"
    item: "Certifications verified against issuer"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Authenticity confirmed"
    expected: "Confirmed by reviewer"

  - id: "vcv-003"
    item: "Certification scope validated"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Scope covers services used"
    expected: "Confirmed by reviewer"

  - id: "vcv-004"
    item: "Expiration tracking operational"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Expirations monitored"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["all"]

  compliance_frameworks:
    - framework: "NIST CSF"
      controls: ["ID.SC-4"]
    - framework: "ISO 27001"
      controls: ["A.15.2.1", "A.15.2.2"]
    - framework: "SOC 2"
      controls: ["CC9.2"]

relationships:
  commonly_combined:
    - "vendor-third-party.third-party-security.third-party-compliance-verification"
    - "vendor-third-party.vendor-risk-assessment.vendor-security-questionnaire"
    - "vendor-third-party.vendor-due-diligence.vendor-capability-assessment"
