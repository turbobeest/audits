# ============================================================
# AUDIT: Vendor Legal Compliance Audit
# ============================================================
# Evaluates vendor compliance with applicable laws, regulations,
# and contractual legal requirements.

audit:
  id: "vendor-third-party.vendor-due-diligence.vendor-legal-compliance"

  name: "Vendor Legal Compliance Audit"

  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "vendor-third-party"
  category_number: 20
  subcategory: "vendor-due-diligence"

  tier: "expert"
  estimated_duration: "4-6 hours"  # median: 5h

  completeness: "requires_discovery"
  requires_runtime: false
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "organizational"

  default_profiles:
    - "full"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Comprehensive evaluation of vendor legal compliance including regulatory
    compliance verification, contractual obligation adherence, litigation
    history review, regulatory enforcement history, and compliance attestation
    validation. Reviews whether vendors meet applicable legal and regulatory
    requirements.

  why_it_matters: |
    Vendor legal violations can create organizational liability, regulatory
    exposure, and reputational damage. Organizations may be held responsible
    for vendor non-compliance with labor laws, data protection regulations,
    or industry requirements. Proper legal compliance verification protects
    against vicarious liability and regulatory penalties.

  when_to_run:
    - "During vendor onboarding"
    - "Annual compliance reviews"
    - "Before contract renewals"
    - "After regulatory changes"
    - "When compliance concerns arise"

prerequisites:
  required_artifacts:
    - type: "legal_compliance_requirements"
      description: "Vendor legal compliance requirements"
    - type: "compliance_attestations"
      description: "Vendor compliance attestations"
    - type: "verification_records"
      description: "Compliance verification documentation"

  access_requirements:
    - "Vendor legal compliance requirements"
    - "Compliance attestations and certifications"
    - "Regulatory databases"
    - "Legal team"
    - "Vendor management team"

discovery:
  file_patterns:
    - glob: "**/legal*compliance*/**"
      purpose: "Find legal compliance documentation"
    - glob: "**/regulatory*/**"
      purpose: "Locate regulatory materials"
    - glob: "**/vendor*contract*/**"
      purpose: "Find contract compliance provisions"

  documents_to_review:
    - type: "Legal Compliance Requirements"
      purpose: "Understand compliance expectations"
    - type: "Vendor Compliance Attestations"
      purpose: "Review compliance claims"
    - type: "Vendor Contracts"
      purpose: "Assess contractual compliance terms"

  interviews:
    - role: "Legal Team"
      questions:
        - "What legal requirements apply to vendors?"
        - "How is compliance verified?"
        - "How are violations handled?"
      purpose: "Understand compliance requirements"
    - role: "Vendor Manager"
      questions:
        - "How do vendors attest to compliance?"
        - "What evidence is collected?"
        - "Have compliance issues occurred?"
      purpose: "Assess verification practices"

knowledge_sources:
  specifications:
    - id: "fcpa"
      name: "Foreign Corrupt Practices Act"
      url: "https://www.justice.gov/criminal-fraud/foreign-corrupt-practices-act"
      offline_cache: true
      priority: "required"
    - id: "uk-bribery"
      name: "UK Bribery Act"
      url: "https://www.legislation.gov.uk/"
      offline_cache: true
      priority: "recommended"

  guides:
    - id: "vendor-compliance-guide"
      name: "Vendor Legal Compliance Best Practices"
      url: "https://www.acc.com/"
      offline_cache: true

tooling:
  assessment_tools:
    - tool: "Regulatory database searches"
      purpose: "Check enforcement actions"
    - tool: "Litigation database searches"
      purpose: "Review legal history"

signals:
  critical:
    - id: "VLC-CRIT-001"
      signal: "Vendor under active regulatory enforcement"
      evidence_indicators:
        - "Active government investigation"
        - "Pending regulatory enforcement action"
        - "Consent decree in effect"
      explanation: |
        Active enforcement indicates significant compliance failures
        and creates ongoing legal exposure for the organization.
      remediation: "Assess impact and consider relationship termination"

    - id: "VLC-CRIT-002"
      signal: "Vendor violating applicable regulations"
      evidence_indicators:
        - "Non-compliance with data protection laws"
        - "Labor law violations"
        - "Environmental compliance failures"
      explanation: |
        Vendor regulatory violations may create vicarious liability
        and regulatory scrutiny for the organization.
      remediation: "Require remediation or terminate relationship"

    - id: "VLC-CRIT-003"
      signal: "No legal compliance verification performed"
      evidence_indicators:
        - "Vendors engaged without compliance review"
        - "No compliance attestation required"
        - "Legal requirements not communicated"
      explanation: |
        Without compliance verification, organizations have no
        assurance of vendor legal compliance.
      remediation: "Implement legal compliance verification process"

  high:
    - id: "VLC-HIGH-001"
      signal: "Vendor has significant litigation history"
      explanation: "Litigation patterns may indicate compliance issues"
      remediation: "Assess litigation nature and implications"

    - id: "VLC-HIGH-002"
      signal: "Compliance attestations not verified"
      explanation: "Attestations may be inaccurate"
      remediation: "Implement attestation verification"

    - id: "VLC-HIGH-003"
      signal: "Anti-corruption compliance not addressed"
      explanation: "FCPA/bribery act exposure"
      remediation: "Require anti-corruption compliance attestation"

  medium:
    - id: "VLC-MED-001"
      signal: "Compliance requirements not in contracts"
      remediation: "Add compliance requirements to contracts"

    - id: "VLC-MED-002"
      signal: "No ongoing compliance monitoring"
      remediation: "Implement periodic compliance reviews"

    - id: "VLC-MED-003"
      signal: "Labor practice compliance not verified"
      remediation: "Verify labor law compliance"

  low:
    - id: "VLC-LOW-001"
      signal: "Compliance verification not documented"
      remediation: "Document all compliance verifications"

  positive:
    - id: "VLC-POS-001"
      signal: "Comprehensive legal compliance verification"
    - id: "VLC-POS-002"
      signal: "Regular compliance monitoring and attestation"
    - id: "VLC-POS-003"
      signal: "Anti-corruption program verification"

procedure:
  context:
    cognitive_mode: "evaluative"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Review compliance requirements"
      description: |
        Evaluate legal compliance requirements for vendors including
        regulatory and contractual requirements.
      duration_estimate: "45 min"
      questions:
        - "What legal requirements apply?"
        - "Are requirements documented?"
        - "Are requirements in contracts?"
      expected_findings:
        - "Requirements assessment"
        - "Coverage evaluation"

    - id: "2"
      name: "Assess verification procedures"
      description: |
        Review compliance verification procedures including
        attestation collection and validation.
      duration_estimate: "60 min"
      questions:
        - "How is compliance verified?"
        - "What attestations are required?"
        - "How are attestations validated?"
      expected_findings:
        - "Verification effectiveness"
        - "Process completeness"

    - id: "3"
      name: "Review enforcement and litigation"
      description: |
        Check for regulatory enforcement actions and significant
        litigation involving vendors.
      duration_estimate: "60 min"
      expected_findings:
        - "Enforcement history"
        - "Litigation concerns"

    - id: "4"
      name: "Sample compliance records"
      description: |
        Review sample vendor compliance records and attestations.
      duration_estimate: "45 min"
      expected_findings:
        - "Documentation quality"
        - "Compliance status"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "legal_compliance_assessment"
      format: "structured"
      sections:
        - "Requirements Review"
        - "Verification Assessment"
        - "Enforcement/Litigation Review"
        - "Sample Analysis"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Key Findings"
        - "Recommendations"

  confidence_guidance:
    high: "Full verification with regulatory database checks"
    medium: "Attestation review with sample verification"
    low: "Documentation review only"

offline:
  capability: "partial"

  cache_manifest:
    knowledge:
      - source_id: "fcpa"
        priority: "required"

profiles:
  membership:
    quick:
      included: false
      reason: "Requires comprehensive legal compliance review"
    full:
      included: true
      priority: 1

closeout_checklist:
  - id: "vlc-001"
    item: "Legal compliance requirements documented"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Requirements exist and communicated"
    expected: "Confirmed by reviewer"

  - id: "vlc-002"
    item: "Compliance verification performed"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Verification process operational"
    expected: "Confirmed by reviewer"

  - id: "vlc-003"
    item: "No active enforcement against critical vendors"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Enforcement history checked"
    expected: "Confirmed by reviewer"

  - id: "vlc-004"
    item: "Compliance requirements in contracts"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Contractual provisions documented"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["all"]

  compliance_frameworks:
    - framework: "NIST CSF"
      controls: ["ID.SC-2"]
    - framework: "FCPA"
      controls: ["Anti-corruption requirements"]
    - framework: "ISO 27001"
      controls: ["A.15.1.1"]
    - framework: "SOC 2"
      controls: ["CC9.2"]

relationships:
  commonly_combined:
    - "vendor-third-party.vendor-due-diligence.vendor-background-check"
    - "vendor-third-party.third-party-security.third-party-compliance-verification"
    - "compliance-legal.legal-licensing.export-control"
