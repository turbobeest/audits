# ============================================================
# AUDIT: Vendor Insurance Verification Audit
# ============================================================
# Evaluates the verification of vendor insurance coverage
# and adequacy assessment.

audit:
  id: "vendor-third-party.vendor-due-diligence.vendor-insurance-verification"

  name: "Vendor Insurance Verification Audit"

  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "vendor-third-party"
  category_number: 20
  subcategory: "vendor-due-diligence"

  tier: "expert"
  estimated_duration: "3-4 hours"  # median: 3h

  completeness: "requires_discovery"
  requires_runtime: false
  destructive: false

execution:
  automatable: "partial"
  severity: "medium"
  scope: "organizational"

  default_profiles:
    - "full"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Comprehensive evaluation of vendor insurance verification processes
    including coverage requirements, certificate of insurance validation,
    policy adequacy assessment, and ongoing monitoring. Reviews whether
    vendor insurance appropriately transfers risk and provides adequate
    protection.

  why_it_matters: |
    Vendor insurance provides financial protection against vendor-caused
    incidents including data breaches, service failures, and negligence.
    Without proper verification, insurance coverage may be inadequate,
    expired, or fraudulent. Proper insurance verification ensures risk
    transfer mechanisms are in place and functional.

  when_to_run:
    - "During vendor onboarding"
    - "Annual insurance reviews"
    - "Before contract renewals"
    - "After vendor security incidents"
    - "When risk requirements change"

prerequisites:
  required_artifacts:
    - type: "insurance_requirements"
      description: "Vendor insurance requirements"
    - type: "verification_procedures"
      description: "Insurance verification procedures"
    - type: "coi_records"
      description: "Certificates of insurance on file"

  access_requirements:
    - "Vendor insurance requirements"
    - "Certificates of insurance"
    - "Insurance verification procedures"
    - "Vendor management team"
    - "Legal/Risk management team"

discovery:
  file_patterns:
    - glob: "**/insurance*/**"
      purpose: "Find insurance documentation"
    - glob: "**/coi*/**"
      purpose: "Locate certificates of insurance"
    - glob: "**/vendor*contract*/**"
      purpose: "Find contract insurance provisions"

  documents_to_review:
    - type: "Insurance Requirements Policy"
      purpose: "Understand coverage requirements"
    - type: "Certificates of Insurance"
      purpose: "Review coverage documentation"
    - type: "Contract Insurance Provisions"
      purpose: "Assess contractual requirements"

  interviews:
    - role: "Vendor Management Team"
      questions:
        - "What insurance is required from vendors?"
        - "How are COIs verified?"
        - "How is expiration tracked?"
      purpose: "Understand verification process"
    - role: "Legal/Risk Team"
      questions:
        - "How are coverage limits determined?"
        - "What coverage types are required?"
        - "How are insurance claims handled?"
      purpose: "Assess requirements adequacy"

knowledge_sources:
  guides:
    - id: "insurance-verification-guide"
      name: "Vendor Insurance Verification Best Practices"
      url: "https://www.irmi.com/"
      offline_cache: true
    - id: "cyber-insurance-guide"
      name: "Cyber Insurance Requirements Guide"
      url: "https://www.marsh.com/"
      offline_cache: true

tooling:
  assessment_tools:
    - tool: "COI tracking system"
      purpose: "Track insurance certificates and expirations"
    - tool: "Insurance verification checklist"
      purpose: "Validate coverage adequacy"

signals:
  critical:
    - id: "VIV-CRIT-001"
      signal: "Critical vendors without required insurance"
      evidence_indicators:
        - "No insurance certificates on file"
        - "Required coverage not obtained"
        - "Vendors operating without coverage"
      explanation: |
        Vendors without required insurance leave organization exposed
        to financial loss from vendor-caused incidents.
      remediation: "Require and verify insurance before engagement"

    - id: "VIV-CRIT-002"
      signal: "Vendor insurance expired and not renewed"
      evidence_indicators:
        - "COI expiration dates passed"
        - "No renewal certificates obtained"
        - "Coverage lapsed without notice"
      explanation: |
        Expired insurance provides no coverage. Organization assumes
        full risk during lapse period.
      remediation: "Track expirations and require renewal certificates"

  high:
    - id: "VIV-HIGH-001"
      signal: "Insurance certificates not verified"
      explanation: "COIs may be fraudulent or inaccurate"
      remediation: "Verify COIs with insurance providers"

    - id: "VIV-HIGH-002"
      signal: "Coverage limits inadequate for risk"
      explanation: "Low limits may not cover potential losses"
      remediation: "Assess and require adequate coverage limits"

    - id: "VIV-HIGH-003"
      signal: "Cyber insurance not required for data vendors"
      explanation: "Data breaches may not be covered"
      remediation: "Require cyber insurance for data-handling vendors"

  medium:
    - id: "VIV-MED-001"
      signal: "Organization not named as additional insured"
      remediation: "Require additional insured endorsement"

    - id: "VIV-MED-002"
      signal: "Insurance requirements not tiered by risk"
      remediation: "Define requirements by vendor risk tier"

    - id: "VIV-MED-003"
      signal: "No notification of cancellation requirement"
      remediation: "Require cancellation notification clause"

  low:
    - id: "VIV-LOW-001"
      signal: "Insurance tracking not centralized"
      remediation: "Centralize COI tracking and management"

  positive:
    - id: "VIV-POS-001"
      signal: "All required insurance verified and current"
    - id: "VIV-POS-002"
      signal: "Automated COI tracking with expiration alerts"
    - id: "VIV-POS-003"
      signal: "Risk-based insurance requirements"

procedure:
  context:
    cognitive_mode: "evaluative"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Review insurance requirements"
      description: |
        Evaluate insurance requirements for vendors including
        coverage types, limits, and tiering.
      duration_estimate: "30 min"
      questions:
        - "What coverage is required?"
        - "What limits are specified?"
        - "Are requirements tiered by risk?"
      expected_findings:
        - "Requirements assessment"
        - "Coverage adequacy"

    - id: "2"
      name: "Assess verification procedures"
      description: |
        Review COI verification procedures including authenticity
        validation and coverage confirmation.
      duration_estimate: "45 min"
      questions:
        - "How are COIs verified?"
        - "Is coverage confirmed with insurers?"
        - "How are additional insured requirements verified?"
      expected_findings:
        - "Verification effectiveness"
        - "Process completeness"

    - id: "3"
      name: "Sample insurance records"
      description: |
        Review sample COIs for validity, coverage adequacy,
        and compliance with requirements.
      duration_estimate: "45 min"
      expected_findings:
        - "Coverage compliance"
        - "Documentation quality"

    - id: "4"
      name: "Review expiration management"
      description: |
        Evaluate tracking and management of insurance expirations.
      duration_estimate: "30 min"
      expected_findings:
        - "Tracking effectiveness"
        - "Renewal process"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "insurance_assessment"
      format: "structured"
      sections:
        - "Requirements Review"
        - "Verification Assessment"
        - "Sample Analysis"
        - "Expiration Management Review"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Key Findings"
        - "Recommendations"

  confidence_guidance:
    high: "Full verification with insurer confirmation"
    medium: "COI review with sample verification"
    low: "Documentation review only"

offline:
  capability: "full"

  cache_manifest:
    knowledge:
      - source_id: "insurance-verification-guide"
        priority: "recommended"

profiles:
  membership:
    quick:
      included: false
      reason: "Requires comprehensive insurance review"
    full:
      included: true
      priority: 2

closeout_checklist:
  - id: "viv-001"
    item: "Insurance requirements documented"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Requirements exist by vendor tier"
    expected: "Confirmed by reviewer"

  - id: "viv-002"
    item: "COIs on file for required vendors"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Certificates obtained and filed"
    expected: "Confirmed by reviewer"

  - id: "viv-003"
    item: "Insurance coverage verified"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Coverage confirmed as adequate"
    expected: "Confirmed by reviewer"

  - id: "viv-004"
    item: "Expiration tracking operational"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Expirations monitored"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["all"]

  compliance_frameworks:
    - framework: "NIST CSF"
      controls: ["ID.SC-2"]
    - framework: "ISO 27001"
      controls: ["A.15.1.3"]
    - framework: "SOC 2"
      controls: ["CC9.2"]

relationships:
  commonly_combined:
    - "vendor-third-party.vendor-due-diligence.vendor-background-check"
    - "vendor-third-party.vendor-risk-assessment.vendor-financial-stability"
    - "vendor-third-party.vendor-due-diligence.vendor-legal-compliance"
