# ============================================================
# AUDIT: Third-Party Compliance Verification Audit
# ============================================================
# Evaluates processes for verifying third-party compliance with
# security and regulatory requirements.

audit:
  id: "vendor-third-party.third-party-security.third-party-compliance-verification"

  name: "Third-Party Compliance Verification Audit"

  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "vendor-third-party"
  category_number: 20
  subcategory: "third-party-security"

  tier: "expert"
  estimated_duration: "5-7 hours"  # median: 6h

  completeness: "requires_discovery"
  requires_runtime: false
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "organizational"

  default_profiles:
    - "full"
    - "security"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Comprehensive evaluation of third-party compliance verification processes
    including certification validation, audit report review, compliance evidence
    collection, ongoing monitoring, and exception management. Reviews whether
    vendor compliance claims are adequately verified and maintained.

  why_it_matters: |
    Organizations often rely on vendor compliance certifications without
    verification, creating false assurance. Unverified compliance claims may
    be outdated, inapplicable, or fraudulent. Proper verification ensures
    vendors actually meet security and regulatory requirements, supporting
    organizational compliance obligations.

  when_to_run:
    - "During vendor onboarding"
    - "Annual compliance verification reviews"
    - "Before contract renewals"
    - "When compliance requirements change"
    - "During regulatory audits"

prerequisites:
  required_artifacts:
    - type: "compliance_requirements"
      description: "Vendor compliance requirements"
    - type: "compliance_evidence"
      description: "Vendor compliance documentation"
    - type: "verification_procedures"
      description: "Compliance verification procedures"

  access_requirements:
    - "Vendor compliance requirements documentation"
    - "Vendor certifications and audit reports"
    - "Compliance verification procedures"
    - "Vendor management team"
    - "Compliance team"

discovery:
  file_patterns:
    - glob: "**/vendor*compliance*/**"
      purpose: "Find vendor compliance materials"
    - glob: "**/certification*/**"
      purpose: "Locate certification documentation"
    - glob: "**/audit*report*/**"
      purpose: "Find audit reports"

  documents_to_review:
    - type: "Vendor Compliance Requirements"
      purpose: "Understand compliance expectations"
    - type: "Vendor Certifications"
      purpose: "Review certification scope and currency"
    - type: "SOC Reports"
      purpose: "Analyze control attestations"

  interviews:
    - role: "Compliance Team"
      questions:
        - "How are vendor compliance claims verified?"
        - "What evidence is required?"
        - "How are exceptions managed?"
      purpose: "Understand verification process"
    - role: "Vendor Manager"
      questions:
        - "Which vendors have compliance requirements?"
        - "How is compliance tracked?"
        - "What happens with non-compliant vendors?"
      purpose: "Assess enforcement"

knowledge_sources:
  specifications:
    - id: "soc2-requirements"
      name: "SOC 2 Trust Service Criteria"
      url: "https://www.aicpa.org/"
      offline_cache: true
      priority: "required"
    - id: "iso27001-cert"
      name: "ISO 27001 Certification Requirements"
      url: "https://www.iso.org/standard/27001"
      offline_cache: true
      priority: "required"

  guides:
    - id: "vendor-compliance-guide"
      name: "Third-Party Compliance Verification Guide"
      url: "https://sharedassessments.org/"
      offline_cache: true

tooling:
  assessment_tools:
    - tool: "Certification validation checklist"
      purpose: "Verify certification authenticity and scope"
    - tool: "SOC report analysis framework"
      purpose: "Evaluate control attestations"

signals:
  critical:
    - id: "TPCV-CRIT-001"
      signal: "Vendor compliance claims not verified"
      evidence_indicators:
        - "Certifications accepted without validation"
        - "No evidence of verification process"
        - "Compliance claims taken at face value"
      explanation: |
        Unverified compliance claims provide false assurance. Vendors may
        claim certifications they do not have or that do not cover relevant
        services.
      remediation: "Implement compliance verification process"

    - id: "TPCV-CRIT-002"
      signal: "Critical vendor missing required certifications"
      evidence_indicators:
        - "Vendors lack required certifications"
        - "Certification scope does not cover services used"
        - "Certifications expired"
      explanation: |
        Missing certifications indicate potential control gaps and may
        violate contractual or regulatory requirements.
      remediation: "Require and verify necessary certifications"

  high:
    - id: "TPCV-HIGH-001"
      signal: "SOC reports not reviewed for exceptions"
      explanation: "Exceptions may indicate control failures"
      remediation: "Implement SOC report review process"

    - id: "TPCV-HIGH-002"
      signal: "Certification expiration not tracked"
      explanation: "Expired certifications no longer provide assurance"
      remediation: "Implement certification tracking and renewal alerts"

    - id: "TPCV-HIGH-003"
      signal: "Compliance requirements not documented"
      explanation: "Cannot verify undefined requirements"
      remediation: "Document compliance requirements by vendor tier"

  medium:
    - id: "TPCV-MED-001"
      signal: "Certification scope not validated"
      remediation: "Verify certification scope matches services"

    - id: "TPCV-MED-002"
      signal: "Compliance evidence not centralized"
      remediation: "Centralize compliance documentation"

    - id: "TPCV-MED-003"
      signal: "Exception management process undefined"
      remediation: "Define process for compliance exceptions"

  low:
    - id: "TPCV-LOW-001"
      signal: "Compliance metrics not tracked"
      remediation: "Implement compliance tracking metrics"

  positive:
    - id: "TPCV-POS-001"
      signal: "Comprehensive compliance verification process"
    - id: "TPCV-POS-002"
      signal: "Automated certification tracking and alerts"
    - id: "TPCV-POS-003"
      signal: "Regular SOC report reviews with exception follow-up"

procedure:
  context:
    cognitive_mode: "evaluative"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Review compliance requirements"
      description: |
        Evaluate documented compliance requirements for vendors
        including certification and audit requirements by tier.
      duration_estimate: "45 min"
      questions:
        - "Are compliance requirements documented?"
        - "Are requirements tiered by risk?"
        - "What certifications are required?"
      expected_findings:
        - "Requirements assessment"
        - "Tier alignment"

    - id: "2"
      name: "Assess verification process"
      description: |
        Review compliance verification procedures including
        evidence collection and validation methods.
      duration_estimate: "60 min"
      questions:
        - "How are certifications verified?"
        - "What evidence is collected?"
        - "Who performs verification?"
      expected_findings:
        - "Process effectiveness"
        - "Verification rigor"

    - id: "3"
      name: "Sample compliance evidence"
      description: |
        Sample vendor compliance evidence for accuracy and
        completeness.
      duration_estimate: "90 min"
      expected_findings:
        - "Evidence quality"
        - "Verification accuracy"

    - id: "4"
      name: "Review exception management"
      description: |
        Evaluate how compliance exceptions and gaps are managed.
      duration_estimate: "45 min"
      expected_findings:
        - "Exception handling"
        - "Risk acceptance process"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "compliance_verification_assessment"
      format: "structured"
      sections:
        - "Requirements Review"
        - "Verification Process Assessment"
        - "Evidence Sampling Results"
        - "Exception Management Review"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Key Findings"
        - "Recommendations"

  confidence_guidance:
    high: "Full process review with evidence sampling"
    medium: "Process review with limited sampling"
    low: "Documentation review only"

offline:
  capability: "full"

  cache_manifest:
    knowledge:
      - source_id: "soc2-requirements"
        priority: "required"

profiles:
  membership:
    quick:
      included: false
      reason: "Requires comprehensive compliance verification review"
    full:
      included: true
      priority: 1

closeout_checklist:
  - id: "tpcv-001"
    item: "Compliance requirements documented by vendor tier"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Requirements defined and communicated"
    expected: "Confirmed by reviewer"

  - id: "tpcv-002"
    item: "Compliance verification process operational"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Verification procedures followed"
    expected: "Confirmed by reviewer"

  - id: "tpcv-003"
    item: "Vendor certifications verified and current"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Certifications validated and in scope"
    expected: "Confirmed by reviewer"

  - id: "tpcv-004"
    item: "Exception management process defined"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Exceptions tracked and managed"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["all"]

  compliance_frameworks:
    - framework: "NIST CSF"
      controls: ["ID.SC-4"]
    - framework: "ISO 27001"
      controls: ["A.15.2.1", "A.15.2.2"]
    - framework: "SOC 2"
      controls: ["CC9.2"]

relationships:
  commonly_combined:
    - "vendor-third-party.vendor-due-diligence.vendor-certification-verification"
    - "vendor-third-party.vendor-risk-assessment.vendor-security-questionnaire"
    - "compliance-legal.industry-standards.soc2-compliance"
