# ============================================================
# AUDIT: Third-Party Incident Response Audit
# ============================================================
# Evaluates incident response coordination with third parties
# including notification requirements and response procedures.

audit:
  id: "vendor-third-party.third-party-security.third-party-incident-response"

  name: "Third-Party Incident Response Audit"

  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "vendor-third-party"
  category_number: 20
  subcategory: "third-party-security"

  tier: "expert"
  estimated_duration: "4-6 hours"  # median: 5h

  completeness: "requires_discovery"
  requires_runtime: false
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "organizational"

  default_profiles:
    - "full"
    - "security"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Comprehensive evaluation of third-party incident response capabilities
    including notification requirements, communication channels, coordination
    procedures, escalation paths, and post-incident reviews. Reviews whether
    vendor incidents are effectively communicated and collaboratively resolved.

  why_it_matters: |
    Vendor security incidents can directly impact organizational security and
    operations. Without defined incident response coordination, organizations
    may learn of vendor breaches too late to respond effectively. Clear
    notification requirements and response procedures minimize incident impact
    and ensure regulatory notification timelines are met.

  when_to_run:
    - "During vendor onboarding for high-risk vendors"
    - "Annual incident response reviews"
    - "After vendor security incidents"
    - "When updating incident response plans"
    - "During tabletop exercises"

prerequisites:
  required_artifacts:
    - type: "incident_notification_requirements"
      description: "Vendor incident notification requirements"
    - type: "incident_response_procedures"
      description: "Third-party incident response procedures"
    - type: "contact_information"
      description: "Vendor security contact information"

  access_requirements:
    - "Vendor incident notification requirements"
    - "Third-party incident playbooks"
    - "Vendor security contacts"
    - "Incident management team"
    - "Historical incident records"

discovery:
  file_patterns:
    - glob: "**/incident*response*/**"
      purpose: "Find incident response documentation"
    - glob: "**/vendor*incident*/**"
      purpose: "Locate vendor incident materials"
    - glob: "**/breach*notification*/**"
      purpose: "Find notification requirements"

  documents_to_review:
    - type: "Vendor Incident Notification Requirements"
      purpose: "Understand notification obligations"
    - type: "Third-Party Incident Playbook"
      purpose: "Review response procedures"
    - type: "Vendor Contracts"
      purpose: "Identify contractual requirements"

  interviews:
    - role: "Incident Response Team"
      questions:
        - "How are vendor incidents communicated?"
        - "What is the vendor incident playbook?"
        - "How is vendor cooperation ensured?"
      purpose: "Understand response coordination"
    - role: "Vendor Manager"
      questions:
        - "Are incident notification requirements in contracts?"
        - "How are vendor contacts maintained?"
        - "Have vendor incidents occurred?"
      purpose: "Assess contractual coverage"

knowledge_sources:
  specifications:
    - id: "nist-ir"
      name: "NIST SP 800-61 Incident Handling Guide"
      url: "https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final"
      offline_cache: true
      priority: "required"
    - id: "gdpr-breach"
      name: "GDPR Breach Notification Requirements"
      url: "https://gdpr-info.eu/"
      offline_cache: true
      priority: "required"

  guides:
    - id: "vendor-incident-guide"
      name: "Third-Party Incident Management Guide"
      url: "https://sharedassessments.org/"
      offline_cache: true

tooling:
  assessment_tools:
    - tool: "Incident response coordination checklist"
      purpose: "Validate vendor IR requirements"
    - tool: "Notification timeline tracker"
      purpose: "Verify notification compliance"

signals:
  critical:
    - id: "TPIR-CRIT-001"
      signal: "No vendor incident notification requirements"
      evidence_indicators:
        - "Contracts lack incident notification clauses"
        - "No notification timeline defined"
        - "Vendors not obligated to report incidents"
      explanation: |
        Without notification requirements, vendors may not disclose incidents
        affecting organizational data, preventing timely response and
        regulatory compliance.
      remediation: "Implement contractual incident notification requirements"

    - id: "TPIR-CRIT-002"
      signal: "No third-party incident response procedures"
      evidence_indicators:
        - "No playbook for vendor incidents"
        - "Response ad hoc and undefined"
        - "No escalation procedures"
      explanation: |
        Without defined procedures, vendor incident response is chaotic
        and ineffective, potentially extending impact and harm.
      remediation: "Develop third-party incident response procedures"

  high:
    - id: "TPIR-HIGH-001"
      signal: "Vendor security contacts not maintained"
      explanation: "Cannot coordinate response without contacts"
      remediation: "Maintain current vendor security contacts"

    - id: "TPIR-HIGH-002"
      signal: "Notification timelines not defined"
      explanation: "Vague requirements lead to delayed notifications"
      remediation: "Specify notification timelines in contracts"

    - id: "TPIR-HIGH-003"
      signal: "No post-incident review process"
      explanation: "Lessons learned not captured"
      remediation: "Implement vendor incident post-mortems"

  medium:
    - id: "TPIR-MED-001"
      signal: "Vendor incident procedures not tested"
      remediation: "Include vendors in incident exercises"

    - id: "TPIR-MED-002"
      signal: "Communication channels not defined"
      remediation: "Establish secure communication channels"

    - id: "TPIR-MED-003"
      signal: "Vendor incident tracking not centralized"
      remediation: "Track vendor incidents in central system"

  low:
    - id: "TPIR-LOW-001"
      signal: "Vendor incident metrics not tracked"
      remediation: "Implement vendor incident metrics"

  positive:
    - id: "TPIR-POS-001"
      signal: "Comprehensive vendor incident notification requirements"
    - id: "TPIR-POS-002"
      signal: "Tested third-party incident response procedures"
    - id: "TPIR-POS-003"
      signal: "Joint incident exercises with critical vendors"

procedure:
  context:
    cognitive_mode: "critical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Review notification requirements"
      description: |
        Evaluate vendor incident notification requirements including
        contractual clauses, timelines, and scope.
      duration_estimate: "60 min"
      questions:
        - "Are notification requirements in contracts?"
        - "What timelines are specified?"
        - "What incidents require notification?"
      expected_findings:
        - "Requirement coverage"
        - "Timeline assessment"

    - id: "2"
      name: "Assess response procedures"
      description: |
        Review third-party incident response procedures and playbooks.
      duration_estimate: "60 min"
      questions:
        - "Do playbooks exist for vendor incidents?"
        - "Are roles and responsibilities defined?"
        - "Is escalation path clear?"
      expected_findings:
        - "Procedure completeness"
        - "Coordination effectiveness"

    - id: "3"
      name: "Evaluate contact management"
      description: |
        Review vendor security contact management and maintenance.
      duration_estimate: "30 min"
      expected_findings:
        - "Contact currency"
        - "Contact accessibility"

    - id: "4"
      name: "Review incident history"
      description: |
        Analyze historical vendor incidents for response effectiveness.
      duration_estimate: "45 min"
      expected_findings:
        - "Response effectiveness"
        - "Lessons learned"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "incident_response_assessment"
      format: "structured"
      sections:
        - "Notification Requirements Review"
        - "Procedure Assessment"
        - "Contact Management Review"
        - "Incident History Analysis"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Key Findings"
        - "Recommendations"

  confidence_guidance:
    high: "Full process review with incident history analysis"
    medium: "Process review with limited historical data"
    low: "Documentation review only"

offline:
  capability: "full"

  cache_manifest:
    knowledge:
      - source_id: "nist-ir"
        priority: "required"

profiles:
  membership:
    quick:
      included: false
      reason: "Requires comprehensive incident response review"
    full:
      included: true
      priority: 1

closeout_checklist:
  - id: "tpir-001"
    item: "Incident notification requirements in vendor contracts"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Notification clauses present with timelines"
    expected: "Confirmed by reviewer"

  - id: "tpir-002"
    item: "Third-party incident response procedures documented"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Playbooks exist and are current"
    expected: "Confirmed by reviewer"

  - id: "tpir-003"
    item: "Vendor security contacts maintained"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Contacts current and accessible"
    expected: "Confirmed by reviewer"

  - id: "tpir-004"
    item: "Incident response procedures tested"
    level: "WARNING"
    verification: "manual"
    verification_notes: "Procedures validated through exercises"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["all"]

  compliance_frameworks:
    - framework: "NIST CSF"
      controls: ["RS.CO-1", "RS.CO-4", "RS.CO-5"]
    - framework: "ISO 27001"
      controls: ["A.16.1.1", "A.16.1.2"]
    - framework: "GDPR"
      controls: ["Article 33", "Article 34"]
    - framework: "SOC 2"
      controls: ["CC7.3", "CC7.4"]

relationships:
  commonly_combined:
    - "vendor-third-party.third-party-security.third-party-data-handling"
    - "incident-response.planning.incident-response-plan"
    - "compliance-legal.data-protection.data-breach-notification"
