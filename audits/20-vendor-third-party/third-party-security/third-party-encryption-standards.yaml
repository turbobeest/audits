# ============================================================
# AUDIT: Third-Party Encryption Standards Audit
# ============================================================
# Evaluates third-party encryption practices for data at rest,
# in transit, and key management.

audit:
  id: "vendor-third-party.third-party-security.third-party-encryption-standards"

  name: "Third-Party Encryption Standards Audit"

  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "vendor-third-party"
  category_number: 20
  subcategory: "third-party-security"

  tier: "expert"
  estimated_duration: "4-6 hours"  # median: 5h

  completeness: "requires_discovery"
  requires_runtime: false
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "security"

  default_profiles:
    - "full"
    - "security"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Comprehensive evaluation of third-party encryption standards including
    encryption algorithms, key lengths, encryption at rest, encryption in
    transit, key management practices, and certificate management. Reviews
    whether vendors meet organizational encryption requirements for data
    protection.

  why_it_matters: |
    Encryption is a critical control for protecting data shared with vendors.
    Weak or absent encryption exposes data to interception and theft. Third
    parties must implement encryption meeting organizational standards to
    maintain security posture and comply with regulations requiring encryption
    of sensitive data.

  when_to_run:
    - "During vendor onboarding with data access"
    - "Annual security reviews"
    - "When encryption standards are updated"
    - "After cryptographic vulnerability disclosures"
    - "During compliance audits"

prerequisites:
  required_artifacts:
    - type: "encryption_requirements"
      description: "Vendor encryption requirements"
    - type: "encryption_evidence"
      description: "Vendor encryption attestations"
    - type: "key_management_documentation"
      description: "Key management practices documentation"

  access_requirements:
    - "Vendor encryption requirements documentation"
    - "Vendor security questionnaire responses"
    - "Encryption configuration evidence"
    - "Vendor management team"
    - "Security architecture team"

discovery:
  code_patterns:
    - pattern: "(encryption|cipher|AES|RSA|TLS).*version"
      type: "regex"
      scope: "config"
      purpose: "Find encryption configurations"
    - pattern: "(key.?management|KMS|HSM)"
      type: "regex"
      scope: "config"
      purpose: "Identify key management references"

  file_patterns:
    - glob: "**/encryption*/**"
      purpose: "Find encryption documentation"
    - glob: "**/security*requirements*/**"
      purpose: "Locate security requirements"
    - glob: "**/crypto*/**"
      purpose: "Find cryptographic standards"

  documents_to_review:
    - type: "Encryption Requirements Policy"
      purpose: "Understand encryption requirements"
    - type: "Vendor Security Assessments"
      purpose: "Review encryption attestations"
    - type: "Cryptographic Standards"
      purpose: "Compare against organizational standards"

  interviews:
    - role: "Security Architecture Team"
      questions:
        - "What encryption standards are required from vendors?"
        - "How is vendor encryption verified?"
        - "What key management requirements exist?"
      purpose: "Understand encryption requirements"
    - role: "Vendor Security Team"
      questions:
        - "How do vendors demonstrate encryption compliance?"
        - "What evidence is collected?"
        - "How are encryption gaps handled?"
      purpose: "Assess verification practices"

knowledge_sources:
  specifications:
    - id: "nist-crypto"
      name: "NIST Cryptographic Standards"
      url: "https://csrc.nist.gov/projects/cryptographic-standards-and-guidelines"
      offline_cache: true
      priority: "required"
    - id: "pci-encryption"
      name: "PCI DSS Encryption Requirements"
      url: "https://www.pcisecuritystandards.org/"
      offline_cache: true
      priority: "recommended"

  guides:
    - id: "encryption-best-practices"
      name: "Encryption Best Practices Guide"
      url: "https://www.owasp.org/"
      offline_cache: true

tooling:
  assessment_tools:
    - tool: "Encryption standards checklist"
      purpose: "Validate encryption requirements"
    - tool: "TLS configuration analyzer"
      purpose: "Verify TLS implementations"

signals:
  critical:
    - id: "TPES-CRIT-001"
      signal: "Vendor not encrypting data at rest"
      evidence_indicators:
        - "Sensitive data stored unencrypted"
        - "No encryption attestation"
        - "Database encryption disabled"
      explanation: |
        Unencrypted data at rest is vulnerable to theft through database
        compromise, backup theft, or storage media loss.
      remediation: "Require and verify encryption at rest"

    - id: "TPES-CRIT-002"
      signal: "Vendor using deprecated encryption algorithms"
      evidence_indicators:
        - "DES, 3DES, RC4, or MD5 in use"
        - "TLS 1.0/1.1 still enabled"
        - "Key lengths below minimum standards"
      explanation: |
        Deprecated algorithms are vulnerable to known attacks and do not
        provide adequate protection.
      remediation: "Require modern encryption algorithms and protocols"

    - id: "TPES-CRIT-003"
      signal: "Vendor transmitting data without encryption"
      evidence_indicators:
        - "HTTP instead of HTTPS"
        - "Unencrypted file transfers"
        - "No TLS for API connections"
      explanation: |
        Unencrypted transmission exposes data to interception and
        man-in-the-middle attacks.
      remediation: "Require TLS 1.2+ for all data transmission"

  high:
    - id: "TPES-HIGH-001"
      signal: "No encryption requirements documented for vendors"
      explanation: "Cannot enforce undefined requirements"
      remediation: "Document encryption requirements for vendors"

    - id: "TPES-HIGH-002"
      signal: "Key management practices unknown"
      explanation: "Encryption without proper key management is weakened"
      remediation: "Require key management attestations"

    - id: "TPES-HIGH-003"
      signal: "Encryption verification not performed"
      explanation: "Claims not validated provide false assurance"
      remediation: "Implement encryption verification process"

  medium:
    - id: "TPES-MED-001"
      signal: "Certificate management practices not reviewed"
      remediation: "Assess vendor certificate management"

    - id: "TPES-MED-002"
      signal: "BYOK not available for cloud vendors"
      remediation: "Evaluate BYOK requirements and options"

    - id: "TPES-MED-003"
      signal: "Encryption standards not tiered by data sensitivity"
      remediation: "Define encryption requirements by data classification"

  low:
    - id: "TPES-LOW-001"
      signal: "Encryption compliance metrics not tracked"
      remediation: "Implement encryption compliance tracking"

  positive:
    - id: "TPES-POS-001"
      signal: "Comprehensive encryption requirements with verification"
    - id: "TPES-POS-002"
      signal: "Regular encryption standards review and updates"
    - id: "TPES-POS-003"
      signal: "BYOK implemented for sensitive cloud services"

procedure:
  context:
    cognitive_mode: "critical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Review encryption requirements"
      description: |
        Evaluate documented encryption requirements for vendors
        including algorithms, protocols, and key lengths.
      duration_estimate: "45 min"
      questions:
        - "What encryption standards are required?"
        - "Are requirements documented and communicated?"
        - "Are requirements tiered by data sensitivity?"
      expected_findings:
        - "Requirements assessment"
        - "Standard alignment"

    - id: "2"
      name: "Assess encryption at rest"
      description: |
        Review vendor encryption at rest practices and evidence.
      duration_estimate: "60 min"
      questions:
        - "Is data encrypted at rest?"
        - "What algorithms and key lengths are used?"
        - "How is compliance verified?"
      expected_findings:
        - "At-rest encryption assessment"
        - "Verification effectiveness"

    - id: "3"
      name: "Evaluate encryption in transit"
      description: |
        Review vendor encryption in transit including TLS
        configurations and certificate practices.
      duration_estimate: "60 min"
      expected_findings:
        - "In-transit encryption assessment"
        - "TLS configuration review"

    - id: "4"
      name: "Review key management"
      description: |
        Assess vendor key management practices including key
        generation, storage, rotation, and destruction.
      duration_estimate: "45 min"
      expected_findings:
        - "Key management assessment"
        - "HSM/KMS usage"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "encryption_assessment"
      format: "structured"
      sections:
        - "Requirements Review"
        - "At-Rest Encryption Assessment"
        - "In-Transit Encryption Assessment"
        - "Key Management Review"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Key Findings"
        - "Recommendations"

  confidence_guidance:
    high: "Full encryption review with configuration verification"
    medium: "Attestation review with sample validation"
    low: "Documentation review only"

offline:
  capability: "full"

  cache_manifest:
    knowledge:
      - source_id: "nist-crypto"
        priority: "required"

profiles:
  membership:
    quick:
      included: false
      reason: "Requires comprehensive encryption review"
    full:
      included: true
      priority: 1

closeout_checklist:
  - id: "tpes-001"
    item: "Encryption requirements documented for vendors"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Standards defined and communicated"
    expected: "Confirmed by reviewer"

  - id: "tpes-002"
    item: "Vendor encryption at rest verified"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "At-rest encryption confirmed for sensitive data"
    expected: "Confirmed by reviewer"

  - id: "tpes-003"
    item: "Vendor encryption in transit verified"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "TLS 1.2+ confirmed for data transmission"
    expected: "Confirmed by reviewer"

  - id: "tpes-004"
    item: "Key management practices acceptable"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Key management meets requirements"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["all"]

  compliance_frameworks:
    - framework: "NIST CSF"
      controls: ["PR.DS-1", "PR.DS-2"]
    - framework: "ISO 27001"
      controls: ["A.10.1.1", "A.10.1.2"]
    - framework: "PCI DSS"
      controls: ["Requirement 3", "Requirement 4"]
    - framework: "SOC 2"
      controls: ["CC6.1", "CC6.7"]

relationships:
  commonly_combined:
    - "vendor-third-party.third-party-security.third-party-data-handling"
    - "security-architecture.cryptography.encryption-at-rest"
    - "security-architecture.cryptography.encryption-in-transit"
