audit:
  id: responsible-design.dark-pattern-avoidance.sneak-into-basket
  name: Sneak into Basket Audit
  version: 1.0.0
  last_updated: '2025-01-19'
  status: active
  category: ethical-societal
  category_number: 21
  subcategory: dark-pattern-avoidance
  tier: expert
  estimated_duration: 1-2 hours  # median: 1h
  completeness: requires_discovery
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: qualitative
  default_profiles:
  - full
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates whether items, services, or charges are added to user
    carts or orders without explicit consent - the "sneak into basket"
    dark pattern. This includes pre-selected add-ons, automatically
    bundled items, donations added by default, or insurance/protection
    plans pre-checked.

    Examines checkout flows, add-on presentations, and default
    selections for unwanted items.
  why_it_matters: |
    Sneaking items into baskets is consumer deception:

    - EU Directive explicitly prohibits pre-ticked boxes for additional payments
    - FTC considers this unfair/deceptive practice
    - Creates customer disputes and chargebacks
    - Damages trust and brand reputation
    - High complaint rates and negative reviews

    Users who notice unexpected items lose trust; those who don't
    notice pay for things they didn't want.
  when_to_run:
  - Before launching checkout or purchase flows
  - When adding upsell/cross-sell features
  - After customer complaints about unexpected charges
  - Annually for all e-commerce flows
prerequisites:
  required_artifacts:
  - type: checkout_flow
    description: Access to test checkout process
  - type: add_on_documentation
    description: Documentation of additional products/services offered
  access_requirements:
  - Test account for purchase flow
  - Access to checkout configuration
discovery:
  interviews:
  - role: Product Manager
    questions:
    - What add-ons or extras are offered during checkout?
    - Are any items pre-selected by default?
    - What is the opt-out rate for pre-selected items?
    - How are add-ons presented to users?
    purpose: Understand add-on presentation practices
    duration: 20 min
  - role: E-commerce/Revenue Lead
    questions:
    - What revenue comes from pre-selected add-ons?
    - Have there been complaints about unexpected items?
    - How do you balance conversion with transparency?
    purpose: Understand business practices and metrics
    duration: 20 min
  documents_to_review:
  - type: Checkout Flow Designs
    purpose: Review add-on presentation
    look_for:
    - Pre-selected checkboxes
    - Default bundle selections
    - Add-on prominence and disclosure
  - type: Customer Complaints
    purpose: Identify sneak-in patterns
    look_for:
    - Unexpected charges complaints
    - Item removal issues
    - Refund requests for unwanted items
  file_patterns:
  - glob: '**/ETHICS.md'
    purpose: Ethics documentation
  - glob: '**/PRIVACY*.md'
    purpose: Privacy documentation
  - glob: '**/terms*.md'
    purpose: Terms of service
  - glob: '**/policy*.md'
    purpose: Policy documentation
  code_patterns:
  - pattern: consent|privacy|gdpr|ccpa|cookie
    type: regex
    scope: all
    purpose: Privacy/consent references
signals:
  critical:
  - id: SNEAK-CRIT-001
    signal: Items pre-selected in cart without user action
    evidence_indicators:
    - Checkbox pre-ticked for additional purchase
    - Insurance/protection added by default
    - Donation pre-added to order
    - Bundle items selected without consent
    explanation: |
      Pre-selecting paid items violates EU Consumer Rights Directive
      which requires explicit consent for additional payments.
      This practice is considered deceptive in most jurisdictions.
    remediation: |
      - Make all paid add-ons opt-in (unchecked by default)
      - Require explicit user action to add items
      - Never pre-select paid additions
      - Clearly label items as additional purchase
  - id: SNEAK-CRIT-002
    signal: Items added automatically without visibility
    evidence_indicators:
    - Cart total increased without item line visible
    - Fees added without item in cart view
    - Items added during checkout not shown clearly
    - Must scroll/expand to see added items
    explanation: |
      Adding items without clear visibility prevents users from
      noticing and removing them, which is deceptive practice
      designed to extract payment for unwanted items.
    remediation: |
      - Show all items clearly in cart
      - Highlight any items added during flow
      - Make removal obvious and easy
      - Never hide cart contents
  high:
  - id: SNEAK-HIGH-001
    signal: Difficult to remove pre-selected items
    evidence_indicators:
    - Removal requires multiple clicks
    - Remove option hidden or small
    - Confirmation required to remove but not to add
    - Must reload page to see removal
    explanation: |
      When removing items is harder than keeping them, users are
      manipulated into purchases they may not want through
      asymmetric friction.
    remediation: |
      - Make removal as easy as a single click
      - Place remove option prominently
      - Don't require extra confirmation for removal
      - Update cart immediately on removal
  - id: SNEAK-HIGH-002
    signal: Add-on presented as part of main product
    evidence_indicators:
    - Insurance shown as part of product price
    - Add-on not visually separated from main item
    - Additional charge blended into total
    - Confusing presentation of separate items
    explanation: |
      Presenting separate paid items as part of the main product
      misleads users about what they're purchasing and the actual
      cost of each component.
    remediation: |
      - Clearly separate add-ons from main products
      - Show each item as distinct line in cart
      - Use visual separation for different items
      - Make optional nature clear
  medium:
  - id: SNEAK-MED-001
    signal: Default selections favor revenue over user preference
    evidence_indicators:
    - More expensive option pre-selected
    - Premium version defaulted
    - Longer subscription term defaulted
    remediation: |
      - Default to user-favorable options
      - Or use no default and require selection
      - Consider user needs over revenue
  - id: SNEAK-MED-002
    signal: Cross-sells aggressive during checkout
    evidence_indicators:
    - Multiple add-on offers per checkout
    - Cross-sells interrupt checkout flow
    - Requires dismissing offers to continue
    remediation: |
      - Limit cross-sell interruptions
      - Allow skipping offers easily
      - Don't pre-select cross-sell items
  positive:
  - id: SNEAK-POS-001
    signal: All add-ons require opt-in
    evidence_indicators:
    - No pre-checked add-ons
    - Clear user action required to add items
    - Cart only contains explicitly added items
  - id: SNEAK-POS-002
    signal: Transparent cart presentation
    evidence_indicators:
    - All items clearly visible
    - Easy item removal
    - Clear line-item pricing
procedure:
  context:
    cognitive_mode: critical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Cart Baseline Test
    description: |
      Add a single item to cart and proceed to checkout without
      selecting any add-ons. Document what appears in cart.
    duration_estimate: 15 min
    expected_findings:
    - Items in cart without selection
    - Pre-selected add-ons identified
  - id: '2'
    name: Add-On Presentation Review
    description: |
      Review how add-ons and extras are presented during checkout.
      Document default selections and opt-out process.
    duration_estimate: 30 min
    expected_findings:
    - Default selections documented
    - Opt-out friction assessed
  - id: '3'
    name: Removal Testing
    description: |
      Attempt to remove any pre-selected or added items.
      Document effort required.
    duration_estimate: 15 min
    expected_findings:
    - Removal effort measured
    - Asymmetry with addition
  - id: '4'
    name: Cart Visibility Assessment
    description: |
      Review whether all cart items are clearly visible and
      properly labeled.
    duration_estimate: 15 min
    expected_findings:
    - Visibility assessment
    - Hidden items identified
  - id: '5'
    name: Synthesize Findings
    description: |
      Compile findings and recommendations.
    duration_estimate: 15 min
    expected_findings:
    - Prioritized findings
    - Recommendations
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Pre-Selection Findings
    - Cart Visibility Assessment
    - Recommendations
  confidence_guidance:
    high: Clear pre-selection documented with screenshots
    medium: Patterns observed but edge cases
    low: Potential concerns without clear evidence
offline:
  capability: partial
profiles:
  membership:
    quick:
      included: true
      priority: 60
    full:
      included: true
      priority: 85
closeout_checklist:
- id: sneak-001
  item: Checkout flow tested for pre-selected items
  level: CRITICAL
  verification: manual
  verification_notes: Full checkout tested documenting all pre-selections
  expected: Confirmed by reviewer
- id: sneak-002
  item: Cart visibility assessed
  level: BLOCKING
  verification: manual
  verification_notes: All cart items clearly visible and labeled
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - e-commerce
    - marketplace
    - saas
    team_sizes:
    - small
    - medium
    - large
  compliance_frameworks:
  - framework: EU Consumer Rights Directive
    controls:
    - Article 22 (Additional Payments)
  - framework: FTC Act
    controls:
    - Section 5 (Deceptive Practices)
relationships:
  commonly_combined:
  - responsible-design.dark-pattern-avoidance.hidden-cost
  - responsible-design.consent-transparency.price-transparency
