audit:
  id: responsible-design.consent-transparency.cookie-consent-implementation
  name: Cookie Consent Implementation Audit
  version: 1.0.0
  last_updated: '2025-01-19'
  status: active
  category: ethical-societal
  category_number: 21
  subcategory: consent-transparency
  tier: expert
  estimated_duration: 2-3 hours  # median: 2h
  completeness: requires_discovery
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: qualitative
  default_profiles:
  - full
  - security
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates cookie consent banner implementation for GDPR and ePrivacy
    compliance. Assesses whether consent is freely given, specific,
    informed, and unambiguous. Examines whether rejection is as easy
    as acceptance and whether cookies are blocked before consent.

    Reviews consent management platform configuration, cookie behavior
    before consent, and dark patterns in consent interfaces.
  why_it_matters: |
    Cookie consent is heavily regulated and enforced:

    - GDPR and ePrivacy require prior consent for non-essential cookies
    - DPAs actively fine organizations for non-compliant consent
    - CNIL, ICO, and other authorities have issued specific guidance
    - Cookie walls and dark patterns face increased scrutiny
    - EU DSA explicitly prohibits dark patterns in consent
  when_to_run:
  - When implementing or changing cookie consent
  - During privacy compliance reviews
  - After regulatory guidance updates
  - Annually for web properties
prerequisites:
  required_artifacts:
  - type: cookie_consent_banner
    description: Access to cookie consent interface
  - type: cookie_inventory
    description: List of cookies used on site
  access_requirements:
  - Access to website without existing consent
  - Browser developer tools
  - CMP configuration access
discovery:
  interviews:
  - role: Privacy/DPO
    questions:
    - How do you categorize cookies?
    - What is blocked before consent?
    - How do you ensure reject is as easy as accept?
    - What CMP are you using and how is it configured?
    purpose: Understand consent implementation
    duration: 30 min
  documents_to_review:
  - type: CMP Configuration
    purpose: Review consent settings
    look_for:
    - Cookie categories
    - Consent blocking behavior
    - UI configuration
  - type: Cookie Inventory
    purpose: Understand what requires consent
    look_for:
    - Essential vs non-essential classification
    - Third-party cookies
    - Tracking cookies
  file_patterns:
  - glob: '**/ETHICS.md'
    purpose: Ethics documentation
  - glob: '**/PRIVACY*.md'
    purpose: Privacy documentation
  - glob: '**/terms*.md'
    purpose: Terms of service
  - glob: '**/policy*.md'
    purpose: Policy documentation
  code_patterns:
  - pattern: consent|privacy|gdpr|ccpa|cookie
    type: regex
    scope: all
    purpose: Privacy/consent references
signals:
  critical:
  - id: COOKIE-CRIT-001
    signal: Non-essential cookies set before consent
    evidence_indicators:
    - Analytics cookies present on first load
    - Advertising cookies set before banner interaction
    - Third-party trackers firing before consent
    explanation: |
      GDPR and ePrivacy require prior consent before setting non-essential
      cookies. Setting cookies before consent is a clear violation.
    remediation: |
      - Block all non-essential cookies until consent
      - Implement proper consent-based triggering
      - Audit and fix cookie loading order
  - id: COOKIE-CRIT-002
    signal: No way to reject cookies
    evidence_indicators:
    - Only 'Accept' or 'Accept All' buttons
    - Reject requires navigating to settings
    - No reject option visible on first layer
    explanation: |
      GDPR requires reject be as easy as accept. No visible reject
      option makes consent not freely given.
    remediation: |
      - Add prominent reject option to first layer
      - Make reject equally visible as accept
      - Enable one-click rejection
  - id: COOKIE-CRIT-003
    signal: Cookie wall blocking access
    evidence_indicators:
    - Content inaccessible without cookie consent
    - Must accept cookies to use service
    - Reject leads to blocked access
    explanation: |
      Cookie walls make consent not freely given. EDPB guidance
      indicates cookie walls are generally non-compliant.
    remediation: |
      - Allow access without cookie consent
      - Provide alternative to tracking
      - Remove access conditioning on consent
  high:
  - id: COOKIE-HIGH-001
    signal: Reject requires more clicks than accept
    evidence_indicators:
    - Accept one click, reject requires settings
    - Multiple layers to reach reject
    - Asymmetric effort between options
    explanation: |
      When rejecting requires more effort, consent is not freely given.
      This is recognized as a dark pattern.
    remediation: |
      - Make reject equally accessible
      - Provide first-layer reject option
      - Eliminate effort asymmetry
  - id: COOKIE-HIGH-002
    signal: Pre-checked consent options
    evidence_indicators:
    - Non-essential categories pre-selected
    - Consent options require unticking
    - Default is consent rather than no consent
    explanation: |
      GDPR requires affirmative consent - pre-checked boxes do not
      constitute valid consent.
    remediation: |
      - Default all non-essential to unchecked
      - Require affirmative opt-in
      - Remove pre-selections
  - id: COOKIE-HIGH-003
    signal: Misleading consent interface design
    evidence_indicators:
    - Accept prominent, reject visually diminished
    - Color/size asymmetry between options
    - Misdirection design patterns
    explanation: |
      Visual manipulation toward accepting constitutes dark pattern
      prohibited by EU DSA.
    remediation: |
      - Use equal visual treatment
      - Apply consistent styling to all options
      - Remove visual manipulation
  medium:
  - id: COOKIE-MED-001
    signal: Consent categories unclear
    evidence_indicators:
    - Vague category descriptions
    - Users cannot understand what they're consenting to
    - Technical language in options
    remediation: |
      - Use clear category descriptions
      - Explain each category purpose
      - Use plain language
  positive:
  - id: COOKIE-POS-001
    signal: Compliant cookie consent implementation
    evidence_indicators:
    - Prior consent blocking implemented
    - Reject as easy as accept
    - Equal visual treatment
    - Granular consent options
procedure:
  context:
    cognitive_mode: critical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Pre-Consent Cookie Audit
    description: Check what cookies are set before any consent action.
    duration_estimate: 30 min
    commands:
    - purpose: Check cookies before consent
      command: Open site in incognito, check cookies before banner interaction
    expected_findings:
    - Cookies present before consent
    - Violation identification
  - id: '2'
    name: Consent Banner Review
    description: Assess consent interface design and options.
    duration_estimate: 30 min
    expected_findings:
    - Option availability
    - Visual treatment assessment
    - Effort asymmetry check
  - id: '3'
    name: Reject Path Testing
    description: Test the rejection path end-to-end.
    duration_estimate: 30 min
    expected_findings:
    - Rejection process documented
    - Comparison to acceptance
  - id: '4'
    name: Post-Reject Cookie Audit
    description: Verify cookies after rejection.
    duration_estimate: 30 min
    expected_findings:
    - Cookies after rejection
    - Consent honoring verification
  - id: '5'
    name: Synthesize Findings
    description: Compile findings and recommendations.
    duration_estimate: 15 min
    expected_findings:
    - Prioritized findings
    - Recommendations
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Pre-Consent Cookie Analysis
    - Consent Interface Review
    - Recommendations
  confidence_guidance:
    high: Technical testing completed, cookies audited
    medium: Interface review without technical audit
    low: Visual review only
offline:
  capability: partial
profiles:
  membership:
    quick:
      included: true
      priority: 60
    security:
      included: true
      priority: 85
    full:
      included: true
      priority: 85
closeout_checklist:
- id: cookie-001
  item: Pre-consent cookie behavior verified
  level: CRITICAL
  verification: manual
  verification_notes: Cookies checked before any consent action
  expected: Confirmed by reviewer
- id: cookie-002
  item: Reject accessibility assessed
  level: CRITICAL
  verification: manual
  verification_notes: Reject option accessibility compared to accept
  expected: Confirmed by reviewer
- id: cookie-003
  item: Post-reject behavior verified
  level: BLOCKING
  verification: manual
  verification_notes: Cookies after rejection audited
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
    team_sizes:
    - small
    - medium
    - large
  compliance_frameworks:
  - framework: GDPR
    controls:
    - Article 7 (Consent)
    - Recital 32
  - framework: ePrivacy Directive
    controls:
    - Article 5(3)
  - framework: EU DSA
    controls:
    - Dark Pattern Prohibition
relationships:
  commonly_combined:
  - responsible-design.dark-pattern-avoidance.privacy-zuckering
  - responsible-design.consent-transparency.opt-in-opt-out-default
