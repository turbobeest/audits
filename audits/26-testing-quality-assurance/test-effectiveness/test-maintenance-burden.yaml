audit:
  id: testing-quality-assurance.test-effectiveness.test-maintenance-burden
  name: Test Maintenance Burden
  version: 1.0.0
  last_updated: '2026-01-22'
  status: active
  category: testing-quality-assurance
  category_number: 26
  subcategory: test-effectiveness
  tier: expert
  estimated_duration: 30-45 min
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: quality
  default_profiles:
  - full
  - quality
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates the maintenance burden of the test suite including test
    brittleness, update frequency, test-to-code change ratio, and
    time spent maintaining tests. Identifies tests that cost more
    to maintain than they're worth.
  why_it_matters: |
    High-maintenance tests slow down development and discourage testing.
    If every code change requires extensive test updates, developers
    avoid changes or skip testing. Tests should be easy to maintain
    while providing coverage.
  when_to_run:
  - Developer productivity assessment
  - Test strategy review
  - Sprint retrospectives
  - Technical debt assessment
prerequisites:
  required_artifacts:
  - type: test_files
    description: Test code
  - type: git_history
    description: Change history
  access_requirements:
  - Test source code
  - Git history access
discovery:
  file_patterns:
  - glob: '**/*.test.{js,ts}'
    purpose: Test files
  - glob: '**/*.spec.{js,ts}'
    purpose: Spec files
  code_patterns:
  - pattern: selector|\.get\(|getElementById
    type: regex
    scope: test
    purpose: Brittle selector usage
knowledge_sources:
  guides:
  - id: maintainable-tests
    name: Writing Maintainable Tests
    url: https://kentcdodds.com/blog/write-tests
    offline_cache: true
  - id: test-patterns
    name: xUnit Test Patterns
    url: http://xunitpatterns.com/
    offline_cache: true
  learning_resources:
  - id: testing-patterns-book
    title: xUnit Test Patterns
    type: book
    reference: ISBN 978-0131495050
tooling:
  static_analysis:
  - tool: Git statistics
    purpose: Change frequency analysis
    offline_capable: true
  scripts:
  - id: maintenance-check
    language: bash
    purpose: Analyze test maintenance
    source: inline
    code: |
      #!/bin/bash
      echo "=== Test Maintenance Burden Analysis ==="

      echo "Test file count:"
      find . -name '*.test.*' -o -name '*.spec.*' 2>/dev/null | wc -l

      echo ""
      echo "Lines of test code:"
      find . -name '*.test.*' -o -name '*.spec.*' 2>/dev/null | xargs wc -l 2>/dev/null | tail -1

      echo ""
      echo "Test files changed recently (last 30 commits):"
      git log --oneline -30 --name-only 2>/dev/null | grep -E '\.(test|spec)\.' | sort | uniq -c | sort -rn | head -10

      echo ""
      echo "Brittle selector patterns:"
      grep -r -c '\[data-testid\]|\\.get\\(|getElementById|querySelector' --include='*.test.*' --include='*.spec.*' . 2>/dev/null | grep -v ':0$' | head -10

      echo ""
      echo "Long test files (potential maintenance issues):"
      find . -name '*.test.*' -o -name '*.spec.*' 2>/dev/null | xargs wc -l 2>/dev/null | sort -rn | head -10
signals:
  critical:
  - id: MAINT-CRIT-001
    signal: Tests change more than code
    evidence_pattern: Test change ratio > 2:1 vs source
    explanation: |
      When tests require more changes than the code they test,
      maintenance cost exceeds value. This often indicates tests
      that are too tightly coupled to implementation details.
    remediation: |
      Reduce test coupling:
      1. Test behavior, not implementation
      2. Use stable selectors (data-testid)
      3. Abstract common setup
      4. Avoid testing private methods
      5. Review test-to-code ratio
  - id: MAINT-CRIT-002
    signal: Tests blocking code changes
    evidence_pattern: Developers skip features due to test updates
    explanation: |
      Tests should enable confident changes, not prevent them.
      If developers avoid changes because test updates are painful,
      the test suite is counterproductive.
    remediation: |
      Remove barriers:
      - Identify highest-friction tests
      - Refactor or remove
      - Add better abstractions
      - Simplify test setup
      - Use testing utilities
  high:
  - id: MAINT-HIGH-001
    signal: Brittle selector-heavy tests
    evidence_pattern: Tests depend on CSS/DOM structure
    explanation: |
      Tests that rely on CSS classes, DOM structure, or XPath break
      when UI changes. Stable identifiers (data-testid) decouple
      tests from implementation.
    remediation: |
      Use stable selectors:
      - Add data-testid attributes
      - Remove CSS class selectors
      - Avoid XPath for UI tests
      - Use role-based queries
  - id: MAINT-HIGH-002
    signal: Significant test duplication
    evidence_pattern: Same setup/assertions repeated
    explanation: |
      Duplicated test code multiplies maintenance. Changes require
      updates in many places. Shared utilities and fixtures reduce
      duplication.
    remediation: |
      Reduce duplication:
      - Extract common setup to fixtures
      - Create test utilities
      - Use factories
      - Implement helper functions
  medium:
  - id: MAINT-MED-001
    signal: Very long test files
    evidence_pattern: Test files > 1000 lines
    remediation: Split into focused test files
  - id: MAINT-MED-002
    signal: Hard-to-understand tests
    evidence_pattern: Complex setup, unclear assertions
    remediation: Simplify tests, improve naming
  low:
  - id: MAINT-LOW-001
    signal: No test utility library
    evidence_pattern: Common patterns not abstracted
  positive:
  - id: MAINT-POS-001
    signal: Low test change ratio
    evidence_pattern: Tests stable despite code changes
  - id: MAINT-POS-002
    signal: Well-organized test utilities
    evidence_pattern: Shared fixtures and helpers
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Measure test volume
    description: |
      Assess the size of the test suite.
    duration_estimate: 5 min
    commands:
    - purpose: Count test files
      command: find . -name '*.test.*' -o -name '*.spec.*' 2>/dev/null | wc -l
    - purpose: Count test lines
      command: find . -name '*.test.*' -o -name '*.spec.*' 2>/dev/null | xargs wc -l 2>/dev/null | tail
        -1
    expected_findings:
    - Test suite size
    - Code volume
  - id: '2'
    name: Analyze change frequency
    description: |
      Examine how often tests change.
    duration_estimate: 10 min
    commands:
    - purpose: Recent test changes
      command: git log --oneline -30 --name-only 2>/dev/null | grep -E '\.(test|spec)\.' | sort | uniq
        -c | sort -rn | head -10
    expected_findings:
    - Change frequency
    - Hot spots
  - id: '3'
    name: Check for brittleness
    description: |
      Identify brittle test patterns.
    duration_estimate: 10 min
    commands:
    - purpose: Find brittle selectors
      command: grep -r -c 'querySelector\|className\|getElementById' --include='*.test.*' . 2>/dev/null
        | grep -v ':0$' | head -10
    expected_findings:
    - Brittle patterns
    - Selector usage
  - id: '4'
    name: Assess organization
    description: |
      Review test structure and utilities.
    duration_estimate: 10 min
    commands:
    - purpose: Find test utilities
      command: find . -name '*test-util*' -o -name '*testHelper*' -o -name '*fixtures*' 2>/dev/null |
        head -10
    expected_findings:
    - Utility coverage
    - Organization quality
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: maintenance_report
    format: table
    sections:
    - Test Suite Size
    - Change Analysis
    - Brittleness Assessment
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Maintenance Analysis
    - Improvement Recommendations
  confidence_guidance:
    high: Full change history analysis
    medium: Pattern analysis
    low: Static analysis only
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: maintainable-tests
      priority: recommended
profiles:
  membership:
    quick:
      included: false
      reason: Requires detailed analysis
    quality:
      included: true
      priority: 4
    full:
      included: true
      priority: 5
closeout_checklist:
- id: maint-001
  item: Test suite size measured
  level: CRITICAL
  verification: find . -name '*.test.*' -o -name '*.spec.*' 2>/dev/null | wc -l
  expected: Count documented
- id: maint-002
  item: Change patterns analyzed
  level: WARNING
  verification: manual
  verification_notes: Review git history for test changes
  expected: Patterns documented
- id: maint-003
  item: Brittleness assessed
  level: WARNING
  verification: grep -r 'querySelector' --include='*.test.*' . 2>/dev/null | wc -l
  expected: Count documented
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: ISO 25010
    controls:
    - Maintainability
relationships:
  commonly_combined:
  - testing-quality-assurance.test-effectiveness.test-flakiness
  - testing-quality-assurance.unit-testing.unit-test-maintainability
  - testing-quality-assurance.test-effectiveness.test-roi
