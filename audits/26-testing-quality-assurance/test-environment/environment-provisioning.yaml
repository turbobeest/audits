audit:
  id: testing-quality-assurance.test-environment.environment-provisioning
  name: Environment Provisioning
  version: 1.0.0
  last_updated: '2026-01-22'
  status: active
  category: testing-quality-assurance
  category_number: 26
  subcategory: test-environment
  tier: expert
  estimated_duration: 30-45 min
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: 'yes'
  severity: medium
  scope: infrastructure
  default_profiles:
  - full
  - quality
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates the automation, speed, and reliability of test environment
    provisioning. Assesses whether teams can quickly spin up isolated
    test environments on demand without manual intervention.
  why_it_matters: |
    Slow or manual environment provisioning blocks testing. Developers
    waiting for environments don't test, or share environments causing
    conflicts. Fast, automated provisioning enables parallel testing,
    feature branches, and experimentation.
  when_to_run:
  - Developer productivity assessment
  - CI/CD optimization
  - Environment strategy review
  - Scaling planning
prerequisites:
  required_artifacts:
  - type: provisioning_scripts
    description: Environment automation scripts
  - type: ci_config
    description: CI/CD configuration
  access_requirements:
  - Provisioning script access
  - CI/CD configuration access
discovery:
  file_patterns:
  - glob: '**/docker-compose*.yml'
    purpose: Docker Compose definitions
  - glob: '**/scripts/setup*'
    purpose: Setup scripts
  - glob: '**/Makefile'
    purpose: Make targets
  code_patterns:
  - pattern: docker-compose up|terraform apply|kubectl
    type: regex
    scope: scripts
    purpose: Provisioning commands
knowledge_sources:
  guides:
  - id: ephemeral-envs
    name: Ephemeral Environments Guide
    url: https://www.gitpod.io/docs
    offline_cache: true
  - id: testcontainers
    name: Testcontainers Documentation
    url: https://www.testcontainers.org/
    offline_cache: true
  learning_resources:
  - id: env-automation
    title: Environment Automation
    type: guide
    reference: DevOps Best Practices
tooling:
  infrastructure_tools:
  - tool: Docker Compose
    purpose: Local environment orchestration
    offline_capable: true
  - tool: Testcontainers
    purpose: Programmatic container management
    offline_capable: true
  - tool: Kubernetes
    purpose: Container orchestration
    offline_capable: false
  scripts:
  - id: provisioning-check
    language: bash
    purpose: Analyze provisioning automation
    source: inline
    code: |
      #!/bin/bash
      echo "=== Environment Provisioning Analysis ==="

      echo "Docker Compose files:"
      find . -name 'docker-compose*.yml' 2>/dev/null | head -10

      echo ""
      echo "Setup scripts:"
      find . -name 'setup*' -o -name 'bootstrap*' -o -name 'init*' 2>/dev/null | grep -E '\.(sh|py|js)$' | head -10

      echo ""
      echo "Makefile targets:"
      grep -E '^[a-z].*:' Makefile 2>/dev/null | head -10

      echo ""
      echo "CI environment setup:"
      grep -A10 'setup\|environment' .github/workflows/*.yml 2>/dev/null | head -20

      echo ""
      echo "Testcontainers usage:"
      grep -r 'testcontainers\|GenericContainer' --include='*.java' --include='*.kt' --include='*.py' . 2>/dev/null | head -5
signals:
  critical:
  - id: PROVISION-CRIT-001
    signal: No automated environment provisioning
    evidence_pattern: Manual setup required for test environments
    explanation: |
      Manual provisioning is slow, error-prone, and creates bottlenecks.
      Developers either wait for environments, skip testing, or share
      environments causing conflicts. Automation is essential for
      productive development.
    remediation: |
      Automate environment provisioning:
      1. Document current manual steps
      2. Script each step
      3. Use Docker Compose or similar
      4. Create single-command setup
      5. Test automation in CI
  - id: PROVISION-CRIT-002
    signal: Provisioning takes hours
    evidence_pattern: Environment setup time > 1 hour
    explanation: |
      Long provisioning times waste developer time and discourage
      testing. Developers work around slow environments, reducing
      test coverage. Provisioning should be minutes, not hours.
    remediation: |
      Speed up provisioning:
      - Pre-build container images
      - Cache dependencies
      - Parallelize setup steps
      - Use ephemeral databases
      - Consider cloud-based environments
  high:
  - id: PROVISION-HIGH-001
    signal: Provisioning requires special access
    evidence_pattern: Only ops can create environments
    explanation: |
      Developer-inaccessible provisioning creates bottlenecks and
      dependencies. Self-service provisioning enables developers
      to test independently without waiting.
    remediation: |
      Enable self-service:
      - Document provisioning process
      - Provide developer tooling
      - Grant necessary permissions
      - Automate approval where needed
  - id: PROVISION-HIGH-002
    signal: Shared test environments only
    evidence_pattern: Cannot create isolated environments
    explanation: |
      Shared environments cause conflicts between developers and
      tests. Changes by one affect others. Isolated environments
      enable independent, parallel testing.
    remediation: |
      Enable isolated environments:
      - Use containerization
      - Create per-branch environments
      - Implement namespace isolation
      - Automate environment lifecycle
  medium:
  - id: PROVISION-MED-001
    signal: Provisioning not reproducible
    evidence_pattern: Same script produces different results
    remediation: Fix determinism issues, pin versions, use IaC
  - id: PROVISION-MED-002
    signal: No cleanup automation
    evidence_pattern: Orphaned environments accumulate
    remediation: Automate environment cleanup and expiration
  low:
  - id: PROVISION-LOW-001
    signal: Provisioning not documented
    evidence_pattern: Tribal knowledge required
  positive:
  - id: PROVISION-POS-001
    signal: One-command environment setup
    evidence_pattern: Single script creates full environment
  - id: PROVISION-POS-002
    signal: Environment-per-PR
    evidence_pattern: Preview environments for each PR
procedure:
  context:
    cognitive_mode: evaluative
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Find provisioning automation
    description: |
      Identify environment setup scripts and tools.
    duration_estimate: 10 min
    commands:
    - purpose: Find Docker Compose
      command: find . -name 'docker-compose*.yml' 2>/dev/null | head -5
    - purpose: Find setup scripts
      command: find . -name 'setup*' -o -name 'bootstrap*' 2>/dev/null | head -10
    expected_findings:
    - Automation approach
    - Script locations
  - id: '2'
    name: Assess provisioning time
    description: |
      Estimate environment setup duration.
    duration_estimate: 10 min
    commands:
    - purpose: Check CI setup time
      command: grep -A5 'setup' .github/workflows/*.yml 2>/dev/null | head -15
    expected_findings:
    - Setup duration
    - Bottlenecks
  - id: '3'
    name: Review self-service capability
    description: |
      Check if developers can provision independently.
    duration_estimate: 10 min
    questions:
    - Can developers run setup locally?
    - Are credentials needed for setup?
    - Can isolated environments be created?
    expected_findings:
    - Self-service status
    - Access requirements
  - id: '4'
    name: Check cleanup automation
    description: |
      Verify environment teardown is automated.
    duration_estimate: 10 min
    commands:
    - purpose: Find cleanup scripts
      command: find . -name '*cleanup*' -o -name '*teardown*' 2>/dev/null | head -5
    expected_findings:
    - Cleanup automation
    - Lifecycle management
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: provisioning_report
    format: table
    sections:
    - Automation Status
    - Provisioning Time
    - Self-Service Capability
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Provisioning Analysis
    - Recommendations
  confidence_guidance:
    high: Full provisioning test with timing
    medium: Script and configuration analysis
    low: Documentation review only
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: ephemeral-envs
      priority: recommended
profiles:
  membership:
    quick:
      included: false
      reason: Requires environment analysis
    quality:
      included: true
      priority: 4
    full:
      included: true
      priority: 5
closeout_checklist:
- id: provision-001
  item: Provisioning automation identified
  level: CRITICAL
  verification: find . -name 'docker-compose*.yml' -o -name 'setup*' 2>/dev/null | wc -l
  expected: Count > 0
- id: provision-002
  item: Provisioning time assessed
  level: WARNING
  verification: manual
  verification_notes: Document approximate setup time
  expected: Time documented
- id: provision-003
  item: Self-service capability verified
  level: WARNING
  verification: manual
  verification_notes: Confirm developers can provision
  expected: Self-service available
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: ISO 25010
    controls:
    - Maintainability
relationships:
  commonly_combined:
  - testing-quality-assurance.test-environment.environment-parity
  - testing-quality-assurance.test-environment.environment-stability
  - cicd-pipeline.pipeline-basics.pipeline-speed
