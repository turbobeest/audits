audit:
  id: testing-quality-assurance.security-testing.dependency-scanning
  name: Dependency Scanning
  version: 1.0.0
  last_updated: '2026-01-22'
  status: active
  category: testing-quality-assurance
  category_number: 26
  subcategory: security-testing
  tier: expert
  estimated_duration: 30-60 min
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: 'yes'
  severity: critical
  scope: security
  default_profiles:
  - full
  - security
  - quick
  blocks_phase: true
  parallelizable: true
description:
  what: |
    Evaluates dependency vulnerability scanning including tool
    configuration, CI/CD integration, vulnerability database updates,
    and remediation workflows. Verifies that third-party packages
    are continuously monitored for known security vulnerabilities.
  why_it_matters: |
    Most modern applications are 80%+ third-party code. Vulnerable
    dependencies are a top attack vector (see Log4Shell, npm incidents).
    Automated scanning catches known vulnerabilities before attackers
    exploit them. Without scanning, you're unknowingly running
    vulnerable code.
  when_to_run:
  - Every build/deployment
  - Security audit preparation
  - Dependency updates
  - New project setup
prerequisites:
  required_artifacts:
  - type: dependency_files
    description: Package manifests (package.json, requirements.txt, etc.)
  access_requirements:
  - Source code repository access
  - CI/CD configuration access
discovery:
  file_patterns:
  - glob: '**/package-lock.json'
    purpose: npm dependencies
  - glob: '**/requirements*.txt'
    purpose: Python dependencies
  - glob: '**/go.sum'
    purpose: Go dependencies
  - glob: '**/Gemfile.lock'
    purpose: Ruby dependencies
  - glob: '**/pom.xml'
    purpose: Maven dependencies
  code_patterns:
  - pattern: snyk|dependabot|renovate|npm audit
    type: regex
    scope: config
    purpose: Dependency scanning tools
knowledge_sources:
  specifications:
  - id: cve-database
    name: CVE Database
    url: https://cve.mitre.org/
    offline_cache: false
    priority: required
  guides:
  - id: dep-scanning
    name: Dependency Scanning Guide
    url: https://snyk.io/learn/dependency-scanning/
    offline_cache: true
  - id: npm-audit
    name: npm Audit Guide
    url: https://docs.npmjs.com/cli/audit
    offline_cache: true
  learning_resources:
  - id: supply-chain
    title: Software Supply Chain Security
    type: article
    reference: https://slsa.dev/
tooling:
  static_analysis:
  - tool: Snyk
    purpose: Commercial dependency scanning
    offline_capable: false
  - tool: Dependabot
    purpose: GitHub dependency scanning
    offline_capable: false
  - tool: npm audit
    purpose: npm dependency audit
    offline_capable: true
  - tool: Trivy
    purpose: Open-source vulnerability scanner
    offline_capable: true
  - tool: OWASP Dependency-Check
    purpose: Open-source dependency analysis
    offline_capable: true
  scripts:
  - id: dep-scan-check
    language: bash
    purpose: Check dependency scanning setup
    source: inline
    code: |
      #!/bin/bash
      echo "=== Dependency Scanning Analysis ==="

      echo "Dependabot configuration:"
      find . -name 'dependabot.yml' -o -name '.dependabot' 2>/dev/null

      echo ""
      echo "Snyk configuration:"
      find . -name '.snyk' 2>/dev/null

      echo ""
      echo "npm audit in CI:"
      grep -r 'npm audit\|yarn audit' .github/workflows/ 2>/dev/null | head -5

      echo ""
      echo "Running npm audit:"
      npm audit --json 2>/dev/null | jq '.metadata.vulnerabilities' || echo "npm audit not available"
signals:
  critical:
  - id: DEPSCAN-CRIT-001
    signal: No dependency scanning configured
    evidence_pattern: No vulnerability scanning for dependencies
    explanation: |
      Without dependency scanning, you're blind to known
      vulnerabilities in your supply chain. Critical CVEs like
      Log4Shell could be present without your knowledge.
    remediation: |
      Implement dependency scanning:
      1. Enable Dependabot (GitHub) or equivalent
      2. Configure Snyk or npm audit in CI
      3. Set up automated PR creation for updates
      4. Configure alerting for critical CVEs
      5. Establish remediation SLAs
  - id: DEPSCAN-CRIT-002
    signal: Critical vulnerabilities present
    evidence_pattern: Known critical CVEs in dependencies
    explanation: |
      Critical vulnerabilities are actively exploited. Every day
      they remain unpatched increases risk of breach. Critical
      findings require immediate attention.
    remediation: |
      Address critical vulnerabilities immediately:
      1. Assess exploitability in your context
      2. Update to patched version if available
      3. Apply workarounds if no patch exists
      4. Document risk acceptance if neither possible
      5. Set remediation deadline (<24-48 hours for critical)
  high:
  - id: DEPSCAN-HIGH-001
    signal: Scanning not blocking deployments
    evidence_pattern: Vulnerabilities present but builds pass
    explanation: |
      Scanning without blocking allows vulnerable code to deploy.
      Teams may ignore findings if there are no consequences.
      Critical and high vulnerabilities should block deployment.
    remediation: |
      Configure blocking:
      - Fail CI on critical vulnerabilities
      - Fail on high vulnerabilities (with exceptions)
      - Require acknowledgment for accepted risks
      - Track vulnerability age
  - id: DEPSCAN-HIGH-002
    signal: Vulnerability database not updated
    evidence_pattern: Using stale vulnerability data
    explanation: |
      New vulnerabilities are discovered daily. Stale vulnerability
      databases miss recent CVEs. Tools should pull fresh data
      with each scan.
    remediation: |
      Ensure fresh vulnerability data:
      - Use cloud-based tools with live updates
      - Update offline databases regularly
      - Verify scan reports show recent CVEs
  medium:
  - id: DEPSCAN-MED-001
    signal: Transitive dependencies not scanned
    evidence_pattern: Only direct dependencies checked
    remediation: Scan full dependency tree including transitive dependencies
  - id: DEPSCAN-MED-002
    signal: No automated remediation
    evidence_pattern: Manual dependency updates only
    remediation: Enable automated PR creation for vulnerability fixes
  low:
  - id: DEPSCAN-LOW-001
    signal: License compliance not checked
    evidence_pattern: Only vulnerabilities checked, not licenses
  positive:
  - id: DEPSCAN-POS-001
    signal: Zero known vulnerabilities
    evidence_pattern: Clean vulnerability scan
  - id: DEPSCAN-POS-002
    signal: Automated remediation active
    evidence_pattern: Dependabot PRs being created and merged
procedure:
  context:
    cognitive_mode: critical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Check scanning configuration
    description: |
      Find dependency scanning tools and configuration.
    duration_estimate: 10 min
    commands:
    - purpose: Find Dependabot config
      command: cat .github/dependabot.yml 2>/dev/null || echo 'No Dependabot'
    - purpose: Find Snyk config
      command: cat .snyk 2>/dev/null || echo 'No Snyk'
    expected_findings:
    - Tool configuration
    - Scan scope
  - id: '2'
    name: Run vulnerability scan
    description: |
      Execute dependency vulnerability scan.
    duration_estimate: 10 min
    commands:
    - purpose: npm audit
      command: npm audit 2>/dev/null | tail -30 || echo 'npm not available'
    - purpose: pip audit
      command: pip-audit 2>/dev/null | tail -20 || echo 'pip-audit not available'
    expected_findings:
    - Current vulnerabilities
    - Severity distribution
  - id: '3'
    name: Verify CI integration
    description: |
      Check if scanning runs in CI pipeline.
    duration_estimate: 10 min
    commands:
    - purpose: Check CI for scanning
      command: grep -r 'audit\|snyk\|trivy' .github/workflows/ 2>/dev/null | head -10
    expected_findings:
    - CI integration
    - Blocking configuration
  - id: '4'
    name: Review remediation status
    description: |
      Assess vulnerability remediation progress.
    duration_estimate: 15 min
    commands:
    - purpose: Check for Dependabot PRs
      command: gh pr list --label 'dependencies' 2>/dev/null | head -10 || echo 'gh not available'
    expected_findings:
    - Open vulnerability PRs
    - Remediation velocity
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: vulnerability_report
    format: table
    sections:
    - Current Vulnerabilities
    - Tool Configuration
    - Remediation Status
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Vulnerability Analysis
    - Recommendations
  confidence_guidance:
    high: Live scan with CI verification
    medium: Configuration analysis
    low: Pattern matching only
offline:
  capability: partial
  cache_manifest:
    knowledge:
    - source_id: dep-scanning
      priority: required
profiles:
  membership:
    quick:
      included: true
      reason: Fast and critical check
    security:
      included: true
      priority: 1
    production:
      included: true
      priority: 1
    full:
      included: true
      priority: 2
closeout_checklist:
- id: depscan-001
  item: Scanning tool configured
  level: CRITICAL
  verification: test -f .github/dependabot.yml && echo PASS || echo FAIL
  expected: PASS
- id: depscan-002
  item: Current vulnerabilities scanned
  level: CRITICAL
  verification: npm audit 2>/dev/null && echo PASS || echo 'Run manually'
  expected: PASS
- id: depscan-003
  item: CI integration verified
  level: WARNING
  verification: grep -r 'audit\|snyk' .github/workflows/ 2>/dev/null | wc -l
  expected: Count > 0
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: PCI-DSS
    controls:
    - '6.2'
  - framework: SOC2
    controls:
    - CC7.1
  - framework: NIST CSF
    controls:
    - ID.SC-2
relationships:
  commonly_combined:
  - testing-quality-assurance.security-testing.sast-integration
  - dependency-supply-chain.dependency-management.dependency-version-policy
  - security-trust.vulnerability-management.vulnerability-remediation
