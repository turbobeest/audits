audit:
  id: testing-quality-assurance.security-testing.penetration-test-coverage
  name: Penetration Test Coverage
  version: 1.0.0
  last_updated: '2026-01-22'
  status: active
  category: testing-quality-assurance
  category_number: 26
  subcategory: security-testing
  tier: expert
  estimated_duration: 1-2 hours  # median: 1h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: security
  default_profiles:
  - full
  - security
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates penetration testing practices including scope coverage,
    test methodology, finding severity distribution, remediation
    tracking, and testing frequency. Assesses whether penetration
    testing adequately validates security controls.
  why_it_matters: |
    Penetration testing validates security by simulating real attacks.
    Automated tools miss logic flaws, business logic vulnerabilities,
    and sophisticated attack chains that skilled testers find. Regular
    pen testing proves security controls work and identifies gaps.
  when_to_run:
  - Security program assessment
  - Pre-compliance audit
  - After major changes
  - Annual security review
prerequisites:
  required_artifacts:
  - type: pentest_reports
    description: Previous penetration test reports
  - type: scope_documentation
    description: Application scope and architecture
  access_requirements:
  - Penetration test reports
  - Remediation tracking
discovery:
  documents_to_review:
  - type: Penetration test reports
    purpose: Review coverage and findings
  - type: Remediation tracking
    purpose: Verify finding resolution
  - type: Test scope documents
    purpose: Assess coverage completeness
  file_patterns:
  - glob: '**/*.md'
    purpose: Documentation files
  - glob: '**/*.yaml'
    purpose: Configuration files
  - glob: '**/*.json'
    purpose: JSON configuration
knowledge_sources:
  specifications:
  - id: ptes
    name: Penetration Testing Execution Standard
    url: http://www.pentest-standard.org/
    offline_cache: true
    priority: required
  - id: owasp-testing
    name: OWASP Testing Guide
    url: https://owasp.org/www-project-web-security-testing-guide/
    offline_cache: true
    priority: required
  guides:
  - id: pentest-guide
    name: Penetration Testing Methodology
    url: https://www.offensive-security.com/penetration-testing/
    offline_cache: true
  learning_resources:
  - id: ethical-hacking
    title: The Web Application Hacker's Handbook
    type: book
    reference: ISBN 978-1118026472
tooling:
  assessment_tools:
  - tool: Penetration test reports
    purpose: Review existing assessments
  - tool: Remediation tracker
    purpose: Track finding resolution
signals:
  critical:
  - id: PENTEST-CRIT-001
    signal: No penetration testing performed
    evidence_pattern: No pen test reports or engagement history
    explanation: |
      Without penetration testing, security controls are unvalidated.
      Automated tools miss complex vulnerabilities. Professional
      pen testing finds issues that attackers would find.
    remediation: |
      Establish penetration testing program:
      1. Define scope (applications, infrastructure)
      2. Select qualified testing provider
      3. Conduct initial assessment
      4. Establish remediation process
      5. Plan regular recurring tests
  - id: PENTEST-CRIT-002
    signal: Critical findings not remediated
    evidence_pattern: Critical/high findings open > 90 days
    explanation: |
      Unaddressed critical findings represent active vulnerabilities.
      Attackers may discover and exploit the same issues. Critical
      findings require immediate remediation.
    remediation: |
      Address critical findings immediately:
      - Prioritize by exploitability
      - Apply compensating controls if fix delayed
      - Track remediation timeline
      - Validate fixes with retesting
  high:
  - id: PENTEST-HIGH-001
    signal: Penetration testing not regular
    evidence_threshold: Last pen test > 12 months ago
    explanation: |
      Applications change constantly. New features, dependencies,
      and configurations introduce vulnerabilities. Annual or
      more frequent testing catches new issues.
    remediation: |
      Establish testing cadence:
      - Annual minimum for stable systems
      - After major releases
      - Quarterly for high-risk applications
      - Continuous for critical systems
  - id: PENTEST-HIGH-002
    signal: Scope doesn't cover all components
    evidence_pattern: APIs, mobile, or infrastructure excluded
    explanation: |
      Incomplete scope leaves attack surface untested. Attackers
      target the weakest point. All components must be in scope.
    remediation: |
      Expand testing scope:
      - Web applications
      - APIs and microservices
      - Mobile applications
      - Cloud infrastructure
      - Third-party integrations
  medium:
  - id: PENTEST-MED-001
    signal: No retest of remediated findings
    evidence_pattern: Fixes claimed but not verified
    remediation: Verify all critical/high fixes with targeted retesting
  - id: PENTEST-MED-002
    signal: Internal-only testing
    evidence_pattern: No external perspective on security
    remediation: Engage external testers for unbiased assessment
  low:
  - id: PENTEST-LOW-001
    signal: Test methodology not documented
    evidence_pattern: Unclear what was tested and how
  positive:
  - id: PENTEST-POS-001
    signal: Regular comprehensive testing
    evidence_pattern: Annual+ tests with full scope coverage
  - id: PENTEST-POS-002
    signal: All findings remediated
    evidence_pattern: Zero open critical/high findings
procedure:
  context:
    cognitive_mode: critical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Review test history
    description: |
      Gather information about penetration testing history.
    duration_estimate: 20 min
    questions:
    - When was the last penetration test?
    - Who performed the testing?
    - What methodology was used?
    expected_findings:
    - Testing frequency
    - Provider information
  - id: '2'
    name: Assess scope coverage
    description: |
      Verify penetration test scope covers all components.
    duration_estimate: 20 min
    questions:
    - What systems were in scope?
    - What systems were excluded?
    - Were all application tiers tested?
    expected_findings:
    - Scope completeness
    - Coverage gaps
  - id: '3'
    name: Review findings
    description: |
      Analyze penetration test findings and severity.
    duration_estimate: 25 min
    questions:
    - How many findings by severity?
    - What types of vulnerabilities found?
    - Are there recurring issues?
    expected_findings:
    - Finding distribution
    - Vulnerability patterns
  - id: '4'
    name: Verify remediation
    description: |
      Check status of finding remediation.
    duration_estimate: 20 min
    questions:
    - How many findings are remediated?
    - What is average time to remediation?
    - Were fixes verified with retesting?
    expected_findings:
    - Remediation status
    - Open findings count
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: pentest_assessment
    format: table
    sections:
    - Test History
    - Scope Coverage
    - Finding Status
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Testing Analysis
    - Recommendations
  confidence_guidance:
    high: Full report review with remediation tracking
    medium: Report review without tracking
    low: Interview-based assessment
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: ptes
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires document review
    security:
      included: true
      priority: 2
    full:
      included: true
      priority: 5
closeout_checklist:
- id: pentest-001
  item: Test history reviewed
  level: CRITICAL
  verification: manual
  verification_notes: Document last pen test date and scope
  expected: Confirmed by reviewer
- id: pentest-002
  item: Scope coverage assessed
  level: BLOCKING
  verification: manual
  verification_notes: Verify all components in scope
  expected: Confirmed by reviewer
- id: pentest-003
  item: Remediation status verified
  level: WARNING
  verification: manual
  verification_notes: Count open critical/high findings
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: PCI-DSS
    controls:
    - '11.3'
  - framework: SOC2
    controls:
    - CC7.1
  - framework: ISO 27001
    controls:
    - A.14.2.8
relationships:
  commonly_combined:
  - testing-quality-assurance.security-testing.dast-integration
  - testing-quality-assurance.security-testing.sast-integration
  - security-trust.vulnerability-management.vulnerability-remediation
