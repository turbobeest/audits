audit:
  id: testing-quality-assurance.test-data-management.test-data-privacy
  name: Test Data Privacy
  version: 1.0.0
  last_updated: '2026-01-22'
  status: active
  category: testing-quality-assurance
  category_number: 26
  subcategory: test-data-management
  tier: expert
  estimated_duration: 45-60 min
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: critical
  scope: security
  default_profiles:
  - full
  - security
  - compliance
  blocks_phase: true
  parallelizable: true
description:
  what: |
    Evaluates privacy compliance of test data including detection of
    personally identifiable information (PII), assessment of data
    anonymization practices, and verification that production data
    is properly handled in test environments.
  why_it_matters: |
    Test data containing real PII creates significant legal and reputational
    risk. GDPR, CCPA, and other regulations apply to test environments too.
    Data breaches from test environments are common and costly. Proper
    anonymization protects both users and the organization.
  when_to_run:
  - Compliance audit preparation
  - Security assessment
  - New test environment setup
  - Data handling policy review
prerequisites:
  required_artifacts:
  - type: test_data
    description: Test data files and fixtures
  - type: database_access
    description: Access to test databases
  access_requirements:
  - Test data file access
  - Test database access
discovery:
  file_patterns:
  - glob: '**/fixtures/**/*.json'
    purpose: JSON fixtures
  - glob: '**/seeds/**'
    purpose: Seed data
  - glob: '**/*.sql'
    purpose: SQL data files
  code_patterns:
  - pattern: '@.*\.com|\d{3}-\d{2}-\d{4}|\d{16}'
    type: regex
    scope: data
    purpose: PII patterns (email, SSN, credit card)
knowledge_sources:
  specifications:
  - id: gdpr
    name: GDPR Requirements
    url: https://gdpr-info.eu/
    offline_cache: true
    priority: required
  guides:
  - id: data-anonymization
    name: Data Anonymization Guide
    url: https://www.enisa.europa.eu/publications/data-pseudonymisation-technical-implementation-techniques
    offline_cache: true
  - id: synthetic-data
    name: Synthetic Data Best Practices
    url: https://mostly.ai/synthetic-data-guide/
    offline_cache: true
  learning_resources:
  - id: privacy-testing
    title: Privacy in Software Testing
    type: guide
    reference: IAPP Certification Materials
tooling:
  static_analysis:
  - tool: Custom PII scanner
    purpose: Detect PII patterns
    offline_capable: true
  - tool: Gitleaks
    purpose: Secret and PII detection
    offline_capable: true
  scripts:
  - id: pii-scan
    language: bash
    purpose: Scan for PII patterns
    source: inline
    code: |
      #!/bin/bash
      echo "=== Test Data Privacy Analysis ==="

      echo "Email patterns in data files:"
      grep -r -E '[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}' --include='*.json' --include='*.sql' --include='*.csv' . 2>/dev/null | grep -v 'example\|test\|fake\|@example' | head -10

      echo ""
      echo "Phone number patterns:"
      grep -r -E '\b\d{3}[-.]?\d{3}[-.]?\d{4}\b' --include='*.json' --include='*.sql' . 2>/dev/null | head -5

      echo ""
      echo "SSN patterns:"
      grep -r -E '\b\d{3}-\d{2}-\d{4}\b' --include='*.json' --include='*.sql' . 2>/dev/null | head -5

      echo ""
      echo "Credit card patterns:"
      grep -r -E '\b\d{4}[- ]?\d{4}[- ]?\d{4}[- ]?\d{4}\b' . 2>/dev/null | head -5

      echo ""
      echo "Synthetic data usage:"
      grep -r 'faker\|Faker\|synthetic\|anonymize' --include='*.js' --include='*.ts' --include='*.py' . 2>/dev/null | head -10
signals:
  critical:
  - id: PRIVACY-CRIT-001
    signal: Real PII detected in test data
    evidence_pattern: Actual names, emails, or sensitive data found
    explanation: |
      Real personal data in test environments violates privacy regulations.
      This data can be exposed through logs, error messages, or breaches.
      Regulatory fines for PII exposure apply regardless of environment.
    remediation: |
      Remove and replace PII immediately:
      1. Identify all PII locations
      2. Replace with synthetic equivalents
      3. Update source data generation
      4. Scrub databases and backups
      5. Implement ongoing PII detection
  - id: PRIVACY-CRIT-002
    signal: Production database used for testing
    evidence_pattern: Test code connects to production data
    explanation: |
      Testing against production data risks data corruption, privacy
      violations, and compliance failures. Production and test environments
      must be completely separated.
    remediation: |
      Separate environments:
      1. Create isolated test database
      2. Generate synthetic test data
      3. Remove production connection strings
      4. Block test code from production
      5. Audit environment boundaries
  high:
  - id: PRIVACY-HIGH-001
    signal: No data anonymization process
    evidence_pattern: Production data copied without sanitization
    explanation: |
      Copying production data to test environments without anonymization
      propagates privacy risks. Proper masking removes identifying
      information while preserving data structure.
    remediation: |
      Implement anonymization:
      - Define PII fields to mask
      - Create masking rules
      - Automate sanitization pipeline
      - Verify anonymization effectiveness
      - Prevent direct copies
  - id: PRIVACY-HIGH-002
    signal: Incomplete PII detection
    evidence_pattern: Only obvious PII fields checked
    explanation: |
      PII can exist in unexpected places: logs, comments, concatenated
      fields, and unstructured data. Comprehensive detection must cover
      all data locations, not just obvious fields.
    remediation: |
      Expand PII detection:
      - Scan all text fields
      - Check log files
      - Analyze concatenated data
      - Review freeform fields
      - Regular expression scanning
  medium:
  - id: PRIVACY-MED-001
    signal: Test database access not restricted
    evidence_pattern: Broad access to test data
    remediation: Apply least-privilege access to test databases
  - id: PRIVACY-MED-002
    signal: No data retention policy for test data
    evidence_pattern: Test data persists indefinitely
    remediation: Implement test data lifecycle management
  low:
  - id: PRIVACY-LOW-001
    signal: Anonymization not documented
    evidence_pattern: Unclear what data is masked
  positive:
  - id: PRIVACY-POS-001
    signal: Fully synthetic test data
    evidence_pattern: No production data in test environments
  - id: PRIVACY-POS-002
    signal: Automated PII scanning
    evidence_pattern: CI/CD includes PII detection
procedure:
  context:
    cognitive_mode: critical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Scan for PII patterns
    description: |
      Search test data for PII patterns.
    duration_estimate: 15 min
    commands:
    - purpose: Find email patterns
      command: grep -r -E '[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}' --include='*.json' . 2>/dev/null
        | grep -v 'example\|test' | head -10
    - purpose: Find phone patterns
      command: grep -r -E '\b\d{3}[-.]?\d{3}[-.]?\d{4}\b' --include='*.json' . 2>/dev/null | head -5
    expected_findings:
    - PII presence
    - Data patterns
  - id: '2'
    name: Check data sources
    description: |
      Verify test data sources and generation.
    duration_estimate: 15 min
    commands:
    - purpose: Check faker usage
      command: grep -r 'faker\|Faker\|synthetic' --include='*.js' --include='*.py' . 2>/dev/null | head
        -10
    expected_findings:
    - Data source
    - Generation method
  - id: '3'
    name: Review anonymization
    description: |
      Assess data anonymization practices.
    duration_estimate: 10 min
    questions:
    - Is production data ever used in tests?
    - What anonymization techniques are applied?
    - Is anonymization automated?
    expected_findings:
    - Anonymization status
    - Process maturity
  - id: '4'
    name: Verify compliance
    description: |
      Check compliance with privacy requirements.
    duration_estimate: 10 min
    questions:
    - What privacy regulations apply?
    - Are test environments in scope?
    - Is there a DPA for test data?
    expected_findings:
    - Compliance status
    - Regulatory requirements
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: privacy_report
    format: table
    sections:
    - PII Detection Results
    - Anonymization Assessment
    - Compliance Status
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Privacy Analysis
    - Remediation Actions
  confidence_guidance:
    high: Full data scan with compliance review
    medium: Pattern-based scanning
    low: Documentation review only
offline:
  capability: partial
  cache_manifest:
    knowledge:
    - source_id: data-anonymization
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires thorough analysis
    security:
      included: true
      priority: 2
    compliance:
      included: true
      priority: 1
    full:
      included: true
      priority: 3
closeout_checklist:
- id: privacy-001
  item: PII scan completed
  level: CRITICAL
  verification: manual
  verification_notes: Document PII patterns found or confirmed absent
  expected: No real PII found
- id: privacy-002
  item: Data sources verified
  level: CRITICAL
  verification: manual
  verification_notes: Confirm no production data in tests
  expected: Synthetic data only
- id: privacy-003
  item: Anonymization reviewed
  level: BLOCKING
  verification: manual
  verification_notes: Verify masking procedures if production data used
  expected: Anonymization confirmed
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: GDPR
    controls:
    - Art. 5
    - Art. 25
    - Art. 32
  - framework: CCPA
    controls:
    - '1798.100'
  - framework: HIPAA
    controls:
    - '164.514'
  - framework: SOC2
    controls:
    - CC6.1
    - CC6.7
relationships:
  commonly_combined:
  - testing-quality-assurance.test-data-management.production-data-masking
  - testing-quality-assurance.test-data-management.test-data-strategy
  - security-trust.data-protection.data-classification
