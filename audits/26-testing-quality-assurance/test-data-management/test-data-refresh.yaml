audit:
  id: testing-quality-assurance.test-data-management.test-data-refresh
  name: Test Data Refresh
  version: 1.0.0
  last_updated: '2026-01-22'
  status: active
  category: testing-quality-assurance
  category_number: 26
  subcategory: test-data-management
  tier: expert
  estimated_duration: 30-45 min
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: quality
  default_profiles:
  - full
  - quality
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates test data refresh practices including frequency, automation,
    data aging, and sync with production schema changes. Ensures test data
    remains current, relevant, and aligned with production data patterns.
  why_it_matters: |
    Stale test data leads to tests that pass but miss real-world issues.
    As applications evolve, test data must evolve too. Regular refresh
    ensures tests remain meaningful and catch regressions that affect
    actual usage patterns.
  when_to_run:
  - Test environment assessment
  - After schema changes
  - Quality review cycles
  - Environment refresh planning
prerequisites:
  required_artifacts:
  - type: test_data
    description: Test data files and databases
  - type: refresh_scripts
    description: Data refresh automation if available
  access_requirements:
  - Test data access
  - Refresh script access
discovery:
  file_patterns:
  - glob: '**/scripts/refresh*'
    purpose: Refresh scripts
  - glob: '**/db/seeds/**'
    purpose: Seed data
  - glob: '**/migrations/**'
    purpose: Schema migrations
  code_patterns:
  - pattern: refresh|reseed|reset|reload
    type: regex
    scope: scripts
    purpose: Refresh commands
knowledge_sources:
  guides:
  - id: data-refresh
    name: Test Data Refresh Strategies
    url: https://www.tricentis.com/resources/test-data-management-guide
    offline_cache: true
  learning_resources:
  - id: tdm-practices
    title: Test Data Management Practices
    type: guide
    reference: QA Best Practices
tooling:
  static_analysis:
  - tool: Custom analysis
    purpose: Refresh automation detection
    offline_capable: true
  scripts:
  - id: refresh-check
    language: bash
    purpose: Analyze refresh patterns
    source: inline
    code: |
      #!/bin/bash
      echo "=== Test Data Refresh Analysis ==="

      echo "Refresh scripts:"
      find . -name '*refresh*' -o -name '*reseed*' -o -name '*reset*' 2>/dev/null | grep -E '\.(sh|js|py|rake)$' | head -10

      echo ""
      echo "Seed files and timestamps:"
      find . -name '*seed*' -type f 2>/dev/null | xargs ls -la 2>/dev/null | head -10

      echo ""
      echo "Migration files (recent):"
      find . -path '*/migrations/*' -type f 2>/dev/null | tail -5

      echo ""
      echo "Scheduled refresh jobs:"
      grep -r 'schedule\|cron' --include='*.yml' --include='*.yaml' . 2>/dev/null | grep -i 'seed\|refresh\|data' | head -5
signals:
  critical:
  - id: REFRESH-CRIT-001
    signal: Test data severely outdated
    evidence_pattern: Test data schema doesn't match current model
    explanation: |
      When test data doesn't match the current schema, tests fail for
      wrong reasons or pass when they shouldn't. Schema drift makes
      tests unreliable indicators of application health.
    remediation: |
      Sync test data with schema:
      1. Identify schema changes since last refresh
      2. Update test data to match current schema
      3. Implement automated schema sync
      4. Add schema validation to CI
      5. Schedule regular refresh cycles
  high:
  - id: REFRESH-HIGH-001
    signal: No automated refresh process
    evidence_pattern: Manual data refresh only
    explanation: |
      Manual refresh is inconsistent, error-prone, and often neglected.
      Automated refresh ensures test data stays current without
      depending on manual intervention.
    remediation: |
      Automate data refresh:
      - Create refresh scripts
      - Schedule periodic execution
      - Add to environment setup
      - Include in CI/CD pipeline
      - Document refresh procedures
  - id: REFRESH-HIGH-002
    signal: Refresh breaks test data relationships
    evidence_pattern: Foreign key violations after refresh
    explanation: |
      Improper refresh can corrupt data relationships, breaking tests
      in ways unrelated to application code. Refresh must maintain
      referential integrity.
    remediation: |
      Preserve data relationships:
      - Refresh in dependency order
      - Use transactions
      - Validate integrity after refresh
      - Test refresh scripts
  medium:
  - id: REFRESH-MED-001
    signal: Inconsistent refresh across environments
    evidence_pattern: Different data in dev/staging/test
    remediation: Standardize refresh process across environments
  - id: REFRESH-MED-002
    signal: Refresh takes too long
    evidence_pattern: Hours-long refresh process
    remediation: Optimize refresh with incremental updates or snapshots
  low:
  - id: REFRESH-LOW-001
    signal: Refresh schedule not documented
    evidence_pattern: Unclear when data is refreshed
  positive:
  - id: REFRESH-POS-001
    signal: Automated scheduled refresh
    evidence_pattern: Regular automated data refresh
  - id: REFRESH-POS-002
    signal: Fast refresh process
    evidence_pattern: Refresh completes in minutes
procedure:
  context:
    cognitive_mode: evaluative
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Find refresh automation
    description: |
      Identify refresh scripts and automation.
    duration_estimate: 10 min
    commands:
    - purpose: Find refresh scripts
      command: find . -name '*refresh*' -o -name '*reseed*' 2>/dev/null | head -10
    - purpose: Check for scheduled jobs
      command: grep -r 'cron\|schedule' --include='*.yml' . 2>/dev/null | grep -i 'seed\|data' | head
        -5
    expected_findings:
    - Refresh automation
    - Schedule status
  - id: '2'
    name: Check data freshness
    description: |
      Assess age of test data files.
    duration_estimate: 10 min
    commands:
    - purpose: Check seed file dates
      command: find . -name '*seed*' -type f 2>/dev/null | xargs ls -la 2>/dev/null | head -10
    expected_findings:
    - Data age
    - Update frequency
  - id: '3'
    name: Verify schema alignment
    description: |
      Check if test data matches current schema.
    duration_estimate: 10 min
    commands:
    - purpose: Find recent migrations
      command: find . -path '*/migrations/*' -type f 2>/dev/null | tail -5
    expected_findings:
    - Schema currency
    - Migration status
  - id: '4'
    name: Review refresh process
    description: |
      Evaluate the refresh workflow.
    duration_estimate: 10 min
    questions:
    - How often is test data refreshed?
    - Is refresh automated?
    - How long does refresh take?
    expected_findings:
    - Process maturity
    - Refresh frequency
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: refresh_report
    format: table
    sections:
    - Refresh Automation
    - Data Currency
    - Process Assessment
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Refresh Analysis
    - Recommendations
  confidence_guidance:
    high: Full refresh process review
    medium: Automation and file analysis
    low: Documentation review only
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: data-refresh
      priority: recommended
profiles:
  membership:
    quick:
      included: false
      reason: Requires process analysis
    quality:
      included: true
      priority: 5
    full:
      included: true
      priority: 6
closeout_checklist:
- id: refresh-001
  item: Refresh automation identified
  level: BLOCKING
  verification: find . -name '*refresh*' -o -name '*reseed*' 2>/dev/null | wc -l
  expected: Count documented
- id: refresh-002
  item: Data freshness assessed
  level: WARNING
  verification: manual
  verification_notes: Document last refresh date
  expected: Date confirmed
- id: refresh-003
  item: Schema alignment verified
  level: WARNING
  verification: manual
  verification_notes: Confirm test data matches current schema
  expected: Aligned
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: ISO 25010
    controls:
    - Maintainability
relationships:
  commonly_combined:
  - testing-quality-assurance.test-data-management.test-data-strategy
  - testing-quality-assurance.test-environment.environment-data
  - testing-quality-assurance.test-environment.environment-provisioning
