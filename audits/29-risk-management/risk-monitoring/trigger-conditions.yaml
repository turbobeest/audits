audit:
  id: risk-management.risk-monitoring.trigger-conditions
  name: Trigger Conditions Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: risk-management
  category_number: 29
  subcategory: risk-monitoring
  tier: phd
  estimated_duration: 2-3 hours  # median: 2h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: organizational
  default_profiles:
  - full
  - security
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines trigger condition management:
    - Definition of risk trigger conditions
    - Monitoring of trigger condition status
    - Automated vs. manual trigger detection
    - Response actions linked to triggers
    - Trigger threshold calibration
    - Documentation of triggered events
    - Review and refinement of triggers
  why_it_matters: |
    Trigger conditions enable proactive risk response:
    - Triggers provide early warning before risks fully materialize
    - PMBOK emphasizes trigger identification for risk monitoring
    - Well-defined triggers enable automated response initiation
    - Without triggers, risk response is reactive
    - Trigger conditions connect monitoring to action
    - Calibrated triggers reduce false positives and missed events
    - Effective triggers improve response timeliness
  when_to_run:
  - When implementing risk triggers
  - Annual risk monitoring review
  - After trigger failures
  - When calibrating KRI thresholds
  - During risk response planning
prerequisites:
  required_artifacts:
  - type: trigger_definitions
    description: Risk trigger condition definitions
  - type: monitoring_configuration
    description: Trigger monitoring configuration
  - type: response_plans
    description: Trigger-linked response plans
  access_requirements:
  - Access to trigger definitions
  - Access to monitoring systems
  - Access to response documentation
discovery:
  code_patterns:
  - pattern: (trigger|condition|threshold).*risk
    type: regex
    scope: docs
    purpose: Find trigger references
  - pattern: (when|if|threshold).*then.*action
    type: regex
    scope: config
    purpose: Find trigger-action rules
  - pattern: (alert|notify|initiate).*trigger
    type: regex
    scope: docs
    purpose: Find trigger response references
  file_patterns:
  - glob: '**/trigger*.{yaml,yml,json,md}'
    purpose: Trigger files
  - glob: '**/alert*.{yaml,yml,json,md}'
    purpose: Alert configuration files
  - glob: '**/condition*.{yaml,yml,json,md}'
    purpose: Condition files
knowledge_sources:
  specifications:
  - id: pmbok-risk
    name: PMBOK Risk Management
    url: https://www.pmi.org/pmbok-guide-standards
    offline_cache: true
    priority: recommended
  - id: iso-31000-2018
    name: ISO 31000:2018 Risk Management
    url: https://www.iso.org/iso-31000-risk-management.html
    offline_cache: true
    priority: required
  guides:
  - id: trigger-management
    name: Risk Trigger Management Guide
    url: https://www.pmi.org/
    offline_cache: true
tooling:
  static_analysis:
  - tool: trigger-analyzer
    purpose: Analyze trigger definitions
    offline_capable: true
  scripts:
  - id: trigger-scanner
    language: bash
    purpose: Scan for trigger definitions
    source: inline
    code: |
      #!/bin/bash
      echo "=== Trigger Condition Scan ==="
      grep -rniE "(trigger|condition|threshold).*risk" \
        --include="*.yaml" --include="*.json" . 2>/dev/null | head -30
signals:
  critical:
  - id: TRIGER-CRIT-001
    signal: No trigger conditions defined for critical risks
    evidence_indicators:
    - No trigger definitions
    - Critical risks without triggers
    - Response relies on event occurrence
    explanation: |
      Trigger conditions enable early response before risks fully
      materialize. Without triggers for critical risks, response
      can only be reactive.
    remediation: |
      - Define trigger conditions for critical risks
      - Link triggers to early warning indicators
      - Document trigger-response relationships
      - Implement trigger monitoring
  high:
  - id: TRIGER-HIGH-001
    signal: Triggers not linked to response actions
    evidence_indicators:
    - Triggers defined but no responses
    - Unclear what happens when triggered
    - No action plans for triggered conditions
    explanation: |
      Triggers provide value only when linked to response actions.
      Triggers without responses are just alerts without purpose.
    remediation: |
      - Link triggers to specific response actions
      - Define response plans for each trigger
      - Document trigger-response mapping
      - Train on response execution
  - id: TRIGER-HIGH-002
    signal: Trigger monitoring not implemented
    evidence_indicators:
    - Triggers defined but not monitored
    - Manual-only trigger detection
    - No systematic monitoring
    explanation: |
      Triggers must be actively monitored to be effective. Unmonitored
      triggers will not provide timely warning.
    remediation: |
      - Implement trigger monitoring
      - Automate where possible
      - Define monitoring frequency
      - Track trigger status
  medium:
  - id: TRIGER-MED-001
    signal: Trigger thresholds not calibrated
    evidence_indicators:
    - Arbitrary threshold values
    - High false positive rate
    - Missed trigger events
    explanation: |
      Calibrated thresholds balance sensitivity with false positives.
      Poorly calibrated triggers either miss events or create alert
      fatigue.
    remediation: |
      - Calibrate trigger thresholds
      - Review threshold effectiveness
      - Adjust based on experience
      - Balance sensitivity and specificity
  - id: TRIGER-MED-002
    signal: Triggered events not documented
    evidence_indicators:
    - No record of triggered conditions
    - Unable to track trigger history
    - No audit trail
    explanation: |
      Documentation enables learning and audit. Without records,
      trigger effectiveness cannot be assessed.
    remediation: |
      - Document all triggered events
      - Record response actions taken
      - Track trigger accuracy
      - Enable audit trail
  low:
  - id: TRIGER-LOW-001
    signal: Triggers not reviewed periodically
    evidence_indicators:
    - Stale trigger definitions
    - No trigger effectiveness review
    - Triggers unchanged despite changes
    explanation: |
      Trigger conditions should be reviewed to ensure continued
      relevance and effectiveness.
    remediation: |
      - Schedule periodic trigger review
      - Assess trigger effectiveness
      - Update triggers as needed
      - Remove obsolete triggers
  positive:
  - id: TRIGER-POS-001
    signal: Comprehensive trigger management
    evidence_indicators:
    - Triggers defined for key risks
    - Linked to response actions
    - Actively monitored
  - id: TRIGER-POS-002
    signal: Effective trigger calibration
    evidence_indicators:
    - Low false positive rate
    - Triggers predict events
    - Regular calibration
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Trigger Definition Review
    description: |
      Evaluate defined trigger conditions.
    duration_estimate: 30 min
    commands:
    - purpose: Find trigger definitions
      command: |
        find . -type f \( -name "*trigger*" -o -name "*condition*" \) \
          -exec grep -l -i "risk" {} \; 2>/dev/null | head -15
    - purpose: Search for trigger specifications
      command: |
        grep -rniE "(trigger|condition).*defined" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    expected_findings:
    - Trigger definitions
    - Condition specifications
    - Threshold values
  - id: '2'
    name: Response Linkage Assessment
    description: |
      Assess how triggers are linked to response actions.
    duration_estimate: 30 min
    commands:
    - purpose: Find trigger-response mapping
      command: |
        grep -rniE "(trigger|condition).*response|action.*trigger" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    - purpose: Check for action plans
      command: |
        grep -rniE "(when|if).*trigger.*(then|action)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Trigger-response mapping
    - Action plans
    - Response documentation
  - id: '3'
    name: Monitoring Assessment
    description: |
      Evaluate trigger monitoring implementation.
    duration_estimate: 30 min
    commands:
    - purpose: Find monitoring configuration
      command: |
        grep -rniE "(monitor|track|watch).*trigger" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    - purpose: Check for automated monitoring
      command: |
        grep -rniE "(automat|alert|notify).*trigger" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Monitoring approach
    - Automation evidence
    - Frequency definition
  - id: '4'
    name: Calibration Review
    description: |
      Assess trigger threshold calibration.
    duration_estimate: 30 min
    commands:
    - purpose: Find calibration documentation
      command: |
        grep -rniE "(calibrat|adjust|tune).*threshold" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    - purpose: Check for effectiveness review
      command: |
        grep -rniE "(effective|accurate|valid).*trigger" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Calibration evidence
    - Effectiveness data
    - Adjustment history
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Trigger Definition Review
    - Response Linkage
    - Monitoring Assessment
    - Recommendations
  - type: trigger_inventory
    format: table
    description: Trigger condition inventory and status
  confidence_guidance:
    high: Comprehensive triggers with monitoring and response
    medium: Triggers exist but gaps in monitoring or response
    low: Minimal or no trigger conditions
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: iso-31000-2018
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires comprehensive trigger review
    full:
      included: true
      priority: 3
    security:
      included: true
      priority: 3
closeout_checklist:
- id: triger-001
  item: Triggers defined for critical risks
  level: CRITICAL
  verification: manual
  verification_notes: Verify trigger definitions exist
  expected: Confirmed by reviewer
- id: triger-002
  item: Triggers linked to response actions
  level: BLOCKING
  verification: manual
  verification_notes: Verify trigger-response linkage
  expected: Confirmed by reviewer
- id: triger-003
  item: Trigger monitoring implemented
  level: BLOCKING
  verification: manual
  verification_notes: Verify monitoring in place
  expected: Confirmed by reviewer
- id: triger-004
  item: Thresholds calibrated
  level: WARNING
  verification: manual
  verification_notes: Check for calibration
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: PMBOK
    controls:
    - 11.6 Monitor Risks
  - framework: ISO 31000
    controls:
    - Clause 6.6
  - framework: COBIT 2019
    controls:
    - APO12.06
relationships:
  commonly_combined:
  - risk-management.risk-monitoring.key-risk-indicators
  - risk-management.risk-monitoring.risk-escalation
  - risk-management.risk-mitigation.risk-response-planning
