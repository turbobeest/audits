audit:
  id: risk-management.threat-modeling.threat-model-methodology
  name: Threat Model Methodology Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: risk-management
  category_number: 29
  subcategory: threat-modeling
  tier: phd
  estimated_duration: 4-5 hours  # median: 4h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: organizational
  default_profiles:
  - full
  - security
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines the threat modeling methodology:
    - Threat modeling framework selection (STRIDE, PASTA, OCTAVE, etc.)
    - Process integration with SDLC and architecture
    - Scope and coverage of threat modeling activities
    - Documentation standards and artifacts
    - Team capabilities and training
    - Tool support and automation
    - Quality assurance of threat models
  why_it_matters: |
    Threat modeling is essential for proactive security design:
    - Identifies security risks early when remediation is cheapest
    - OWASP emphasizes threat modeling as a key practice
    - Enables security-by-design rather than reactive patching
    - Microsoft SDL requires threat modeling for software development
    - Without methodology, threat modeling is ad-hoc and incomplete
    - Structured approaches ensure comprehensive coverage
    - NIST emphasizes understanding threat sources and events
  when_to_run:
  - When implementing threat modeling program
  - Annual security program review
  - During SDLC maturity assessment
  - After security incidents
  - When evaluating methodology effectiveness
prerequisites:
  required_artifacts:
  - type: threat_model_methodology
    description: Threat modeling methodology documentation
  - type: threat_model_examples
    description: Sample threat models
  - type: training_materials
    description: Threat modeling training materials
  access_requirements:
  - Access to threat modeling documentation
  - Access to sample threat models
  - Access to SDLC process documentation
discovery:
  code_patterns:
  - pattern: (threat.model|STRIDE|PASTA|OCTAVE|DREAD)
    type: regex
    scope: docs
    purpose: Find threat modeling references
  - pattern: (threat|attack|adversary).*analysis
    type: regex
    scope: docs
    purpose: Find threat analysis documentation
  - pattern: (DFD|data.flow|trust.boundary)
    type: regex
    scope: docs
    purpose: Find data flow analysis references
  file_patterns:
  - glob: '**/threat*model*.{yaml,yml,json,md}'
    purpose: Threat model files
  - glob: '**/STRIDE*.{yaml,yml,json,md}'
    purpose: STRIDE analysis files
  - glob: '**/security*design*.{yaml,yml,json,md}'
    purpose: Security design files
knowledge_sources:
  specifications:
  - id: owasp-threat-modeling
    name: OWASP Threat Modeling
    url: https://owasp.org/www-community/Threat_Modeling
    offline_cache: true
    priority: required
  - id: microsoft-sdl
    name: Microsoft Security Development Lifecycle
    url: https://www.microsoft.com/en-us/securityengineering/sdl
    offline_cache: true
    priority: recommended
  - id: nist-threat-modeling
    name: NIST Threat Modeling
    url: https://csrc.nist.gov/
    offline_cache: true
    priority: recommended
  guides:
  - id: threat-modeling-book
    name: 'Threat Modeling: Designing for Security'
    url: https://threatmodelingbook.com/
    offline_cache: true
tooling:
  static_analysis:
  - tool: microsoft-threat-modeling-tool
    purpose: Create and analyze threat models
    command: TMT.exe
    offline_capable: true
  - tool: owasp-threat-dragon
    purpose: Open source threat modeling
    command: threat-dragon
    offline_capable: true
  scripts:
  - id: threat-model-scanner
    language: bash
    purpose: Scan for threat model documentation
    source: inline
    code: |
      #!/bin/bash
      echo "=== Threat Model Scan ==="
      find . -type f \( -name "*threat*model*" -o -name "*STRIDE*" \
        -o -name "*security*design*" \) 2>/dev/null | head -20
signals:
  critical:
  - id: TMETH-CRIT-001
    signal: No threat modeling methodology defined
    evidence_indicators:
    - No documented approach
    - No threat modeling framework selected
    - Ad-hoc or absent threat modeling
    explanation: |
      Without a defined methodology, threat modeling is inconsistent
      and incomplete. A structured approach ensures comprehensive
      coverage and repeatable results.
    remediation: |
      - Select appropriate threat modeling framework
      - Document methodology and process
      - Define when threat modeling is required
      - Train teams on methodology
  - id: TMETH-CRIT-002
    signal: Threat modeling not performed for critical systems
    evidence_indicators:
    - No threat models for key applications
    - Security-sensitive systems without analysis
    - Threat modeling not required
    explanation: |
      Critical systems require threat modeling to identify and address
      security risks before deployment. Without it, vulnerabilities
      may be deployed to production.
    remediation: |
      - Identify systems requiring threat modeling
      - Conduct threat modeling for critical systems
      - Require threat models in development process
      - Track coverage
  high:
  - id: TMETH-HIGH-001
    signal: Threat modeling not integrated with SDLC
    evidence_indicators:
    - Threat modeling separate from development
    - No gate requiring threat model
    - Models not updated with changes
    explanation: |
      Integration with SDLC ensures threat modeling occurs at the
      right time and models stay current. Isolated threat modeling
      becomes a checkbox exercise.
    remediation: |
      - Integrate threat modeling into SDLC
      - Require threat models at design phase
      - Update models when architecture changes
      - Track as part of development process
  - id: TMETH-HIGH-002
    signal: Threat modeling team lacks expertise
    evidence_indicators:
    - No trained threat modelers
    - Models of poor quality
    - Key threats missed
    explanation: |
      Effective threat modeling requires expertise. Untrained teams
      produce incomplete or incorrect models that miss significant
      threats.
    remediation: |
      - Train team on threat modeling
      - Develop threat modeling expertise
      - Provide coaching and review
      - Consider external expertise
  medium:
  - id: TMETH-MED-001
    signal: Threat models not documented consistently
    evidence_indicators:
    - Inconsistent formats
    - Missing elements
    - Hard to review models
    explanation: |
      Consistent documentation enables review and comparison.
      Inconsistent formats make it difficult to assess quality
      and coverage.
    remediation: |
      - Define documentation standards
      - Create templates
      - Require standard elements
      - Review for consistency
  - id: TMETH-MED-002
    signal: No tool support for threat modeling
    evidence_indicators:
    - Manual-only process
    - No standard tooling
    - Difficult to maintain models
    explanation: |
      Tooling enables efficient threat modeling and helps maintain
      models over time. Manual processes are resource-intensive.
    remediation: |
      - Evaluate threat modeling tools
      - Implement standard tooling
      - Train on tool usage
      - Enable model maintenance
  low:
  - id: TMETH-LOW-001
    signal: Threat modeling effectiveness not measured
    evidence_indicators:
    - No metrics on threat modeling
    - Unknown model quality
    - No improvement tracking
    explanation: |
      Measuring effectiveness enables improvement in threat modeling
      practices.
    remediation: |
      - Define threat modeling metrics
      - Track model coverage and quality
      - Assess effectiveness
      - Drive improvement
  positive:
  - id: TMETH-POS-001
    signal: Mature threat modeling program
    evidence_indicators:
    - Defined methodology
    - Integrated with SDLC
    - Trained team
  - id: TMETH-POS-002
    signal: Effective threat identification
    evidence_indicators:
    - Comprehensive coverage
    - Consistent documentation
    - Tool-supported
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Methodology Review
    description: |
      Evaluate defined threat modeling methodology.
    duration_estimate: 60 min
    commands:
    - purpose: Find methodology documentation
      command: |
        find . -type f \( -name "*threat*model*" -o -name "*methodology*" \) \
          -exec grep -l -iE "STRIDE|PASTA|OCTAVE|threat" {} \; 2>/dev/null | head -15
    - purpose: Search for framework references
      command: |
        grep -rniE "(STRIDE|PASTA|OCTAVE|DREAD|threat.model)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -30
    expected_findings:
    - Methodology documentation
    - Framework selection
    - Process definition
  - id: '2'
    name: Integration Assessment
    description: |
      Assess integration with SDLC and development processes.
    duration_estimate: 45 min
    commands:
    - purpose: Find SDLC integration
      command: |
        grep -rniE "(sdlc|development|design).*threat" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    - purpose: Check for gating requirements
      command: |
        grep -rniE "(gate|require|mandate).*threat.*model" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - SDLC integration
    - Gating requirements
    - Timing in process
  - id: '3'
    name: Coverage Assessment
    description: |
      Evaluate threat model coverage across systems.
    duration_estimate: 45 min
    commands:
    - purpose: Find existing threat models
      command: |
        find . -type f -name "*threat*model*" 2>/dev/null | head -20
    - purpose: Check for coverage tracking
      command: |
        grep -rniE "(coverage|scope|systems).*threat.*model" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Threat model inventory
    - Coverage scope
    - Gap identification
  - id: '4'
    name: Quality Assessment
    description: |
      Assess quality of threat models and team capability.
    duration_estimate: 45 min
    commands:
    - purpose: Find quality requirements
      command: |
        grep -rniE "(quality|review|valid).*threat.*model" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    - purpose: Check for training
      command: |
        grep -rniE "(train|skill|expertise).*threat" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Quality standards
    - Review processes
    - Training evidence
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Methodology Assessment
    - Integration Review
    - Coverage Analysis
    - Recommendations
  - type: maturity_assessment
    format: table
    description: Threat modeling maturity assessment
  confidence_guidance:
    high: Mature methodology integrated with SDLC
    medium: Methodology exists but gaps in integration or coverage
    low: Minimal or ad-hoc threat modeling
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: owasp-threat-modeling
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires comprehensive methodology review
    full:
      included: true
      priority: 2
    security:
      included: true
      priority: 1
closeout_checklist:
- id: tmeth-001
  item: Threat modeling methodology documented
  level: CRITICAL
  verification: manual
  verification_notes: Verify documented methodology exists
  expected: Confirmed by reviewer
- id: tmeth-002
  item: Threat modeling integrated with SDLC
  level: CRITICAL
  verification: manual
  verification_notes: Verify SDLC integration
  expected: Confirmed by reviewer
- id: tmeth-003
  item: Critical systems have threat models
  level: BLOCKING
  verification: manual
  verification_notes: Verify coverage of critical systems
  expected: Confirmed by reviewer
- id: tmeth-004
  item: Team trained on threat modeling
  level: WARNING
  verification: manual
  verification_notes: Check for training
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: OWASP
    controls:
    - Threat Modeling
  - framework: Microsoft SDL
    controls:
    - Threat Modeling
  - framework: NIST CSF
    controls:
    - ID.RA-1
    - ID.RA-3
  - framework: SOC 2
    controls:
    - CC3.2
relationships:
  commonly_combined:
  - risk-management.threat-modeling.threat-identification
  - risk-management.threat-modeling.attack-surface-analysis
  - risk-management.technical-risk.security-vulnerability-risk
