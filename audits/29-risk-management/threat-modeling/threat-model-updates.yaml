audit:
  id: risk-management.threat-modeling.threat-model-updates
  name: Threat Model Updates Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: risk-management
  category_number: 29
  subcategory: threat-modeling
  tier: phd
  estimated_duration: 2-3 hours  # median: 2h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: organizational
  default_profiles:
  - full
  - security
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines threat model update practices:
    - Triggers for threat model updates
    - Integration with change management
    - Version control of threat models
    - Review and approval of changes
    - Update frequency and cadence
    - Tracking model currency
    - Communication of changes
  why_it_matters: |
    Threat models must stay current to remain valuable:
    - Systems change through development and operations
    - Threat landscape evolves continuously
    - Stale threat models provide false assurance
    - Microsoft SDL emphasizes ongoing threat model maintenance
    - OWASP recommends updating threat models with changes
    - Architecture changes may introduce new threats
    - New vulnerabilities affect existing threat assessments
  when_to_run:
  - Annual threat modeling review
  - When assessing model currency
  - During process improvement
  - After incidents involving stale models
  - When implementing update processes
prerequisites:
  required_artifacts:
  - type: update_procedures
    description: Threat model update procedures
  - type: threat_models
    description: Existing threat models with history
  - type: change_management
    description: Change management documentation
  access_requirements:
  - Access to threat models
  - Access to update procedures
  - Access to change management
discovery:
  code_patterns:
  - pattern: (update|maintain|review).*threat.*model
    type: regex
    scope: docs
    purpose: Find update process references
  - pattern: (version|revision|change).*threat.*model
    type: regex
    scope: docs
    purpose: Find version control references
  - pattern: (trigger|change|modify).*threat.*model
    type: regex
    scope: docs
    purpose: Find update trigger references
  file_patterns:
  - glob: '**/threat*model*update*.{yaml,yml,json,md}'
    purpose: Update procedure files
  - glob: '**/threat*model*v*.{yaml,yml,json,md}'
    purpose: Versioned threat model files
knowledge_sources:
  specifications:
  - id: microsoft-sdl
    name: Microsoft SDL Threat Modeling
    url: https://www.microsoft.com/en-us/securityengineering/sdl
    offline_cache: true
    priority: required
  - id: owasp-threat-modeling
    name: OWASP Threat Modeling
    url: https://owasp.org/www-community/Threat_Modeling
    offline_cache: true
    priority: required
  guides:
  - id: threat-model-maintenance
    name: Threat Model Maintenance Guide
    url: https://www.microsoft.com/
    offline_cache: true
tooling:
  static_analysis:
  - tool: model-tracker
    purpose: Track threat model currency
    offline_capable: true
  scripts:
  - id: update-scanner
    language: bash
    purpose: Scan for update processes
    source: inline
    code: |
      #!/bin/bash
      echo "=== Threat Model Update Scan ==="
      grep -rniE "(update|maintain|review).*threat.*model" \
        --include="*.yaml" --include="*.md" . 2>/dev/null | head -30
signals:
  critical:
  - id: TMUPD-CRIT-001
    signal: No process for updating threat models
    evidence_indicators:
    - No update procedures
    - Models never updated
    - Point-in-time only
    explanation: |
      Without update processes, threat models become stale. Static
      models do not reflect current system state or threats.
    remediation: |
      - Define update process
      - Establish triggers
      - Integrate with change management
      - Schedule periodic reviews
  - id: TMUPD-CRIT-002
    signal: Threat models significantly out of date
    evidence_indicators:
    - Models not updated in years
    - Major changes not reflected
    - Known obsolescence
    explanation: |
      Significantly outdated models provide false assurance. Major
      system changes require corresponding model updates.
    remediation: |
      - Update stale models immediately
      - Assess currency of all models
      - Prioritize critical systems
      - Prevent future staleness
  high:
  - id: TMUPD-HIGH-001
    signal: Updates not triggered by changes
    evidence_indicators:
    - Changes without model review
    - No change management integration
    - Models bypass changes
    explanation: |
      System changes should trigger threat model review. Without
      integration, models drift from reality.
    remediation: |
      - Integrate with change management
      - Define update triggers
      - Require model review for changes
      - Track compliance
  - id: TMUPD-HIGH-002
    signal: No version control for threat models
    evidence_indicators:
    - No version history
    - Cannot track changes
    - No audit trail
    explanation: |
      Version control enables tracking changes and understanding
      model evolution. Without it, changes are lost.
    remediation: |
      - Implement version control
      - Track all changes
      - Maintain history
      - Enable rollback
  medium:
  - id: TMUPD-MED-001
    signal: Updates not reviewed or approved
    evidence_indicators:
    - No review process
    - Unvalidated changes
    - No approval workflow
    explanation: |
      Review ensures update quality. Unreviewed changes may
      introduce errors or miss important considerations.
    remediation: |
      - Implement review process
      - Require approval for changes
      - Define review criteria
      - Track approvals
  - id: TMUPD-MED-002
    signal: Model currency not tracked
    evidence_indicators:
    - Unknown last update dates
    - No currency metrics
    - Cannot assess staleness
    explanation: |
      Tracking currency enables proactive maintenance. Without it,
      staleness is discovered only when problems occur.
    remediation: |
      - Track last update dates
      - Implement currency metrics
      - Alert on aging models
      - Enable proactive maintenance
  low:
  - id: TMUPD-LOW-001
    signal: Model changes not communicated
    evidence_indicators:
    - Stakeholders unaware of changes
    - No change notifications
    - Limited visibility
    explanation: |
      Communication ensures stakeholders are aware of model changes
      and their implications.
    remediation: |
      - Communicate model changes
      - Notify stakeholders
      - Document notifications
      - Enable awareness
  positive:
  - id: TMUPD-POS-001
    signal: Effective threat model maintenance
    evidence_indicators:
    - Defined update process
    - Change management integration
    - Version control
  - id: TMUPD-POS-002
    signal: Current threat models
    evidence_indicators:
    - Recent updates
    - Changes reflected
    - Currency tracked
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Process Review
    description: |
      Evaluate threat model update processes.
    duration_estimate: 30 min
    commands:
    - purpose: Find update procedures
      command: |
        find . -type f -name "*update*" -exec grep -l -i "threat.*model" {} \; \
          2>/dev/null | head -15
    - purpose: Search for update process
      command: |
        grep -rniE "(update|maintain|review).*process.*threat" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    expected_findings:
    - Update procedures
    - Process documentation
    - Trigger definitions
  - id: '2'
    name: Integration Assessment
    description: |
      Assess integration with change management.
    duration_estimate: 30 min
    commands:
    - purpose: Find change management integration
      command: |
        grep -rniE "(change.*management|change.*control).*threat" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    - purpose: Check for trigger integration
      command: |
        grep -rniE "(trigger|initiate|require).*update.*model" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Change management integration
    - Trigger configuration
    - Process linkage
  - id: '3'
    name: Version Control Review
    description: |
      Evaluate version control and tracking.
    duration_estimate: 30 min
    commands:
    - purpose: Find version control
      command: |
        grep -rniE "(version|revision|v[0-9]).*threat.*model" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    - purpose: Check for history tracking
      command: |
        grep -rniE "(history|changelog|audit).*threat.*model" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Version control
    - Change history
    - Audit trail
  - id: '4'
    name: Currency Assessment
    description: |
      Assess model currency and tracking.
    duration_estimate: 30 min
    commands:
    - purpose: Find update dates
      command: |
        grep -rniE "(last_updated|updated|reviewed).*202[0-9]" \
          --include="*.yaml" --include="*.json" . 2>/dev/null | \
          grep -i "threat" | head -20
    - purpose: Check for currency metrics
      command: |
        grep -rniE "(currency|age|stale).*model" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Update dates
    - Currency tracking
    - Staleness indicators
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Process Assessment
    - Integration Review
    - Currency Analysis
    - Recommendations
  - type: currency_report
    format: table
    description: Threat model currency report
  confidence_guidance:
    high: Defined process with integration and currency tracking
    medium: Process exists but gaps in integration or tracking
    low: Minimal or no update process
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: microsoft-sdl
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires comprehensive update review
    full:
      included: true
      priority: 3
    security:
      included: true
      priority: 2
closeout_checklist:
- id: tmupd-001
  item: Update process defined
  level: CRITICAL
  verification: manual
  verification_notes: Verify documented update process
  expected: Confirmed by reviewer
- id: tmupd-002
  item: Integrated with change management
  level: BLOCKING
  verification: manual
  verification_notes: Verify change management integration
  expected: Confirmed by reviewer
- id: tmupd-003
  item: Version control implemented
  level: BLOCKING
  verification: manual
  verification_notes: Verify version control
  expected: Confirmed by reviewer
- id: tmupd-004
  item: Currency tracked
  level: WARNING
  verification: manual
  verification_notes: Check for currency tracking
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: Microsoft SDL
    controls:
    - Threat Model Maintenance
  - framework: OWASP
    controls:
    - Threat Model Updates
  - framework: SOC 2
    controls:
    - CC6.8
relationships:
  commonly_combined:
  - risk-management.threat-modeling.threat-model-methodology
  - risk-management.risk-monitoring.risk-review-cadence
  - risk-management.risk-identification.risk-register-maintenance
