audit:
  id: risk-management.threat-modeling.attack-surface-analysis
  name: Attack Surface Analysis Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: risk-management
  category_number: 29
  subcategory: threat-modeling
  tier: phd
  estimated_duration: 3-4 hours  # median: 3h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: organizational
  default_profiles:
  - full
  - security
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines attack surface analysis practices:
    - Identification of entry points and interfaces
    - Trust boundary mapping
    - Data flow analysis
    - External-facing surface enumeration
    - Attack surface reduction efforts
    - Continuous attack surface monitoring
    - Documentation and visualization
  why_it_matters: |
    Attack surface defines where attacks can be attempted:
    - Every entry point is a potential attack vector
    - Microsoft emphasizes attack surface reduction
    - Smaller attack surface means reduced risk
    - OWASP includes attack surface in threat modeling
    - Unknown attack surface cannot be protected
    - Attack surface changes with deployments and updates
    - Trust boundaries define where validation is required
  when_to_run:
  - During threat modeling
  - Before major deployments
  - When architecture changes
  - After security incidents
  - Periodic security assessment
prerequisites:
  required_artifacts:
  - type: architecture_docs
    description: System architecture documentation
  - type: interface_inventory
    description: Inventory of interfaces and entry points
  - type: data_flow_diagrams
    description: Data flow diagrams
  access_requirements:
  - Access to architecture documentation
  - Access to interface inventories
  - Access to system configurations
discovery:
  code_patterns:
  - pattern: (attack.surface|entry.point|interface|endpoint)
    type: regex
    scope: docs
    purpose: Find attack surface references
  - pattern: (trust.boundary|trust.zone|security.boundary)
    type: regex
    scope: docs
    purpose: Find trust boundary references
  - pattern: (data.flow|DFD|information.flow)
    type: regex
    scope: docs
    purpose: Find data flow references
  file_patterns:
  - glob: '**/attack*surface*.{yaml,yml,json,md}'
    purpose: Attack surface files
  - glob: '**/interface*.{yaml,yml,json,md}'
    purpose: Interface files
  - glob: '**/data*flow*.{yaml,yml,json,md}'
    purpose: Data flow files
knowledge_sources:
  specifications:
  - id: owasp-attack-surface
    name: OWASP Attack Surface Analysis
    url: https://owasp.org/www-community/Attack_Surface_Analysis_Cheat_Sheet
    offline_cache: true
    priority: required
  - id: microsoft-asr
    name: Microsoft Attack Surface Reduction
    url: https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/attack-surface-reduction
    offline_cache: true
    priority: recommended
  guides:
  - id: attack-surface-management
    name: Attack Surface Management Guide
    url: https://www.sans.org/
    offline_cache: true
tooling:
  static_analysis:
  - tool: attack-surface-scanner
    purpose: Enumerate attack surface
    offline_capable: true
  scripts:
  - id: surface-scanner
    language: bash
    purpose: Scan for attack surface documentation
    source: inline
    code: |
      #!/bin/bash
      echo "=== Attack Surface Scan ==="
      grep -rniE "(attack.surface|entry.point|endpoint|interface)" \
        --include="*.yaml" --include="*.md" . 2>/dev/null | head -30
signals:
  critical:
  - id: ATKSRF-CRIT-001
    signal: No attack surface analysis performed
    evidence_indicators:
    - No documented attack surface
    - Entry points unknown
    - No interface inventory
    explanation: |
      Without attack surface analysis, organizations do not know where
      they are vulnerable to attack. Unknown attack surface cannot
      be protected or monitored.
    remediation: |
      - Conduct attack surface analysis
      - Identify all entry points
      - Document interfaces
      - Map trust boundaries
  - id: ATKSRF-CRIT-002
    signal: External attack surface unknown
    evidence_indicators:
    - Internet-facing assets not inventoried
    - Unknown external exposure
    - Shadow IT contributing to surface
    explanation: |
      External attack surface is the most critical to understand.
      Unknown external exposure represents direct risk from
      internet-based attacks.
    remediation: |
      - Inventory external-facing assets
      - Discover unknown exposure
      - Address shadow IT
      - Monitor external surface
  high:
  - id: ATKSRF-HIGH-001
    signal: Trust boundaries not mapped
    evidence_indicators:
    - No trust boundary documentation
    - Unclear where validation required
    - Missing security perimeters
    explanation: |
      Trust boundaries define where security controls are needed.
      Without mapping, controls may be missing at critical points.
    remediation: |
      - Map all trust boundaries
      - Define validation requirements
      - Document security perimeters
      - Review boundary controls
  - id: ATKSRF-HIGH-002
    signal: Attack surface not monitored for changes
    evidence_indicators:
    - Point-in-time analysis only
    - No continuous monitoring
    - Changes not detected
    explanation: |
      Attack surface changes with deployments and configurations.
      Static analysis becomes stale without continuous monitoring.
    remediation: |
      - Implement continuous monitoring
      - Detect surface changes
      - Alert on new exposure
      - Integrate with deployment
  medium:
  - id: ATKSRF-MED-001
    signal: No attack surface reduction efforts
    evidence_indicators:
    - Surface only documented, not reduced
    - No minimization strategy
    - Unnecessary exposure tolerated
    explanation: |
      Smaller attack surface means less risk. Analysis should lead
      to reduction efforts where possible.
    remediation: |
      - Prioritize surface reduction
      - Close unnecessary entry points
      - Remove unused interfaces
      - Minimize exposure
  - id: ATKSRF-MED-002
    signal: Data flows not documented
    evidence_indicators:
    - No data flow diagrams
    - Information flows unknown
    - Data movement not tracked
    explanation: |
      Data flow analysis reveals how information moves through
      systems and where it crosses trust boundaries.
    remediation: |
      - Create data flow diagrams
      - Document information flows
      - Identify sensitive data paths
      - Mark trust boundary crossings
  low:
  - id: ATKSRF-LOW-001
    signal: Attack surface not visualized
    evidence_indicators:
    - Text-only documentation
    - No diagrams
    - Hard to understand surface
    explanation: |
      Visualization aids understanding and communication of attack
      surface complexity.
    remediation: |
      - Create visual representations
      - Use diagrams and maps
      - Enable stakeholder understanding
      - Update visualizations
  positive:
  - id: ATKSRF-POS-001
    signal: Comprehensive attack surface management
    evidence_indicators:
    - Complete surface analysis
    - Trust boundaries mapped
    - Continuous monitoring
  - id: ATKSRF-POS-002
    signal: Active surface reduction
    evidence_indicators:
    - Surface minimization efforts
    - Unnecessary exposure eliminated
    - Regular review and reduction
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Surface Documentation Review
    description: |
      Evaluate attack surface documentation.
    duration_estimate: 45 min
    commands:
    - purpose: Find attack surface documentation
      command: |
        find . -type f \( -name "*attack*surface*" -o -name "*interface*" \
          -o -name "*endpoint*" \) 2>/dev/null | head -20
    - purpose: Search for entry point documentation
      command: |
        grep -rniE "(entry.point|attack.surface|exposed)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -30
    expected_findings:
    - Attack surface documentation
    - Entry point inventory
    - Interface listing
  - id: '2'
    name: Trust Boundary Assessment
    description: |
      Assess trust boundary mapping.
    duration_estimate: 30 min
    commands:
    - purpose: Find trust boundary documentation
      command: |
        grep -rniE "(trust.boundary|trust.zone|security.zone)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    - purpose: Check for boundary controls
      command: |
        grep -rniE "(perimeter|dmz|firewall).*boundary" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Trust boundaries
    - Security zones
    - Boundary controls
  - id: '3'
    name: Data Flow Review
    description: |
      Evaluate data flow documentation.
    duration_estimate: 30 min
    commands:
    - purpose: Find data flow diagrams
      command: |
        find . -type f \( -name "*data*flow*" -o -name "*DFD*" \) \
          2>/dev/null | head -15
    - purpose: Search for flow documentation
      command: |
        grep -rniE "(data.flow|information.flow|data.movement)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    expected_findings:
    - Data flow diagrams
    - Flow documentation
    - Sensitive data paths
  - id: '4'
    name: Monitoring Assessment
    description: |
      Assess attack surface monitoring.
    duration_estimate: 30 min
    commands:
    - purpose: Find monitoring documentation
      command: |
        grep -rniE "(monitor|continuous|discover).*surface" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    - purpose: Check for change detection
      command: |
        grep -rniE "(change|detect|alert).*surface" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Monitoring approach
    - Change detection
    - Alerting
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Surface Analysis Review
    - Trust Boundary Assessment
    - Monitoring Evaluation
    - Recommendations
  - type: surface_inventory
    format: table
    description: Attack surface inventory
  confidence_guidance:
    high: Comprehensive surface analysis with monitoring
    medium: Analysis exists but gaps in coverage or monitoring
    low: Minimal or no surface analysis
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: owasp-attack-surface
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires comprehensive surface review
    full:
      included: true
      priority: 2
    security:
      included: true
      priority: 1
closeout_checklist:
- id: atksrf-001
  item: Attack surface documented
  level: CRITICAL
  verification: manual
  verification_notes: Verify surface documentation exists
  expected: Confirmed by reviewer
- id: atksrf-002
  item: Trust boundaries mapped
  level: CRITICAL
  verification: manual
  verification_notes: Verify trust boundary mapping
  expected: Confirmed by reviewer
- id: atksrf-003
  item: External surface known
  level: BLOCKING
  verification: manual
  verification_notes: Verify external exposure identified
  expected: Confirmed by reviewer
- id: atksrf-004
  item: Surface monitoring in place
  level: WARNING
  verification: manual
  verification_notes: Check for continuous monitoring
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: OWASP
    controls:
    - Attack Surface Analysis
  - framework: NIST CSF
    controls:
    - ID.AM-3
    - PR.PT-4
  - framework: SOC 2
    controls:
    - CC6.6
relationships:
  commonly_combined:
  - risk-management.threat-modeling.threat-identification
  - risk-management.threat-modeling.countermeasure-mapping
  - risk-management.technical-risk.security-vulnerability-risk
