audit:
  id: risk-management.threat-modeling.threat-prioritization
  name: Threat Prioritization Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: risk-management
  category_number: 29
  subcategory: threat-modeling
  tier: phd
  estimated_duration: 2-3 hours  # median: 2h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: organizational
  default_profiles:
  - full
  - security
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines threat prioritization practices:
    - Prioritization criteria and methodology
    - DREAD or equivalent scoring
    - Threat likelihood and impact assessment
    - Context-specific prioritization factors
    - Resource allocation alignment
    - Documentation of prioritization decisions
    - Review and adjustment of priorities
  why_it_matters: |
    Threat prioritization enables focused security investment:
    - Cannot address all threats equally; prioritization is essential
    - DREAD provides systematic threat scoring
    - Wrong priorities waste resources on low-risk threats
    - High-priority threats unaddressed create significant exposure
    - Prioritization must reflect organizational context
    - OWASP emphasizes risk-based prioritization
    - Effective prioritization maximizes security ROI
  when_to_run:
  - After threat identification
  - During security planning
  - When resource constraints require prioritization
  - Annual threat assessment review
  - After significant incidents
prerequisites:
  required_artifacts:
  - type: threat_list
    description: List of identified threats
  - type: prioritization_criteria
    description: Threat prioritization criteria
  - type: risk_ratings
    description: Threat risk ratings
  access_requirements:
  - Access to threat documentation
  - Access to prioritization criteria
  - Understanding of organizational context
discovery:
  code_patterns:
  - pattern: (DREAD|damage|reproducibility|exploitability|affected|discoverability)
    type: regex
    scope: docs
    purpose: Find DREAD scoring references
  - pattern: (priorit|rank|severity).*threat
    type: regex
    scope: docs
    purpose: Find threat prioritization
  - pattern: (high|medium|low|critical).*threat
    type: regex
    scope: docs
    purpose: Find threat severity ratings
  file_patterns:
  - glob: '**/threat*priorit*.{yaml,yml,json,md}'
    purpose: Threat prioritization files
  - glob: '**/DREAD*.{yaml,yml,json,md}'
    purpose: DREAD scoring files
knowledge_sources:
  specifications:
  - id: dread-model
    name: Microsoft DREAD Threat Model
    url: https://docs.microsoft.com/en-us/security/sdl/
    offline_cache: true
    priority: required
  - id: owasp-risk-rating
    name: OWASP Risk Rating Methodology
    url: https://owasp.org/www-community/OWASP_Risk_Rating_Methodology
    offline_cache: true
    priority: required
  guides:
  - id: threat-prioritization
    name: Threat Prioritization Best Practices
    url: https://www.microsoft.com/
    offline_cache: true
tooling:
  static_analysis:
  - tool: dread-calculator
    purpose: Calculate DREAD scores
    offline_capable: true
  scripts:
  - id: priority-scanner
    language: bash
    purpose: Scan for threat priorities
    source: inline
    code: |
      #!/bin/bash
      echo "=== Threat Priority Scan ==="
      grep -rniE "(DREAD|priority|severity).*threat" \
        --include="*.yaml" --include="*.md" . 2>/dev/null | head -30
signals:
  critical:
  - id: THRPRI-CRIT-001
    signal: No threat prioritization methodology
    evidence_indicators:
    - No prioritization criteria
    - Threats treated equally
    - Ad-hoc prioritization
    explanation: |
      Without methodology, prioritization is arbitrary. Systematic
      approaches ensure consistent, defensible prioritization.
    remediation: |
      - Define prioritization methodology
      - Use DREAD or equivalent
      - Document criteria
      - Apply consistently
  high:
  - id: THRPRI-HIGH-001
    signal: Prioritization not aligned with resources
    evidence_indicators:
    - High-priority threats not addressed
    - Resources on low-priority items
    - Misaligned investment
    explanation: |
      Prioritization should drive resource allocation. Misalignment
      wastes resources and leaves critical threats unaddressed.
    remediation: |
      - Align resources to priorities
      - Address high-priority threats first
      - Review allocation regularly
      - Justify low-priority investments
  - id: THRPRI-HIGH-002
    signal: Context not considered in prioritization
    evidence_indicators:
    - Generic prioritization
    - Business context ignored
    - Asset value not factored
    explanation: |
      Context affects threat relevance. Generic prioritization may
      not reflect organizational reality.
    remediation: |
      - Factor in business context
      - Consider asset values
      - Adjust for specific environment
      - Validate with stakeholders
  medium:
  - id: THRPRI-MED-001
    signal: Prioritization rationale not documented
    evidence_indicators:
    - Priorities without explanation
    - Cannot review decisions
    - No audit trail
    explanation: |
      Documented rationale supports review and learning. Without it,
      priorities cannot be validated or improved.
    remediation: |
      - Document prioritization rationale
      - Explain decisions
      - Enable review
      - Support audit
  - id: THRPRI-MED-002
    signal: Priorities not reviewed regularly
    evidence_indicators:
    - Stale priorities
    - No scheduled review
    - Unchanged despite changes
    explanation: |
      Priorities should evolve with threat landscape and business
      changes. Static priorities become inappropriate.
    remediation: |
      - Schedule priority reviews
      - Update with threat changes
      - Reflect business changes
      - Track priority evolution
  low:
  - id: THRPRI-LOW-001
    signal: No stakeholder input in prioritization
    evidence_indicators:
    - Security-only prioritization
    - Business not consulted
    - Limited perspectives
    explanation: |
      Stakeholder input ensures priorities reflect organizational
      needs and concerns.
    remediation: |
      - Include stakeholders
      - Gather business input
      - Validate priorities
      - Document consensus
  positive:
  - id: THRPRI-POS-001
    signal: Systematic threat prioritization
    evidence_indicators:
    - Defined methodology
    - DREAD or equivalent used
    - Context-aware
  - id: THRPRI-POS-002
    signal: Resource-aligned prioritization
    evidence_indicators:
    - Resources match priorities
    - High-priority addressed first
    - Regular review
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Methodology Review
    description: |
      Evaluate threat prioritization methodology.
    duration_estimate: 30 min
    commands:
    - purpose: Find prioritization methodology
      command: |
        find . -type f \( -name "*DREAD*" -o -name "*priorit*" \) \
          -exec grep -l -i "threat" {} \; 2>/dev/null | head -15
    - purpose: Search for prioritization criteria
      command: |
        grep -rniE "(DREAD|priorit|criteria).*threat" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -30
    expected_findings:
    - Methodology documentation
    - DREAD or equivalent
    - Criteria definitions
  - id: '2'
    name: Priority Assessment
    description: |
      Evaluate assigned threat priorities.
    duration_estimate: 30 min
    commands:
    - purpose: Find threat priorities
      command: |
        grep -rniE "(priority|severity|score)\\s*[=:]" \
          --include="*.yaml" --include="*.json" . 2>/dev/null | \
          grep -i "threat" | head -30
    - purpose: Check for rationale
      command: |
        grep -rniE "(rationale|reason|justify).*priority" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Priority assignments
    - Rationale documentation
    - Score calculations
  - id: '3'
    name: Alignment Review
    description: |
      Assess alignment with resources and context.
    duration_estimate: 30 min
    commands:
    - purpose: Check resource alignment
      command: |
        grep -rniE "(resource|budget|effort).*priority" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    - purpose: Find context consideration
      command: |
        grep -rniE "(context|business|asset).*priority" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Resource alignment
    - Context consideration
    - Business factors
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Methodology Assessment
    - Priority Analysis
    - Alignment Review
    - Recommendations
  - type: priority_matrix
    format: table
    description: Threat priority matrix
  confidence_guidance:
    high: Systematic prioritization aligned with resources
    medium: Prioritization exists but gaps in methodology or alignment
    low: Minimal or ad-hoc prioritization
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: dread-model
      priority: required
    - source_id: owasp-risk-rating
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires comprehensive prioritization review
    full:
      included: true
      priority: 2
    security:
      included: true
      priority: 2
closeout_checklist:
- id: thrpri-001
  item: Prioritization methodology defined
  level: CRITICAL
  verification: manual
  verification_notes: Verify documented methodology
  expected: Confirmed by reviewer
- id: thrpri-002
  item: Priorities aligned with resources
  level: BLOCKING
  verification: manual
  verification_notes: Verify resource alignment
  expected: Confirmed by reviewer
- id: thrpri-003
  item: Context considered
  level: BLOCKING
  verification: manual
  verification_notes: Verify context factors
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: Microsoft SDL
    controls:
    - DREAD
  - framework: OWASP
    controls:
    - Risk Rating
  - framework: NIST CSF
    controls:
    - ID.RA-5
relationships:
  commonly_combined:
  - risk-management.threat-modeling.threat-identification
  - risk-management.threat-modeling.countermeasure-mapping
  - risk-management.risk-assessment.risk-prioritization
