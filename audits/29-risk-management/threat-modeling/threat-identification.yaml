audit:
  id: risk-management.threat-modeling.threat-identification
  name: Threat Identification Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: risk-management
  category_number: 29
  subcategory: threat-modeling
  tier: phd
  estimated_duration: 3-4 hours  # median: 3h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: organizational
  default_profiles:
  - full
  - security
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines threat identification practices:
    - Threat actor identification and profiling
    - Threat event enumeration
    - Use of threat intelligence sources
    - STRIDE or other categorization frameworks
    - Threat scenario development
    - Documentation of identified threats
    - Coverage and completeness of threat identification
  why_it_matters: |
    Comprehensive threat identification is the foundation of threat modeling:
    - Cannot defend against threats you haven't identified
    - STRIDE provides systematic categorization (Spoofing, Tampering, etc.)
    - Threat actors inform attack capabilities and motivations
    - NIST emphasizes identifying threat sources and events
    - Incomplete identification leaves blind spots
    - Threat intelligence enhances identification with real-world data
    - Different systems face different threat landscapes
  when_to_run:
  - During threat modeling activities
  - When updating threat assessments
  - After significant security incidents
  - When threat landscape changes
  - Annual threat assessment review
prerequisites:
  required_artifacts:
  - type: threat_catalog
    description: Catalog of identified threats
  - type: threat_actors
    description: Threat actor profiles
  - type: threat_intelligence
    description: Threat intelligence feeds or reports
  access_requirements:
  - Access to threat documentation
  - Access to threat intelligence
  - Access to threat models
discovery:
  code_patterns:
  - pattern: (threat.actor|adversary|attacker)
    type: regex
    scope: docs
    purpose: Find threat actor references
  - pattern: (STRIDE|spoofing|tampering|repudiation|disclosure|denial|elevation)
    type: regex
    scope: docs
    purpose: Find STRIDE categorization
  - pattern: (threat.event|attack.scenario|threat.scenario)
    type: regex
    scope: docs
    purpose: Find threat scenario references
  file_patterns:
  - glob: '**/threat*.{yaml,yml,json,md}'
    purpose: Threat files
  - glob: '**/STRIDE*.{yaml,yml,json,md}'
    purpose: STRIDE analysis files
  - glob: '**/actor*.{yaml,yml,json,md}'
    purpose: Threat actor files
knowledge_sources:
  specifications:
  - id: stride-model
    name: Microsoft STRIDE Threat Model
    url: https://docs.microsoft.com/en-us/azure/security/develop/threat-modeling-tool-threats
    offline_cache: true
    priority: required
  - id: mitre-attack
    name: MITRE ATT&CK Framework
    url: https://attack.mitre.org/
    offline_cache: true
    priority: required
  guides:
  - id: threat-intelligence
    name: Threat Intelligence Best Practices
    url: https://www.sans.org/
    offline_cache: true
tooling:
  static_analysis:
  - tool: threat-scanner
    purpose: Identify potential threats
    offline_capable: true
  scripts:
  - id: threat-scanner
    language: bash
    purpose: Scan for threat documentation
    source: inline
    code: |
      #!/bin/bash
      echo "=== Threat Identification Scan ==="
      grep -rniE "(threat|actor|adversary|attack)" \
        --include="*.yaml" --include="*.md" . 2>/dev/null | head -30
signals:
  critical:
  - id: THRID-CRIT-001
    signal: No systematic threat identification performed
    evidence_indicators:
    - No documented threats
    - No threat enumeration process
    - Ad-hoc threat consideration
    explanation: |
      Without systematic identification, threats are missed. Structured
      approaches like STRIDE ensure comprehensive coverage of threat
      categories.
    remediation: |
      - Implement systematic threat identification
      - Use STRIDE or equivalent framework
      - Document all identified threats
      - Review for completeness
  - id: THRID-CRIT-002
    signal: Threat actors not identified or profiled
    evidence_indicators:
    - No threat actor analysis
    - Unknown who might attack
    - No attacker capability assessment
    explanation: |
      Understanding threat actors informs defense priorities. Different
      actors have different capabilities, motivations, and targets.
    remediation: |
      - Identify relevant threat actors
      - Profile actor capabilities and motivations
      - Map actors to potential threats
      - Use threat intelligence
  high:
  - id: THRID-HIGH-001
    signal: Threat intelligence not used
    evidence_indicators:
    - No threat intelligence sources
    - Threats identified in isolation
    - No real-world threat context
    explanation: |
      Threat intelligence provides real-world context for threat
      identification. Without it, threats may be theoretical rather
      than relevant.
    remediation: |
      - Integrate threat intelligence
      - Subscribe to relevant feeds
      - Apply intelligence to identification
      - Update threats based on intelligence
  - id: THRID-HIGH-002
    signal: STRIDE or equivalent not systematically applied
    evidence_indicators:
    - Missing threat categories
    - Incomplete STRIDE analysis
    - Some categories not considered
    explanation: |
      STRIDE ensures all threat categories are considered. Partial
      application misses threats in uncovered categories.
    remediation: |
      - Apply STRIDE completely
      - Check all categories
      - Document threats per category
      - Review for gaps
  medium:
  - id: THRID-MED-001
    signal: Threat scenarios not developed
    evidence_indicators:
    - Individual threats only
    - No attack scenarios
    - Missing end-to-end analysis
    explanation: |
      Threat scenarios describe how attacks unfold. They provide
      context for understanding attack chains and impact.
    remediation: |
      - Develop threat scenarios
      - Describe attack sequences
      - Map to kill chains
      - Consider combinations
  - id: THRID-MED-002
    signal: Threats not mapped to assets
    evidence_indicators:
    - Generic threat lists
    - No asset-threat mapping
    - Unclear what is threatened
    explanation: |
      Threats are relevant to specific assets. Mapping ensures
      understanding of what is at risk and enables prioritization.
    remediation: |
      - Map threats to assets
      - Identify threatened assets
      - Prioritize by asset value
      - Document relationships
  low:
  - id: THRID-LOW-001
    signal: Threats not regularly updated
    evidence_indicators:
    - Stale threat lists
    - No review of new threats
    - Unchanged despite landscape shifts
    explanation: |
      The threat landscape evolves continuously. Regular updates
      ensure threat identification remains current.
    remediation: |
      - Schedule threat reviews
      - Monitor for new threats
      - Update based on intelligence
      - Remove obsolete threats
  positive:
  - id: THRID-POS-001
    signal: Comprehensive threat identification
    evidence_indicators:
    - STRIDE systematically applied
    - Threat actors identified
    - Threat intelligence integrated
  - id: THRID-POS-002
    signal: Threat scenarios well-developed
    evidence_indicators:
    - Attack scenarios documented
    - Kill chains mapped
    - Asset mapping complete
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Threat Documentation Review
    description: |
      Evaluate documented threats and threat catalogs.
    duration_estimate: 45 min
    commands:
    - purpose: Find threat documentation
      command: |
        find . -type f \( -name "*threat*" -o -name "*actor*" \) \
          2>/dev/null | head -20
    - purpose: Search for threat enumeration
      command: |
        grep -rniE "(threat|attack|adversary)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -30
    expected_findings:
    - Threat documentation
    - Threat catalog
    - Actor profiles
  - id: '2'
    name: Framework Application
    description: |
      Assess application of STRIDE or equivalent frameworks.
    duration_estimate: 45 min
    commands:
    - purpose: Find STRIDE references
      command: |
        grep -rniE "(STRIDE|spoofing|tampering|repudiation|disclosure|denial|elevation)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -30
    - purpose: Check for all categories
      command: |
        for cat in spoofing tampering repudiation disclosure denial elevation; do
          echo "=== $cat ===" ; grep -rniE "$cat" --include="*.md" . 2>/dev/null | head -5
        done
    expected_findings:
    - STRIDE application
    - Category coverage
    - Systematic approach
  - id: '3'
    name: Threat Intelligence Assessment
    description: |
      Evaluate use of threat intelligence.
    duration_estimate: 30 min
    commands:
    - purpose: Find intelligence references
      command: |
        grep -rniE "(intelligence|mitre|att&ck|cti)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    - purpose: Check for intelligence integration
      command: |
        grep -rniE "(feed|source|indicator).*threat" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Intelligence sources
    - Integration evidence
    - CTI usage
  - id: '4'
    name: Scenario Review
    description: |
      Assess threat scenario development.
    duration_estimate: 30 min
    commands:
    - purpose: Find threat scenarios
      command: |
        grep -rniE "(scenario|attack.chain|kill.chain)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    - purpose: Check for asset mapping
      command: |
        grep -rniE "(asset|target|victim).*threat" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Threat scenarios
    - Attack chains
    - Asset mapping
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Threat Documentation Review
    - Framework Analysis
    - Intelligence Assessment
    - Recommendations
  - type: threat_inventory
    format: table
    description: Identified threats inventory
  confidence_guidance:
    high: Comprehensive identification with intelligence integration
    medium: Identification exists but gaps in coverage or intelligence
    low: Minimal or ad-hoc identification
offline:
  capability: partial
  cache_manifest:
    knowledge:
    - source_id: stride-model
      priority: required
    - source_id: mitre-attack
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires comprehensive threat review
    full:
      included: true
      priority: 2
    security:
      included: true
      priority: 1
closeout_checklist:
- id: thrid-001
  item: Threats systematically identified
  level: CRITICAL
  verification: manual
  verification_notes: Verify systematic approach
  expected: Confirmed by reviewer
- id: thrid-002
  item: STRIDE or equivalent applied
  level: CRITICAL
  verification: manual
  verification_notes: Verify framework application
  expected: Confirmed by reviewer
- id: thrid-003
  item: Threat actors identified
  level: BLOCKING
  verification: manual
  verification_notes: Verify actor identification
  expected: Confirmed by reviewer
- id: thrid-004
  item: Threat intelligence used
  level: WARNING
  verification: manual
  verification_notes: Check for intelligence integration
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: NIST CSF
    controls:
    - ID.RA-2
    - ID.RA-3
  - framework: MITRE ATT&CK
    controls:
    - Threat Identification
  - framework: SOC 2
    controls:
    - CC3.2
relationships:
  commonly_combined:
  - risk-management.threat-modeling.threat-model-methodology
  - risk-management.threat-modeling.attack-surface-analysis
  - risk-management.threat-modeling.threat-prioritization
