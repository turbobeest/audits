audit:
  id: risk-management.technical-risk.security-vulnerability-risk
  name: Security Vulnerability Risk Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: risk-management
  category_number: 29
  subcategory: technical-risk
  tier: phd
  estimated_duration: 4-5 hours  # median: 4h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: critical
  scope: organizational
  default_profiles:
  - full
  - security
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines security vulnerability risk management:
    - Vulnerability scanning and detection
    - Vulnerability assessment and prioritization
    - Patch management process
    - Remediation tracking and SLAs
    - Risk acceptance for vulnerabilities
    - Vulnerability metrics and reporting
    - Integration with risk management
  why_it_matters: |
    Security vulnerabilities are primary attack vectors:
    - Most breaches exploit known vulnerabilities
    - Vulnerability counts continue to grow
    - Patch delays create exposure windows
    - NIST and ISO require vulnerability management
    - Risk-based prioritization is essential
    - Compliance frameworks mandate timely patching
    - Zero-day risk requires rapid response capability
  when_to_run:
  - Quarterly vulnerability review
  - After security incidents
  - During compliance audits
  - When vulnerability posture questioned
  - After major scanning results
prerequisites:
  required_artifacts:
  - type: vulnerability_scans
    description: Vulnerability scan results
  - type: patch_policy
    description: Patch management policy
  - type: remediation_tracking
    description: Vulnerability remediation tracking
  access_requirements:
  - Access to vulnerability data
  - Access to patch management
  - Access to remediation tracking
discovery:
  code_patterns:
  - pattern: (vulnerability|CVE|patch|exploit)
    type: regex
    scope: docs
    purpose: Find vulnerability references
  - pattern: (CVSS|severity|critical).*vuln
    type: regex
    scope: docs
    purpose: Find vulnerability severity references
  - pattern: (remediat|fix|patch).*vuln
    type: regex
    scope: docs
    purpose: Find remediation references
  file_patterns:
  - glob: '**/vulnerability*.{yaml,yml,json,md}'
    purpose: Vulnerability documentation
  - glob: '**/patch*.{yaml,yml,json,md}'
    purpose: Patch documentation
  - glob: '**/cve*.{yaml,yml,json,md}'
    purpose: CVE tracking files
knowledge_sources:
  specifications:
  - id: nist-800-40
    name: NIST SP 800-40 Patch Management
    url: https://csrc.nist.gov/publications/detail/sp/800-40/rev-4/final
    offline_cache: true
    priority: required
  - id: iso-27001
    name: ISO/IEC 27001 Information Security
    url: https://www.iso.org/isoiec-27001-information-security.html
    offline_cache: true
    priority: required
  guides:
  - id: vuln-management
    name: Vulnerability Management Guide
    url: https://www.cisa.gov/
    offline_cache: true
tooling:
  static_analysis:
  - tool: vuln-analyzer
    purpose: Analyze vulnerability data
    offline_capable: true
  scripts:
  - id: vuln-scanner
    language: bash
    purpose: Scan for vulnerability tracking
    source: inline
    code: |
      #!/bin/bash
      echo "=== Security Vulnerability Risk Scan ==="
      grep -rniE "(vulnerability|CVE|patch|CVSS)" \
        --include="*.yaml" --include="*.md" . 2>/dev/null | head -30
signals:
  critical:
  - id: VULNRISK-CRIT-001
    signal: No vulnerability management program
    evidence_indicators:
    - No scanning
    - Vulnerabilities unknown
    - No management process
    explanation: |
      Without vulnerability management, the organization is
      unaware of and cannot address security vulnerabilities.
    remediation: |
      - Implement vulnerability scanning
      - Establish management process
      - Track vulnerabilities
      - Remediate based on risk
  - id: VULNRISK-CRIT-002
    signal: Critical vulnerabilities unpatched
    evidence_indicators:
    - Critical CVEs open
    - Exploited vulnerabilities
    - Long-standing exposure
    explanation: |
      Critical unpatched vulnerabilities are high-risk.
      Exploited vulnerabilities require immediate action.
    remediation: |
      - Identify critical vulnerabilities
      - Prioritize patching
      - Implement emergency procedures
      - Track to closure
  high:
  - id: VULNRISK-HIGH-001
    signal: Patch SLAs not met
    evidence_indicators:
    - Overdue patches
    - SLA breaches
    - Slow remediation
    explanation: |
      SLA breaches extend exposure windows. Timely patching
      is essential for risk reduction.
    remediation: |
      - Assess patching process
      - Remove obstacles
      - Enforce SLAs
      - Track compliance
  - id: VULNRISK-HIGH-002
    signal: Vulnerability prioritization not risk-based
    evidence_indicators:
    - All patches equal
    - No risk assessment
    - CVSS only
    explanation: |
      Risk-based prioritization considers context and exploitability.
      CVSS alone may not reflect actual risk.
    remediation: |
      - Implement risk-based prioritization
      - Consider exploitability
      - Factor in context
      - Align with threat intelligence
  medium:
  - id: VULNRISK-MED-001
    signal: Incomplete vulnerability coverage
    evidence_indicators:
    - Gaps in scanning
    - Systems not covered
    - Partial visibility
    explanation: |
      Complete coverage is needed to understand vulnerability
      posture. Gaps hide risks.
    remediation: |
      - Assess coverage gaps
      - Extend scanning
      - Include all systems
      - Validate completeness
  - id: VULNRISK-MED-002
    signal: Risk acceptance not documented
    evidence_indicators:
    - Exceptions informal
    - No approval
    - Acceptance not tracked
    explanation: |
      Documented risk acceptance enables oversight and
      ensures appropriate decisions.
    remediation: |
      - Formalize acceptance process
      - Require approval
      - Document rationale
      - Track expiration
  low:
  - id: VULNRISK-LOW-001
    signal: Vulnerability metrics not reported
    evidence_indicators:
    - No reporting
    - Posture unknown
    - No trending
    explanation: |
      Metrics enable understanding of vulnerability posture
      and effectiveness of management.
    remediation: |
      - Define metrics
      - Report regularly
      - Track trends
      - Enable decisions
  positive:
  - id: VULNRISK-POS-001
    signal: Mature vulnerability management
    evidence_indicators:
    - Comprehensive scanning
    - Risk-based prioritization
    - SLAs met
  - id: VULNRISK-POS-002
    signal: Strong security posture
    evidence_indicators:
    - Low critical count
    - Timely patching
    - Declining trends
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Program Review
    description: |
      Evaluate vulnerability management program.
    duration_estimate: 60 min
    commands:
    - purpose: Find vulnerability documentation
      command: |
        find . -type f \( -name "*vulnerability*" -o -name "*vuln*" \
          -o -name "*patch*" \) 2>/dev/null | head -20
    - purpose: Search for program documentation
      command: |
        grep -rniE "(vulnerability|vuln).*management\|program\|process" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -30
    expected_findings:
    - Program documentation
    - Process description
    - Scope coverage
  - id: '2'
    name: Scanning Review
    description: |
      Assess vulnerability scanning practices.
    duration_estimate: 45 min
    commands:
    - purpose: Find scanning documentation
      command: |
        grep -rniE "(scan|detect|assess).*vuln" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    - purpose: Check for coverage
      command: |
        grep -rniE "(coverage|scope|include).*scan" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Scanning approach
    - Coverage scope
    - Frequency
  - id: '3'
    name: Remediation Review
    description: |
      Evaluate remediation and patching process.
    duration_estimate: 45 min
    commands:
    - purpose: Find remediation documentation
      command: |
        grep -rniE "(remediat|patch|fix).*vuln\|CVE" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    - purpose: Check for SLAs
      command: |
        grep -rniE "(SLA|timeline|deadline).*patch\|remediat" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Remediation process
    - SLA definitions
    - Tracking mechanism
  - id: '4'
    name: Metrics Review
    description: |
      Assess vulnerability metrics and reporting.
    duration_estimate: 30 min
    commands:
    - purpose: Find metrics documentation
      command: |
        grep -rniE "(metric|report|KPI).*vuln" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Metrics defined
    - Reporting approach
    - Trending data
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Program Assessment
    - Scanning Review
    - Remediation Analysis
    - Recommendations
  - type: vulnerability_report
    format: table
    description: Vulnerability risk summary
  confidence_guidance:
    high: Mature vulnerability management with strong posture
    medium: Program exists but gaps in coverage or remediation
    low: Minimal or no vulnerability management
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: nist-800-40
      priority: required
    - source_id: iso-27001
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires comprehensive vulnerability review
    full:
      included: true
      priority: 1
    security:
      included: true
      priority: 1
closeout_checklist:
- id: vulnrisk-001
  item: Vulnerability management program exists
  level: CRITICAL
  verification: manual
  verification_notes: Verify program
  expected: Confirmed by reviewer
- id: vulnrisk-002
  item: Critical vulnerabilities addressed
  level: CRITICAL
  verification: manual
  verification_notes: Verify critical vulnerability status
  expected: Confirmed by reviewer
- id: vulnrisk-003
  item: Patch SLAs defined and met
  level: BLOCKING
  verification: manual
  verification_notes: Verify SLA compliance
  expected: Confirmed by reviewer
- id: vulnrisk-004
  item: Complete scanning coverage
  level: BLOCKING
  verification: manual
  verification_notes: Verify coverage
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: NIST 800-40
    controls:
    - All
  - framework: ISO 27001
    controls:
    - A.12.6
    - A.14.2
  - framework: PCI DSS
    controls:
    - Requirement 6
    - Requirement 11
  - framework: SOC 2
    controls:
    - CC6.1
    - CC7.1
relationships:
  commonly_combined:
  - risk-management.technical-risk.technology-obsolescence
  - risk-management.threat-modeling.threat-identification
  - risk-management.risk-mitigation.mitigation-effectiveness
