audit:
  id: risk-management.technical-risk.integration-risk
  name: Integration Risk Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: risk-management
  category_number: 29
  subcategory: technical-risk
  tier: phd
  estimated_duration: 4-5 hours  # median: 4h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: organizational
  default_profiles:
  - full
  - security
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines integration risk management:
    - Integration inventory and mapping
    - API dependency management
    - Third-party integration risks
    - Data exchange reliability
    - Integration failure handling
    - Version compatibility management
    - Integration security assessment
  why_it_matters: |
    Integrations create dependencies and failure points:
    - Failed integrations can cascade across systems
    - Third-party API changes can break functionality
    - Data inconsistency can result from integration failures
    - Security vulnerabilities can cross integration boundaries
    - ISO 31000 includes dependency risk
    - Modern architectures rely heavily on integrations
    - Integration failures impact user experience
  when_to_run:
  - Before major integrations
  - After integration failures
  - During architecture reviews
  - Quarterly risk assessments
  - When adding third-party dependencies
prerequisites:
  required_artifacts:
  - type: integration_inventory
    description: Inventory of integrations
  - type: api_documentation
    description: API documentation
  - type: dependency_map
    description: System dependency mapping
  access_requirements:
  - Access to integration documentation
  - Access to API specifications
  - Access to monitoring data
discovery:
  code_patterns:
  - pattern: (integration|API|interface).*risk
    type: regex
    scope: docs
    purpose: Find integration risk references
  - pattern: (dependency|third.party|external)
    type: regex
    scope: docs
    purpose: Find dependency references
  - pattern: (webhook|callback|sync)
    type: regex
    scope: config
    purpose: Find integration configuration
  file_patterns:
  - glob: '**/integration*.{yaml,yml,json,md}'
    purpose: Integration documentation
  - glob: '**/api*.{yaml,yml,json,md}'
    purpose: API documentation
  - glob: '**/dependency*.{yaml,yml,json,md}'
    purpose: Dependency documentation
knowledge_sources:
  specifications:
  - id: iso-31000
    name: ISO 31000 Risk Management
    url: https://www.iso.org/iso-31000-risk-management.html
    offline_cache: true
    priority: required
  - id: api-security
    name: OWASP API Security
    url: https://owasp.org/www-project-api-security/
    offline_cache: true
    priority: required
  guides:
  - id: integration-guide
    name: Integration Best Practices
    url: https://www.mulesoft.com/
    offline_cache: true
tooling:
  static_analysis:
  - tool: dependency-analyzer
    purpose: Analyze integration dependencies
    offline_capable: true
  scripts:
  - id: integration-scanner
    language: bash
    purpose: Scan for integration configuration
    source: inline
    code: |
      #!/bin/bash
      echo "=== Integration Risk Scan ==="
      grep -rniE "(integration|API|endpoint|webhook)" \
        --include="*.yaml" --include="*.json" . 2>/dev/null | head -30
signals:
  critical:
  - id: INTRISK-CRIT-001
    signal: Critical integrations not documented
    evidence_indicators:
    - Unknown integrations
    - No inventory
    - Undocumented dependencies
    explanation: |
      Unknown integrations cannot be managed or monitored.
      Failures are unexpected and recovery is delayed.
    remediation: |
      - Inventory all integrations
      - Document dependencies
      - Map data flows
      - Assess criticality
  - id: INTRISK-CRIT-002
    signal: No failure handling for critical integrations
    evidence_indicators:
    - No error handling
    - Failures cascade
    - No fallback
    explanation: |
      Without failure handling, integration failures cascade
      to affect dependent systems and users.
    remediation: |
      - Implement error handling
      - Add circuit breakers
      - Create fallback logic
      - Test failure scenarios
  high:
  - id: INTRISK-HIGH-001
    signal: Third-party API dependencies unmanaged
    evidence_indicators:
    - No version pinning
    - Changes not monitored
    - No deprecation tracking
    explanation: |
      Third-party API changes can break integrations.
      Proactive management prevents surprises.
    remediation: |
      - Track API versions
      - Monitor for changes
      - Test compatibility
      - Plan for deprecations
  - id: INTRISK-HIGH-002
    signal: Integration security not assessed
    evidence_indicators:
    - No security review
    - Unknown data exposure
    - Authentication gaps
    explanation: |
      Integrations can expose data and create attack vectors.
      Security assessment identifies and addresses risks.
    remediation: |
      - Assess integration security
      - Review authentication
      - Verify data protection
      - Test security controls
  medium:
  - id: INTRISK-MED-001
    signal: Integration monitoring insufficient
    evidence_indicators:
    - No monitoring
    - Failures undetected
    - Limited visibility
    explanation: |
      Monitoring enables rapid detection and response
      to integration issues.
    remediation: |
      - Implement monitoring
      - Alert on failures
      - Track performance
      - Enable visibility
  - id: INTRISK-MED-002
    signal: No integration SLAs defined
    evidence_indicators:
    - No performance targets
    - Expectations unclear
    - No accountability
    explanation: |
      SLAs set expectations and enable accountability
      for integration performance.
    remediation: |
      - Define SLAs
      - Agree with stakeholders
      - Monitor compliance
      - Address violations
  low:
  - id: INTRISK-LOW-001
    signal: Integration documentation outdated
    evidence_indicators:
    - Stale documentation
    - Changes not reflected
    - Inaccurate specs
    explanation: |
      Current documentation supports troubleshooting
      and onboarding.
    remediation: |
      - Update documentation
      - Track changes
      - Automate where possible
      - Review regularly
  positive:
  - id: INTRISK-POS-001
    signal: Mature integration management
    evidence_indicators:
    - Complete inventory
    - Robust monitoring
    - Effective failure handling
  - id: INTRISK-POS-002
    signal: Secure integrations
    evidence_indicators:
    - Security assessed
    - Controls in place
    - Regular review
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Integration Inventory
    description: |
      Review integration inventory and documentation.
    duration_estimate: 60 min
    commands:
    - purpose: Find integration documentation
      command: |
        find . -type f \( -name "*integration*" -o -name "*api*" \
          -o -name "*interface*" \) 2>/dev/null | head -30
    - purpose: Search for integration configuration
      command: |
        grep -rniE "(endpoint|webhook|callback|api)" \
          --include="*.yaml" --include="*.json" . 2>/dev/null | head -30
    expected_findings:
    - Integration inventory
    - API documentation
    - Configuration
  - id: '2'
    name: Dependency Assessment
    description: |
      Assess third-party and external dependencies.
    duration_estimate: 45 min
    commands:
    - purpose: Find dependency documentation
      command: |
        grep -rniE "(dependency|third.party|external)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    - purpose: Check for version tracking
      command: |
        grep -rniE "(version|deprecat|EOL).*api\|integration" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Dependency list
    - Version tracking
    - Deprecation awareness
  - id: '3'
    name: Reliability Review
    description: |
      Evaluate integration reliability and failure handling.
    duration_estimate: 45 min
    commands:
    - purpose: Find reliability documentation
      command: |
        grep -rniE "(circuit.breaker|retry|fallback|timeout)" \
          --include="*.yaml" --include="*.json" . 2>/dev/null | head -20
    - purpose: Check for monitoring
      command: |
        grep -rniE "(monitor|alert|health).*integration\|api" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Failure handling
    - Monitoring configuration
    - Reliability patterns
  - id: '4'
    name: Security Review
    description: |
      Assess integration security.
    duration_estimate: 30 min
    commands:
    - purpose: Find security documentation
      command: |
        grep -rniE "(auth|security|encrypt).*integration\|api" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    expected_findings:
    - Security configuration
    - Authentication approach
    - Data protection
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Integration Inventory
    - Dependency Assessment
    - Reliability Review
    - Recommendations
  - type: integration_matrix
    format: table
    description: Integration risk matrix
  confidence_guidance:
    high: Mature integration management with robust monitoring
    medium: Integrations documented but gaps in reliability or security
    low: Integrations poorly managed or undocumented
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: iso-31000
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires comprehensive integration review
    full:
      included: true
      priority: 2
    security:
      included: true
      priority: 2
closeout_checklist:
- id: intrisk-001
  item: Integrations inventoried
  level: CRITICAL
  verification: manual
  verification_notes: Verify integration inventory
  expected: Confirmed by reviewer
- id: intrisk-002
  item: Failure handling implemented
  level: CRITICAL
  verification: manual
  verification_notes: Verify failure handling
  expected: Confirmed by reviewer
- id: intrisk-003
  item: Integration security assessed
  level: BLOCKING
  verification: manual
  verification_notes: Verify security assessment
  expected: Confirmed by reviewer
- id: intrisk-004
  item: Monitoring in place
  level: BLOCKING
  verification: manual
  verification_notes: Verify monitoring
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: ISO 31000
    controls:
    - Clause 5
    - Clause 6
  - framework: OWASP API Security
    controls:
    - All
  - framework: SOC 2
    controls:
    - CC6.1
    - CC7.2
relationships:
  commonly_combined:
  - risk-management.technical-risk.performance-risk
  - risk-management.risk-identification.dependency-risks
  - risk-management.technical-risk.security-vulnerability-risk
