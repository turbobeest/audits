audit:
  id: risk-management.risk-mitigation.mitigation-effectiveness
  name: Mitigation Effectiveness Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: risk-management
  category_number: 29
  subcategory: risk-mitigation
  tier: phd
  estimated_duration: 4-5 hours  # median: 4h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: organizational
  default_profiles:
  - full
  - security
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines how mitigation effectiveness is measured:
    - Effectiveness metrics and key performance indicators
    - Control testing and validation approaches
    - Expected vs. actual risk reduction measurement
    - Continuous monitoring of control performance
    - Reassessment of ineffective treatments
    - Documentation of effectiveness evidence
    - Feedback loops for treatment improvement
  why_it_matters: |
    Measuring effectiveness ensures risk treatment provides value:
    - Treatments that do not work waste resources and leave risk unaddressed
    - ISO 31000 requires monitoring and review of treatment effectiveness
    - NIST emphasizes continuous monitoring of security control effectiveness
    - Control testing reveals whether expected protection is achieved
    - Ineffective treatments require reassessment and adjustment
    - Cost-benefit of treatment depends on actual effectiveness
    - Regulatory compliance often requires demonstrating control effectiveness
  when_to_run:
  - After treatment implementation
  - Regular control testing cycles
  - Annual effectiveness reviews
  - When control failures occur
  - During compliance audits
prerequisites:
  required_artifacts:
  - type: control_tests
    description: Control testing results
  - type: effectiveness_metrics
    description: Effectiveness KPIs and measurements
  - type: treatment_plans
    description: Risk treatment plans with expected outcomes
  access_requirements:
  - Access to control testing results
  - Access to effectiveness metrics
  - Access to treatment documentation
discovery:
  code_patterns:
  - pattern: (effectiveness|efficacy|performance).*control
    type: regex
    scope: docs
    purpose: Find effectiveness references
  - pattern: (test|validation|verification).*control
    type: regex
    scope: docs
    purpose: Find control testing references
  - pattern: (kpi|metric|measure).*risk.*reduction
    type: regex
    scope: docs
    purpose: Find effectiveness metrics
  file_patterns:
  - glob: '**/control*test*.{yaml,yml,json,md}'
    purpose: Control test files
  - glob: '**/effectiveness*.{yaml,yml,json,md}'
    purpose: Effectiveness files
  - glob: '**/control*monitor*.{yaml,yml,json,md}'
    purpose: Control monitoring files
knowledge_sources:
  specifications:
  - id: iso-31000-2018
    name: ISO 31000:2018 Risk Management
    url: https://www.iso.org/iso-31000-risk-management.html
    offline_cache: true
    priority: required
  - id: nist-800-53a
    name: NIST SP 800-53A Assessment Procedures
    url: https://csrc.nist.gov/publications/detail/sp/800-53a/rev-5/final
    offline_cache: true
    priority: recommended
  guides:
  - id: control-effectiveness
    name: Control Effectiveness Measurement Guide
    url: https://www.theiia.org/
    offline_cache: true
tooling:
  static_analysis:
  - tool: effectiveness-analyzer
    purpose: Analyze control effectiveness data
    offline_capable: true
  scripts:
  - id: effectiveness-scanner
    language: bash
    purpose: Scan for effectiveness metrics
    source: inline
    code: |
      #!/bin/bash
      echo "=== Effectiveness Metrics Scan ==="
      grep -rniE "(effectiveness|efficacy|performance)\\s*[=:]" \
        --include="*.yaml" --include="*.json" . 2>/dev/null | head -30
signals:
  critical:
  - id: MITEFF-CRIT-001
    signal: No mitigation effectiveness measurement
    evidence_indicators:
    - No effectiveness metrics defined
    - No control testing performed
    - Treatment success assumed without verification
    explanation: |
      Without effectiveness measurement, organizations do not know if
      treatments work. ISO 31000 requires monitoring and reviewing the
      effectiveness of risk treatment.
    remediation: |
      - Define effectiveness metrics for treatments
      - Implement control testing program
      - Measure actual risk reduction
      - Track effectiveness over time
  - id: MITEFF-CRIT-002
    signal: Controls known to be ineffective remain in place
    evidence_indicators:
    - Failed control tests not addressed
    - Known ineffective controls still relied upon
    - No remediation of failing controls
    explanation: |
      Relying on known ineffective controls provides false assurance.
      Controls that fail testing must be remediated or replaced.
    remediation: |
      - Remediate failing controls immediately
      - Escalate persistent failures
      - Update risk assessment for control weakness
      - Plan alternative treatments
  high:
  - id: MITEFF-HIGH-001
    signal: Control testing infrequent or absent
    evidence_indicators:
    - No regular control testing schedule
    - Testing only during audits
    - Long gaps between tests
    explanation: |
      Regular testing ensures controls remain effective over time.
      Infrequent testing allows control degradation to go undetected.
    remediation: |
      - Establish regular testing schedule
      - Implement continuous control monitoring
      - Test critical controls more frequently
      - Document testing cadence
  - id: MITEFF-HIGH-002
    signal: Expected vs. actual effectiveness not compared
    evidence_indicators:
    - Treatment expected outcomes not documented
    - No comparison to actual results
    - Cannot assess treatment value
    explanation: |
      Comparing expected to actual effectiveness reveals whether
      treatments delivered anticipated risk reduction. This enables
      learning and improvement.
    remediation: |
      - Document expected treatment outcomes
      - Measure actual risk reduction
      - Compare and analyze variance
      - Adjust expectations and plans
  medium:
  - id: MITEFF-MED-001
    signal: Effectiveness metrics not defined for treatments
    evidence_indicators:
    - No KPIs for treatment effectiveness
    - Effectiveness subjectively assessed
    - No quantifiable measures
    explanation: |
      Defined metrics enable objective effectiveness assessment.
      Without metrics, effectiveness judgments are inconsistent.
    remediation: |
      - Define effectiveness KPIs for each treatment
      - Include leading and lagging indicators
      - Make metrics measurable
      - Track and report regularly
  - id: MITEFF-MED-002
    signal: Ineffective treatments not reassessed
    evidence_indicators:
    - No reassessment when effectiveness low
    - Same treatment continues despite failure
    - No alternative approaches considered
    explanation: |
      Ineffective treatments require reassessment and potential
      replacement. Continuing ineffective treatment wastes resources
      and leaves risk unaddressed.
    remediation: |
      - Trigger reassessment for ineffective treatments
      - Consider alternative approaches
      - Update treatment plans
      - Document reassessment decisions
  low:
  - id: MITEFF-LOW-001
    signal: Effectiveness results not communicated
    evidence_indicators:
    - Limited visibility of effectiveness data
    - No effectiveness reporting
    - Risk owners unaware of control performance
    explanation: |
      Communicating effectiveness enables informed decisions and
      supports accountability for control performance.
    remediation: |
      - Report effectiveness to stakeholders
      - Include in risk reporting
      - Share with control and risk owners
      - Enable continuous improvement
  positive:
  - id: MITEFF-POS-001
    signal: Robust effectiveness measurement program
    evidence_indicators:
    - Defined metrics and KPIs
    - Regular control testing
    - Expected vs. actual comparison
  - id: MITEFF-POS-002
    signal: Continuous improvement from effectiveness data
    evidence_indicators:
    - Ineffective treatments reassessed
    - Feedback loop in place
    - Effectiveness improvements tracked
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Metrics Review
    description: |
      Evaluate defined effectiveness metrics and KPIs.
    duration_estimate: 45 min
    commands:
    - purpose: Find effectiveness metrics
      command: |
        find . -type f \( -name "*effectiveness*" -o -name "*metric*" \
          -o -name "*kpi*" \) -exec grep -l -i "control\|risk" {} \; 2>/dev/null | head -15
    - purpose: Search for performance indicators
      command: |
        grep -rniE "(kpi|metric|indicator|measure).*effect" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -30
    expected_findings:
    - Effectiveness metrics
    - KPI definitions
    - Performance measures
  - id: '2'
    name: Control Testing Review
    description: |
      Assess control testing practices and results.
    duration_estimate: 45 min
    commands:
    - purpose: Find control testing documentation
      command: |
        find . -type f \( -name "*control*test*" -o -name "*validation*" \) \
          2>/dev/null | head -15
    - purpose: Search for test results
      command: |
        grep -rniE "(test|validation)\\s*(result|status|pass|fail)" \
          --include="*.yaml" --include="*.json" . 2>/dev/null | head -30
    expected_findings:
    - Testing documentation
    - Test results
    - Testing schedule
  - id: '3'
    name: Expected vs. Actual Analysis
    description: |
      Evaluate comparison of expected to actual effectiveness.
    duration_estimate: 45 min
    commands:
    - purpose: Search for expected outcomes
      command: |
        grep -rniE "(expected|target|planned).*reduction" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    - purpose: Find actual results
      command: |
        grep -rniE "(actual|achieved|realized).*reduction" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Expected outcomes documented
    - Actual results recorded
    - Variance analysis
  - id: '4'
    name: Continuous Improvement Review
    description: |
      Assess feedback loops and improvement from effectiveness data.
    duration_estimate: 30 min
    commands:
    - purpose: Find improvement references
      command: |
        grep -rniE "(improve|enhance|optimize).*effectiveness" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    - purpose: Search for reassessment triggers
      command: |
        grep -rniE "(reassess|review|update).*ineffective" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Improvement processes
    - Feedback mechanisms
    - Reassessment triggers
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Metrics Assessment
    - Control Testing Review
    - Effectiveness Analysis
    - Recommendations
  - type: effectiveness_report
    format: table
    description: Control effectiveness summary
  confidence_guidance:
    high: Comprehensive effectiveness measurement with testing
    medium: Some measurement but gaps in testing or analysis
    low: Minimal or no effectiveness measurement
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: iso-31000-2018
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires comprehensive effectiveness review
    full:
      included: true
      priority: 2
    security:
      included: true
      priority: 2
closeout_checklist:
- id: miteff-001
  item: Effectiveness metrics defined
  level: CRITICAL
  verification: manual
  verification_notes: Verify KPIs for treatment effectiveness
  expected: Confirmed by reviewer
- id: miteff-002
  item: Regular control testing performed
  level: CRITICAL
  verification: manual
  verification_notes: Verify testing schedule and results
  expected: Confirmed by reviewer
- id: miteff-003
  item: Expected vs. actual compared
  level: BLOCKING
  verification: manual
  verification_notes: Verify effectiveness comparison
  expected: Confirmed by reviewer
- id: miteff-004
  item: Ineffective treatments reassessed
  level: BLOCKING
  verification: manual
  verification_notes: Verify reassessment for failures
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: ISO 31000
    controls:
    - Clause 6.6
    - Clause 6.7
  - framework: NIST 800-53A
    controls:
    - Assessment Procedures
  - framework: COBIT 2019
    controls:
    - MEA01
    - APO12.05
  - framework: SOC 2
    controls:
    - CC4.1
    - CC4.2
relationships:
  commonly_combined:
  - risk-management.risk-mitigation.residual-risk-assessment
  - risk-management.risk-monitoring.key-risk-indicators
  - risk-management.risk-monitoring.risk-monitoring-process
