audit:
  id: risk-management.risk-mitigation.residual-risk-assessment
  name: Residual Risk Assessment Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: risk-management
  category_number: 29
  subcategory: risk-mitigation
  tier: phd
  estimated_duration: 3-4 hours  # median: 3h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: organizational
  default_profiles:
  - full
  - security
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines residual risk assessment practices:
    - Estimation of remaining risk after treatment
    - Comparison of residual risk to tolerance
    - Documentation of residual risk acceptance
    - Re-assessment after treatment implementation
    - Secondary risk identification from treatments
    - Residual risk monitoring requirements
    - Escalation of residual risk above tolerance
  why_it_matters: |
    Understanding residual risk is essential for informed risk decisions:
    - No treatment eliminates risk entirely; residual risk always remains
    - ISO 31000 requires assessing residual risk and determining if tolerable
    - Residual risk above tolerance may require additional treatment
    - Treatments can introduce secondary risks requiring assessment
    - Risk owners must formally accept residual risk
    - Regulatory compliance often requires documented residual risk acceptance
    - Without residual assessment, true risk exposure remains unknown
  when_to_run:
  - After treatment implementation
  - During risk acceptance reviews
  - Annual risk assessment updates
  - When residual risk approaches tolerance
  - During compliance audits
prerequisites:
  required_artifacts:
  - type: risk_register
    description: Risk register with inherent and residual scores
  - type: treatment_evidence
    description: Evidence of treatment implementation
  - type: acceptance_records
    description: Risk acceptance documentation
  access_requirements:
  - Access to risk register
  - Access to treatment implementation evidence
  - Access to acceptance records
discovery:
  code_patterns:
  - pattern: (residual|remaining|net).*risk
    type: regex
    scope: docs
    purpose: Find residual risk references
  - pattern: (accept|approval|sign.off).*residual
    type: regex
    scope: docs
    purpose: Find residual acceptance references
  - pattern: (secondary|new|additional).*risk.*treatment
    type: regex
    scope: docs
    purpose: Find secondary risk references
  file_patterns:
  - glob: '**/residual*risk*.{yaml,yml,json,md}'
    purpose: Residual risk files
  - glob: '**/risk*acceptance*.{yaml,yml,json,md}'
    purpose: Risk acceptance files
knowledge_sources:
  specifications:
  - id: iso-31000-2018
    name: ISO 31000:2018 Risk Management
    url: https://www.iso.org/iso-31000-risk-management.html
    offline_cache: true
    priority: required
  - id: nist-800-37
    name: NIST SP 800-37 Risk Management Framework
    url: https://csrc.nist.gov/publications/detail/sp/800-37/rev-2/final
    offline_cache: true
    priority: recommended
  guides:
  - id: residual-risk
    name: Residual Risk Management Guide
    url: https://www.theiia.org/
    offline_cache: true
tooling:
  static_analysis:
  - tool: residual-analyzer
    purpose: Analyze residual risk levels
    offline_capable: true
  scripts:
  - id: residual-scanner
    language: bash
    purpose: Scan for residual risk assessments
    source: inline
    code: |
      #!/bin/bash
      echo "=== Residual Risk Scan ==="
      grep -rniE "(residual|remaining)\\s*(risk|score|rating)" \
        --include="*.yaml" --include="*.json" . 2>/dev/null | head -30
signals:
  critical:
  - id: RESRISK-CRIT-001
    signal: No residual risk assessment performed
    evidence_indicators:
    - Only inherent risk assessed
    - No post-treatment assessment
    - Residual risk unknown
    explanation: |
      Without residual risk assessment, organizations do not know their
      actual exposure after treatment. ISO 31000 requires assessing
      residual risk to determine if it is tolerable.
    remediation: |
      - Assess residual risk for all treated risks
      - Document post-treatment risk levels
      - Compare residual to tolerance
      - Update risk register with residual scores
  - id: RESRISK-CRIT-002
    signal: Residual risk above tolerance not escalated
    evidence_indicators:
    - Residual exceeds tolerance
    - No escalation documented
    - No additional treatment planned
    explanation: |
      Residual risk exceeding tolerance requires escalation and action.
      Operating with known unacceptable risk levels exposes the
      organization without appropriate oversight.
    remediation: |
      - Escalate residual risk above tolerance
      - Plan additional treatment or accept with authorization
      - Document escalation and decisions
      - Monitor closely
  high:
  - id: RESRISK-HIGH-001
    signal: Residual risk not formally accepted
    evidence_indicators:
    - No documented acceptance
    - Risk owners have not signed off
    - Acceptance authority unclear
    explanation: |
      Residual risk represents accepted exposure that should be formally
      acknowledged. Without acceptance, accountability for remaining
      risk is unclear.
    remediation: |
      - Require formal acceptance of residual risk
      - Document risk owner sign-off
      - Define acceptance authority levels
      - Maintain acceptance records
  - id: RESRISK-HIGH-002
    signal: Secondary risks from treatments not assessed
    evidence_indicators:
    - Treatments may introduce new risks
    - No secondary risk analysis
    - New vulnerabilities not considered
    explanation: |
      Risk treatments can introduce new risks (secondary risks) that
      must be assessed. Ignoring secondary risks means incomplete
      understanding of post-treatment exposure.
    remediation: |
      - Assess secondary risks from treatments
      - Document new risks introduced
      - Include secondary risks in risk register
      - Balance primary and secondary risk
  medium:
  - id: RESRISK-MED-001
    signal: Residual assessment not updated after treatment
    evidence_indicators:
    - Stale residual assessments
    - No reassessment after control changes
    - Residual scores unchanged despite treatment
    explanation: |
      Residual risk should be reassessed when treatments are implemented
      or controls change. Stale assessments do not reflect current exposure.
    remediation: |
      - Reassess residual after treatment completion
      - Update when controls change
      - Track treatment effectiveness
      - Maintain current residual scores
  - id: RESRISK-MED-002
    signal: Control effectiveness not factored
    evidence_indicators:
    - Residual assumes perfect controls
    - No control testing integrated
    - Control failures not reflected
    explanation: |
      Residual risk depends on control effectiveness. Assuming controls
      work perfectly overstates protection and understates residual.
    remediation: |
      - Factor control effectiveness into residual
      - Integrate control testing results
      - Adjust residual for control weaknesses
      - Monitor control performance
  low:
  - id: RESRISK-LOW-001
    signal: Residual risk not communicated
    evidence_indicators:
    - Stakeholders unaware of residual risk
    - No residual risk reporting
    - Limited visibility
    explanation: |
      Stakeholders should understand residual risk to make informed
      decisions. Communication supports accountability and oversight.
    remediation: |
      - Report residual risk to stakeholders
      - Include in risk reporting
      - Communicate to risk owners
      - Enable informed decisions
  positive:
  - id: RESRISK-POS-001
    signal: Comprehensive residual risk management
    evidence_indicators:
    - Residual assessed for all risks
    - Compared to tolerance
    - Formally accepted
  - id: RESRISK-POS-002
    signal: Dynamic residual assessment
    evidence_indicators:
    - Updated after treatment
    - Control effectiveness factored
    - Secondary risks assessed
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Residual Assessment Review
    description: |
      Verify that residual risk is assessed for treated risks.
    duration_estimate: 45 min
    commands:
    - purpose: Find residual risk assessments
      command: |
        grep -rniE "(residual|remaining|net)\\s*(risk|score)" \
          --include="*.yaml" --include="*.json" --include="*.csv" . 2>/dev/null | head -30
    - purpose: Search for post-treatment assessment
      command: |
        grep -rniE "(post.treatment|after.*control|current).*risk" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    expected_findings:
    - Residual risk scores
    - Post-treatment assessments
    - Current risk levels
  - id: '2'
    name: Tolerance Comparison
    description: |
      Assess how residual risk is compared to tolerance.
    duration_estimate: 30 min
    commands:
    - purpose: Search for tolerance comparison
      command: |
        grep -rniE "(residual|remaining).*tolerance" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    - purpose: Find exceedance handling
      command: |
        grep -rniE "(exceed|above|over).*tolerance.*residual" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Tolerance comparison
    - Exceedance handling
    - Within/above tolerance status
  - id: '3'
    name: Acceptance Documentation Review
    description: |
      Evaluate residual risk acceptance documentation.
    duration_estimate: 30 min
    commands:
    - purpose: Find acceptance documentation
      command: |
        find . -type f -name "*accept*" -exec grep -l -i "risk" {} \; \
          2>/dev/null | head -15
    - purpose: Search for sign-off references
      command: |
        grep -rniE "(accept|approv|sign.off).*residual" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    expected_findings:
    - Acceptance records
    - Sign-off documentation
    - Authorization evidence
  - id: '4'
    name: Secondary Risk Assessment
    description: |
      Verify that secondary risks from treatments are assessed.
    duration_estimate: 30 min
    commands:
    - purpose: Find secondary risk references
      command: |
        grep -rniE "(secondary|new|additional|introduce).*risk" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    - purpose: Check for treatment side effects
      command: |
        grep -rniE "treatment.*(create|cause|introduce).*risk" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Secondary risk consideration
    - Treatment side effects
    - New risk assessment
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Residual Assessment Review
    - Tolerance Analysis
    - Acceptance Documentation
    - Recommendations
  - type: residual_analysis
    format: table
    description: Residual risk levels and tolerance comparison
  confidence_guidance:
    high: Comprehensive residual assessment with acceptance
    medium: Residual assessed but gaps in acceptance or tolerance
    low: Minimal or no residual assessment
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: iso-31000-2018
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires comprehensive residual review
    full:
      included: true
      priority: 2
    security:
      included: true
      priority: 2
closeout_checklist:
- id: resrisk-001
  item: Residual risk assessed for all treated risks
  level: CRITICAL
  verification: manual
  verification_notes: Verify residual assessments exist
  expected: Confirmed by reviewer
- id: resrisk-002
  item: Residual compared to tolerance
  level: CRITICAL
  verification: manual
  verification_notes: Verify tolerance comparison
  expected: Confirmed by reviewer
- id: resrisk-003
  item: Residual risk formally accepted
  level: BLOCKING
  verification: manual
  verification_notes: Verify acceptance documentation
  expected: Confirmed by reviewer
- id: resrisk-004
  item: Secondary risks assessed
  level: WARNING
  verification: manual
  verification_notes: Check for secondary risk consideration
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: ISO 31000
    controls:
    - Clause 6.5.3
  - framework: NIST 800-37
    controls:
    - 3.2 Authorize
  - framework: COBIT 2019
    controls:
    - APO12.05
  - framework: SOC 2
    controls:
    - CC3.2
relationships:
  commonly_combined:
  - risk-management.risk-mitigation.mitigation-effectiveness
  - risk-management.risk-mitigation.risk-acceptance-criteria
  - risk-management.risk-assessment.risk-tolerance-alignment
