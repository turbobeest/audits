audit:
  id: risk-management.risk-identification.historical-risk-analysis
  name: Historical Risk Analysis Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: risk-management
  category_number: 29
  subcategory: risk-identification
  tier: phd
  estimated_duration: 3-4 hours  # median: 3h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: organizational
  default_profiles:
  - full
  - security
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines how historical data informs risk identification:
    - Analysis of past incidents and near-misses
    - Lessons learned documentation and application
    - Trend analysis of risk materializations
    - Root cause analysis practices
    - Industry incident and breach analysis
    - Historical risk data retention and accessibility
    - Feedback loops from risk events to identification
  why_it_matters: |
    Historical data provides valuable insights for risk identification:
    - Past incidents reveal actual vulnerabilities and threat patterns
    - Organizations that learn from history avoid repeating mistakes
    - NIST emphasizes using threat intelligence including historical data
    - Root cause analysis identifies systemic issues requiring attention
    - Industry incidents provide lessons without experiencing them directly
    - ISO 31000 notes that risk criteria should be based on experience
    - According to IBM, organizations using lessons learned reduce repeat
      incidents by 30%
  when_to_run:
  - Annual risk management program review
  - Following significant incidents
  - During lessons learned retrospectives
  - When updating risk identification processes
  - After reviewing industry incident reports
prerequisites:
  required_artifacts:
  - type: incident_records
    description: Historical incident and event records
  - type: lessons_learned
    description: Lessons learned documentation
  - type: root_cause_analyses
    description: Post-incident root cause analyses
  access_requirements:
  - Access to incident management system
  - Access to lessons learned repository
  - Access to historical risk data
discovery:
  code_patterns:
  - pattern: (historical|past|previous).*risk
    type: regex
    scope: docs
    purpose: Find historical risk references
  - pattern: (lessons.learned|retrospective|postmortem)
    type: regex
    scope: docs
    purpose: Find lessons learned documentation
  - pattern: (root.cause|rca|incident.analysis)
    type: regex
    scope: docs
    purpose: Find root cause analysis documentation
  file_patterns:
  - glob: '**/lessons*learned*.{yaml,yml,json,md}'
    purpose: Lessons learned files
  - glob: '**/postmortem*.{yaml,yml,json,md}'
    purpose: Postmortem files
  - glob: '**/incident*report*.{yaml,yml,json,md}'
    purpose: Incident report files
  - glob: '**/root*cause*.{yaml,yml,json,md}'
    purpose: Root cause analysis files
knowledge_sources:
  specifications:
  - id: iso-31000-2018
    name: ISO 31000:2018 Risk Management
    url: https://www.iso.org/iso-31000-risk-management.html
    offline_cache: true
    priority: required
  - id: nist-incident-handling
    name: NIST SP 800-61 Incident Handling
    url: https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final
    offline_cache: true
    priority: recommended
  guides:
  - id: root-cause-analysis
    name: Root Cause Analysis Best Practices
    url: https://asq.org/quality-resources/root-cause-analysis
    offline_cache: true
tooling:
  static_analysis:
  - tool: incident-analyzer
    purpose: Analyze incident patterns
    offline_capable: true
  scripts:
  - id: historical-scanner
    language: bash
    purpose: Scan for historical risk documentation
    source: inline
    code: |
      #!/bin/bash
      echo "=== Historical Risk Documentation Scan ==="
      find . -type f \( -name "*incident*" -o -name "*postmortem*" \
        -o -name "*lessons*" -o -name "*rca*" \) 2>/dev/null
signals:
  critical:
  - id: HISTRS-CRIT-001
    signal: No historical risk analysis performed
    evidence_indicators:
    - No lessons learned process
    - Incidents not analyzed for risk insights
    - Historical data not used in risk identification
    explanation: |
      Failing to analyze historical data means repeating preventable mistakes.
      ISO 31000 emphasizes learning from experience as a key principle.
      Organizations that ignore history are condemned to repeat it.
    remediation: |
      - Establish lessons learned process
      - Analyze past incidents for risk patterns
      - Incorporate historical insights into risk identification
      - Create feedback loop from incidents to risk register
  - id: HISTRS-CRIT-002
    signal: Critical incidents not documented or analyzed
    evidence_indicators:
    - Major incidents without postmortems
    - No root cause analysis for significant events
    - Incident data not retained
    explanation: |
      Significant incidents must be thoroughly analyzed to extract lessons
      and prevent recurrence. Without documentation and analysis, the
      organization loses valuable learning opportunities.
    remediation: |
      - Require postmortems for all significant incidents
      - Conduct thorough root cause analyses
      - Document incidents and analyses
      - Retain incident data for trend analysis
  high:
  - id: HISTRS-HIGH-001
    signal: Lessons learned not applied to risk identification
    evidence_indicators:
    - Documented lessons but unchanged processes
    - Risk register not updated after incidents
    - Same risks materializing repeatedly
    explanation: |
      Lessons learned have value only when applied. If documentation exists
      but risk identification remains unchanged, the organization continues
      to be exposed to known risks.
    remediation: |
      - Link lessons learned to risk register updates
      - Track action item completion from lessons learned
      - Verify risk identification process improvements
      - Monitor for repeat incidents
  - id: HISTRS-HIGH-002
    signal: Industry incidents not analyzed
    evidence_indicators:
    - No monitoring of industry incidents
    - No analysis of peer organization events
    - No benchmarking against industry risks
    explanation: |
      Industry incidents provide learning opportunities without experiencing
      them directly. Organizations that ignore peer experiences miss
      valuable insights for proactive risk identification.
    remediation: |
      - Monitor industry incident reports and disclosures
      - Analyze applicability to your organization
      - Update risk identification based on industry events
      - Participate in industry information sharing
  medium:
  - id: HISTRS-MED-001
    signal: Root cause analysis not consistently performed
    evidence_indicators:
    - RCA only for major incidents
    - Inconsistent analysis methodology
    - Root causes not fully explored
    explanation: |
      Consistent root cause analysis ensures that underlying issues are
      identified and addressed. Inconsistent application leads to
      incomplete understanding and continued exposure.
    remediation: |
      - Define criteria for when RCA is required
      - Standardize RCA methodology
      - Train staff on RCA techniques
      - Review RCA quality periodically
  - id: HISTRS-MED-002
    signal: Historical data not accessible for analysis
    evidence_indicators:
    - Scattered incident records
    - No centralized repository
    - Difficult to search historical data
    explanation: |
      Historical data must be accessible to be useful. If data is scattered
      or difficult to search, trend analysis and pattern identification
      become impractical.
    remediation: |
      - Centralize incident and event data
      - Implement searchable repository
      - Standardize data formats
      - Enable trend analysis capabilities
  low:
  - id: HISTRS-LOW-001
    signal: Trend analysis not performed
    evidence_indicators:
    - No aggregation of historical data
    - No pattern identification
    - No trend reporting
    explanation: |
      Trend analysis reveals patterns that individual incident analysis
      might miss. Aggregated views can identify systemic issues requiring
      strategic attention.
    remediation: |
      - Implement trend analysis capabilities
      - Generate periodic trend reports
      - Identify patterns across incidents
      - Use trends to inform risk identification
  positive:
  - id: HISTRS-POS-001
    signal: Robust lessons learned program
    evidence_indicators:
    - Consistent postmortem process
    - Lessons documented and shared
    - Actions tracked to completion
  - id: HISTRS-POS-002
    signal: Historical analysis integrated with risk identification
    evidence_indicators:
    - Risk register updated based on incidents
    - Trend analysis informs priorities
    - Industry incidents analyzed
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Lessons Learned Process Assessment
    description: |
      Evaluate the existence and maturity of lessons learned and
      post-incident analysis processes.
    duration_estimate: 45 min
    commands:
    - purpose: Find lessons learned documentation
      command: |
        find . -type f \( -name "*lesson*" -o -name "*postmortem*" \
          -o -name "*retrospective*" \) 2>/dev/null | head -20
    - purpose: Search for lessons learned references
      command: |
        grep -rniE "(lessons.learned|postmortem|retrospective)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -30
    expected_findings:
    - Lessons learned process documentation
    - Postmortem templates or records
    - Retrospective documentation
  - id: '2'
    name: Root Cause Analysis Review
    description: |
      Assess root cause analysis practices and their application
      to risk identification.
    duration_estimate: 45 min
    commands:
    - purpose: Find root cause analysis documentation
      command: |
        find . -type f \( -name "*rca*" -o -name "*root*cause*" \) \
          2>/dev/null | head -15
    - purpose: Search for RCA references
      command: |
        grep -rniE "(root.cause|five.why|fishbone|ishikawa)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    expected_findings:
    - RCA process documentation
    - RCA templates or records
    - Evidence of RCA application
  - id: '3'
    name: Historical Data Access Assessment
    description: |
      Evaluate accessibility and usability of historical incident
      and risk data.
    duration_estimate: 30 min
    commands:
    - purpose: Find incident history files
      command: |
        find . -type f \( -name "*incident*" -o -name "*event*log*" \
          -o -name "*risk*history*" \) 2>/dev/null | head -20
    - purpose: Check for trend analysis
      command: |
        grep -rniE "(trend|pattern|analysis).*incident" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Incident data repository
    - Historical records accessible
    - Trend analysis evidence
  - id: '4'
    name: Integration Assessment
    description: |
      Verify that historical analysis feeds into risk identification
      processes and the risk register.
    duration_estimate: 30 min
    commands:
    - purpose: Find risk register updates from incidents
      command: |
        grep -rniE "(incident|lesson|historical).*risk.*(register|update)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Risk register update process
    - Integration with lessons learned
    - Feedback loop documentation
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Lessons Learned Assessment
    - Root Cause Analysis Review
    - Data Accessibility
    - Recommendations
  - type: trend_analysis
    format: table
    description: Historical incident trends and patterns
  confidence_guidance:
    high: Documented processes with evidence of application
    medium: Processes exist but application inconsistent
    low: Limited or no historical analysis
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: iso-31000-2018
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires comprehensive historical review
    full:
      included: true
      priority: 3
    security:
      included: true
      priority: 3
closeout_checklist:
- id: histrs-001
  item: Lessons learned process exists
  level: CRITICAL
  verification: manual
  verification_notes: Verify existence of lessons learned or postmortem process
  expected: Confirmed by reviewer
- id: histrs-002
  item: Root cause analysis performed for significant incidents
  level: BLOCKING
  verification: manual
  verification_notes: Verify RCA conducted for major incidents
  expected: Confirmed by reviewer
- id: histrs-003
  item: Historical insights applied to risk identification
  level: BLOCKING
  verification: manual
  verification_notes: Verify risk register updates based on lessons learned
  expected: Confirmed by reviewer
- id: histrs-004
  item: Historical data accessible for analysis
  level: WARNING
  verification: manual
  verification_notes: Verify ability to access and search historical data
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: ISO 31000
    controls:
    - Clause 5.4.4
    - Clause 6.7
  - framework: NIST 800-61
    controls:
    - 3.4 Post-Incident Activity
  - framework: COBIT 2019
    controls:
    - DSS02.07
    - APO12.06
relationships:
  commonly_combined:
  - risk-management.risk-identification.risk-identification-process
  - risk-management.risk-monitoring.risk-review-cadence
  - risk-management.business-continuity.continuity-testing
