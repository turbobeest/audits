audit:
  id: risk-management.risk-identification.dependency-risks
  name: Dependency Risks Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: risk-management
  category_number: 29
  subcategory: risk-identification
  tier: phd
  estimated_duration: 4-6 hours  # median: 5h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: organizational
  default_profiles:
  - full
  - security
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines the identification and management of dependency risks:
    - Third-party vendor and supplier dependencies
    - Technology and platform dependencies
    - Service provider dependencies (cloud, SaaS, APIs)
    - Open source and library dependencies
    - Internal system and data dependencies
    - Key personnel dependencies
    - Concentration risk from critical dependencies
  why_it_matters: |
    Modern organizations have extensive dependencies that introduce risks:
    - Supply chain attacks have increased 742% in recent years (Gartner)
    - Single points of failure from unmanaged dependencies cause outages
    - Vendor failures can cascade to organizational impact
    - ISO 27001 requires managing supplier relationships and their risks
    - NIST CSF emphasizes supply chain risk management
    - Many regulatory frameworks require third-party risk management
    - Unidentified dependencies are invisible risks
  when_to_run:
  - Annual vendor and supplier risk reviews
  - Before major technology decisions
  - During supply chain assessments
  - After vendor incidents or failures
  - During M&A due diligence
prerequisites:
  required_artifacts:
  - type: vendor_inventory
    description: List of vendors and third-party relationships
  - type: architecture_docs
    description: System architecture and dependency documentation
  - type: sbom
    description: Software Bill of Materials
  access_requirements:
  - Access to vendor management systems
  - Access to architecture documentation
  - Access to dependency scanning tools
  - Access to contract and procurement records
discovery:
  code_patterns:
  - pattern: (vendor|supplier|third.party|partner).*risk
    type: regex
    scope: docs
    purpose: Find vendor risk documentation
  - pattern: (dependency|depends|require).*risk
    type: regex
    scope: docs
    purpose: Find dependency risk references
  - pattern: (supply.chain|procurement).*risk
    type: regex
    scope: docs
    purpose: Find supply chain risk documentation
  - pattern: (import|require|from|use)\s+['"]
    type: regex
    scope: source
    purpose: Identify code dependencies
  file_patterns:
  - glob: '**/vendor*.{yaml,yml,json,md,xlsx}'
    purpose: Vendor management files
  - glob: '**/supplier*.{yaml,yml,json,md,xlsx}'
    purpose: Supplier files
  - glob: '**/sbom*.{json,yaml,xml}'
    purpose: Software Bill of Materials
  - glob: '**/package*.json'
    purpose: Node.js dependencies
  - glob: '**/requirements*.txt'
    purpose: Python dependencies
  - glob: '**/go.mod'
    purpose: Go dependencies
knowledge_sources:
  specifications:
  - id: iso-27001-a515
    name: ISO 27001:2022 A.5.19-5.23 Supplier Relationships
    url: https://www.iso.org/standard/27001
    offline_cache: true
    priority: required
  - id: nist-csf-supply-chain
    name: NIST CSF Supply Chain Risk Management
    url: https://www.nist.gov/cyberframework
    offline_cache: true
    priority: required
  - id: nist-800-161
    name: NIST SP 800-161 Supply Chain Risk Management
    url: https://csrc.nist.gov/publications/detail/sp/800-161/rev-1/final
    offline_cache: true
    priority: recommended
  guides:
  - id: owasp-dependency-check
    name: OWASP Dependency-Check
    url: https://owasp.org/www-project-dependency-check/
    offline_cache: true
tooling:
  static_analysis:
  - tool: dependency-check
    purpose: Scan software dependencies for vulnerabilities
    command: dependency-check --project PROJECT --scan .
    offline_capable: true
  - tool: npm-audit
    purpose: Audit Node.js dependencies
    command: npm audit --json
    offline_capable: true
  - tool: safety
    purpose: Check Python dependencies
    command: safety check -r requirements.txt
    offline_capable: true
  scripts:
  - id: dependency-scanner
    language: bash
    purpose: Scan for dependency files
    source: inline
    code: |
      #!/bin/bash
      echo "=== Dependency File Scan ==="
      find . -type f \( -name "package*.json" -o -name "requirements*.txt" \
        -o -name "go.mod" -o -name "Gemfile*" -o -name "pom.xml" \
        -o -name "*.csproj" -o -name "Cargo.toml" \) 2>/dev/null
signals:
  critical:
  - id: DEPRIS-CRIT-001
    signal: No dependency inventory maintained
    evidence_indicators:
    - No vendor inventory exists
    - No software bill of materials
    - Unknown third-party relationships
    explanation: |
      Without a dependency inventory, organizations cannot assess or manage
      dependency risks. ISO 27001 requires maintaining an inventory of
      suppliers and their associated risks.
    remediation: |
      - Create comprehensive vendor and supplier inventory
      - Generate software bill of materials (SBOM)
      - Document all third-party relationships
      - Classify dependencies by criticality
  - id: DEPRIS-CRIT-002
    signal: Critical single points of dependency failure
    evidence_indicators:
    - Single vendor for critical services
    - No alternatives for essential capabilities
    - High concentration risk in dependencies
    explanation: |
      Single points of failure in dependencies create unacceptable risk.
      If a sole provider fails, the organization may be unable to continue
      operations. Diversification reduces concentration risk.
    remediation: |
      - Identify single points of failure
      - Develop alternative sources or providers
      - Create contingency plans for critical dependencies
      - Implement multi-vendor strategies where possible
  high:
  - id: DEPRIS-HIGH-001
    signal: Vendor and supplier risks not assessed
    evidence_indicators:
    - No vendor risk assessments conducted
    - No due diligence on third parties
    - Missing vendor security evaluations
    explanation: |
      Third-party relationships introduce risks that must be assessed.
      ISO 27001 A.5.19-5.23 requires evaluating and managing supplier risks.
      Unassessed vendors may have security gaps that affect your organization.
    remediation: |
      - Implement vendor risk assessment process
      - Conduct due diligence on critical vendors
      - Evaluate vendor security posture
      - Include risk assessment in procurement process
  - id: DEPRIS-HIGH-002
    signal: Software dependencies not scanned for vulnerabilities
    evidence_indicators:
    - No dependency scanning in place
    - Unknown vulnerable dependencies
    - Outdated libraries with known CVEs
    explanation: |
      Software dependencies frequently contain vulnerabilities. Without
      scanning, organizations unknowingly inherit security risks from
      their dependency chain.
    remediation: |
      - Implement automated dependency scanning
      - Generate and maintain SBOM
      - Monitor for vulnerability disclosures
      - Establish remediation processes for vulnerable dependencies
  - id: DEPRIS-HIGH-003
    signal: No exit strategy for critical vendors
    evidence_indicators:
    - No transition plans for vendor changes
    - Data portability not addressed
    - Vendor lock-in not managed
    explanation: |
      Organizations must be able to exit vendor relationships without
      operational disruption. Lack of exit strategies creates dependency
      and negotiating disadvantages.
    remediation: |
      - Develop exit strategies for critical vendors
      - Ensure data portability provisions in contracts
      - Document transition procedures
      - Maintain alternative vendor relationships
  medium:
  - id: DEPRIS-MED-001
    signal: Dependency criticality not classified
    evidence_indicators:
    - All dependencies treated equally
    - No criticality rating for vendors
    - Resource allocation not risk-based
    explanation: |
      Not all dependencies carry equal risk. Classifying criticality
      enables appropriate resource allocation for risk management.
    remediation: |
      - Classify dependencies by criticality
      - Define criticality criteria
      - Align risk management effort with criticality
      - Review criticality ratings periodically
  - id: DEPRIS-MED-002
    signal: Internal dependencies not mapped
    evidence_indicators:
    - System interdependencies unknown
    - Data flow dependencies undocumented
    - No internal dependency inventory
    explanation: |
      Internal dependencies can be as risky as external ones. Understanding
      internal dependencies is essential for impact analysis and change
      management.
    remediation: |
      - Map internal system dependencies
      - Document data flow dependencies
      - Identify internal single points of failure
      - Maintain architecture documentation
  low:
  - id: DEPRIS-LOW-001
    signal: Dependency risks not reviewed regularly
    evidence_indicators:
    - Stale vendor risk assessments
    - Infrequent dependency updates
    - No scheduled dependency reviews
    explanation: |
      Dependency risks change over time. Regular review ensures assessments
      remain current and new risks are identified.
    remediation: |
      - Schedule regular dependency risk reviews
      - Update assessments when conditions change
      - Monitor vendor health indicators
      - Review dependencies during change management
  positive:
  - id: DEPRIS-POS-001
    signal: Comprehensive dependency risk management
    evidence_indicators:
    - Complete dependency inventory
    - Regular risk assessments
    - Automated vulnerability scanning
  - id: DEPRIS-POS-002
    signal: Diversified critical dependencies
    evidence_indicators:
    - Multi-vendor strategies in place
    - Alternative sources available
    - Exit strategies documented
procedure:
  context:
    cognitive_mode: critical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Dependency Inventory Assessment
    description: |
      Evaluate the completeness of dependency inventory including
      vendors, software, and internal systems.
    duration_estimate: 60 min
    commands:
    - purpose: Find vendor and supplier documentation
      command: |
        find . -type f \( -name "*vendor*" -o -name "*supplier*" \
          -o -name "*third*party*" \) 2>/dev/null | head -20
    - purpose: Find software dependency files
      command: |
        find . -type f \( -name "package*.json" -o -name "requirements*.txt" \
          -o -name "go.mod" -o -name "Gemfile" -o -name "pom.xml" \
          -o -name "sbom*" \) 2>/dev/null | head -20
    expected_findings:
    - Vendor inventory documentation
    - Software dependency files
    - SBOM or equivalent
  - id: '2'
    name: Risk Assessment Review
    description: |
      Evaluate vendor and dependency risk assessment practices.
    duration_estimate: 60 min
    commands:
    - purpose: Find vendor risk assessment documentation
      command: |
        grep -rniE "(vendor|supplier|third.party).*risk.*assess" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -30
    - purpose: Check for dependency scanning configuration
      command: |
        find . -type f \( -name "*snyk*" -o -name "*dependency*check*" \
          -o -name "*audit*" \) 2>/dev/null | head -15
    expected_findings:
    - Vendor risk assessment process
    - Dependency scanning configuration
    - Risk evaluation criteria
  - id: '3'
    name: Concentration Risk Analysis
    description: |
      Identify single points of failure and concentration risks
      in dependencies.
    duration_estimate: 45 min
    commands:
    - purpose: Find critical dependency documentation
      command: |
        grep -rniE "(critical|essential|key|core).*depend" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    - purpose: Search for single source references
      command: |
        grep -rniE "(single|sole|only).*(vendor|supplier|source)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    expected_findings:
    - Critical dependencies identified
    - Concentration risks documented
    - Alternative source planning
  - id: '4'
    name: Vulnerability Assessment
    description: |
      Evaluate software dependency vulnerability management.
    duration_estimate: 45 min
    commands:
    - purpose: Check for vulnerability scanning results
      command: |
        find . -type f \( -name "*vulnerability*" -o -name "*cve*" \
          -o -name "*security*scan*" \) 2>/dev/null | head -15
    - purpose: Look for remediation tracking
      command: |
        grep -rniE "(remediat|patch|fix|upgrade).*depend" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    expected_findings:
    - Vulnerability scan results
    - Remediation tracking
    - Patch management process
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Dependency Inventory Analysis
    - Risk Assessment Status
    - Concentration Risk Findings
    - Recommendations
  - type: dependency_matrix
    format: table
    description: Critical dependency inventory with risk ratings
  confidence_guidance:
    high: Complete inventory with documented risk assessments
    medium: Partial inventory with limited assessments
    low: Incomplete inventory, minimal risk assessment
offline:
  capability: partial
  cache_manifest:
    knowledge:
    - source_id: iso-27001-a515
      priority: required
    - source_id: nist-csf-supply-chain
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires comprehensive dependency analysis
    full:
      included: true
      priority: 2
    security:
      included: true
      priority: 1
closeout_checklist:
- id: depris-001
  item: Dependency inventory is maintained
  level: CRITICAL
  verification: manual
  verification_notes: Verify existence of vendor and software dependency inventory
  expected: Confirmed by reviewer
- id: depris-002
  item: Critical dependencies identified and documented
  level: CRITICAL
  verification: manual
  verification_notes: Verify critical dependencies are known and classified
  expected: Confirmed by reviewer
- id: depris-003
  item: Vendor risk assessments conducted
  level: BLOCKING
  verification: manual
  verification_notes: Verify risk assessments for critical vendors
  expected: Confirmed by reviewer
- id: depris-004
  item: Software dependencies scanned for vulnerabilities
  level: BLOCKING
  verification: manual
  verification_notes: Verify dependency scanning is in place
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: ISO 27001
    controls:
    - A.5.19
    - A.5.20
    - A.5.21
    - A.5.22
    - A.5.23
  - framework: NIST CSF
    controls:
    - ID.SC-1
    - ID.SC-2
    - ID.SC-3
    - ID.SC-4
  - framework: NIST 800-53
    controls:
    - SR-1
    - SR-2
    - SR-3
    - SA-12
  - framework: SOC 2
    controls:
    - CC9.2
relationships:
  commonly_combined:
  - risk-management.risk-identification.risk-identification-process
  - risk-management.technical-risk.integration-risk
  - risk-management.business-continuity.disaster-recovery-planning
