audit:
  id: risk-management.business-continuity.rpo-rto-analysis
  name: RPO/RTO Analysis Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: risk-management
  category_number: 29
  subcategory: business-continuity
  tier: phd
  estimated_duration: 3-4 hours  # median: 3h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: organizational
  default_profiles:
  - full
  - security
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines RPO/RTO definitions and capabilities:
    - RPO definitions for critical systems
    - RTO definitions aligned with business needs
    - Technical capability to meet objectives
    - Testing and validation of objectives
    - Gap analysis between requirements and capability
    - Tiered recovery objectives
    - Stakeholder agreement on objectives
  why_it_matters: |
    RPO/RTO are fundamental to business continuity planning:
    - RPO defines acceptable data loss (recovery point)
    - RTO defines acceptable downtime (recovery time)
    - ISO 22301 requires defined recovery objectives
    - Objectives must align with business requirements
    - Technical capabilities must meet defined objectives
    - Unrealistic objectives provide false assurance
    - Cost increases significantly for aggressive objectives
  when_to_run:
  - Annual BCP review
  - Before major system changes
  - When business requirements change
  - After failed recovery tests
  - During compliance audits
prerequisites:
  required_artifacts:
  - type: bia_results
    description: Business Impact Analysis results
  - type: recovery_objectives
    description: RPO/RTO definitions
  - type: technical_capabilities
    description: Recovery capability documentation
  access_requirements:
  - Access to BIA documentation
  - Access to recovery objective definitions
  - Access to technical architecture
discovery:
  code_patterns:
  - pattern: (RPO|recovery.point.objective|data.loss)
    type: regex
    scope: docs
    purpose: Find RPO references
  - pattern: (RTO|recovery.time.objective|downtime)
    type: regex
    scope: docs
    purpose: Find RTO references
  - pattern: (tier|priority|critical).*recovery
    type: regex
    scope: docs
    purpose: Find tiered recovery references
  file_patterns:
  - glob: '**/rpo*.{yaml,yml,json,md}'
    purpose: RPO files
  - glob: '**/rto*.{yaml,yml,json,md}'
    purpose: RTO files
  - glob: '**/recovery*objective*.{yaml,yml,json,md}'
    purpose: Recovery objective files
knowledge_sources:
  specifications:
  - id: iso-22301
    name: ISO 22301 Business Continuity
    url: https://www.iso.org/iso-22301-business-continuity.html
    offline_cache: true
    priority: required
  - id: nist-800-34
    name: NIST SP 800-34 Contingency Planning
    url: https://csrc.nist.gov/publications/detail/sp/800-34/rev-1/final
    offline_cache: true
    priority: required
  guides:
  - id: rpo-rto-guide
    name: RPO/RTO Best Practices
    url: https://www.ready.gov/
    offline_cache: true
tooling:
  static_analysis:
  - tool: recovery-analyzer
    purpose: Analyze recovery objectives
    offline_capable: true
  scripts:
  - id: rpo-rto-scanner
    language: bash
    purpose: Scan for RPO/RTO documentation
    source: inline
    code: |
      #!/bin/bash
      echo "=== RPO/RTO Scan ==="
      grep -rniE "(RPO|RTO|recovery.point|recovery.time)" \
        --include="*.yaml" --include="*.md" . 2>/dev/null | head -30
signals:
  critical:
  - id: RPORTO-CRIT-001
    signal: No RPO/RTO defined for critical systems
    evidence_indicators:
    - No recovery objectives
    - Undefined data loss tolerance
    - Undefined downtime tolerance
    explanation: |
      Without defined objectives, recovery cannot be planned or tested.
      Organizations cannot know if recovery meets business needs.
    remediation: |
      - Define RPO for all critical systems
      - Define RTO aligned with business needs
      - Document objectives formally
      - Obtain stakeholder agreement
  - id: RPORTO-CRIT-002
    signal: Technical capability cannot meet RPO/RTO
    evidence_indicators:
    - Backup frequency exceeds RPO
    - Recovery time exceeds RTO
    - Known capability gaps
    explanation: |
      Objectives are meaningless if they cannot be met. Gaps between
      requirements and capability represent unmitigated risk.
    remediation: |
      - Assess capability vs objectives
      - Close capability gaps
      - Adjust objectives if necessary
      - Invest in improved capability
  high:
  - id: RPORTO-HIGH-001
    signal: RPO/RTO not aligned with business impact
    evidence_indicators:
    - Objectives not based on BIA
    - Misaligned priorities
    - IT-defined without business input
    explanation: |
      Objectives must reflect business requirements. Misalignment
      means recovery may not meet actual business needs.
    remediation: |
      - Base objectives on BIA
      - Align with business priorities
      - Validate with stakeholders
      - Document business rationale
  - id: RPORTO-HIGH-002
    signal: RPO/RTO not tested or validated
    evidence_indicators:
    - Untested objectives
    - Unknown actual capability
    - No test evidence
    explanation: |
      Objectives must be validated through testing. Untested objectives
      may not be achievable when needed.
    remediation: |
      - Test RPO/RTO regularly
      - Validate actual capability
      - Document test results
      - Address gaps identified
  medium:
  - id: RPORTO-MED-001
    signal: No tiered recovery objectives
    evidence_indicators:
    - One-size-fits-all objectives
    - No prioritization
    - All systems same RTO
    explanation: |
      Tiered objectives enable resource optimization. Treating all
      systems equally wastes resources or under-protects critical systems.
    remediation: |
      - Implement tiered objectives
      - Prioritize critical systems
      - Align resources to tiers
      - Document tier assignments
  - id: RPORTO-MED-002
    signal: RPO/RTO not reviewed regularly
    evidence_indicators:
    - Stale objectives
    - Business changes not reflected
    - No review schedule
    explanation: |
      Objectives should evolve with business needs. Static objectives
      may not reflect current requirements.
    remediation: |
      - Review objectives annually
      - Update with business changes
      - Track objective evolution
      - Validate current relevance
  low:
  - id: RPORTO-LOW-001
    signal: Cost-benefit not considered for objectives
    evidence_indicators:
    - Cost not analyzed
    - Aggressive objectives without justification
    - No investment analysis
    explanation: |
      More aggressive objectives cost more. Cost-benefit analysis
      ensures appropriate investment.
    remediation: |
      - Analyze cost vs benefit
      - Justify aggressive objectives
      - Consider trade-offs
      - Document decisions
  positive:
  - id: RPORTO-POS-001
    signal: Well-defined RPO/RTO
    evidence_indicators:
    - Clear objectives
    - Business-aligned
    - Tiered approach
  - id: RPORTO-POS-002
    signal: Validated recovery capability
    evidence_indicators:
    - Tested objectives
    - Capability meets requirements
    - Regular validation
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Objective Definition Review
    description: |
      Evaluate RPO/RTO definitions for critical systems.
    duration_estimate: 45 min
    commands:
    - purpose: Find RPO documentation
      command: |
        grep -rniE "(RPO|recovery.point)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -30
    - purpose: Find RTO documentation
      command: |
        grep -rniE "(RTO|recovery.time)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -30
    expected_findings:
    - RPO definitions
    - RTO definitions
    - System coverage
  - id: '2'
    name: Business Alignment Review
    description: |
      Assess alignment with business requirements.
    duration_estimate: 45 min
    commands:
    - purpose: Find BIA references
      command: |
        grep -rniE "(business.impact|BIA|criticality)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    - purpose: Check for business alignment
      command: |
        grep -rniE "(business|stakeholder).*RPO\|RTO" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - BIA linkage
    - Business alignment
    - Stakeholder validation
  - id: '3'
    name: Capability Assessment
    description: |
      Evaluate technical capability to meet objectives.
    duration_estimate: 45 min
    commands:
    - purpose: Find capability documentation
      command: |
        grep -rniE "(capability|capacity|achieve).*recovery" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    - purpose: Check for gap analysis
      command: |
        grep -rniE "(gap|shortfall|cannot.meet)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Capability documentation
    - Gap analysis
    - Achievement evidence
  - id: '4'
    name: Validation Review
    description: |
      Assess testing and validation of objectives.
    duration_estimate: 30 min
    commands:
    - purpose: Find test documentation
      command: |
        grep -rniE "(test|validate|verify).*RPO\|RTO" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Test evidence
    - Validation results
    - Capability confirmation
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - RPO/RTO Definition Review
    - Business Alignment Assessment
    - Capability Gap Analysis
    - Recommendations
  - type: objective_matrix
    format: table
    description: RPO/RTO by system
  confidence_guidance:
    high: Well-defined, aligned, and validated RPO/RTO
    medium: Objectives exist but gaps in alignment or validation
    low: Minimal or undefined recovery objectives
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: iso-22301
      priority: required
    - source_id: nist-800-34
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires comprehensive RPO/RTO review
    full:
      included: true
      priority: 2
    security:
      included: true
      priority: 2
closeout_checklist:
- id: rporto-001
  item: RPO defined for critical systems
  level: CRITICAL
  verification: manual
  verification_notes: Verify RPO definitions
  expected: Confirmed by reviewer
- id: rporto-002
  item: RTO defined and business-aligned
  level: CRITICAL
  verification: manual
  verification_notes: Verify RTO definitions and alignment
  expected: Confirmed by reviewer
- id: rporto-003
  item: Technical capability meets objectives
  level: BLOCKING
  verification: manual
  verification_notes: Verify capability vs objectives
  expected: Confirmed by reviewer
- id: rporto-004
  item: Objectives tested and validated
  level: BLOCKING
  verification: manual
  verification_notes: Verify test evidence
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: ISO 22301
    controls:
    - Clause 8.2
    - Clause 8.3
  - framework: NIST 800-34
    controls:
    - Section 3.4
  - framework: SOC 2
    controls:
    - A1.2
  - framework: COBIT 2019
    controls:
    - DSS04
relationships:
  commonly_combined:
  - risk-management.business-continuity.bcp-documentation
  - risk-management.business-continuity.disaster-recovery-planning
  - risk-management.business-continuity.continuity-testing
