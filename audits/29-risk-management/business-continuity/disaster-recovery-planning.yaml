audit:
  id: risk-management.business-continuity.disaster-recovery-planning
  name: Disaster Recovery Planning Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: risk-management
  category_number: 29
  subcategory: business-continuity
  tier: phd
  estimated_duration: 4-6 hours  # median: 5h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: critical
  scope: organizational
  default_profiles:
  - full
  - security
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines IT Disaster Recovery planning:
    - DR strategy and architecture
    - Recovery site capabilities
    - Data backup and replication
    - Application recovery procedures
    - Infrastructure recovery
    - DR documentation and runbooks
    - Integration with BCP
  why_it_matters: |
    DR planning ensures IT service recovery after disasters:
    - IT systems underpin business operations
    - NIST 800-34 requires contingency planning for IT systems
    - Without DR, businesses cannot recover from disasters
    - ISO 22301 requires IT recovery as part of BCM
    - Cloud services still require DR planning
    - Ransomware makes DR more critical than ever
    - Regulatory requirements often mandate DR capabilities
  when_to_run:
  - Annual DR review
  - Before major infrastructure changes
  - After IT incidents
  - During compliance audits
  - When evaluating DR investments
prerequisites:
  required_artifacts:
  - type: dr_plans
    description: Disaster Recovery Plan documentation
  - type: infrastructure_docs
    description: IT infrastructure documentation
  - type: backup_config
    description: Backup and replication configurations
  access_requirements:
  - Access to DR documentation
  - Access to infrastructure configurations
  - Access to backup systems
discovery:
  code_patterns:
  - pattern: (disaster.recovery|DR|failover|recovery.site)
    type: regex
    scope: docs
    purpose: Find DR references
  - pattern: (backup|replication|sync|mirror)
    type: regex
    scope: config
    purpose: Find backup/replication configurations
  - pattern: (RTO|RPO|recovery.time|recovery.point)
    type: regex
    scope: docs
    purpose: Find RTO/RPO references
  file_patterns:
  - glob: '**/disaster*recovery*.{yaml,yml,json,md}'
    purpose: DR files
  - glob: '**/dr*plan*.{yaml,yml,json,md}'
    purpose: DR plan files
  - glob: '**/backup*.{yaml,yml,json,md}'
    purpose: Backup configuration files
knowledge_sources:
  specifications:
  - id: nist-800-34
    name: NIST SP 800-34 Contingency Planning
    url: https://csrc.nist.gov/publications/detail/sp/800-34/rev-1/final
    offline_cache: true
    priority: required
  - id: iso-22301
    name: ISO 22301 Business Continuity
    url: https://www.iso.org/iso-22301-business-continuity.html
    offline_cache: true
    priority: required
  guides:
  - id: dr-best-practices
    name: DR Planning Best Practices
    url: https://www.ready.gov/
    offline_cache: true
tooling:
  static_analysis:
  - tool: dr-analyzer
    purpose: Analyze DR coverage
    offline_capable: true
  scripts:
  - id: dr-scanner
    language: bash
    purpose: Scan for DR configuration
    source: inline
    code: |
      #!/bin/bash
      echo "=== DR Planning Scan ==="
      find . -type f \( -name "*disaster*recovery*" -o -name "*dr*plan*" \
        -o -name "*failover*" \) 2>/dev/null | head -20
signals:
  critical:
  - id: DRPLAN-CRIT-001
    signal: No disaster recovery plan exists
    evidence_indicators:
    - No DR documentation
    - No recovery capability
    - No backup strategy
    explanation: |
      Without DR planning, organizations cannot recover IT services
      after disasters. This represents existential risk.
    remediation: |
      - Develop DR strategy
      - Document DR plans
      - Implement recovery capabilities
      - Test regularly
  - id: DRPLAN-CRIT-002
    signal: Critical systems lack DR coverage
    evidence_indicators:
    - Critical systems without DR
    - Incomplete coverage
    - Single points of failure
    explanation: |
      Critical systems require DR coverage to ensure business
      continuity. Gaps leave essential capabilities unrecoverable.
    remediation: |
      - Identify critical systems
      - Ensure DR coverage
      - Eliminate single points of failure
      - Document recovery for each
  high:
  - id: DRPLAN-HIGH-001
    signal: Recovery site not adequate
    evidence_indicators:
    - No secondary site
    - Insufficient capacity
    - Same geographic area
    explanation: |
      Recovery sites must be adequate for actual recovery. Insufficient
      or geographically proximate sites may fail during regional disasters.
    remediation: |
      - Assess recovery site adequacy
      - Ensure geographic separation
      - Verify capacity sufficiency
      - Test site capabilities
  - id: DRPLAN-HIGH-002
    signal: Data replication insufficient
    evidence_indicators:
    - RPO not met
    - Inconsistent replication
    - Data at risk
    explanation: |
      Data replication must meet RPO requirements. Insufficient
      replication risks significant data loss.
    remediation: |
      - Assess replication against RPO
      - Implement adequate replication
      - Monitor replication health
      - Test data recovery
  medium:
  - id: DRPLAN-MED-001
    signal: DR runbooks incomplete or outdated
    evidence_indicators:
    - Missing runbooks
    - Outdated procedures
    - Unclear steps
    explanation: |
      Runbooks enable execution of recovery. Incomplete or outdated
      runbooks impede effective recovery.
    remediation: |
      - Develop complete runbooks
      - Keep procedures current
      - Provide clear step-by-step guidance
      - Test runbook effectiveness
  - id: DRPLAN-MED-002
    signal: DR not tested regularly
    evidence_indicators:
    - No recent DR tests
    - Untested procedures
    - Unknown recovery capability
    explanation: |
      Testing validates DR capability. Untested plans may fail
      when needed.
    remediation: |
      - Test DR regularly
      - Document test results
      - Address test findings
      - Schedule annual tests
  low:
  - id: DRPLAN-LOW-001
    signal: DR metrics not tracked
    evidence_indicators:
    - No RTO/RPO tracking
    - Unknown recovery times
    - No improvement metrics
    explanation: |
      Metrics enable understanding and improvement of DR capability.
    remediation: |
      - Track DR metrics
      - Measure actual RTO/RPO
      - Monitor improvement
      - Report to leadership
  positive:
  - id: DRPLAN-POS-001
    signal: Comprehensive DR planning
    evidence_indicators:
    - Complete coverage
    - Adequate recovery site
    - Tested procedures
  - id: DRPLAN-POS-002
    signal: Effective data protection
    evidence_indicators:
    - RPO met
    - Robust replication
    - Verified recovery
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: DR Strategy Review
    description: |
      Evaluate DR strategy and architecture.
    duration_estimate: 60 min
    commands:
    - purpose: Find DR documentation
      command: |
        find . -type f \( -name "*disaster*recovery*" -o -name "*dr*" \
          -o -name "*failover*" \) 2>/dev/null | head -20
    - purpose: Search for DR strategy
      command: |
        grep -rniE "(disaster.recovery|DR|recovery.site|failover)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -30
    expected_findings:
    - DR documentation
    - Recovery strategy
    - Architecture documentation
  - id: '2'
    name: Coverage Assessment
    description: |
      Assess DR coverage of critical systems.
    duration_estimate: 45 min
    commands:
    - purpose: Find critical system DR
      command: |
        grep -rniE "(critical|essential|tier.1).*recovery" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    - purpose: Check for coverage gaps
      command: |
        grep -rniE "(coverage|scope|include).*disaster\|dr" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - System coverage
    - Critical system DR
    - Gap identification
  - id: '3'
    name: Data Protection Review
    description: |
      Evaluate backup and replication capabilities.
    duration_estimate: 45 min
    commands:
    - purpose: Find backup configuration
      command: |
        find . -type f \( -name "*backup*" -o -name "*replication*" \) \
          2>/dev/null | head -20
    - purpose: Check for RPO documentation
      command: |
        grep -rniE "(RPO|recovery.point|data.loss)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    expected_findings:
    - Backup configuration
    - Replication setup
    - RPO documentation
  - id: '4'
    name: Runbook Assessment
    description: |
      Evaluate DR runbooks and procedures.
    duration_estimate: 45 min
    commands:
    - purpose: Find runbooks
      command: |
        find . -type f \( -name "*runbook*" -o -name "*procedure*" \) \
          -exec grep -l -iE "recovery|restore|dr" {} \; 2>/dev/null | head -15
    - purpose: Check for step-by-step procedures
      command: |
        grep -rniE "(step|procedure|process).*recovery" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    expected_findings:
    - Runbook documentation
    - Recovery procedures
    - Step-by-step guidance
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Strategy Assessment
    - Coverage Review
    - Data Protection Analysis
    - Recommendations
  - type: dr_coverage
    format: table
    description: DR coverage by system
  confidence_guidance:
    high: Comprehensive DR with tested procedures
    medium: DR exists but gaps in coverage or testing
    low: Minimal or no DR planning
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: nist-800-34
      priority: required
    - source_id: iso-22301
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires comprehensive DR review
    full:
      included: true
      priority: 1
    security:
      included: true
      priority: 1
closeout_checklist:
- id: drplan-001
  item: DR plan exists
  level: CRITICAL
  verification: manual
  verification_notes: Verify DR documentation exists
  expected: Confirmed by reviewer
- id: drplan-002
  item: Critical systems covered
  level: CRITICAL
  verification: manual
  verification_notes: Verify coverage of critical systems
  expected: Confirmed by reviewer
- id: drplan-003
  item: Recovery site adequate
  level: BLOCKING
  verification: manual
  verification_notes: Verify recovery site capability
  expected: Confirmed by reviewer
- id: drplan-004
  item: DR tested regularly
  level: BLOCKING
  verification: manual
  verification_notes: Verify testing evidence
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: NIST 800-34
    controls:
    - Section 3
    - Section 4
  - framework: ISO 22301
    controls:
    - Clause 8
  - framework: SOC 2
    controls:
    - A1.2
    - A1.3
  - framework: COBIT 2019
    controls:
    - DSS04
relationships:
  commonly_combined:
  - risk-management.business-continuity.bcp-documentation
  - risk-management.business-continuity.rpo-rto-analysis
  - risk-management.business-continuity.failover-capability
