audit:
  id: risk-management.business-continuity.failover-capability
  name: Failover Capability Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: risk-management
  category_number: 29
  subcategory: business-continuity
  tier: phd
  estimated_duration: 4-6 hours  # median: 5h
  completeness: requires_discovery
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: critical
  scope: organizational
  default_profiles:
  - full
  - security
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines technical failover capabilities:
    - Failover automation and orchestration
    - Recovery site readiness
    - Data synchronization and consistency
    - Failover testing and validation
    - Failback procedures
    - Capacity for production workloads
    - Integration with monitoring and alerting
  why_it_matters: |
    Failover capability is essential for service continuity:
    - Failover enables rapid recovery from site failures
    - Automated failover reduces recovery time
    - Testing validates failover actually works
    - Capacity must match production requirements
    - Data consistency prevents loss during failover
    - Failback is needed after recovery
    - Modern architectures often require multi-region capability
  when_to_run:
  - Annual DR review
  - Before major infrastructure changes
  - After failover failures
  - When capacity changes significantly
  - During compliance audits
prerequisites:
  required_artifacts:
  - type: failover_architecture
    description: Failover architecture documentation
  - type: replication_config
    description: Data replication configuration
  - type: failover_procedures
    description: Failover procedure documentation
  access_requirements:
  - Access to infrastructure documentation
  - Access to replication systems
  - Access to failover orchestration
discovery:
  code_patterns:
  - pattern: (failover|failback|switchover)
    type: regex
    scope: config
    purpose: Find failover configuration
  - pattern: (replication|sync|mirror).*data
    type: regex
    scope: config
    purpose: Find replication configuration
  - pattern: (active.passive|active.active|multi.region)
    type: regex
    scope: docs
    purpose: Find architecture patterns
  file_patterns:
  - glob: '**/failover*.{yaml,yml,json,md}'
    purpose: Failover configuration files
  - glob: '**/replication*.{yaml,yml,json,md}'
    purpose: Replication configuration files
  - glob: '**/dr*.{yaml,yml,json,md}'
    purpose: DR configuration files
knowledge_sources:
  specifications:
  - id: nist-800-34
    name: NIST SP 800-34 Contingency Planning
    url: https://csrc.nist.gov/publications/detail/sp/800-34/rev-1/final
    offline_cache: true
    priority: required
  - id: cloud-failover
    name: Cloud Failover Best Practices
    url: https://aws.amazon.com/disaster-recovery/
    offline_cache: true
    priority: required
  guides:
  - id: failover-guide
    name: Failover Architecture Guide
    url: https://docs.microsoft.com/
    offline_cache: true
tooling:
  static_analysis:
  - tool: failover-analyzer
    purpose: Analyze failover configuration
    offline_capable: true
  scripts:
  - id: failover-scanner
    language: bash
    purpose: Scan for failover configuration
    source: inline
    code: |
      #!/bin/bash
      echo "=== Failover Capability Scan ==="
      find . -type f \( -name "*failover*" -o -name "*replication*" \
        -o -name "*dr*" \) 2>/dev/null | head -20
signals:
  critical:
  - id: FAILOV-CRIT-001
    signal: No failover capability for critical systems
    evidence_indicators:
    - No failover architecture
    - Single site only
    - No recovery capability
    explanation: |
      Without failover capability, critical systems cannot recover
      from site failures. This represents existential risk.
    remediation: |
      - Implement failover capability
      - Design recovery architecture
      - Deploy to secondary site
      - Test failover capability
  - id: FAILOV-CRIT-002
    signal: Failover not tested
    evidence_indicators:
    - Untested failover
    - Unknown if failover works
    - No test evidence
    explanation: |
      Untested failover may not work when needed. Testing validates
      that failover actually works as designed.
    remediation: |
      - Test failover regularly
      - Document test results
      - Fix issues identified
      - Schedule regular tests
  high:
  - id: FAILOV-HIGH-001
    signal: Recovery site capacity insufficient
    evidence_indicators:
    - Inadequate capacity
    - Cannot run production
    - Scaled down secondary
    explanation: |
      Recovery site must handle production workloads. Insufficient
      capacity means recovery site cannot support operations.
    remediation: |
      - Assess capacity requirements
      - Ensure adequate capacity
      - Plan for scaling
      - Test under load
  - id: FAILOV-HIGH-002
    signal: Data replication not meeting RPO
    evidence_indicators:
    - Replication lag
    - Async without RPO consideration
    - Data at risk
    explanation: |
      Data replication must meet RPO requirements. Insufficient
      replication means data loss during failover.
    remediation: |
      - Assess replication vs RPO
      - Implement adequate replication
      - Monitor replication lag
      - Consider sync replication
  medium:
  - id: FAILOV-MED-001
    signal: Manual failover only
    evidence_indicators:
    - No automation
    - Manual intervention required
    - Slow failover
    explanation: |
      Manual failover is slower and error-prone. Automation
      reduces RTO and human error.
    remediation: |
      - Implement automation
      - Reduce manual steps
      - Test automated failover
      - Monitor for issues
  - id: FAILOV-MED-002
    signal: No failback procedures
    evidence_indicators:
    - No failback documented
    - Cannot return to primary
    - One-way failover only
    explanation: |
      Failback is needed to return to normal operations. Without
      failback, recovery is incomplete.
    remediation: |
      - Document failback procedures
      - Test failback capability
      - Plan return to primary
      - Consider data resync
  low:
  - id: FAILOV-LOW-001
    signal: Failover not integrated with monitoring
    evidence_indicators:
    - No alerting integration
    - Manual detection
    - Delayed awareness
    explanation: |
      Integration with monitoring enables rapid response. Manual
      detection delays failover initiation.
    remediation: |
      - Integrate with monitoring
      - Enable alerting
      - Consider auto-failover
      - Reduce detection time
  positive:
  - id: FAILOV-POS-001
    signal: Robust failover capability
    evidence_indicators:
    - Automated failover
    - Adequate capacity
    - Regular testing
  - id: FAILOV-POS-002
    signal: Complete failover/failback
    evidence_indicators:
    - Both directions work
    - Tested procedures
    - Data consistency maintained
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Architecture Review
    description: |
      Evaluate failover architecture and design.
    duration_estimate: 60 min
    commands:
    - purpose: Find failover architecture
      command: |
        find . -type f \( -name "*failover*" -o -name "*dr*architecture*" \) \
          2>/dev/null | head -20
    - purpose: Search for architecture patterns
      command: |
        grep -rniE "(active.passive|active.active|multi.region|failover)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -30
    expected_findings:
    - Architecture documentation
    - Design patterns
    - Component coverage
  - id: '2'
    name: Replication Review
    description: |
      Assess data replication configuration.
    duration_estimate: 45 min
    commands:
    - purpose: Find replication configuration
      command: |
        find . -type f \( -name "*replication*" -o -name "*sync*" \
          -o -name "*mirror*" \) 2>/dev/null | head -20
    - purpose: Check for RPO alignment
      command: |
        grep -rniE "(RPO|replication.*lag|sync|async)" \
          --include="*.yaml" --include="*.md" . 2>/dev/null | head -20
    expected_findings:
    - Replication configuration
    - RPO alignment
    - Consistency mechanisms
  - id: '3'
    name: Capacity Assessment
    description: |
      Evaluate recovery site capacity.
    duration_estimate: 45 min
    commands:
    - purpose: Find capacity documentation
      command: |
        grep -rniE "(capacity|scale|resource).*recovery\|dr\|secondary" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    - purpose: Check for scaling configuration
      command: |
        grep -rniE "(scale|auto.scale|capacity)" \
          --include="*.yaml" --include="*.json" . 2>/dev/null | head -15
    expected_findings:
    - Capacity documentation
    - Scaling configuration
    - Production readiness
  - id: '4'
    name: Testing Review
    description: |
      Assess failover testing practices.
    duration_estimate: 45 min
    commands:
    - purpose: Find test documentation
      command: |
        find . -type f -name "*test*" -exec grep -l -i \
          "failover\|dr\|recovery" {} \; 2>/dev/null | head -15
    - purpose: Check for test results
      command: |
        grep -rniE "(test|exercise).*failover\|dr" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    expected_findings:
    - Test documentation
    - Test results
    - Issue tracking
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Architecture Review
    - Replication Assessment
    - Capacity Analysis
    - Recommendations
  - type: capability_matrix
    format: table
    description: Failover capability by system
  confidence_guidance:
    high: Robust, tested failover with adequate capacity
    medium: Failover exists but gaps in testing or capacity
    low: Minimal or no failover capability
offline:
  capability: partial
  cache_manifest:
    knowledge:
    - source_id: nist-800-34
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires comprehensive failover review
    full:
      included: true
      priority: 1
    security:
      included: true
      priority: 1
closeout_checklist:
- id: failov-001
  item: Failover capability exists
  level: CRITICAL
  verification: manual
  verification_notes: Verify failover architecture
  expected: Confirmed by reviewer
- id: failov-002
  item: Failover tested
  level: CRITICAL
  verification: manual
  verification_notes: Verify test evidence
  expected: Confirmed by reviewer
- id: failov-003
  item: Capacity adequate
  level: BLOCKING
  verification: manual
  verification_notes: Verify capacity assessment
  expected: Confirmed by reviewer
- id: failov-004
  item: Replication meets RPO
  level: BLOCKING
  verification: manual
  verification_notes: Verify replication configuration
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: NIST 800-34
    controls:
    - Section 3.4
    - Section 4
  - framework: ISO 22301
    controls:
    - Clause 8
  - framework: SOC 2
    controls:
    - A1.2
    - A1.3
  - framework: COBIT 2019
    controls:
    - DSS04
relationships:
  commonly_combined:
  - risk-management.business-continuity.disaster-recovery-planning
  - risk-management.business-continuity.rpo-rto-analysis
  - risk-management.business-continuity.continuity-testing
