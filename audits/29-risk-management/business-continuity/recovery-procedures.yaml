audit:
  id: risk-management.business-continuity.recovery-procedures
  name: Recovery Procedures Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: risk-management
  category_number: 29
  subcategory: business-continuity
  tier: phd
  estimated_duration: 4-5 hours  # median: 4h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: critical
  scope: organizational
  default_profiles:
  - full
  - security
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines recovery procedure documentation:
    - Step-by-step recovery procedures
    - Procedure completeness and clarity
    - Dependencies and sequencing
    - Role assignments and responsibilities
    - Testing and validation
    - Version control and maintenance
    - Integration with DR and BCP
  why_it_matters: |
    Recovery procedures enable effective incident response:
    - Clear procedures reduce recovery time
    - ISO 22301 requires documented recovery procedures
    - Incomplete procedures cause delays and errors
    - Procedures must be executable under stress
    - NIST 800-34 emphasizes contingency plan documentation
    - Untested procedures may fail during incidents
    - Outdated procedures reflect obsolete systems
  when_to_run:
  - Annual BCP review
  - After system changes
  - After failed recoveries
  - Before compliance audits
  - When procedure currency questioned
prerequisites:
  required_artifacts:
  - type: recovery_procedures
    description: Recovery procedure documentation
  - type: runbooks
    description: Operational runbooks
  - type: system_documentation
    description: System architecture documentation
  access_requirements:
  - Access to procedure documentation
  - Access to runbooks
  - Understanding of systems covered
discovery:
  code_patterns:
  - pattern: (recovery|restore|recover).*procedure
    type: regex
    scope: docs
    purpose: Find recovery procedure references
  - pattern: (runbook|playbook|step.by.step)
    type: regex
    scope: docs
    purpose: Find runbook references
  - pattern: (failover|failback|switchover).*procedure
    type: regex
    scope: docs
    purpose: Find failover procedure references
  file_patterns:
  - glob: '**/recovery*procedure*.{yaml,yml,json,md}'
    purpose: Recovery procedure files
  - glob: '**/runbook*.{yaml,yml,json,md}'
    purpose: Runbook files
  - glob: '**/playbook*.{yaml,yml,json,md}'
    purpose: Playbook files
knowledge_sources:
  specifications:
  - id: iso-22301
    name: ISO 22301 Business Continuity
    url: https://www.iso.org/iso-22301-business-continuity.html
    offline_cache: true
    priority: required
  - id: nist-800-34
    name: NIST SP 800-34 Contingency Planning
    url: https://csrc.nist.gov/publications/detail/sp/800-34/rev-1/final
    offline_cache: true
    priority: required
  guides:
  - id: runbook-guide
    name: Runbook Best Practices
    url: https://www.atlassian.com/
    offline_cache: true
tooling:
  static_analysis:
  - tool: procedure-analyzer
    purpose: Analyze procedure completeness
    offline_capable: true
  scripts:
  - id: procedure-scanner
    language: bash
    purpose: Scan for recovery procedures
    source: inline
    code: |
      #!/bin/bash
      echo "=== Recovery Procedure Scan ==="
      find . -type f \( -name "*recovery*" -o -name "*runbook*" \
        -o -name "*procedure*" \) 2>/dev/null | head -20
signals:
  critical:
  - id: RECPROC-CRIT-001
    signal: No recovery procedures documented
    evidence_indicators:
    - No procedure documentation
    - Recovery knowledge undocumented
    - Dependent on individual knowledge
    explanation: |
      Without documented procedures, recovery depends on individual
      knowledge which may not be available during incidents.
    remediation: |
      - Document recovery procedures
      - Create step-by-step runbooks
      - Cover all critical systems
      - Make procedures executable
  - id: RECPROC-CRIT-002
    signal: Critical systems lack recovery procedures
    evidence_indicators:
    - Critical systems not covered
    - Incomplete coverage
    - Key systems undocumented
    explanation: |
      Critical systems must have documented recovery procedures.
      Gaps leave essential capabilities without recovery path.
    remediation: |
      - Identify coverage gaps
      - Document procedures for all critical systems
      - Prioritize critical coverage
      - Validate completeness
  high:
  - id: RECPROC-HIGH-001
    signal: Procedures not executable under stress
    evidence_indicators:
    - Unclear steps
    - Missing details
    - Assumed knowledge
    explanation: |
      Procedures must be executable by available staff during incidents.
      Complex or unclear procedures fail under stress.
    remediation: |
      - Simplify procedures
      - Add explicit details
      - Remove assumed knowledge
      - Test with diverse staff
  - id: RECPROC-HIGH-002
    signal: Procedures not tested
    evidence_indicators:
    - Untested procedures
    - Unknown executability
    - No test evidence
    explanation: |
      Untested procedures may fail when needed. Testing validates
      that procedures work as documented.
    remediation: |
      - Test all procedures
      - Document test results
      - Fix issues identified
      - Retest after changes
  medium:
  - id: RECPROC-MED-001
    signal: Procedures outdated
    evidence_indicators:
    - Stale documentation
    - System changes not reflected
    - Obsolete steps
    explanation: |
      Outdated procedures may not work with current systems.
      Changes must be reflected in procedures.
    remediation: |
      - Update procedures regularly
      - Track system changes
      - Validate currency
      - Implement change process
  - id: RECPROC-MED-002
    signal: Dependencies not documented
    evidence_indicators:
    - Unclear sequencing
    - Missing prerequisites
    - Dependency assumptions
    explanation: |
      Dependencies affect recovery sequencing. Undocumented
      dependencies cause recovery failures.
    remediation: |
      - Document dependencies
      - Define sequencing
      - Identify prerequisites
      - Map relationships
  low:
  - id: RECPROC-LOW-001
    signal: No procedure version control
    evidence_indicators:
    - Unversioned documents
    - Multiple copies
    - Unknown current version
    explanation: |
      Version control ensures staff use current procedures.
      Uncontrolled versions cause confusion.
    remediation: |
      - Implement version control
      - Mark versions clearly
      - Control distribution
      - Retire old versions
  positive:
  - id: RECPROC-POS-001
    signal: Comprehensive recovery procedures
    evidence_indicators:
    - Complete coverage
    - Clear steps
    - Tested procedures
  - id: RECPROC-POS-002
    signal: Well-maintained procedures
    evidence_indicators:
    - Current documentation
    - Version controlled
    - Regular updates
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Procedure Inventory
    description: |
      Inventory recovery procedure documentation.
    duration_estimate: 60 min
    commands:
    - purpose: Find recovery procedures
      command: |
        find . -type f \( -name "*recovery*" -o -name "*restore*" \
          -o -name "*runbook*" \) 2>/dev/null | head -30
    - purpose: Search for procedure documentation
      command: |
        grep -rniE "(recovery|restore).*procedure" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -30
    expected_findings:
    - Procedure documentation
    - Runbooks
    - Coverage inventory
  - id: '2'
    name: Coverage Assessment
    description: |
      Assess coverage of critical systems.
    duration_estimate: 45 min
    commands:
    - purpose: Check for critical system coverage
      command: |
        grep -rniE "(critical|essential|tier.1).*recovery" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    - purpose: Find system references
      command: |
        grep -rniE "(system|service|application).*procedure" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    expected_findings:
    - Critical system coverage
    - System identification
    - Gap identification
  - id: '3'
    name: Quality Assessment
    description: |
      Evaluate procedure quality and executability.
    duration_estimate: 45 min
    commands:
    - purpose: Find step-by-step documentation
      command: |
        grep -rniE "(step|procedure|instruction)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    - purpose: Check for dependencies
      command: |
        grep -rniE "(depend|prerequisite|sequence|order)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Procedure structure
    - Dependency documentation
    - Quality indicators
  - id: '4'
    name: Maintenance Review
    description: |
      Assess procedure maintenance and version control.
    duration_estimate: 30 min
    commands:
    - purpose: Check for update dates
      command: |
        grep -rniE "(last_updated|updated|reviewed).*202[0-9]" \
          --include="*.yaml" --include="*.json" . 2>/dev/null | \
          grep -iE "recovery|runbook|procedure" | head -20
    - purpose: Find version information
      command: |
        grep -rniE "(version|revision|v[0-9])" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | \
          grep -iE "recovery|procedure" | head -15
    expected_findings:
    - Update dates
    - Version information
    - Maintenance evidence
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Procedure Inventory
    - Coverage Assessment
    - Quality Review
    - Recommendations
  - type: coverage_matrix
    format: table
    description: Procedure coverage by system
  confidence_guidance:
    high: Comprehensive, tested, current procedures
    medium: Procedures exist but gaps in coverage or quality
    low: Minimal or no documented procedures
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: iso-22301
      priority: required
    - source_id: nist-800-34
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires comprehensive procedure review
    full:
      included: true
      priority: 1
    security:
      included: true
      priority: 1
closeout_checklist:
- id: recproc-001
  item: Recovery procedures documented
  level: CRITICAL
  verification: manual
  verification_notes: Verify procedure documentation
  expected: Confirmed by reviewer
- id: recproc-002
  item: Critical systems covered
  level: CRITICAL
  verification: manual
  verification_notes: Verify coverage of critical systems
  expected: Confirmed by reviewer
- id: recproc-003
  item: Procedures tested
  level: BLOCKING
  verification: manual
  verification_notes: Verify test evidence
  expected: Confirmed by reviewer
- id: recproc-004
  item: Procedures current
  level: BLOCKING
  verification: manual
  verification_notes: Verify procedure currency
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: ISO 22301
    controls:
    - Clause 8.4
  - framework: NIST 800-34
    controls:
    - Section 3.4
    - Section 4
  - framework: SOC 2
    controls:
    - A1.2
    - A1.3
  - framework: COBIT 2019
    controls:
    - DSS04
relationships:
  commonly_combined:
  - risk-management.business-continuity.bcp-documentation
  - risk-management.business-continuity.disaster-recovery-planning
  - risk-management.business-continuity.continuity-testing
