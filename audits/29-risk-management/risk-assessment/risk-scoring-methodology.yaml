audit:
  id: risk-management.risk-assessment.risk-scoring-methodology
  name: Risk Scoring Methodology Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: risk-management
  category_number: 29
  subcategory: risk-assessment
  tier: phd
  estimated_duration: 3-4 hours  # median: 3h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  requires_interviews: true
  severity: high
  scope: organizational
  default_profiles:
  - full
  - security
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines the risk scoring methodology:
    - Risk score calculation formula (e.g., Likelihood x Impact)
    - Scoring scale definitions and ranges
    - Treatment of control effectiveness in scores
    - Inherent vs. residual risk scoring
    - Score aggregation for risk portfolios
    - Risk heat map and visualization approaches
    - Score-based risk thresholds and categorization
  why_it_matters: |
    The risk scoring methodology determines how risks are prioritized:
    - Scoring is the basis for risk-based resource allocation
    - Flawed scoring leads to misallocated resources and missed risks
    - ISO 31000 requires consistent criteria for risk comparison
    - NIST emphasizes the need for consistent risk determination
    - Different scoring approaches (additive vs. multiplicative) yield
      different prioritization
    - Aggregation methods affect portfolio-level risk understanding
    - Scoring must support decision-making at multiple organizational levels
  when_to_run:
  - During risk methodology implementation
  - Annual risk management review
  - When scoring inconsistencies are identified
  - After implementing new risk tools
  - During internal audit assessments
prerequisites:
  required_artifacts:
  - type: risk_methodology
    description: Risk assessment methodology documentation
  - type: scoring_criteria
    description: Risk scoring criteria and formulas
  - type: risk_register
    description: Risk register with calculated scores
  access_requirements:
  - Access to risk methodology documentation
  - Access to scoring formulas and criteria
  - Access to risk register with scores
discovery:
  code_patterns:
  - pattern: (risk_score|risk_rating|overall_risk)\s*[=:]
    type: regex
    scope: config
    purpose: Find risk score configurations
  - pattern: (likelihood|probability)\s*\*\s*(impact|severity)
    type: regex
    scope: config
    purpose: Find multiplicative scoring formulas
  - pattern: (inherent|residual|current|net).*risk
    type: regex
    scope: docs
    purpose: Find inherent vs residual risk references
  file_patterns:
  - glob: '**/risk*score*.{yaml,yml,json,md}'
    purpose: Risk scoring files
  - glob: '**/risk*method*.{yaml,yml,json,md}'
    purpose: Risk methodology files
  - glob: '**/risk*matrix*.{yaml,yml,json,md}'
    purpose: Risk matrix files
knowledge_sources:
  specifications:
  - id: iso-31000-2018
    name: ISO 31000:2018 Risk Management
    url: https://www.iso.org/iso-31000-risk-management.html
    offline_cache: true
    priority: required
  - id: nist-800-30
    name: NIST SP 800-30 Risk Assessment Guide
    url: https://csrc.nist.gov/publications/detail/sp/800-30/rev-1/final
    offline_cache: true
    priority: required
  - id: fair-framework
    name: FAIR Risk Analysis Framework
    url: https://www.fairinstitute.org/
    offline_cache: true
    priority: recommended
  guides:
  - id: risk-matrix-design
    name: Risk Matrix Design Best Practices
    url: https://www.riskmethods.com/
    offline_cache: true
tooling:
  static_analysis:
  - tool: scoring-analyzer
    purpose: Analyze risk score distribution
    offline_capable: true
  scripts:
  - id: score-scanner
    language: bash
    purpose: Scan for risk scores
    source: inline
    code: |
      #!/bin/bash
      echo "=== Risk Score Scan ==="
      grep -rniE "(risk_score|overall_risk|risk_rating)\\s*[=:]\\s*" \
        --include="*.yaml" --include="*.json" . 2>/dev/null | head -30
signals:
  critical:
  - id: RSCORE-CRIT-001
    signal: No defined risk scoring methodology
    evidence_indicators:
    - No documented scoring formula
    - Risk scores assigned subjectively
    - Inconsistent scoring across assessors
    explanation: |
      A defined scoring methodology is essential for consistent risk
      prioritization. Without it, risks cannot be meaningfully compared
      and resources cannot be allocated effectively.
    remediation: |
      - Define standard risk scoring formula
      - Document scoring methodology
      - Implement scoring in risk tools
      - Train assessors on methodology
  - id: RSCORE-CRIT-002
    signal: Scoring methodology fundamentally flawed
    evidence_indicators:
    - Additive scoring hides high-impact risks
    - Scale ranges create clustering
    - Formula produces illogical results
    explanation: |
      Flawed scoring methodologies lead to systematically incorrect
      prioritization. Common issues include additive formulas that hide
      high-severity/low-probability risks and scales that cluster most
      risks in the middle.
    remediation: |
      - Review scoring formula for mathematical soundness
      - Use multiplicative scoring for risk = L x I
      - Calibrate scales to achieve useful distribution
      - Validate results against expert judgment
  high:
  - id: RSCORE-HIGH-001
    signal: Control effectiveness not factored in scoring
    evidence_indicators:
    - No distinction between inherent and residual risk
    - Controls not reflected in scores
    - Only gross risk assessed
    explanation: |
      Risk scores should reflect control effectiveness to understand
      current exposure. Without this, organizations cannot measure
      control value or prioritize control improvements.
    remediation: |
      - Implement inherent and residual risk scoring
      - Factor control effectiveness into residual scores
      - Track both inherent and residual risk
      - Calculate control value as score difference
  - id: RSCORE-HIGH-002
    signal: Risk scores not aligned with risk appetite
    evidence_indicators:
    - No thresholds defined for score ranges
    - Unclear what scores require action
    - Risk appetite not expressed in scoring terms
    explanation: |
      Risk scores must connect to risk appetite to drive action. Without
      clear thresholds, scores are informational rather than actionable.
    remediation: |
      - Define risk thresholds aligned with appetite
      - Map score ranges to required responses
      - Document escalation triggers
      - Align reporting to thresholds
  medium:
  - id: RSCORE-MED-001
    signal: Score aggregation methodology unclear
    evidence_indicators:
    - No defined approach for portfolio scoring
    - Unclear how to combine multiple risks
    - Aggregation may mask significant risks
    explanation: |
      Portfolio-level risk views require aggregation, but naive aggregation
      can mask significant individual risks. Clear methodology is needed.
    remediation: |
      - Define aggregation methodology
      - Consider correlation in aggregation
      - Preserve visibility of significant risks
      - Document aggregation limitations
  - id: RSCORE-MED-002
    signal: Risk matrix design creates false precision
    evidence_indicators:
    - Too many score categories
    - Meaningless distinctions between levels
    - Precision exceeds assessment accuracy
    explanation: |
      Overly detailed risk matrices create false precision. The granularity
      of scoring should match the accuracy of underlying assessments.
    remediation: |
      - Simplify matrix to meaningful distinctions
      - Use 3-5 levels for each dimension
      - Match precision to assessment accuracy
      - Focus on actionable categorization
  low:
  - id: RSCORE-LOW-001
    signal: Risk heat map not used effectively
    evidence_indicators:
    - Heat map generated but not used
    - No decision-making from visualization
    - Heat map not communicated
    explanation: |
      Risk heat maps are powerful communication tools but require
      effective use to drive decision-making.
    remediation: |
      - Integrate heat maps into reporting
      - Use for executive communication
      - Track movement on heat maps over time
      - Drive prioritization discussions from visuals
  positive:
  - id: RSCORE-POS-001
    signal: Well-designed risk scoring methodology
    evidence_indicators:
    - Documented scoring formula
    - Inherent and residual scoring
    - Aligned with risk appetite
  - id: RSCORE-POS-002
    signal: Effective risk visualization
    evidence_indicators:
    - Risk heat maps in use
    - Thresholds clearly defined
    - Scores drive decision-making
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Methodology Review
    description: |
      Evaluate the documented risk scoring methodology for soundness
      and alignment with best practices.
    duration_estimate: 45 min
    commands:
    - purpose: Find scoring methodology documentation
      command: |
        find . -type f \( -name "*risk*score*" -o -name "*risk*method*" \
          -o -name "*risk*matrix*" \) 2>/dev/null | head -15
    - purpose: Search for scoring formula references
      command: |
        grep -rniE "(score|rating)\\s*(formula|calculation|methodology)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -30
    expected_findings:
    - Scoring methodology documentation
    - Formula definitions
    - Scale and range specifications
  - id: '2'
    name: Inherent vs Residual Assessment
    description: |
      Evaluate whether both inherent and residual risk scoring are
      implemented and used.
    duration_estimate: 30 min
    commands:
    - purpose: Search for inherent/residual risk references
      command: |
        grep -rniE "(inherent|residual|gross|net|current).*risk.*(score|rating)" \
          --include="*.md" --include="*.yaml" --include="*.json" . 2>/dev/null | head -30
    - purpose: Check for control effectiveness in scoring
      command: |
        grep -rniE "(control|mitigation|treatment).*effectiveness.*(score|factor)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    expected_findings:
    - Inherent risk scoring
    - Residual risk scoring
    - Control effectiveness factors
  - id: '3'
    name: Threshold Analysis
    description: |
      Assess how risk scores connect to risk appetite and action thresholds.
    duration_estimate: 30 min
    commands:
    - purpose: Search for risk thresholds
      command: |
        grep -rniE "(threshold|tolerance|appetite|acceptable).*risk.*score" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    - purpose: Check for score-based escalation
      command: |
        grep -rniE "(escalat|action|response|treat).*score" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Risk thresholds defined
    - Score-based response requirements
    - Escalation triggers
  - id: '4'
    name: Application Review
    description: |
      Evaluate how scoring methodology is applied in practice.
    duration_estimate: 30 min
    commands:
    - purpose: Find risk scores in register
      command: |
        grep -rniE "(risk_score|overall_risk|risk_level)\\s*[=:]" \
          --include="*.yaml" --include="*.json" --include="*.csv" . 2>/dev/null | head -30
    - purpose: Check score distribution
      command: |
        grep -rniE "risk_score\\s*[=:]\\s*[0-9]+" \
          --include="*.yaml" --include="*.json" . 2>/dev/null | head -30
    expected_findings:
    - Consistent score application
    - Reasonable score distribution
    - Both inherent and residual scores
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Methodology Assessment
    - Threshold Analysis
    - Application Review
    - Recommendations
  - type: score_distribution
    format: table
    description: Risk score distribution analysis
  confidence_guidance:
    high: Well-documented methodology consistently applied
    medium: Methodology exists but application issues
    low: Informal or inconsistent scoring
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: iso-31000-2018
      priority: required
    - source_id: nist-800-30
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires comprehensive methodology review
    full:
      included: true
      priority: 2
    security:
      included: true
      priority: 2
closeout_checklist:
- id: rscore-001
  item: Risk scoring methodology documented
  level: CRITICAL
  verification: manual
  verification_notes: Verify existence of documented scoring methodology
  expected: Confirmed by reviewer
- id: rscore-002
  item: Both inherent and residual scoring implemented
  level: CRITICAL
  verification: manual
  verification_notes: Verify both score types are calculated
  expected: Confirmed by reviewer
- id: rscore-003
  item: Risk thresholds aligned with appetite
  level: BLOCKING
  verification: manual
  verification_notes: Verify thresholds connect to risk appetite
  expected: Confirmed by reviewer
- id: rscore-004
  item: Scoring consistently applied
  level: BLOCKING
  verification: manual
  verification_notes: Verify consistent application across risks
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: ISO 31000
    controls:
    - Clause 6.4.3
    - Clause 6.4.4
  - framework: NIST 800-30
    controls:
    - Section 2.4
  - framework: COBIT 2019
    controls:
    - APO12.02
    - APO12.03
relationships:
  commonly_combined:
  - risk-management.risk-assessment.risk-likelihood-assessment
  - risk-management.risk-assessment.risk-impact-analysis
  - risk-management.risk-assessment.risk-prioritization
