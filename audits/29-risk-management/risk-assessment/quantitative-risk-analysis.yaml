# ============================================================
# AUDIT: Quantitative Risk Analysis
# Category: 29 - Risk Management
# Subcategory: risk-assessment
# ============================================================
# Evaluates the use of quantitative methods for risk assessment
# including FAIR, Monte Carlo simulation, and statistical analysis.
# ============================================================

audit:
  id: "risk-management.risk-assessment.quantitative-risk-analysis"
  name: "Quantitative Risk Analysis Audit"
  version: "1.0.0"
  last_updated: "2025-01-22"
  status: "active"

  category: "risk-management"
  category_number: 29
  subcategory: "risk-assessment"

  tier: "phd"
  estimated_duration: "4-6 hours"  # median: 5h

  completeness: "requires_discovery"
  requires_runtime: false
  destructive: false

execution:
  automatable: "partial"
  requires_interviews: true
  severity: "medium"
  scope: "organizational"

  default_profiles:
    - "full"
    - "security"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    This audit examines quantitative risk analysis practices:
    - Use of FAIR (Factor Analysis of Information Risk) methodology
    - Monte Carlo simulation for risk aggregation
    - Loss distribution modeling
    - Data collection and statistical analysis
    - Quantification of probability and impact in monetary terms
    - Integration of quantitative results with decision-making
    - Appropriate scope for quantitative analysis

  why_it_matters: |
    Quantitative risk analysis enables data-driven risk decisions:
    - Expresses risk in business terms (dollars, time, probability)
    - Enables cost-benefit analysis for risk treatments
    - FAIR is becoming an industry standard for cyber risk quantification
    - Supports more precise risk communication to executives and boards
    - ISO 31000 includes quantitative analysis as a valid approach
    - Quantitative methods can reveal risks hidden by qualitative approaches
    - However, quantitative analysis requires appropriate data and expertise
    - Precision without accuracy creates false confidence

  when_to_run:
    - "When implementing quantitative risk methodology"
    - "During annual risk methodology review"
    - "For high-value risk decisions requiring precise analysis"
    - "When evaluating risk transfer options (insurance, etc.)"
    - "After implementing FAIR or similar frameworks"

prerequisites:
  required_artifacts:
    - type: "risk_methodology"
      description: "Quantitative risk methodology documentation"
    - type: "loss_data"
      description: "Historical loss data and incident records"
    - type: "risk_models"
      description: "Risk quantification models"

  access_requirements:
    - "Access to quantitative risk methodology"
    - "Access to loss data and statistics"
    - "Access to risk modeling tools"
    - "Understanding of statistical methods"

discovery:
  code_patterns:
    - pattern: "(FAIR|quantitative|monte.carlo|simulation).*risk"
      type: "regex"
      scope: "docs"
      purpose: "Find quantitative risk references"

    - pattern: "(loss.magnitude|loss.event.frequency|probability.distribution)"
      type: "regex"
      scope: "docs"
      purpose: "Find FAIR methodology references"

    - pattern: "(\\$[0-9]+|\\d+\\s*(million|thousand|M|K)).*risk"
      type: "regex"
      scope: "docs"
      purpose: "Find monetized risk values"

  file_patterns:
    - glob: "**/fair*.{yaml,yml,json,md,xlsx}"
      purpose: "FAIR methodology files"
    - glob: "**/quantitative*.{yaml,yml,json,md}"
      purpose: "Quantitative analysis files"
    - glob: "**/risk*model*.{yaml,yml,json,py,xlsx}"
      purpose: "Risk model files"

knowledge_sources:
  specifications:
    - id: "fair-standard"
      name: "FAIR Risk Analysis Standard"
      url: "https://www.fairinstitute.org/fair-standard"
      offline_cache: true
      priority: "required"

    - id: "iso-31000-2018"
      name: "ISO 31000:2018 Risk Management"
      url: "https://www.iso.org/iso-31000-risk-management.html"
      offline_cache: true
      priority: "required"

    - id: "open-group-fair"
      name: "Open Group FAIR Standard"
      url: "https://www.opengroup.org/fair"
      offline_cache: true
      priority: "recommended"

  guides:
    - id: "fair-institute-guides"
      name: "FAIR Institute Learning Resources"
      url: "https://www.fairinstitute.org/resources"
      offline_cache: true

    - id: "risklens-education"
      name: "RiskLens FAIR Education"
      url: "https://www.risklens.com/education"
      offline_cache: true

tooling:
  static_analysis:
    - tool: "fair-analyzer"
      purpose: "Analyze FAIR model completeness"
      offline_capable: true

  infrastructure_tools:
    - tool: "risklens"
      purpose: "FAIR-based risk quantification platform"
      command: "risklens analyze --scenario $SCENARIO"

    - tool: "monte-carlo-sim"
      purpose: "Monte Carlo risk simulation"
      command: "python risk_simulation.py"

  scripts:
    - id: "quantitative-scanner"
      language: "bash"
      purpose: "Scan for quantitative risk data"
      source: "inline"
      code: |
        #!/bin/bash
        echo "=== Quantitative Risk Scan ==="
        find . -type f \( -name "*fair*" -o -name "*quantitative*" -o -name "*monte*carlo*" \) \
          2>/dev/null | head -20

signals:
  critical:
    - id: "QUANTR-CRIT-001"
      signal: "Quantitative analysis used without appropriate data"
      evidence_indicators:
        - "Models use fabricated or assumed data"
        - "No historical loss data available"
        - "Probability distributions not validated"
      explanation: |
        Quantitative analysis requires appropriate data to be meaningful.
        Using fabricated inputs creates false precision and potentially
        worse decisions than qualitative analysis.
      remediation: |
        - Assess data availability before quantitative analysis
        - Use qualitative methods where data insufficient
        - Document data sources and limitations
        - Validate assumptions with available evidence

    - id: "QUANTR-CRIT-002"
      signal: "Results presented without uncertainty"
      evidence_indicators:
        - "Point estimates only, no ranges"
        - "No confidence intervals"
        - "Decision-makers unaware of uncertainty"
      explanation: |
        Quantitative risk results are inherently uncertain. Presenting
        point estimates without ranges creates false confidence and
        inappropriate decision-making.
      remediation: |
        - Always present ranges, not point estimates
        - Include confidence intervals
        - Communicate uncertainty to decision-makers
        - Use distributions, not single values

  high:
    - id: "QUANTR-HIGH-001"
      signal: "FAIR methodology incompletely implemented"
      evidence_indicators:
        - "Missing FAIR factors"
        - "Incorrect factor relationships"
        - "No calibrated estimation"
      explanation: |
        FAIR is a structured methodology that requires complete implementation.
        Partial implementation may produce incorrect results and misleading
        prioritization.
      remediation: |
        - Implement complete FAIR ontology
        - Ensure correct factor relationships
        - Use calibrated estimation techniques
        - Validate model against known scenarios

    - id: "QUANTR-HIGH-002"
      signal: "Monte Carlo inputs not properly specified"
      evidence_indicators:
        - "Inappropriate distribution choices"
        - "Correlations not modeled"
        - "Insufficient iterations"
      explanation: |
        Monte Carlo simulation quality depends on input specification.
        Poor inputs produce misleading outputs, particularly when
        correlations are ignored.
      remediation: |
        - Select appropriate probability distributions
        - Model correlations between variables
        - Use sufficient iterations for convergence
        - Validate output distributions

  medium:
    - id: "QUANTR-MED-001"
      signal: "Quantitative results not integrated with decisions"
      evidence_indicators:
        - "Analysis performed but not used"
        - "Decisions made on qualitative criteria"
        - "No cost-benefit analysis from results"
      explanation: |
        Quantitative analysis provides value only when integrated into
        decision-making. If results are ignored, the effort is wasted.
      remediation: |
        - Integrate results into risk reporting
        - Use for cost-benefit analysis
        - Inform risk treatment decisions
        - Track predicted vs. actual outcomes

    - id: "QUANTR-MED-002"
      signal: "Loss data not systematically collected"
      evidence_indicators:
        - "Ad-hoc loss recording"
        - "Incomplete incident data"
        - "No structured loss taxonomy"
      explanation: |
        Quantitative analysis depends on quality loss data. Systematic
        collection builds the foundation for increasingly accurate
        risk quantification over time.
      remediation: |
        - Implement structured loss data collection
        - Define loss taxonomy
        - Capture all relevant incident costs
        - Build internal loss database

  low:
    - id: "QUANTR-LOW-001"
      signal: "Industry data not used"
      evidence_indicators:
        - "Only internal data considered"
        - "No benchmarking against industry"
        - "Limited data sample"
      explanation: |
        Industry data can supplement limited internal data, improving
        the statistical basis for quantitative analysis.
      remediation: |
        - Incorporate industry loss data
        - Use VERIS, Advisen, or similar databases
        - Benchmark against industry statistics
        - Combine internal and external data

  positive:
    - id: "QUANTR-POS-001"
      signal: "Mature quantitative risk program"
      evidence_indicators:
        - "FAIR or equivalent fully implemented"
        - "Quality loss data collection"
        - "Results integrated with decisions"

    - id: "QUANTR-POS-002"
      signal: "Appropriate uncertainty communication"
      evidence_indicators:
        - "Results presented as ranges"
        - "Confidence levels stated"
        - "Limitations acknowledged"

procedure:
  context:
    cognitive_mode: "analytical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Methodology Assessment"
      description: |
        Evaluate the quantitative risk methodology for completeness
        and alignment with standards like FAIR.
      duration_estimate: "60 min"

      commands:
        - purpose: "Find quantitative methodology documentation"
          command: |
            find . -type f \( -name "*fair*" -o -name "*quantitative*" \
              -o -name "*risk*model*" \) 2>/dev/null | head -15

        - purpose: "Search for FAIR references"
          command: |
            grep -rniE "(FAIR|loss.event.frequency|loss.magnitude|threat.event.frequency)" \
              --include="*.md" --include="*.yaml" . 2>/dev/null | head -30

      expected_findings:
        - "Methodology documentation"
        - "FAIR or equivalent framework"
        - "Model specifications"

    - id: "2"
      name: "Data Quality Assessment"
      description: |
        Assess the quality and availability of data used in
        quantitative risk analysis.
      duration_estimate: "45 min"

      commands:
        - purpose: "Find loss data files"
          command: |
            find . -type f \( -name "*loss*" -o -name "*incident*data*" \
              -o -name "*breach*cost*" \) 2>/dev/null | head -15

        - purpose: "Search for data source documentation"
          command: |
            grep -rniE "(data.source|loss.data|historical|veris|advisen)" \
              --include="*.md" --include="*.yaml" . 2>/dev/null | head -20

      expected_findings:
        - "Loss data collection"
        - "Data source documentation"
        - "Data quality assessment"

    - id: "3"
      name: "Uncertainty Analysis"
      description: |
        Evaluate how uncertainty is handled and communicated in
        quantitative results.
      duration_estimate: "45 min"

      commands:
        - purpose: "Search for uncertainty communication"
          command: |
            grep -rniE "(confidence|uncertainty|range|distribution|percentile)" \
              --include="*.md" --include="*.yaml" . 2>/dev/null | head -20

        - purpose: "Find Monte Carlo references"
          command: |
            grep -rniE "(monte.carlo|simulation|iteration|convergence)" \
              --include="*.md" --include="*.yaml" --include="*.py" . 2>/dev/null | head -15

      expected_findings:
        - "Uncertainty documentation"
        - "Range-based results"
        - "Simulation evidence"

    - id: "4"
      name: "Integration Assessment"
      description: |
        Assess how quantitative results are integrated into
        risk decisions and reporting.
      duration_estimate: "30 min"

      commands:
        - purpose: "Find risk decision documentation"
          command: |
            grep -rniE "(decision|cost.benefit|roi|treatment).*quantitative" \
              --include="*.md" --include="*.yaml" . 2>/dev/null | head -15

        - purpose: "Search for executive reporting"
          command: |
            grep -rniE "(executive|board|report).*risk.*(quantif|dollar|monetary)" \
              --include="*.md" --include="*.yaml" . 2>/dev/null | head -15

      expected_findings:
        - "Decision integration"
        - "Cost-benefit analysis"
        - "Executive reporting"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Methodology Assessment"
        - "Data Quality Review"
        - "Uncertainty Analysis"
        - "Recommendations"

    - type: "maturity_assessment"
      format: "table"
      description: "Quantitative risk program maturity"

  confidence_guidance:
    high: "FAIR implemented with quality data and uncertainty communication"
    medium: "Some quantitative methods but gaps in data or methodology"
    low: "Minimal or no quantitative risk analysis"

offline:
  capability: "partial"

  cache_manifest:
    knowledge:
      - source_id: "fair-standard"
        priority: "required"
      - source_id: "iso-31000-2018"
        priority: "required"

profiles:
  membership:
    quick:
      included: false
      reason: "Requires in-depth methodology review"
    full:
      included: true
      priority: 3
    security:
      included: true
      priority: 2

closeout_checklist:
  - id: "quantr-001"
    item: "Quantitative methodology documented"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Verify documented quantitative approach"
    expected: "Confirmed by reviewer"

  - id: "quantr-002"
    item: "Data sources documented and validated"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Verify data quality and source documentation"
    expected: "Confirmed by reviewer"

  - id: "quantr-003"
    item: "Uncertainty communicated in results"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Verify ranges and confidence levels presented"
    expected: "Confirmed by reviewer"

  - id: "quantr-004"
    item: "Results integrated with decision-making"
    level: "WARNING"
    verification: "manual"
    verification_notes: "Verify quantitative results inform decisions"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["all"]

  compliance_frameworks:
    - framework: "ISO 31000"
      controls: ["Clause 6.4.3"]
    - framework: "FAIR"
      controls: ["Risk Quantification"]
    - framework: "NIST CSF"
      controls: ["ID.RA-4"]
    - framework: "COBIT 2019"
      controls: ["APO12.02"]

relationships:
  commonly_combined:
    - "risk-management.risk-assessment.qualitative-risk-analysis"
    - "risk-management.risk-assessment.risk-scoring-methodology"
    - "risk-management.risk-mitigation.risk-response-planning"
