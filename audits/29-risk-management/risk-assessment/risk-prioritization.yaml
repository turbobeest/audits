audit:
  id: risk-management.risk-assessment.risk-prioritization
  name: Risk Prioritization Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: risk-management
  category_number: 29
  subcategory: risk-assessment
  tier: phd
  estimated_duration: 3-4 hours  # median: 3h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  requires_interviews: true
  severity: high
  scope: organizational
  default_profiles:
  - full
  - security
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines how risks are prioritized for action:
    - Prioritization criteria and methodology
    - Alignment with risk appetite and tolerance
    - Consideration of multiple factors beyond risk score
    - Treatment capacity and resource constraints
    - Stakeholder input in prioritization decisions
    - Documentation of prioritization rationale
    - Regular review and adjustment of priorities
  why_it_matters: |
    Risk prioritization determines where resources are allocated:
    - Organizations cannot address all risks; prioritization is essential
    - ISO 31000 requires risk evaluation to support decision-making
    - Poor prioritization wastes resources on low-priority risks
    - Critical risks left unaddressed can cause significant harm
    - NIST emphasizes prioritization based on risk level and criticality
    - Prioritization must balance risk score with strategic factors
    - Transparent prioritization builds stakeholder confidence
  when_to_run:
  - Annual risk management review
  - After completing risk assessments
  - When resource constraints change
  - Following changes to risk appetite
  - During strategic planning cycles
prerequisites:
  required_artifacts:
  - type: risk_register
    description: Risk register with assessed risks
  - type: risk_appetite
    description: Risk appetite and tolerance statements
  - type: prioritization_criteria
    description: Risk prioritization criteria
  access_requirements:
  - Access to risk register and assessments
  - Access to risk appetite documentation
  - Understanding of resource constraints
discovery:
  code_patterns:
  - pattern: (priorit|rank|order|treatment.plan).*risk
    type: regex
    scope: docs
    purpose: Find risk prioritization documentation
  - pattern: (top.risk|critical.risk|high.priority.risk)
    type: regex
    scope: docs
    purpose: Find prioritized risk references
  - pattern: (risk.appetite|tolerance|threshold).*priorit
    type: regex
    scope: docs
    purpose: Find appetite-based prioritization
  file_patterns:
  - glob: '**/risk*priorit*.{yaml,yml,json,md}'
    purpose: Risk prioritization files
  - glob: '**/top*risk*.{yaml,yml,json,md}'
    purpose: Top risk files
  - glob: '**/risk*treatment*.{yaml,yml,json,md}'
    purpose: Risk treatment files
knowledge_sources:
  specifications:
  - id: iso-31000-2018
    name: ISO 31000:2018 Risk Management
    url: https://www.iso.org/iso-31000-risk-management.html
    offline_cache: true
    priority: required
  - id: nist-800-30
    name: NIST SP 800-30 Risk Assessment Guide
    url: https://csrc.nist.gov/publications/detail/sp/800-30/rev-1/final
    offline_cache: true
    priority: required
  guides:
  - id: coso-priority
    name: COSO ERM Risk Prioritization
    url: https://www.coso.org/
    offline_cache: true
tooling:
  static_analysis:
  - tool: priority-analyzer
    purpose: Analyze risk prioritization patterns
    offline_capable: true
  scripts:
  - id: priority-scanner
    language: bash
    purpose: Scan for priority assignments
    source: inline
    code: |
      #!/bin/bash
      echo "=== Risk Priority Scan ==="
      grep -rniE "(priority|rank)\\s*[=:]\\s*(high|medium|low|critical|[1-9])" \
        --include="*.yaml" --include="*.json" . 2>/dev/null | head -30
signals:
  critical:
  - id: RPRIO-CRIT-001
    signal: No risk prioritization process exists
    evidence_indicators:
    - No documented prioritization criteria
    - All risks treated as equal priority
    - No top risks identified
    explanation: |
      Without prioritization, risk treatment is random or ad-hoc. ISO 31000
      requires risk evaluation to support decision-making about risk
      treatment priorities.
    remediation: |
      - Define risk prioritization criteria
      - Establish prioritization process
      - Identify and document top risks
      - Align prioritization with risk appetite
  - id: RPRIO-CRIT-002
    signal: Prioritization disconnected from risk appetite
    evidence_indicators:
    - No reference to risk appetite in prioritization
    - Risks above appetite not flagged
    - Thresholds not used for prioritization
    explanation: |
      Risk appetite defines what risks require immediate attention.
      Prioritization disconnected from appetite may not address the
      most important risks from an organizational perspective.
    remediation: |
      - Link prioritization to risk appetite thresholds
      - Flag risks exceeding tolerance for immediate action
      - Document how appetite informs prioritization
      - Review appetite alignment regularly
  high:
  - id: RPRIO-HIGH-001
    signal: Prioritization based solely on risk score
    evidence_indicators:
    - No consideration of strategic factors
    - Treatment capacity not considered
    - Regulatory requirements not factored
    explanation: |
      Risk score is necessary but not sufficient for prioritization.
      Strategic importance, regulatory requirements, and treatment
      feasibility should also influence priorities.
    remediation: |
      - Include strategic alignment in prioritization
      - Consider regulatory and compliance factors
      - Factor in treatment feasibility
      - Balance multiple prioritization criteria
  - id: RPRIO-HIGH-002
    signal: No stakeholder input in prioritization
    evidence_indicators:
    - Risk team prioritizes in isolation
    - Business units not consulted
    - Executive oversight absent
    explanation: |
      Prioritization affects the entire organization. Stakeholder input
      ensures priorities reflect diverse perspectives and organizational
      needs.
    remediation: |
      - Include stakeholders in prioritization process
      - Obtain business unit input on priorities
      - Ensure executive oversight and approval
      - Document stakeholder input and decisions
  medium:
  - id: RPRIO-MED-001
    signal: Prioritization rationale not documented
    evidence_indicators:
    - Only priority levels recorded
    - No explanation for rankings
    - Unable to explain prioritization decisions
    explanation: |
      Documented rationale supports transparency and enables review
      of prioritization decisions. It also aids learning and improvement.
    remediation: |
      - Document rationale for priority decisions
      - Explain factors considered
      - Enable audit trail of decisions
      - Review rationale quality periodically
  - id: RPRIO-MED-002
    signal: Priorities not reviewed regularly
    evidence_indicators:
    - Static priority assignments
    - No scheduled priority reviews
    - Priorities unchanged despite conditions
    explanation: |
      Risk conditions change, requiring priority adjustments. Regular
      review ensures priorities remain appropriate and reflect current
      risk landscape.
    remediation: |
      - Schedule regular priority reviews
      - Update priorities when conditions change
      - Track priority changes over time
      - Document reasons for changes
  low:
  - id: RPRIO-LOW-001
    signal: Top risks not communicated to leadership
    evidence_indicators:
    - No executive risk reporting
    - Top risks not visible to leadership
    - No board risk oversight
    explanation: |
      Leadership needs visibility into top risks to provide oversight
      and support risk treatment. Lack of communication limits
      organizational risk awareness.
    remediation: |
      - Report top risks to leadership regularly
      - Include in executive and board reporting
      - Enable leadership oversight of priorities
      - Track leadership acknowledgment
  positive:
  - id: RPRIO-POS-001
    signal: Effective multi-factor prioritization
    evidence_indicators:
    - Multiple criteria considered
    - Aligned with risk appetite
    - Stakeholder input included
  - id: RPRIO-POS-002
    signal: Dynamic prioritization with regular review
    evidence_indicators:
    - Priorities updated regularly
    - Changes documented
    - Responsive to conditions
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Prioritization Criteria Review
    description: |
      Evaluate the criteria used for risk prioritization.
    duration_estimate: 45 min
    commands:
    - purpose: Find prioritization criteria documentation
      command: |
        find . -type f \( -name "*priorit*" -o -name "*rank*" \) \
          -exec grep -l -i "risk" {} \; 2>/dev/null | head -15
    - purpose: Search for prioritization methodology
      command: |
        grep -rniE "(priorit|rank)\\s*(criteria|method|factor)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -30
    expected_findings:
    - Prioritization criteria documentation
    - Multiple factors considered
    - Methodology description
  - id: '2'
    name: Appetite Alignment Assessment
    description: |
      Assess how prioritization aligns with risk appetite and tolerance.
    duration_estimate: 30 min
    commands:
    - purpose: Search for appetite-based prioritization
      command: |
        grep -rniE "(appetite|tolerance|threshold).*priorit" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    - purpose: Find risks exceeding appetite
      command: |
        grep -rniE "(exceed|above|over).*appetite" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Appetite alignment documentation
    - Threshold-based prioritization
    - Appetite exceedance flagging
  - id: '3'
    name: Stakeholder Input Review
    description: |
      Evaluate stakeholder involvement in prioritization decisions.
    duration_estimate: 30 min
    commands:
    - purpose: Search for stakeholder input
      command: |
        grep -rniE "(stakeholder|business.unit|executive).*priorit" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    - purpose: Find approval documentation
      command: |
        grep -rniE "(approv|sign.off|endorse).*priorit" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Stakeholder involvement
    - Approval process
    - Executive oversight
  - id: '4'
    name: Communication Review
    description: |
      Assess how priorities are communicated and reviewed.
    duration_estimate: 30 min
    commands:
    - purpose: Find top risk reporting
      command: |
        find . -type f \( -name "*top*risk*" -o -name "*executive*risk*" \) \
          2>/dev/null | head -15
    - purpose: Search for priority review
      command: |
        grep -rniE "(review|update).*priorit" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Executive reporting
    - Regular review process
    - Communication documentation
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Prioritization Criteria Assessment
    - Appetite Alignment Review
    - Stakeholder Input Analysis
    - Recommendations
  - type: priority_matrix
    format: table
    description: Risk priority distribution and criteria
  confidence_guidance:
    high: Multi-factor prioritization aligned with appetite
    medium: Prioritization exists but gaps in criteria or alignment
    low: Minimal or undocumented prioritization
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: iso-31000-2018
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires comprehensive prioritization review
    full:
      included: true
      priority: 2
    security:
      included: true
      priority: 2
closeout_checklist:
- id: rprio-001
  item: Prioritization criteria documented
  level: CRITICAL
  verification: manual
  verification_notes: Verify documented prioritization criteria
  expected: Confirmed by reviewer
- id: rprio-002
  item: Prioritization aligned with risk appetite
  level: CRITICAL
  verification: manual
  verification_notes: Verify appetite informs prioritization
  expected: Confirmed by reviewer
- id: rprio-003
  item: Stakeholder input included
  level: BLOCKING
  verification: manual
  verification_notes: Verify stakeholder involvement
  expected: Confirmed by reviewer
- id: rprio-004
  item: Top risks communicated to leadership
  level: BLOCKING
  verification: manual
  verification_notes: Verify executive risk reporting
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: ISO 31000
    controls:
    - Clause 6.5
  - framework: NIST 800-30
    controls:
    - Section 2.5
  - framework: COSO ERM
    controls:
    - Risk Prioritization
  - framework: COBIT 2019
    controls:
    - APO12.03
relationships:
  commonly_combined:
  - risk-management.risk-assessment.risk-scoring-methodology
  - risk-management.risk-assessment.risk-tolerance-alignment
  - risk-management.risk-mitigation.risk-response-planning
