audit:
  id: risk-management.compliance-risk.certification-risk
  name: Certification Risk Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: risk-management
  category_number: 29
  subcategory: compliance-risk
  tier: phd
  estimated_duration: 3-4 hours  # median: 3h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: organizational
  default_profiles:
  - full
  - security
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines certification risk management:
    - Certification inventory and status
    - Maintenance requirements and timeline
    - Risk of certification loss
    - Audit preparedness
    - Finding remediation for certifications
    - Scope changes and impact
    - Business dependency on certifications
  why_it_matters: |
    Certifications are often business-critical:
    - Many contracts require certifications (SOC 2, ISO 27001)
    - Certification loss can disqualify from business
    - Maintaining certifications requires ongoing effort
    - Audit failures can impact certification status
    - Scope changes require careful management
    - ISO 31000 includes certification as compliance risk
    - Certification demonstrates security to customers
  when_to_run:
  - Certification renewal planning
  - Before certification audits
  - When scope changes
  - After audit findings
  - During strategic planning
prerequisites:
  required_artifacts:
  - type: certification_inventory
    description: Inventory of certifications
  - type: audit_schedule
    description: Certification audit schedule
  - type: finding_status
    description: Certification finding status
  access_requirements:
  - Access to certification documentation
  - Access to audit status
  - Access to finding tracking
discovery:
  code_patterns:
  - pattern: (SOC.2|ISO.27001|PCI.DSS|certification)
    type: regex
    scope: docs
    purpose: Find certification references
  - pattern: (audit|assessment|examination)
    type: regex
    scope: docs
    purpose: Find audit references
  - pattern: (scope|boundary|included)
    type: regex
    scope: docs
    purpose: Find scope references
  file_patterns:
  - glob: '**/certification*.{yaml,yml,json,md}'
    purpose: Certification files
  - glob: '**/soc2*.{yaml,yml,json,md}'
    purpose: SOC 2 documentation
  - glob: '**/iso27001*.{yaml,yml,json,md}'
    purpose: ISO 27001 documentation
knowledge_sources:
  specifications:
  - id: soc-2
    name: SOC 2 Trust Services Criteria
    url: https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/sorhome
    offline_cache: true
    priority: required
  - id: iso-27001
    name: ISO/IEC 27001 Information Security
    url: https://www.iso.org/isoiec-27001-information-security.html
    offline_cache: true
    priority: required
  guides:
  - id: certification-guide
    name: Certification Management Guide
    url: https://www.isaca.org/
    offline_cache: true
tooling:
  static_analysis:
  - tool: cert-analyzer
    purpose: Analyze certification status
    offline_capable: true
  scripts:
  - id: cert-scanner
    language: bash
    purpose: Scan for certification documentation
    source: inline
    code: |
      #!/bin/bash
      echo "=== Certification Risk Scan ==="
      grep -rniE "(SOC.2|ISO.27001|PCI|certification|certif)" \
        --include="*.yaml" --include="*.md" . 2>/dev/null | head -30
signals:
  critical:
  - id: CERTRISK-CRIT-001
    signal: Certification at risk of loss
    evidence_indicators:
    - Critical findings open
    - Audit deadline approaching
    - Remediation unlikely
    explanation: |
      Losing a required certification can result in loss of
      business, contract breaches, and customer trust damage.
    remediation: |
      - Assess certification risk
      - Expedite remediation
      - Engage leadership
      - Plan contingencies
  - id: CERTRISK-CRIT-002
    signal: No certification maintenance program
    evidence_indicators:
    - Ad-hoc maintenance
    - Audit surprises
    - No ongoing compliance
    explanation: |
      Certifications require continuous compliance. Without
      a program, compliance drifts between audits.
    remediation: |
      - Implement maintenance program
      - Monitor continuously
      - Address gaps promptly
      - Prepare for audits
  high:
  - id: CERTRISK-HIGH-001
    signal: Certification findings not remediated timely
    evidence_indicators:
    - Overdue findings
    - Repeat issues
    - No urgency
    explanation: |
      Findings must be remediated to maintain certification.
      Overdue findings risk certification status.
    remediation: |
      - Prioritize remediation
      - Track to completion
      - Escalate delays
      - Prevent repeat issues
  - id: CERTRISK-HIGH-002
    signal: Scope changes not managed
    evidence_indicators:
    - New services not assessed
    - Scope creep
    - Gaps in coverage
    explanation: |
      Scope changes can affect certification. New services
      must be assessed and included appropriately.
    remediation: |
      - Manage scope changes
      - Assess new services
      - Update certification scope
      - Notify auditors
  medium:
  - id: CERTRISK-MED-001
    signal: Audit preparedness insufficient
    evidence_indicators:
    - Last-minute preparation
    - Evidence not ready
    - Staff unprepared
    explanation: |
      Audit preparedness affects audit outcome. Insufficient
      preparation risks findings and delays.
    remediation: |
      - Plan audit preparation
      - Prepare evidence
      - Train staff
      - Conduct readiness reviews
  - id: CERTRISK-MED-002
    signal: Business dependency on certification not understood
    evidence_indicators:
    - Impact unknown
    - No dependency mapping
    - Risk not communicated
    explanation: |
      Understanding business dependency enables appropriate
      investment and risk treatment.
    remediation: |
      - Map certification dependencies
      - Assess business impact
      - Communicate to leadership
      - Prioritize accordingly
  low:
  - id: CERTRISK-LOW-001
    signal: Certification status not reported
    evidence_indicators:
    - No executive reporting
    - Status unknown
    - Limited visibility
    explanation: |
      Reporting enables leadership oversight and
      demonstrates governance.
    remediation: |
      - Report certification status
      - Include risks and findings
      - Enable oversight
      - Support decisions
  positive:
  - id: CERTRISK-POS-001
    signal: Strong certification management
    evidence_indicators:
    - Continuous compliance
    - Timely remediation
    - Audit preparedness
  - id: CERTRISK-POS-002
    signal: Low certification risk
    evidence_indicators:
    - No critical findings
    - Stable compliance
    - Well-managed scope
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Certification Inventory
    description: |
      Review certification inventory and status.
    duration_estimate: 45 min
    commands:
    - purpose: Find certification documentation
      command: |
        find . -type f \( -name "*certification*" -o -name "*soc*" \
          -o -name "*iso27001*" \) 2>/dev/null | head -20
    - purpose: Search for certification status
      command: |
        grep -rniE "(SOC.2|ISO.27001|PCI|certification).*status" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -30
    expected_findings:
    - Certification inventory
    - Status documentation
    - Timeline information
  - id: '2'
    name: Finding Review
    description: |
      Assess certification finding status.
    duration_estimate: 45 min
    commands:
    - purpose: Find finding documentation
      command: |
        grep -rniE "(finding|deficiency|exception).*certification\|audit" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    - purpose: Check for remediation
      command: |
        grep -rniE "(remediat|correct|address).*finding" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Finding status
    - Remediation progress
    - Risk indicators
  - id: '3'
    name: Maintenance Review
    description: |
      Evaluate certification maintenance program.
    duration_estimate: 30 min
    commands:
    - purpose: Find maintenance documentation
      command: |
        grep -rniE "(maintain|continuous|ongoing).*certification\|compliance" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    expected_findings:
    - Maintenance program
    - Continuous compliance
    - Monitoring approach
  - id: '4'
    name: Dependency Assessment
    description: |
      Assess business dependency on certifications.
    duration_estimate: 30 min
    commands:
    - purpose: Find dependency documentation
      command: |
        grep -rniE "(require|depend|contract).*certification" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Business dependencies
    - Impact assessment
    - Stakeholder requirements
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Certification Inventory
    - Finding Status
    - Risk Assessment
    - Recommendations
  - type: certification_status
    format: table
    description: Certification status summary
  confidence_guidance:
    high: Strong certification management with low risk
    medium: Certifications maintained but some risk indicators
    low: Certifications at risk or poorly managed
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: soc-2
      priority: required
    - source_id: iso-27001
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires comprehensive certification review
    full:
      included: true
      priority: 2
    security:
      included: true
      priority: 1
closeout_checklist:
- id: certrisk-001
  item: Certifications inventoried
  level: CRITICAL
  verification: manual
  verification_notes: Verify certification inventory
  expected: Confirmed by reviewer
- id: certrisk-002
  item: Findings remediated timely
  level: CRITICAL
  verification: manual
  verification_notes: Verify finding status
  expected: Confirmed by reviewer
- id: certrisk-003
  item: Maintenance program in place
  level: BLOCKING
  verification: manual
  verification_notes: Verify maintenance program
  expected: Confirmed by reviewer
- id: certrisk-004
  item: Business dependencies understood
  level: WARNING
  verification: manual
  verification_notes: Verify dependency assessment
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: SOC 2
    controls:
    - All TSC
  - framework: ISO 27001
    controls:
    - Clause 9
    - Clause 10
  - framework: PCI DSS
    controls:
    - Requirement 12
relationships:
  commonly_combined:
  - risk-management.compliance-risk.audit-findings-risk
  - risk-management.compliance-risk.regulatory-compliance-risk
  - risk-management.risk-monitoring.risk-monitoring-process
