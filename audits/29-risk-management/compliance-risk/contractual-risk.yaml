audit:
  id: risk-management.compliance-risk.contractual-risk
  name: Contractual Risk Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: risk-management
  category_number: 29
  subcategory: compliance-risk
  tier: phd
  estimated_duration: 3-4 hours  # median: 3h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: organizational
  default_profiles:
  - full
  - security
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines contractual risk management:
    - Contractual obligation identification
    - SLA compliance tracking
    - Penalty and liability exposure
    - Contract compliance monitoring
    - Breach risk assessment
    - Security requirements in contracts
    - Change management for contracts
  why_it_matters: |
    Contractual risks can have significant business impact:
    - SLA breaches result in penalties and credits
    - Security breaches may violate contract terms
    - Data handling requirements are contractually binding
    - Non-compliance can lead to contract termination
    - Liability exposure can be substantial
    - ISO 31000 includes contractual risk in scope
    - Customer trust depends on meeting commitments
  when_to_run:
  - Contract renewal periods
  - When SLA breaches occur
  - Before major service changes
  - During vendor reviews
  - After security incidents
prerequisites:
  required_artifacts:
  - type: contracts
    description: Key contracts with obligations
  - type: sla_documentation
    description: SLA definitions and tracking
  - type: compliance_metrics
    description: Contract compliance metrics
  access_requirements:
  - Access to contract documentation
  - Access to SLA tracking
  - Access to compliance metrics
discovery:
  code_patterns:
  - pattern: (contract|agreement|SLA).*obligation
    type: regex
    scope: docs
    purpose: Find contractual obligation references
  - pattern: (penalty|liability|breach)
    type: regex
    scope: docs
    purpose: Find penalty/liability references
  - pattern: (service.level|SLA|uptime)
    type: regex
    scope: docs
    purpose: Find SLA references
  file_patterns:
  - glob: '**/contract*.{yaml,yml,json,md}'
    purpose: Contract documentation
  - glob: '**/sla*.{yaml,yml,json,md}'
    purpose: SLA documentation
  - glob: '**/agreement*.{yaml,yml,json,md}'
    purpose: Agreement files
knowledge_sources:
  specifications:
  - id: iso-31000
    name: ISO 31000 Risk Management
    url: https://www.iso.org/iso-31000-risk-management.html
    offline_cache: true
    priority: required
  - id: contract-management
    name: Contract Management Best Practices
    url: https://www.iaccm.com/
    offline_cache: true
    priority: required
  guides:
  - id: sla-guide
    name: SLA Management Guide
    url: https://www.itilnews.com/
    offline_cache: true
tooling:
  static_analysis:
  - tool: contract-analyzer
    purpose: Analyze contractual obligations
    offline_capable: true
  scripts:
  - id: contract-scanner
    language: bash
    purpose: Scan for contract documentation
    source: inline
    code: |
      #!/bin/bash
      echo "=== Contractual Risk Scan ==="
      grep -rniE "(contract|SLA|agreement|obligation)" \
        --include="*.yaml" --include="*.md" . 2>/dev/null | head -30
signals:
  critical:
  - id: CONTRISK-CRIT-001
    signal: Contractual obligations not tracked
    evidence_indicators:
    - No obligation tracking
    - Unknown commitments
    - Obligations not documented
    explanation: |
      Without tracking, obligations may be missed, leading to
      breaches, penalties, and relationship damage.
    remediation: |
      - Inventory contractual obligations
      - Implement tracking system
      - Assign ownership
      - Monitor compliance
  - id: CONTRISK-CRIT-002
    signal: SLA breaches not detected or addressed
    evidence_indicators:
    - No SLA monitoring
    - Breaches undetected
    - No remediation
    explanation: |
      SLA breaches have financial and relationship consequences.
      Undetected breaches compound impact.
    remediation: |
      - Implement SLA monitoring
      - Alert on breaches
      - Track remediation
      - Report to stakeholders
  high:
  - id: CONTRISK-HIGH-001
    signal: High liability exposure unmitigated
    evidence_indicators:
    - Unlimited liability
    - Exposure not assessed
    - No risk transfer
    explanation: |
      Significant liability exposure can threaten the business.
      Assessment and mitigation are essential.
    remediation: |
      - Assess liability exposure
      - Negotiate limits
      - Consider insurance
      - Document risk acceptance
  - id: CONTRISK-HIGH-002
    signal: Security requirements not flowing down
    evidence_indicators:
    - Security obligations not tracked
    - No vendor flow-down
    - Gaps in security compliance
    explanation: |
      Security requirements in contracts must be implemented.
      Gaps expose the organization to breaches and liability.
    remediation: |
      - Map security requirements
      - Implement controls
      - Flow to vendors
      - Verify compliance
  medium:
  - id: CONTRISK-MED-001
    signal: Contract changes not risk assessed
    evidence_indicators:
    - Changes without review
    - New obligations unassessed
    - Ad-hoc changes
    explanation: |
      Contract changes can introduce new obligations or risks.
      Assessment ensures awareness.
    remediation: |
      - Review all changes
      - Assess risk impact
      - Update tracking
      - Communicate changes
  - id: CONTRISK-MED-002
    signal: No contract risk metrics
    evidence_indicators:
    - No metrics tracking
    - Unknown compliance rate
    - No trending
    explanation: |
      Metrics enable understanding of contract risk posture
      and effectiveness of management.
    remediation: |
      - Define contract metrics
      - Track compliance rate
      - Report to leadership
      - Enable improvement
  low:
  - id: CONTRISK-LOW-001
    signal: Contract risks not reported to leadership
    evidence_indicators:
    - No executive reporting
    - Risks not visible
    - Limited awareness
    explanation: |
      Leadership needs visibility into contract risks
      for informed decision-making.
    remediation: |
      - Report to leadership
      - Include in risk reporting
      - Enable oversight
      - Support decisions
  positive:
  - id: CONTRISK-POS-001
    signal: Effective contract risk management
    evidence_indicators:
    - Obligations tracked
    - SLAs monitored
    - Compliance high
  - id: CONTRISK-POS-002
    signal: Proactive contract management
    evidence_indicators:
    - Changes assessed
    - Risks mitigated
    - Relationships strong
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Obligation Review
    description: |
      Evaluate contractual obligation identification and tracking.
    duration_estimate: 45 min
    commands:
    - purpose: Find contract documentation
      command: |
        find . -type f \( -name "*contract*" -o -name "*agreement*" \) \
          2>/dev/null | head -20
    - purpose: Search for obligation references
      command: |
        grep -rniE "(obligation|commitment|requirement).*contract" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -30
    expected_findings:
    - Contract inventory
    - Obligation tracking
    - Coverage documentation
  - id: '2'
    name: SLA Compliance Review
    description: |
      Assess SLA monitoring and compliance.
    duration_estimate: 45 min
    commands:
    - purpose: Find SLA documentation
      command: |
        find . -type f -name "*sla*" 2>/dev/null | head -20
    - purpose: Check for compliance tracking
      command: |
        grep -rniE "(SLA|service.level|uptime).*compliance\|metric" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    expected_findings:
    - SLA definitions
    - Compliance tracking
    - Performance metrics
  - id: '3'
    name: Liability Assessment
    description: |
      Evaluate liability exposure and mitigation.
    duration_estimate: 30 min
    commands:
    - purpose: Find liability references
      command: |
        grep -rniE "(liability|penalty|damages|indemnif)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    expected_findings:
    - Liability exposure
    - Mitigation measures
    - Risk transfer
  - id: '4'
    name: Security Requirements Review
    description: |
      Assess security requirement compliance.
    duration_estimate: 30 min
    commands:
    - purpose: Find security requirements
      command: |
        grep -rniE "(security|privacy).*requirement.*contract" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Security requirements
    - Compliance evidence
    - Flow-down tracking
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Obligation Assessment
    - SLA Compliance Review
    - Liability Analysis
    - Recommendations
  - type: contract_risk_matrix
    format: table
    description: Contract risk by agreement
  confidence_guidance:
    high: Comprehensive contract risk management with SLA compliance
    medium: Tracking exists but gaps in monitoring or compliance
    low: Minimal or no contract risk management
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: iso-31000
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires comprehensive contract review
    full:
      included: true
      priority: 2
    security:
      included: true
      priority: 2
closeout_checklist:
- id: contrisk-001
  item: Contractual obligations tracked
  level: CRITICAL
  verification: manual
  verification_notes: Verify obligation tracking
  expected: Confirmed by reviewer
- id: contrisk-002
  item: SLA compliance monitored
  level: CRITICAL
  verification: manual
  verification_notes: Verify SLA monitoring
  expected: Confirmed by reviewer
- id: contrisk-003
  item: Liability exposure assessed
  level: BLOCKING
  verification: manual
  verification_notes: Verify liability assessment
  expected: Confirmed by reviewer
- id: contrisk-004
  item: Security requirements tracked
  level: BLOCKING
  verification: manual
  verification_notes: Verify security compliance
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: ISO 31000
    controls:
    - Clause 5
  - framework: SOC 2
    controls:
    - CC2.3
    - CC9.1
  - framework: COBIT 2019
    controls:
    - APO10
relationships:
  commonly_combined:
  - risk-management.compliance-risk.legal-liability-risk
  - risk-management.compliance-risk.regulatory-compliance-risk
  - risk-management.risk-assessment.risk-impact-analysis
