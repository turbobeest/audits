audit:
  id: risk-management.compliance-risk.regulatory-compliance-risk
  name: Regulatory Compliance Risk Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: risk-management
  category_number: 29
  subcategory: compliance-risk
  tier: expert
  estimated_duration: 4-6 hours  # median: 5h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: critical
  scope: organizational
  default_profiles:
  - full
  - security
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines regulatory compliance risk management:
    - Regulatory requirement identification
    - Compliance risk assessment process
    - Risk rating and prioritization
    - Compliance gap analysis
    - Remediation tracking
    - Regulatory change monitoring
    - Compliance metrics and reporting
  why_it_matters: |
    Regulatory compliance risk can have severe consequences:
    - Non-compliance penalties can be significant
    - Regulatory requirements continue to expand
    - GDPR fines can reach 4% of global revenue
    - Industry-specific regulations add complexity
    - Compliance failures damage reputation
    - ISO 31000 includes compliance in risk management
    - Proactive compliance risk management reduces exposure
  when_to_run:
  - Annual compliance review
  - When regulations change
  - Before regulatory audits
  - After compliance incidents
  - When entering new markets
prerequisites:
  required_artifacts:
  - type: regulatory_inventory
    description: Inventory of applicable regulations
  - type: compliance_assessments
    description: Compliance assessment results
  - type: gap_analysis
    description: Compliance gap analysis
  access_requirements:
  - Access to regulatory mapping
  - Access to compliance assessments
  - Access to remediation tracking
discovery:
  code_patterns:
  - pattern: (GDPR|HIPAA|PCI|SOX|regulation)
    type: regex
    scope: docs
    purpose: Find regulatory references
  - pattern: (compliance|regulatory).*risk
    type: regex
    scope: docs
    purpose: Find compliance risk references
  - pattern: (non.compliance|violation|penalty)
    type: regex
    scope: docs
    purpose: Find non-compliance references
  file_patterns:
  - glob: '**/compliance*risk*.{yaml,yml,json,md}'
    purpose: Compliance risk files
  - glob: '**/regulatory*.{yaml,yml,json,md}'
    purpose: Regulatory documentation
  - glob: '**/gdpr*.{yaml,yml,json,md}'
    purpose: GDPR documentation
knowledge_sources:
  specifications:
  - id: iso-31000
    name: ISO 31000 Risk Management
    url: https://www.iso.org/iso-31000-risk-management.html
    offline_cache: true
    priority: required
  - id: coso-erm
    name: COSO Enterprise Risk Management
    url: https://www.coso.org/
    offline_cache: true
    priority: required
  guides:
  - id: compliance-risk-guide
    name: Compliance Risk Management Guide
    url: https://www.complianceweek.com/
    offline_cache: true
tooling:
  static_analysis:
  - tool: compliance-analyzer
    purpose: Analyze compliance coverage
    offline_capable: true
  scripts:
  - id: compliance-scanner
    language: bash
    purpose: Scan for compliance documentation
    source: inline
    code: |
      #!/bin/bash
      echo "=== Regulatory Compliance Risk Scan ==="
      grep -rniE "(GDPR|HIPAA|PCI|SOX|compliance).*risk" \
        --include="*.yaml" --include="*.md" . 2>/dev/null | head -30
signals:
  critical:
  - id: REGRISK-CRIT-001
    signal: No regulatory compliance risk assessment
    evidence_indicators:
    - No compliance risk process
    - Regulations not mapped to risks
    - Compliance risks unknown
    explanation: |
      Without compliance risk assessment, the organization cannot
      understand or manage regulatory exposure.
    remediation: |
      - Identify applicable regulations
      - Assess compliance risks
      - Map requirements to controls
      - Document risk assessment
  - id: REGRISK-CRIT-002
    signal: Critical compliance gaps unaddressed
    evidence_indicators:
    - Known gaps without remediation
    - Non-compliance accepted without risk treatment
    - Regulatory violations
    explanation: |
      Critical compliance gaps expose the organization to penalties,
      enforcement actions, and reputational damage.
    remediation: |
      - Prioritize critical gaps
      - Implement remediation
      - Track to completion
      - Verify compliance
  high:
  - id: REGRISK-HIGH-001
    signal: Regulatory changes not monitored
    evidence_indicators:
    - No change monitoring
    - Surprise regulatory changes
    - Reactive compliance
    explanation: |
      Regulatory changes can create new compliance obligations.
      Without monitoring, the organization may fall out of compliance.
    remediation: |
      - Implement regulatory monitoring
      - Track pending changes
      - Assess impact proactively
      - Plan for compliance
  - id: REGRISK-HIGH-002
    signal: Compliance risks not prioritized
    evidence_indicators:
    - All risks equal priority
    - No risk rating
    - Resources misallocated
    explanation: |
      Prioritization ensures focus on highest-impact risks.
      Without it, resources may not address critical exposures.
    remediation: |
      - Implement risk rating
      - Prioritize based on impact
      - Allocate resources appropriately
      - Focus on critical risks
  medium:
  - id: REGRISK-MED-001
    signal: Compliance risk metrics incomplete
    evidence_indicators:
    - No metrics tracking
    - Unknown compliance posture
    - No trending
    explanation: |
      Metrics enable understanding of compliance risk posture
      and effectiveness of risk management.
    remediation: |
      - Define compliance metrics
      - Track risk indicators
      - Report to leadership
      - Enable trending
  - id: REGRISK-MED-002
    signal: Remediation not tracked effectively
    evidence_indicators:
    - Open items not tracked
    - No remediation dates
    - Unclear ownership
    explanation: |
      Effective tracking ensures remediation progresses.
      Without it, gaps may persist indefinitely.
    remediation: |
      - Track all remediation
      - Assign ownership
      - Set target dates
      - Monitor progress
  low:
  - id: REGRISK-LOW-001
    signal: No cross-regulatory analysis
    evidence_indicators:
    - Regulations treated separately
    - Duplicate controls
    - No optimization
    explanation: |
      Cross-regulatory analysis identifies common controls
      and optimizes compliance investment.
    remediation: |
      - Map common requirements
      - Identify control overlap
      - Optimize compliance
      - Reduce duplication
  positive:
  - id: REGRISK-POS-001
    signal: Mature compliance risk management
    evidence_indicators:
    - Complete regulatory mapping
    - Effective risk assessment
    - Proactive monitoring
  - id: REGRISK-POS-002
    signal: Strong compliance posture
    evidence_indicators:
    - Gaps remediated
    - Metrics positive
    - No violations
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Regulatory Mapping Review
    description: |
      Evaluate identification of applicable regulations.
    duration_estimate: 60 min
    commands:
    - purpose: Find regulatory documentation
      command: |
        find . -type f \( -name "*regulatory*" -o -name "*compliance*" \) \
          2>/dev/null | head -30
    - purpose: Search for regulation references
      command: |
        grep -rniE "(GDPR|HIPAA|PCI|SOX|CCPA|regulation)" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -30
    expected_findings:
    - Regulatory inventory
    - Regulation mapping
    - Coverage documentation
  - id: '2'
    name: Risk Assessment Review
    description: |
      Assess compliance risk assessment process.
    duration_estimate: 45 min
    commands:
    - purpose: Find risk assessment
      command: |
        grep -rniE "(compliance|regulatory).*risk.*assess" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    - purpose: Check for risk rating
      command: |
        grep -rniE "(risk.rating|severity|priority).*compliance" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Risk assessment process
    - Risk ratings
    - Prioritization approach
  - id: '3'
    name: Gap Analysis Review
    description: |
      Evaluate compliance gap analysis and tracking.
    duration_estimate: 45 min
    commands:
    - purpose: Find gap analysis
      command: |
        grep -rniE "(gap|deficiency|finding).*compliance" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -20
    - purpose: Check for remediation tracking
      command: |
        grep -rniE "(remediat|correct|fix).*compliance" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Gap analysis
    - Remediation tracking
    - Progress monitoring
  - id: '4'
    name: Monitoring Review
    description: |
      Assess regulatory change monitoring.
    duration_estimate: 30 min
    commands:
    - purpose: Find monitoring documentation
      command: |
        grep -rniE "(monitor|track|watch).*regulat" \
          --include="*.md" --include="*.yaml" . 2>/dev/null | head -15
    expected_findings:
    - Monitoring process
    - Change tracking
    - Proactive approach
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Regulatory Mapping Assessment
    - Risk Assessment Review
    - Gap Analysis
    - Recommendations
  - type: compliance_risk_matrix
    format: table
    description: Compliance risk by regulation
  confidence_guidance:
    high: Mature compliance risk management with proactive monitoring
    medium: Process exists but gaps in coverage or tracking
    low: Minimal or reactive compliance risk management
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: iso-31000
      priority: required
    - source_id: coso-erm
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires comprehensive compliance review
    full:
      included: true
      priority: 1
    security:
      included: true
      priority: 1
closeout_checklist:
- id: regrisk-001
  item: Applicable regulations identified
  level: CRITICAL
  verification: manual
  verification_notes: Verify regulatory inventory
  expected: Confirmed by reviewer
- id: regrisk-002
  item: Compliance risks assessed
  level: CRITICAL
  verification: manual
  verification_notes: Verify risk assessment
  expected: Confirmed by reviewer
- id: regrisk-003
  item: Gaps tracked and remediated
  level: BLOCKING
  verification: manual
  verification_notes: Verify remediation tracking
  expected: Confirmed by reviewer
- id: regrisk-004
  item: Regulatory changes monitored
  level: BLOCKING
  verification: manual
  verification_notes: Verify monitoring process
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: ISO 31000
    controls:
    - Clause 5
    - Clause 6
  - framework: COSO ERM
    controls:
    - Compliance Objective
  - framework: SOC 2
    controls:
    - CC2.3
  - framework: COBIT 2019
    controls:
    - EDM03
    - MEA03
relationships:
  commonly_combined:
  - risk-management.compliance-risk.policy-compliance-risk
  - risk-management.compliance-risk.audit-findings-risk
  - risk-management.risk-assessment.risk-impact-analysis
