audit:
  id: real-time-embedded.watchdog-recovery.fault-detection
  name: Fault Detection Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: real-time-embedded
  category_number: 39
  subcategory: watchdog-recovery
  tier: expert
  estimated_duration: 4-6 hours  # median: 5h
  completeness: requires_discovery
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: embedded-systems
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates fault detection mechanisms in embedded systems including hardware
    fault monitoring, software assertion and sanity checks, plausibility
    verification, and self-test capabilities. Reviews detection coverage,
    latency, and diagnostic data collection.
  why_it_matters: |
    Fault detection enables appropriate response before faults cause harm.
    Undetected faults silently corrupt data or behavior. Safety-critical
    systems require high fault coverage with bounded detection latency.
    Good detection distinguishes transient from persistent faults and
    enables targeted recovery.
  when_to_run:
  - During safety analysis
  - When implementing monitoring
  - Before safety certification
  - After reliability issues
  - For FMEA support
prerequisites:
  required_artifacts:
  - type: source_code
    description: Fault detection implementation
  - type: safety_analysis
    description: FMEA or hazard analysis
  - type: system_architecture
    description: System monitoring architecture
  - type: diagnostic_requirements
    description: Detection requirements
  access_requirements:
  - Access to source code
  - Access to safety analysis
  - Fault injection capability
  - Diagnostic data access
discovery:
  file_patterns:
  - glob: '**/fault*.c'
    purpose: Find fault handling code
  - glob: '**/monitor*.c'
    purpose: Find monitoring code
  - glob: '**/diagnostic*.c'
    purpose: Find diagnostic code
  - glob: '**/selftest*.c'
    purpose: Find self-test code
  - glob: '**/health*.c'
    purpose: Find health monitoring
knowledge_sources:
  guides:
  - id: fault-detection
    name: Fault Detection Techniques
    url: https://www.embedded.com/fault-detection
  - id: fmea-guide
    name: FMEA for Embedded Systems
    url: https://www.embedded.com/fmea-embedded
  standards:
  - id: iec-61508
    name: IEC 61508 Functional Safety
    relevance: Diagnostic coverage
  - id: iso-26262
    name: ISO 26262 Functional Safety
    relevance: FMEDA requirements
tooling:
  analysis_tools:
  - tool: fault-injector
    purpose: Fault injection testing
  - tool: code-coverage
    purpose: Detection code coverage
  - tool: debugger
    purpose: Fault analysis
signals:
  critical:
  - id: FD-CRIT-001
    signal: Critical faults not detected
    evidence_indicators:
    - Safety-critical fault unmonitored
    - No detection mechanism
    - Fault leads to hazard
    explanation: |
      Undetected critical faults can lead to hazardous conditions.
      All safety-critical failure modes must be detected.
    remediation: Implement detection for all critical faults
  - id: FD-CRIT-002
    signal: Fault detection latency excessive
    evidence_indicators:
    - Detection slower than fault tolerance time
    - Harm possible before detection
    - Safety function fails
    explanation: |
      Detection must be fast enough to enable response before
      fault causes harm. Latency must be bounded.
    remediation: Reduce detection latency to meet requirements
  high:
  - id: FD-HIGH-001
    signal: Low diagnostic coverage
    evidence_indicators:
    - Many faults undetectable
    - Coverage below ASIL requirement
    - Gaps in monitoring
    explanation: |
      Low coverage leaves faults undetected. Safety standards
      specify minimum coverage for each ASIL level.
    remediation: Increase diagnostic coverage to required level
  - id: FD-HIGH-002
    signal: No plausibility checking
    evidence_indicators:
    - Sensor values not validated
    - Out-of-range not detected
    - Impossible states accepted
    explanation: |
      Plausibility checks catch many faults by verifying values
      are within expected ranges and consistent.
    remediation: Add plausibility checks for critical data
  medium:
  - id: FD-MED-001
    signal: Self-test incomplete or infrequent
    evidence_indicators:
    - No periodic self-test
    - Startup test only
    - Latent faults undetected
    explanation: |
      Periodic self-test detects latent faults that develop over
      time. Startup-only testing misses these.
    remediation: Implement periodic self-testing
  - id: FD-MED-002
    signal: Fault diagnostic data insufficient
    evidence_indicators:
    - No fault logging
    - Root cause unclear
    - Limited diagnostic info
    explanation: |
      Diagnostic data enables root cause analysis and improves
      system reliability over time.
    remediation: Enhance fault logging and diagnostics
  low:
  - id: FD-LOW-001
    signal: Detection mechanisms not documented
    evidence_indicators:
    - Coverage unclear
    - Detection times not specified
    - Mechanisms not listed
    explanation: |
      Documentation supports safety analysis and certification.
    remediation: Document all fault detection mechanisms
  positive:
  - id: FD-POS-001
    signal: Comprehensive fault detection coverage
    evidence_indicators:
    - All critical faults detected
    - Coverage meets requirements
    - Detection latency bounded
  - id: FD-POS-002
    signal: Robust diagnostic system
    evidence_indicators:
    - Periodic self-test
    - Plausibility checking
    - Comprehensive logging
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Review Fault List
    description: Document faults that must be detected
    duration_estimate: 1 hour
  - id: '2'
    name: Map Detection Mechanisms
    description: Document detection for each fault
    duration_estimate: 1-2 hours
  - id: '3'
    name: Analyze Coverage
    description: Calculate diagnostic coverage
    duration_estimate: 1 hour
  - id: '4'
    name: Measure Detection Latency
    description: Determine time to detect faults
    duration_estimate: 1 hour
  - id: '5'
    name: Test Detection Mechanisms
    description: Inject faults to verify detection
    duration_estimate: 1 hour
  - id: '6'
    name: Document Findings
    description: Compile assessment report
    duration_estimate: 30 minutes
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Fault List Review
    - Detection Coverage Analysis
    - Latency Assessment
    - Recommendations
closeout_checklist:
- id: fd-001
  item: Fault list reviewed
  level: CRITICAL
  verification: manual
- id: fd-002
  item: Detection mechanisms mapped
  level: CRITICAL
  verification: manual
- id: fd-003
  item: Coverage analyzed
  level: HIGH
  verification: automated
- id: fd-004
  item: Detection tested
  level: HIGH
  verification: automated
governance:
  applicable_to:
    archetypes:
    - embedded-systems
    - safety-critical
    - reliable-systems
  compliance_mappings:
  - framework: IEC 61508
    control: Table A.2-A.12
    description: Diagnostic techniques
  - framework: ISO 26262
    control: Part 5
    description: FMEDA requirements
  - framework: DO-178C
    control: 6.3.5
    description: Error detection
relationships:
  commonly_combined:
  - real-time-embedded.watchdog-recovery.watchdog-timer-configuration
  - real-time-embedded.watchdog-recovery.recovery-mechanisms
  depends_on:
  - safety.fmea-analysis
  feeds_into:
  - safety.diagnostic-coverage
  - reliability.fault-tolerance
