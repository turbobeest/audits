audit:
  id: real-time-embedded.firmware-quality.static-analysis-coverage
  name: Static Analysis Coverage Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: real-time-embedded
  category_number: 39
  subcategory: firmware-quality
  tier: expert
  estimated_duration: 4-6 hours  # median: 5h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: embedded-systems
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates static analysis tool deployment and coverage for embedded firmware.
    Reviews which files are analyzed, exclusion patterns, suppression practices,
    and findings resolution workflow. Assesses tool configuration completeness
    and appropriateness for embedded-specific analysis.
  why_it_matters: |
    Static analysis catches bugs that testing may miss - null pointers, buffer
    overflows, uninitialized variables, and dead code. However, value depends on
    coverage. Excluded files, suppressed warnings, and incomplete configuration
    reduce effectiveness. Comprehensive coverage is essential for safety-critical
    software quality assurance.
  when_to_run:
  - When establishing analysis infrastructure
  - During code quality review
  - Before safety certification
  - After adding new code modules
  - Periodically for process health
prerequisites:
  required_artifacts:
  - type: source_code
    description: Complete firmware source code
  - type: analysis_configuration
    description: Static analysis tool configuration
  - type: suppression_files
    description: Warning suppression configuration
  - type: analysis_reports
    description: Recent analysis results
  access_requirements:
  - Access to source code
  - Access to analysis tools
  - Access to configuration files
  - CI pipeline access
discovery:
  file_patterns:
  - glob: '**/*.c'
    purpose: Find C source files
  - glob: '**/*.h'
    purpose: Find header files
  - glob: '**/.lint*'
    purpose: Find lint configuration
  - glob: '**/polyspace*.psprj'
    purpose: Find Polyspace project
  - glob: '**/suppress*.txt'
    purpose: Find suppression files
knowledge_sources:
  guides:
  - id: static-analysis-embedded
    name: Static Analysis for Embedded Systems
    url: https://www.embedded.com/static-analysis
  - id: coverity-guide
    name: Coverity Configuration Guide
    url: https://www.synopsys.com/software-integrity
  standards:
  - id: do-178c
    name: DO-178C Software Considerations
    relevance: Static analysis requirements
  - id: iso-26262
    name: ISO 26262 Functional Safety
    relevance: Analysis tool qualification
tooling:
  analysis_tools:
  - tool: pc-lint
    purpose: Gimpel PC-Lint Plus
  - tool: polyspace
    purpose: MathWorks Polyspace
  - tool: coverity
    purpose: Synopsys Coverity
  - tool: klocwork
    purpose: Perforce Klocwork
  - tool: cppcheck
    purpose: Open source analyzer
signals:
  critical:
  - id: SAC-CRIT-001
    signal: Safety-critical code excluded from analysis
    evidence_indicators:
    - Critical modules in exclusion list
    - No analysis of safety functions
    - Coverage gap in critical paths
    explanation: |
      Safety-critical code requires the most rigorous analysis.
      Excluding it defeats the purpose of static analysis.
    remediation: Include all safety-critical code in analysis
  - id: SAC-CRIT-002
    signal: High severity findings not addressed
    evidence_indicators:
    - Critical warnings suppressed
    - Potential bugs ignored
    - No resolution workflow
    explanation: |
      High severity findings indicate likely bugs. Ignoring them
      allows bugs to reach production.
    remediation: Resolve all high severity findings
  high:
  - id: SAC-HIGH-001
    signal: Significant code not analyzed
    evidence_indicators:
    - Large portions excluded
    - Third-party code not checked
    - Coverage below 90%
    explanation: |
      Unanalyzed code may contain bugs. Maximize coverage to
      maximize bug detection.
    remediation: Extend analysis coverage to all code
  - id: SAC-HIGH-002
    signal: Tool configuration incomplete
    evidence_indicators:
    - Default settings used
    - Embedded-specific checks disabled
    - Type sizes not configured
    explanation: |
      Incomplete configuration misses issues. Embedded systems
      need specific settings for correct analysis.
    remediation: Complete tool configuration for target
  medium:
  - id: SAC-MED-001
    signal: Excessive suppressions without justification
    evidence_indicators:
    - Many warnings suppressed
    - No justification recorded
    - Blanket suppressions used
    explanation: |
      Suppressions hide potential issues. Each should be justified
      and reviewed periodically.
    remediation: Document suppression justification
  - id: SAC-MED-002
    signal: Analysis not integrated in CI
    evidence_indicators:
    - Manual analysis only
    - Findings accumulate between runs
    - No regression prevention
    explanation: |
      Without CI integration, new issues enter codebase between
      manual analysis runs.
    remediation: Integrate analysis in CI pipeline
  low:
  - id: SAC-LOW-001
    signal: Analysis process not documented
    evidence_indicators:
    - Configuration rationale missing
    - Workflow not specified
    - Coverage metrics not tracked
    explanation: |
      Documentation supports process improvement and certification
      evidence generation.
    remediation: Document analysis process and metrics
  positive:
  - id: SAC-POS-001
    signal: Comprehensive analysis coverage
    evidence_indicators:
    - All code analyzed
    - All findings addressed
    - CI integration active
  - id: SAC-POS-002
    signal: Well-configured analysis environment
    evidence_indicators:
    - Target-specific configuration
    - Embedded checks enabled
    - Proper suppression management
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Inventory Analysis Tools
    description: Document all static analysis tools in use
    duration_estimate: 30 minutes
  - id: '2'
    name: Review Configuration
    description: Examine tool configuration completeness
    duration_estimate: 1 hour
  - id: '3'
    name: Assess Coverage
    description: Determine what code is analyzed
    duration_estimate: 1 hour
  - id: '4'
    name: Review Suppressions
    description: Examine suppression files and justifications
    duration_estimate: 1 hour
  - id: '5'
    name: Evaluate Findings Resolution
    description: Review how findings are addressed
    duration_estimate: 1 hour
  - id: '6'
    name: Document Findings
    description: Compile assessment report
    duration_estimate: 30 minutes
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Tool Configuration Review
    - Coverage Assessment
    - Suppression Analysis
    - Recommendations
closeout_checklist:
- id: sac-001
  item: Analysis tools inventoried
  level: HIGH
  verification: manual
- id: sac-002
  item: Configuration reviewed
  level: HIGH
  verification: manual
- id: sac-003
  item: Coverage assessed
  level: CRITICAL
  verification: automated
- id: sac-004
  item: Suppressions reviewed
  level: HIGH
  verification: manual
governance:
  applicable_to:
    archetypes:
    - embedded-systems
    - safety-critical
    - quality-focused
  compliance_mappings:
  - framework: DO-178C
    control: 6.3.4
    description: Static analysis requirements
  - framework: ISO 26262
    control: Part 6, Table 12
    description: Static analysis recommendation
  - framework: IEC 61508
    control: Table B.7
    description: Static analysis technique
relationships:
  commonly_combined:
  - real-time-embedded.firmware-quality.misra-compliance
  - real-time-embedded.firmware-quality.code-metrics
  depends_on:
  - build.static-analysis-tools
  feeds_into:
  - quality.defect-detection
  - certification.analysis-evidence

# Glossary of domain-specific terms:
glossary:
  "WCET": "Worst-Case Execution Time - maximum possible execution time for a code path"
  "ISR": "Interrupt Service Routine - function executed in response to hardware interrupt"
  "jitter": "Variation in timing between expected and actual execution"
