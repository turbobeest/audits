audit:
  id: real-time-embedded.watchdog-recovery.error-logging
  name: Error Logging Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: real-time-embedded
  category_number: 39
  subcategory: watchdog-recovery
  tier: expert
  estimated_duration: 3-5 hours  # median: 4h
  completeness: requires_discovery
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: embedded-systems
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates error and fault logging in embedded systems including what
    events are logged, storage mechanism, survivability across resets,
    retrieval methods, and log management. Reviews logging overhead and
    impact on real-time performance.
  why_it_matters: |
    Error logs enable debugging, root cause analysis, and reliability
    improvement. Field failures without logs are difficult to diagnose.
    Safety standards require maintaining records of safety-related events.
    Logs must survive resets to capture information about crashes.
  when_to_run:
  - When implementing logging
  - For diagnostics improvement
  - Before field deployment
  - After reliability issues
  - For compliance verification
prerequisites:
  required_artifacts:
  - type: source_code
    description: Logging implementation
  - type: logging_design
    description: Logging architecture documentation
  - type: storage_design
    description: Non-volatile storage design
  - type: event_specifications
    description: Events to be logged
  access_requirements:
  - Access to source code
  - Access to log storage
  - Log retrieval tools
  - Test environment
discovery:
  file_patterns:
  - glob: '**/log*.c'
    purpose: Find logging code
  - glob: '**/error_log*.c'
    purpose: Find error logging
  - glob: '**/event*.c'
    purpose: Find event logging
  - glob: '**/nvm*.c'
    purpose: Find NVM storage
  - glob: '**/diagnostic*.c'
    purpose: Find diagnostics
knowledge_sources:
  guides:
  - id: embedded-logging
    name: Embedded Logging Best Practices
    url: https://www.embedded.com/logging
  - id: flash-logging
    name: Flash-Based Logging
    url: https://www.embedded.com/flash-logging
  standards:
  - id: iec-61508
    name: IEC 61508 Functional Safety
    relevance: Diagnostic recording
  - id: iso-26262
    name: ISO 26262 Functional Safety
    relevance: DTC storage
tooling:
  analysis_tools:
  - tool: log-analyzer
    purpose: Log parsing and analysis
  - tool: flash-reader
    purpose: NVM retrieval
  - tool: debugger
    purpose: Logging debugging
signals:
  critical:
  - id: EL-CRIT-001
    signal: Safety-critical events not logged
    evidence_indicators:
    - Safety events missing from log
    - Fault information not recorded
    - Compliance requirement not met
    explanation: |
      Safety-critical events must be logged for incident investigation
      and compliance. Missing logs hinder analysis.
    remediation: Log all safety-critical events
  - id: EL-CRIT-002
    signal: Logs lost on reset
    evidence_indicators:
    - Logs only in RAM
    - Reset clears all history
    - Crash info unavailable
    explanation: |
      Logs must survive resets to capture crash information. RAM-only
      logs lose critical debugging data.
    remediation: Store critical logs in non-volatile memory
  high:
  - id: EL-HIGH-001
    signal: Logging causes timing issues
    evidence_indicators:
    - Log writes block execution
    - Deadline misses from logging
    - Synchronous NVM writes
    explanation: |
      Logging in real-time paths must not impact timing. Deferred
      or buffered logging reduces impact.
    remediation: Implement non-blocking logging mechanism
  - id: EL-HIGH-002
    signal: Log overflow not handled
    evidence_indicators:
    - Log fills without management
    - Oldest entries lost
    - Critical events may be overwritten
    explanation: |
      Log storage is limited. Overflow management must preserve
      important entries.
    remediation: Implement log rotation with priority preservation
  medium:
  - id: EL-MED-001
    signal: Insufficient event detail
    evidence_indicators:
    - Events lack context
    - Root cause unclear from log
    - Missing timestamp or state
    explanation: |
      Log entries need sufficient detail for diagnosis. Minimal
      logs may not enable root cause analysis.
    remediation: Include relevant context in log entries
  - id: EL-MED-002
    signal: No log retrieval mechanism
    evidence_indicators:
    - Logs trapped on device
    - No remote retrieval
    - Physical access required
    explanation: |
      Logs are only useful if retrievable. Field devices need
      remote retrieval capability.
    remediation: Implement log retrieval mechanism
  low:
  - id: EL-LOW-001
    signal: Logging design not documented
    evidence_indicators:
    - What is logged unclear
    - Storage not specified
    - Format undefined
    explanation: |
      Documentation supports log analysis and maintenance.
    remediation: Document logging design and event definitions
  positive:
  - id: EL-POS-001
    signal: Comprehensive error logging
    evidence_indicators:
    - All critical events logged
    - Persistent storage
    - Low overhead
  - id: EL-POS-002
    signal: Robust log management
    evidence_indicators:
    - Overflow handled
    - Remote retrieval
    - Useful detail level
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Inventory Logged Events
    description: Document what events are logged
    duration_estimate: 1 hour
  - id: '2'
    name: Review Storage Mechanism
    description: Analyze log storage and persistence
    duration_estimate: 1 hour
  - id: '3'
    name: Assess Logging Overhead
    description: Measure logging impact on timing
    duration_estimate: 30 minutes
  - id: '4'
    name: Verify Reset Survival
    description: Test log persistence across resets
    duration_estimate: 30 minutes
  - id: '5'
    name: Review Retrieval Mechanisms
    description: Evaluate log access methods
    duration_estimate: 30 minutes
  - id: '6'
    name: Document Findings
    description: Compile assessment report
    duration_estimate: 30 minutes
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Event Coverage
    - Storage Analysis
    - Overhead Assessment
    - Recommendations
closeout_checklist:
- id: el-001
  item: Logged events inventoried
  level: HIGH
  verification: manual
- id: el-002
  item: Storage mechanism reviewed
  level: HIGH
  verification: manual
- id: el-003
  item: Reset survival verified
  level: HIGH
  verification: automated
- id: el-004
  item: Retrieval tested
  level: MEDIUM
  verification: automated
governance:
  applicable_to:
    archetypes:
    - embedded-systems
    - safety-critical
    - field-deployed
  compliance_mappings:
  - framework: IEC 61508
    control: 7.9.2
    description: Diagnostic testing
  - framework: ISO 26262
    control: Part 7
    description: DTC requirements
  - framework: AUTOSAR
    control: Dem
    description: Diagnostic event manager
relationships:
  commonly_combined:
  - real-time-embedded.watchdog-recovery.fault-detection
  - diagnostics.field-diagnostics
  depends_on:
  - hardware.nvm-storage
  feeds_into:
  - reliability.failure-analysis
  - operations.fleet-diagnostics
