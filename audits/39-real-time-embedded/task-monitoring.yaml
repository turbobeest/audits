audit:
  id: real-time-embedded.watchdog-recovery.task-monitoring
  name: Task Monitoring Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: real-time-embedded
  category_number: 39
  subcategory: watchdog-recovery
  tier: expert
  estimated_duration: 3-5 hours  # median: 4h
  completeness: requires_discovery
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: embedded-systems
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates task-level health monitoring including deadline monitoring,
    execution progress checking, alive signaling, and coordinated watchdog
    feeding. Reviews how individual task failures are detected and how
    monitoring interacts with the hardware watchdog.
  why_it_matters: |
    A single watchdog refresh point only verifies that one code path executes.
    Multi-task systems need per-task monitoring to detect individual task
    failures. Coordinated monitoring ensures all tasks are healthy before
    watchdog refresh, catching partial system failures.
  when_to_run:
  - When designing task monitoring
  - After adding new tasks
  - For reliability improvement
  - Before safety certification
  - When debugging hangs
prerequisites:
  required_artifacts:
  - type: source_code
    description: Task monitoring implementation
  - type: task_specifications
    description: Task timing requirements
  - type: watchdog_design
    description: Watchdog integration design
  - type: system_architecture
    description: Task architecture documentation
  access_requirements:
  - Access to source code
  - Access to timing specifications
  - Fault injection capability
  - Debug/trace access
discovery:
  file_patterns:
  - glob: '**/task_monitor*.c'
    purpose: Find task monitoring
  - glob: '**/health*.c'
    purpose: Find health checking
  - glob: '**/alive*.c'
    purpose: Find alive signaling
  - glob: '**/supervision*.c'
    purpose: Find supervision code
  - glob: '**/watchdog*.c'
    purpose: Find watchdog integration
knowledge_sources:
  guides:
  - id: task-monitoring
    name: RTOS Task Monitoring
    url: https://www.embedded.com/task-monitoring
  - id: supervision
    name: Software Supervision Patterns
    url: https://www.embedded.com/supervision
  standards:
  - id: autosar-wdgm
    name: AUTOSAR Watchdog Manager
    relevance: Automotive task supervision
  - id: iec-61508
    name: IEC 61508 Functional Safety
    relevance: Program sequence monitoring
tooling:
  analysis_tools:
  - tool: tracealyzer
    purpose: Task health visualization
  - tool: fault-injector
    purpose: Task failure simulation
  - tool: debugger
    purpose: Monitoring debugging
signals:
  critical:
  - id: TM-CRIT-001
    signal: No per-task monitoring
    evidence_indicators:
    - Single watchdog feed point
    - Task failures not detected
    - Partial hang goes unnoticed
    explanation: |
      Without per-task monitoring, individual task failures may not
      trigger watchdog reset, leaving system partially operational.
    remediation: Implement per-task health monitoring
  - id: TM-CRIT-002
    signal: Critical task not monitored
    evidence_indicators:
    - Safety task missing supervision
    - Gap in monitoring coverage
    - Critical failure undetected
    explanation: |
      All safety-critical tasks must be monitored. Missing supervision
      on critical tasks creates safety vulnerability.
    remediation: Add monitoring for all critical tasks
  high:
  - id: TM-HIGH-001
    signal: Monitoring deadline too loose
    evidence_indicators:
    - Task can be stuck for long time
    - Monitoring period >> task period
    - Slow failure detection
    explanation: |
      Monitoring deadline should match task timing requirements.
      Loose deadlines delay failure detection.
    remediation: Set monitoring deadlines appropriate for task timing
  - id: TM-HIGH-002
    signal: Alive signal can be faked
    evidence_indicators:
    - Simple periodic signal
    - No execution progress check
    - Stuck task can still signal
    explanation: |
      Simple alive signals can continue even if task is stuck in
      loop. Need execution progress or flow monitoring.
    remediation: Implement execution progress monitoring
  medium:
  - id: TM-MED-001
    signal: No coordinated watchdog feeding
    evidence_indicators:
    - Tasks feed watchdog independently
    - Partial failure still feeds dog
    - System continues with failed task
    explanation: |
      Coordinated feeding ensures all tasks healthy before watchdog
      refresh. Independent feeding masks partial failures.
    remediation: Implement coordinated watchdog feeding
  - id: TM-MED-002
    signal: Monitoring task itself not monitored
    evidence_indicators:
    - Monitor is single point of failure
    - No supervision of supervisor
    - Monitor hang not detected
    explanation: |
      The monitoring task itself can fail. Consider diverse or
      redundant monitoring.
    remediation: Ensure monitoring mechanism is itself monitored
  low:
  - id: TM-LOW-001
    signal: Task monitoring not documented
    evidence_indicators:
    - Monitoring coverage unclear
    - Timing requirements not specified
    - Design rationale missing
    explanation: |
      Documentation supports maintenance and certification.
    remediation: Document task monitoring design
  positive:
  - id: TM-POS-001
    signal: Comprehensive task monitoring
    evidence_indicators:
    - All tasks monitored
    - Appropriate timing
    - Coordinated watchdog
  - id: TM-POS-002
    signal: Execution progress monitoring
    evidence_indicators:
    - Flow or sequence monitoring
    - Not just alive signals
    - Stuck detection robust
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Inventory Monitored Tasks
    description: Document which tasks are monitored and how
    duration_estimate: 1 hour
  - id: '2'
    name: Analyze Monitoring Mechanism
    description: Review how monitoring detects failures
    duration_estimate: 1 hour
  - id: '3'
    name: Verify Monitoring Timing
    description: Check deadlines match requirements
    duration_estimate: 30 minutes
  - id: '4'
    name: Test Task Failure Detection
    description: Inject faults to verify detection
    duration_estimate: 1-2 hours
  - id: '5'
    name: Review Watchdog Integration
    description: Verify coordinated feeding approach
    duration_estimate: 30 minutes
  - id: '6'
    name: Document Findings
    description: Compile assessment report
    duration_estimate: 30 minutes
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Monitoring Coverage
    - Mechanism Analysis
    - Testing Results
    - Recommendations
closeout_checklist:
- id: tm-001
  item: Monitored tasks inventoried
  level: CRITICAL
  verification: manual
- id: tm-002
  item: Monitoring mechanism analyzed
  level: HIGH
  verification: manual
- id: tm-003
  item: Failure detection tested
  level: HIGH
  verification: automated
- id: tm-004
  item: Watchdog integration reviewed
  level: HIGH
  verification: manual
governance:
  applicable_to:
    archetypes:
    - embedded-systems
    - safety-critical
    - rtos-based
  compliance_mappings:
  - framework: AUTOSAR
    control: WdgM
    description: Watchdog manager
  - framework: IEC 61508
    control: A.1.5
    description: Program sequence monitoring
  - framework: ISO 26262
    control: Part 6
    description: Program flow monitoring
relationships:
  commonly_combined:
  - real-time-embedded.watchdog-recovery.watchdog-timer-configuration
  - real-time-embedded.watchdog-recovery.fault-detection
  depends_on:
  - real-time-embedded.rtos-configuration.task-lifecycle-management
  feeds_into:
  - reliability.task-reliability
  - safety.program-flow-monitoring
