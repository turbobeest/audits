audit:
  id: real-time-embedded.watchdog-recovery.system-reset-handling
  name: System Reset Handling Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: real-time-embedded
  category_number: 39
  subcategory: watchdog-recovery
  tier: expert
  estimated_duration: 3-5 hours  # median: 4h
  completeness: requires_discovery
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: embedded-systems
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Reviews system behavior during and after various reset types including
    power-on reset, watchdog reset, software reset, and brown-out reset.
    Examines reset cause identification, initialization sequence, data
    persistence, and recovery from interrupted operations.
  why_it_matters: |
    Different reset types may require different handling. Reset cause
    identification enables appropriate response and debugging. Proper
    initialization ensures consistent starting state. Handling interrupted
    operations prevents data corruption. Understanding reset behavior is
    essential for reliable system operation.
  when_to_run:
  - During system bring-up
  - When debugging reset issues
  - Before production release
  - After hardware changes
  - For reliability assessment
prerequisites:
  required_artifacts:
  - type: startup_code
    description: Reset and initialization code
  - type: hardware_manual
    description: Reset controller documentation
  - type: system_design
    description: Reset handling design
  - type: data_persistence
    description: Non-volatile data design
  access_requirements:
  - Access to source code
  - Access to hardware documentation
  - Reset testing capability
  - Debug access
discovery:
  file_patterns:
  - glob: '**/reset*.c'
    purpose: Find reset handling
  - glob: '**/startup*.c'
    purpose: Find startup code
  - glob: '**/system_init*.c'
    purpose: Find initialization
  - glob: '**/brownout*.c'
    purpose: Find brown-out handling
  - glob: '**/nvm*.c'
    purpose: Find NVM handling
knowledge_sources:
  guides:
  - id: reset-handling
    name: Embedded Reset Handling
    url: https://www.embedded.com/reset-handling
  - id: brownout-protection
    name: Brown-Out Protection
    url: https://www.embedded.com/brownout
  standards:
  - id: iec-61508
    name: IEC 61508 Functional Safety
    relevance: Reset requirements
  - id: iso-26262
    name: ISO 26262 Functional Safety
    relevance: Hardware reset handling
tooling:
  analysis_tools:
  - tool: debugger
    purpose: Reset debugging
  - tool: power-supply
    purpose: Brown-out simulation
  - tool: logic-analyzer
    purpose: Reset timing
signals:
  critical:
  - id: SRH-CRIT-001
    signal: Reset cause not identified
    evidence_indicators:
    - Reset source not checked
    - Same handling for all resets
    - Watchdog resets go unnoticed
    explanation: |
      Different reset causes may require different handling. Watchdog
      resets indicate faults that need investigation.
    remediation: Identify and appropriately handle each reset type
  - id: SRH-CRIT-002
    signal: Data corruption after reset
    evidence_indicators:
    - NVM data invalid after reset
    - Interrupted write corrupts data
    - No transactional protection
    explanation: |
      Resets interrupting write operations can corrupt data. Critical
      data needs transactional protection.
    remediation: Implement transactional updates for critical data
  high:
  - id: SRH-HIGH-001
    signal: Brown-out reset not handled
    evidence_indicators:
    - Brown-out causes corruption
    - No brown-out detection
    - System unstable at low voltage
    explanation: |
      Brown-out conditions cause unpredictable behavior. Brown-out
      reset ensures clean restart.
    remediation: Enable and properly handle brown-out reset
  - id: SRH-HIGH-002
    signal: Reset loop not detected
    evidence_indicators:
    - Repeated resets go unnoticed
    - No reset counter
    - Infinite reset loop possible
    explanation: |
      Reset loops indicate persistent faults. Detection enables
      alternative recovery like fallback firmware.
    remediation: Implement reset loop detection and handling
  medium:
  - id: SRH-MED-001
    signal: Initialization order not enforced
    evidence_indicators:
    - Undefined init order
    - Race conditions at startup
    - Inconsistent behavior
    explanation: |
      Proper initialization order ensures consistent startup state.
      Random order causes intermittent issues.
    remediation: Enforce deterministic initialization order
  - id: SRH-MED-002
    signal: Reset information not logged
    evidence_indicators:
    - Reset history not kept
    - Debugging difficult
    - Field failures hard to diagnose
    explanation: |
      Reset logging enables field failure diagnosis and reliability
      improvement.
    remediation: Log reset cause and relevant state
  low:
  - id: SRH-LOW-001
    signal: Reset handling not documented
    evidence_indicators:
    - Reset behavior unclear
    - Init sequence undocumented
    - Expected behavior unknown
    explanation: |
      Documentation supports debugging and maintenance.
    remediation: Document reset handling and initialization
  positive:
  - id: SRH-POS-001
    signal: Comprehensive reset handling
    evidence_indicators:
    - All reset types handled
    - Cause identified and logged
    - Consistent initialization
  - id: SRH-POS-002
    signal: Robust data integrity through resets
    evidence_indicators:
    - Transactional updates
    - Validation on load
    - Corruption recovery
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Review Reset Sources
    description: Document all reset types and hardware behavior
    duration_estimate: 30 minutes
  - id: '2'
    name: Analyze Reset Handling Code
    description: Review reset cause identification and response
    duration_estimate: 1 hour
  - id: '3'
    name: Examine Initialization Sequence
    description: Verify proper startup order and state
    duration_estimate: 1 hour
  - id: '4'
    name: Test Reset Scenarios
    description: Verify behavior for each reset type
    duration_estimate: 1-2 hours
  - id: '5'
    name: Check Data Integrity
    description: Verify data survives resets properly
    duration_estimate: 30 minutes
  - id: '6'
    name: Document Findings
    description: Compile assessment report
    duration_estimate: 30 minutes
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Reset Source Analysis
    - Handling Code Review
    - Test Results
    - Recommendations
closeout_checklist:
- id: srh-001
  item: Reset sources documented
  level: HIGH
  verification: manual
- id: srh-002
  item: Handling code analyzed
  level: HIGH
  verification: manual
- id: srh-003
  item: Reset scenarios tested
  level: HIGH
  verification: automated
- id: srh-004
  item: Data integrity verified
  level: HIGH
  verification: automated
governance:
  applicable_to:
    archetypes:
    - embedded-systems
    - safety-critical
    - reliable-systems
  compliance_mappings:
  - framework: IEC 61508
    control: 7.4.4
    description: Reset behavior
  - framework: ISO 26262
    control: Part 5
    description: Hardware reset
  - framework: DO-178C
    control: 6.3.5
    description: Initialization
relationships:
  commonly_combined:
  - real-time-embedded.watchdog-recovery.watchdog-timer-configuration
  - real-time-embedded.watchdog-recovery.recovery-mechanisms
  depends_on:
  - hardware.reset-controller
  feeds_into:
  - reliability.reset-reliability
  - diagnostics.reset-diagnostics
