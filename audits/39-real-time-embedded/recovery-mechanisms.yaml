audit:
  id: real-time-embedded.watchdog-recovery.recovery-mechanisms
  name: Recovery Mechanisms Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: real-time-embedded
  category_number: 39
  subcategory: watchdog-recovery
  tier: expert
  estimated_duration: 4-6 hours  # median: 5h
  completeness: requires_discovery
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: embedded-systems
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates system recovery mechanisms including graceful degradation, safe
    state transitions, reset handling, and state restoration. Reviews recovery
    from various fault types, recovery timing, and ensuring system reaches
    a known good state.
  why_it_matters: |
    Recovery mechanisms determine how the system responds to detected faults.
    Proper recovery restores normal operation or achieves a safe state.
    Improper recovery can leave the system in an inconsistent or unsafe state.
    Safety-critical systems must have well-defined recovery behavior for
    all identified faults.
  when_to_run:
  - During safety design
  - When implementing fault handling
  - Before safety certification
  - After reliability issues
  - For recovery validation
prerequisites:
  required_artifacts:
  - type: source_code
    description: Recovery implementation code
  - type: recovery_design
    description: Recovery strategy documentation
  - type: safe_states
    description: Safe state definitions
  - type: fault_response
    description: Fault response matrix
  access_requirements:
  - Access to source code
  - Access to design documentation
  - Fault injection capability
  - System test access
discovery:
  file_patterns:
  - glob: '**/recovery*.c'
    purpose: Find recovery code
  - glob: '**/fault_handler*.c'
    purpose: Find fault handling
  - glob: '**/safe_state*.c'
    purpose: Find safe state code
  - glob: '**/reset_handler*.c'
    purpose: Find reset handling
  - glob: '**/degraded*.c'
    purpose: Find degradation code
knowledge_sources:
  guides:
  - id: recovery-design
    name: Fault Recovery Design
    url: https://www.embedded.com/fault-recovery
  - id: safe-states
    name: Defining Safe States
    url: https://www.embedded.com/safe-states
  standards:
  - id: iec-61508
    name: IEC 61508 Functional Safety
    relevance: Safe state requirements
  - id: iso-26262
    name: ISO 26262 Functional Safety
    relevance: Fault tolerant time
tooling:
  analysis_tools:
  - tool: fault-injector
    purpose: Recovery testing
  - tool: state-machine-analyzer
    purpose: State transition analysis
  - tool: debugger
    purpose: Recovery debugging
signals:
  critical:
  - id: RM-CRIT-001
    signal: No defined safe state
    evidence_indicators:
    - Safe state not specified
    - Fault response undefined
    - System state unknown after fault
    explanation: |
      Without defined safe states, fault recovery may leave system
      in dangerous condition. Safe states must be specified.
    remediation: Define and implement safe states for all fault scenarios
  - id: RM-CRIT-002
    signal: Recovery can lead to unsafe condition
    evidence_indicators:
    - Recovery action causes hazard
    - Transition through unsafe state
    - Recovery worse than fault
    explanation: |
      Recovery actions must not create new hazards. All recovery
      paths must be analyzed for safety.
    remediation: Analyze and fix unsafe recovery paths
  high:
  - id: RM-HIGH-001
    signal: Recovery timing not bounded
    evidence_indicators:
    - Recovery time variable
    - May exceed fault tolerant time
    - Harm possible during recovery
    explanation: |
      Recovery must complete within fault tolerant time interval
      to prevent fault from causing harm.
    remediation: Bound recovery time within fault tolerant interval
  - id: RM-HIGH-002
    signal: State restoration incomplete
    evidence_indicators:
    - System state inconsistent after reset
    - Data corruption after recovery
    - Partial restoration only
    explanation: |
      Incomplete state restoration leaves system in unknown condition.
      All critical state must be properly restored or reinitialized.
    remediation: Ensure complete state restoration or reinitialization
  medium:
  - id: RM-MED-001
    signal: No graceful degradation
    evidence_indicators:
    - Any fault causes full shutdown
    - No partial operation mode
    - Availability impacted by minor faults
    explanation: |
      Graceful degradation maintains partial functionality during
      faults, improving availability.
    remediation: Implement degraded operation modes where appropriate
  - id: RM-MED-002
    signal: Recovery not tested for all faults
    evidence_indicators:
    - Some fault scenarios untested
    - Edge cases not covered
    - Recovery assumed to work
    explanation: |
      All recovery paths must be tested to verify correct behavior.
      Untested paths may have defects.
    remediation: Test recovery for all identified fault scenarios
  low:
  - id: RM-LOW-001
    signal: Recovery strategy not documented
    evidence_indicators:
    - Recovery behavior unclear
    - Safe states not documented
    - Fault response matrix missing
    explanation: |
      Documentation supports verification and maintenance.
    remediation: Document recovery strategy and fault responses
  positive:
  - id: RM-POS-001
    signal: Well-defined recovery for all faults
    evidence_indicators:
    - Safe states defined
    - Recovery paths tested
    - Timing bounded
  - id: RM-POS-002
    signal: Graceful degradation implemented
    evidence_indicators:
    - Partial operation modes
    - Progressive degradation
    - Availability maintained
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Review Safe State Definitions
    description: Document all defined safe states
    duration_estimate: 1 hour
  - id: '2'
    name: Analyze Recovery Paths
    description: Map recovery for each fault type
    duration_estimate: 1-2 hours
  - id: '3'
    name: Verify Recovery Timing
    description: Measure recovery completion time
    duration_estimate: 1 hour
  - id: '4'
    name: Test State Restoration
    description: Verify system state after recovery
    duration_estimate: 1 hour
  - id: '5'
    name: Evaluate Degradation Modes
    description: Review partial operation capabilities
    duration_estimate: 30 minutes
  - id: '6'
    name: Document Findings
    description: Compile assessment report
    duration_estimate: 30 minutes
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Safe State Review
    - Recovery Path Analysis
    - Timing Verification
    - Recommendations
closeout_checklist:
- id: rm-001
  item: Safe states reviewed
  level: CRITICAL
  verification: manual
- id: rm-002
  item: Recovery paths analyzed
  level: CRITICAL
  verification: manual
- id: rm-003
  item: Recovery timing verified
  level: HIGH
  verification: automated
- id: rm-004
  item: State restoration tested
  level: HIGH
  verification: automated
governance:
  applicable_to:
    archetypes:
    - embedded-systems
    - safety-critical
    - high-availability
  compliance_mappings:
  - framework: IEC 61508
    control: 7.4.4
    description: Safe state specification
  - framework: ISO 26262
    control: Part 4
    description: Fault tolerant time
  - framework: DO-178C
    control: 6.3.5
    description: Error recovery
relationships:
  commonly_combined:
  - real-time-embedded.watchdog-recovery.fault-detection
  - real-time-embedded.watchdog-recovery.system-reset-handling
  depends_on:
  - safety.safe-state-definition
  - real-time-embedded.watchdog-recovery.fault-detection
  feeds_into:
  - safety.functional-safety
  - reliability.availability
