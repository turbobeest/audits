audit:
  id: real-time-embedded.communication-protocols.protocol-timing
  name: Protocol Timing Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: real-time-embedded
  category_number: 39
  subcategory: communication-protocols
  tier: expert
  estimated_duration: 4-6 hours  # median: 5h
  completeness: requires_discovery
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: embedded-systems
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Analyzes communication protocol timing including message latency, jitter,
    timeout handling, and timing constraint compliance. Reviews how protocol
    timing interacts with real-time task scheduling and hardware interfaces.
    Examines worst-case end-to-end latency.
  why_it_matters: |
    Communication timing directly affects control system performance. Late
    sensor data causes stale control. Timeout values too short cause spurious
    failures, too long delay error detection. Protocol timing must be
    considered in overall system timing analysis.
  when_to_run:
  - During protocol integration
  - When debugging timing issues
  - Before real-time deployment
  - After communication changes
  - For timing certification
prerequisites:
  required_artifacts:
  - type: protocol_implementation
    description: Protocol stack source code
  - type: timing_requirements
    description: Communication timing requirements
  - type: system_architecture
    description: System communication architecture
  - type: task_schedule
    description: Task timing information
  access_requirements:
  - Access to source code
  - Protocol analyzer
  - Timing measurement tools
  - Debug/trace capability
discovery:
  file_patterns:
  - glob: '**/protocol*.c'
    purpose: Find protocol code
  - glob: '**/timeout*.c'
    purpose: Find timeout handling
  - glob: '**/comm*.c'
    purpose: Find communication code
  - glob: '**/latency*.c'
    purpose: Find latency measurement
  - glob: '**/timing*.h'
    purpose: Find timing constants
knowledge_sources:
  guides:
  - id: protocol-timing
    name: Communication Protocol Timing
    url: https://www.embedded.com/protocol-timing
  - id: end-to-end-latency
    name: End-to-End Latency Analysis
    url: https://www.embedded.com/latency-analysis
  standards:
  - id: autosar-com
    name: AUTOSAR COM
    relevance: Automotive communication timing
  - id: iec-61131
    name: IEC 61131
    relevance: PLC communication timing
tooling:
  analysis_tools:
  - tool: protocol-analyzer
    purpose: Message timing capture
  - tool: oscilloscope
    purpose: Signal timing measurement
  - tool: tracealyzer
    purpose: Protocol timing visualization
signals:
  critical:
  - id: PT-CRIT-001
    signal: Message latency exceeds deadline
    evidence_indicators:
    - End-to-end latency too high
    - Control loop deadline missed
    - Data arrives too late
    explanation: |
      Message latency must be less than the control deadline. Late
      messages make control based on stale data.
    remediation: Reduce latency through optimization or priority
  - id: PT-CRIT-002
    signal: Protocol blocking impacts real-time tasks
    evidence_indicators:
    - Protocol waits block tasks
    - Priority inversion through protocol
    - Task deadline missed
    explanation: |
      Protocol operations must not block real-time tasks beyond
      acceptable limits. Blocking causes deadline violations.
    remediation: Use non-blocking protocol operations or proper priority
  high:
  - id: PT-HIGH-001
    signal: Timeout values not analyzed
    evidence_indicators:
    - Arbitrary timeout values
    - No worst-case analysis
    - Spurious timeouts possible
    explanation: |
      Timeout values must be based on worst-case normal operation.
      Wrong values cause spurious failures or slow detection.
    remediation: Set timeouts based on worst-case analysis
  - id: PT-HIGH-002
    signal: Jitter exceeds requirements
    evidence_indicators:
    - Message timing varies widely
    - Jitter budget exceeded
    - Inconsistent communication
    explanation: |
      Timing jitter affects control system performance. Excessive
      jitter violates timing requirements.
    remediation: Reduce jitter through scheduling or buffering
  medium:
  - id: PT-MED-001
    signal: Timing not integrated in system analysis
    evidence_indicators:
    - Protocol timing separate from task analysis
    - End-to-end not calculated
    - Interaction not considered
    explanation: |
      Protocol timing must be included in overall system timing
      analysis for accurate deadline verification.
    remediation: Include protocol timing in system analysis
  - id: PT-MED-002
    signal: Retry timing not analyzed
    evidence_indicators:
    - Retry delays unknown
    - Worst-case with retries not calculated
    - Degraded performance not characterized
    explanation: |
      Communication errors trigger retries that add latency. Worst
      case must include retry scenarios.
    remediation: Analyze worst-case timing with retries
  low:
  - id: PT-LOW-001
    signal: Protocol timing not documented
    evidence_indicators:
    - Latency requirements not specified
    - Timeout rationale missing
    - Timing analysis not recorded
    explanation: |
      Documentation supports maintenance and verification.
    remediation: Document protocol timing analysis
  positive:
  - id: PT-POS-001
    signal: Protocol timing within requirements
    evidence_indicators:
    - Latency meets deadlines
    - Jitter within budget
    - Timeouts appropriate
  - id: PT-POS-002
    signal: Timing integrated in system analysis
    evidence_indicators:
    - End-to-end analysis complete
    - Protocol in timing model
    - Worst-case characterized
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Document Timing Requirements
    description: Gather latency and jitter requirements
    duration_estimate: 30 minutes
  - id: '2'
    name: Measure Message Latency
    description: Capture actual message timing
    duration_estimate: 1-2 hours
  - id: '3'
    name: Analyze Jitter
    description: Calculate timing variation statistics
    duration_estimate: 1 hour
  - id: '4'
    name: Review Timeout Configuration
    description: Verify timeout values are appropriate
    duration_estimate: 30 minutes
  - id: '5'
    name: Assess System Integration
    description: Verify protocol timing in system analysis
    duration_estimate: 1 hour
  - id: '6'
    name: Document Findings
    description: Compile assessment report
    duration_estimate: 30 minutes
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Timing Requirements
    - Latency Measurements
    - Jitter Analysis
    - Recommendations
closeout_checklist:
- id: pt-001
  item: Timing requirements documented
  level: HIGH
  verification: manual
- id: pt-002
  item: Latency measured
  level: CRITICAL
  verification: automated
- id: pt-003
  item: Jitter analyzed
  level: HIGH
  verification: automated
- id: pt-004
  item: System integration assessed
  level: HIGH
  verification: manual
governance:
  applicable_to:
    archetypes:
    - embedded-systems
    - real-time
    - control-systems
  compliance_mappings:
  - framework: AUTOSAR
    control: COM Timing
    description: Communication timing
  - framework: DO-178C
    control: 6.3.4
    description: Timing analysis
  - framework: IEC 61508
    control: 7.4.3
    description: Communication timing
relationships:
  commonly_combined:
  - real-time-embedded.timing-analysis.deadline-verification
  - real-time-embedded.communication-protocols.can-bus-analysis
  depends_on:
  - real-time-embedded.timing-analysis.response-time-analysis
  feeds_into:
  - real-time-embedded.timing-analysis.schedulability-analysis
  - control.control-system-performance

# Glossary of domain-specific terms:
glossary:
  "WCET": "Worst-Case Execution Time - maximum possible execution time for a code path"
  "ISR": "Interrupt Service Routine - function executed in response to hardware interrupt"
  "jitter": "Variation in timing between expected and actual execution"
