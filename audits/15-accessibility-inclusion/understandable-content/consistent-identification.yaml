# ============================================================
# AUDIT: Consistent Identification - WCAG 2.1 Compliance
# ============================================================
# Verifies components with same functionality are identified
# consistently per WCAG 2.1 SC 3.2.4.

audit:
  id: "accessibility-inclusion.understandable-content.consistent-identification"
  name: "Consistent Identification Audit"
  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "accessibility-inclusion"
  category_number: 15
  subcategory: "understandable-content"

  tier: "expert"
  estimated_duration: "2-3 hours"  # median: 2h

  completeness: "complete"
  requires_runtime: true
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "codebase"

  default_profiles:
    - "full"
    - "accessibility"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    This audit verifies components with the same functionality are
    identified consistently per WCAG 2.1 SC 3.2.4 Consistent
    Identification (Level AA).

    The audit covers:
    - Icon consistency (same icon = same function)
    - Button label consistency
    - Link text consistency
    - Form input labels
    - Error message patterns
    - Action button naming
    - Aria-labels and accessible names
    - Visual indicator consistency

  why_it_matters: |
    Consistent identification helps users understand functionality:

    - Same icon should mean same action everywhere
    - Same button text should produce same result
    - Users learn patterns and expect consistency
    - Inconsistency creates confusion and errors
    - Screen reader users rely on consistent labeling

    When the same function is labeled differently in different
    places, users cannot reliably predict what will happen.

  when_to_run:
    - "When implementing new components"
    - "During design system audits"
    - "Before accessibility compliance reviews"
    - "When standardizing UI patterns"
    - "After adding new features"

prerequisites:
  required_artifacts:
    - type: "codebase"
      description: "Access to component and template code"
    - type: "running_application"
      description: "Deployed instance for comparison"
    - type: "design_system"
      description: "Design system documentation"

  access_requirements:
    - "Read access to source code"
    - "Access to design system"
    - "Browser access for testing"

discovery:
  code_patterns:
    - pattern: "aria-label"
      type: "regex"
      scope: "source"
      purpose: "Find accessible labels"
    - pattern: "<button|<Button"
      type: "regex"
      scope: "source"
      purpose: "Find button elements"
    - pattern: "icon.*delete|trash|remove"
      type: "regex"
      scope: "source"
      purpose: "Find delete action icons"
    - pattern: "icon.*edit|pencil|modify"
      type: "regex"
      scope: "source"
      purpose: "Find edit action icons"
    - pattern: "icon.*search|magnify"
      type: "regex"
      scope: "source"
      purpose: "Find search icons"

  file_patterns:
    - glob: "**/components/**/*.{jsx,tsx}"
      purpose: "UI components"
    - glob: "**/buttons/**/*.{jsx,tsx}"
      purpose: "Button components"
    - glob: "**/icons/**"
      purpose: "Icon assets"

knowledge_sources:
  specifications:
    - id: "wcag-21"
      name: "WCAG 2.1 Quick Reference"
      url: "https://www.w3.org/WAI/WCAG21/quickref/"
      offline_cache: true
      priority: "recommended"
    - id: "wcag21-324"
      name: "WCAG 2.1 Success Criterion 3.2.4 Consistent Identification"
      url: "https://www.w3.org/WAI/WCAG21/Understanding/consistent-identification.html"
      offline_cache: true
      priority: "required"

  guides:
    - id: "w3c-consistent-id"
      name: "W3C: Consistent Identification Techniques"
      url: "https://www.w3.org/WAI/WCAG21/Techniques/general/G197"
      offline_cache: true

tooling:
  static_analysis:
    - tool: "custom linting rules"
      purpose: "Check for consistent labeling patterns"
      offline_capable: true

  scripts:
    - id: "find-inconsistent-labels"
      language: "bash"
      purpose: "Find potential labeling inconsistencies"
      source: "inline"
      code: |
        #!/bin/bash
        echo "=== Delete/Remove Actions ==="
        grep -rn "delete\|remove\|trash" --include="*.jsx" --include="*.tsx" . | grep -i "aria-label\|title\|alt" | head -20
        echo ""
        echo "=== Edit/Modify Actions ==="
        grep -rn "edit\|modify\|update" --include="*.jsx" --include="*.tsx" . | grep -i "aria-label\|title" | head -20
        echo ""
        echo "=== Search Actions ==="
        grep -rn "search\|find\|query" --include="*.jsx" --include="*.tsx" . | grep -i "aria-label\|title\|placeholder" | head -15

signals:
  critical:
    - id: "A11Y-IDENT-CRIT-001"
      signal: "Same icon used for different functions"
      evidence_pattern: "Trash icon used for both delete and clear"
      explanation: |
        Using the same icon for different actions confuses users
        about what will happen when they interact with it.
      remediation: "Use distinct icons for distinct functions"
    - id: "A11Y-IDENT-CRIT-002"
      signal: "Same function labeled differently across app"
      evidence_pattern: "'Delete', 'Remove', 'Trash' for same action"
      explanation: |
        Users cannot predict behavior when the same action has
        different names in different places.
      remediation: "Standardize terminology across the application"

  high:
    - id: "A11Y-IDENT-HIGH-001"
      signal: "Aria-labels inconsistent for same functionality"
      explanation: "Screen reader users rely on consistent labels"
      remediation: "Standardize aria-labels for common actions"
    - id: "A11Y-IDENT-HIGH-002"
      signal: "Form field labels vary for same input type"
      explanation: "Same type of input should have consistent labeling"
      remediation: "Create standard label patterns for common fields"
    - id: "A11Y-IDENT-HIGH-003"
      signal: "Error messages use inconsistent patterns"
      explanation: "Error communication should follow consistent patterns"
      remediation: "Create error message templates"

  medium:
    - id: "A11Y-IDENT-MED-001"
      signal: "Button styles inconsistent for same action type"
      remediation: "Standardize button styling by action type"
    - id: "A11Y-IDENT-MED-002"
      signal: "Icon + text combinations vary"
      remediation: "Use consistent icon+text pairing"
    - id: "A11Y-IDENT-MED-003"
      signal: "Placeholder text inconsistent"
      remediation: "Standardize placeholder patterns"

  low:
    - id: "A11Y-IDENT-LOW-001"
      signal: "Minor naming variations exist"

  positive:
    - id: "A11Y-IDENT-POS-001"
      signal: "Consistent terminology across application"
    - id: "A11Y-IDENT-POS-002"
      signal: "Design system enforces consistent patterns"
    - id: "A11Y-IDENT-POS-003"
      signal: "Icons consistently represent same functions"

procedure:
  context:
    cognitive_mode: "critical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Inventory Common Actions"
      description: |
        Identify all common actions and how they are labeled
        throughout the application.
      duration_estimate: "30 min"
      commands:
        - purpose: "Find delete actions"
          command: "grep -rn 'delete\\|remove\\|trash\\|discard' --include='*.jsx' --include='*.tsx' . | head -30"
        - purpose: "Find save actions"
          command: "grep -rn 'save\\|submit\\|apply\\|confirm' --include='*.jsx' --include='*.tsx' . | head -30"
        - purpose: "Find cancel actions"
          command: "grep -rn 'cancel\\|close\\|dismiss\\|back' --include='*.jsx' --include='*.tsx' . | head -30"
      expected_findings:
        - "Action terminology inventory"
        - "Label variations"

    - id: "2"
      name: "Compare Labels Across Pages"
      description: |
        Visit multiple pages and compare how the same
        functionality is labeled.
      duration_estimate: "45 min"
      questions:
        - "Is the delete action always called 'Delete'?"
        - "Are edit buttons consistently labeled?"
        - "Do search inputs have consistent placeholders?"
        - "Are form labels consistent across forms?"
      expected_findings:
        - "Labeling consistency across pages"
        - "Inconsistent terminology"

    - id: "3"
      name: "Audit Icon Usage"
      description: |
        Verify icons are used consistently for the
        same functionality.
      duration_estimate: "30 min"
      questions:
        - "Does the trash icon always mean delete?"
        - "Does the pencil icon always mean edit?"
        - "Are icons reused for different functions?"
      expected_findings:
        - "Icon usage patterns"
        - "Icon inconsistencies"

    - id: "4"
      name: "Review Screen Reader Labels"
      description: |
        Check aria-labels and accessible names for
        consistency.
      duration_estimate: "30 min"
      commands:
        - purpose: "Find aria-labels"
          command: "grep -rn 'aria-label=' --include='*.jsx' --include='*.tsx' . | head -50"
      expected_findings:
        - "Accessible name patterns"
        - "Label inconsistencies"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Action Terminology Analysis"
        - "Icon Usage Audit"
        - "Accessible Label Review"
        - "Standardization Recommendations"

  confidence_guidance:
    high: "Complete cross-application review"
    medium: "Sample pages with code analysis"
    low: "Code pattern analysis only"

offline:
  capability: "full"

  cache_manifest:
    knowledge:
      - source_id: "wcag21-324"
        priority: "required"

profiles:
  membership:
    quick:
      included: false
      reason: "Requires cross-application comparison"
    full:
      included: true
      priority: 2
    accessibility:
      included: true
      priority: 1

closeout_checklist:
  - id: "consistent-id-001"
    item: "Same functionality labeled consistently"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Compare labels for common actions across pages"
    expected: "Confirmed by reviewer"

  - id: "consistent-id-002"
    item: "Icons consistently represent same functions"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Verify icon-to-function mapping is consistent"
    expected: "Confirmed by reviewer"

  - id: "consistent-id-003"
    item: "Aria-labels follow consistent patterns"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Review aria-labels for common actions"
    expected: "Confirmed by reviewer"

  - id: "consistent-id-004"
    item: "Design system enforces consistency"
    level: "WARNING"
    verification: "manual"
    verification_notes: "Check for standardized component patterns"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["all"]

  compliance_frameworks:
    - framework: "WCAG 2.1"
      controls: ["3.2.4"]
    - framework: "Section 508"
      controls: ["1194.22"]
    - framework: "EN 301 549"
      controls: ["9.3.2.4"]

relationships:
  commonly_combined:
    - "accessibility-inclusion.understandable-content.consistent-navigation"
    - "accessibility-inclusion.understandable-content.error-suggestion"
