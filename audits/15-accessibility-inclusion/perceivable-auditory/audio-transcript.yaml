# ============================================================
# AUDIT: Audio Transcript Provision - WCAG 2.1 Compliance
# ============================================================
# Verifies audio content has text transcripts for deaf and
# hard of hearing users.

audit:
  id: "accessibility-inclusion.perceivable-auditory.audio-transcript"
  name: "Audio Transcript Provision Audit"
  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "accessibility-inclusion"
  category_number: 15
  subcategory: "perceivable-auditory"

  tier: "expert"
  estimated_duration: "2-4 hours"  # median: 3h

  completeness: "requires_discovery"
  requires_runtime: true
  destructive: false

execution:
  automatable: "partial"
  severity: "critical"
  scope: "codebase"

  default_profiles:
    - "full"
    - "accessibility"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    This audit verifies that all audio-only content has text
    transcripts available, per WCAG 2.1 SC 1.2.1 (Audio-only
    and Video-only - Prerecorded) Level A.

    The audit covers:
    - Podcasts and audio recordings
    - Audio clips in applications
    - Voice messages or audio feedback
    - Audio instructions
    - Background audio with informational content
    - Audio elements in multimedia presentations
    - Notification sounds with information

  why_it_matters: |
    Approximately 466 million people worldwide have disabling
    hearing loss (WHO). Audio-only content without transcripts:

    - Completely excludes deaf users from information
    - Prevents access for users in sound-sensitive environments
    - Is inaccessible to users without audio capability
    - Violates Level A WCAG requirements (baseline)
    - Creates legal liability under accessibility laws

    Transcripts also benefit:
    - Non-native speakers
    - Users with cognitive disabilities
    - Users who prefer reading to listening
    - Search engine indexing (SEO benefit)

  when_to_run:
    - "When adding audio content"
    - "During content audits"
    - "Before accessibility compliance reviews"
    - "After podcast or audio feature launches"
    - "When migrating multimedia content"

prerequisites:
  required_artifacts:
    - type: "codebase"
      description: "Access to audio files and embedding code"
    - type: "running_application"
      description: "Deployed instance for content verification"
    - type: "content_inventory"
      description: "List of all audio content"

  access_requirements:
    - "Read access to audio files and templates"
    - "Access to CMS for content review"
    - "Access to transcript storage location"

discovery:
  code_patterns:
    - pattern: "<audio"
      type: "regex"
      scope: "source"
      purpose: "Find audio elements"
    - pattern: "\\.mp3|\\.wav|\\.ogg|\\.m4a|\\.aac"
      type: "regex"
      scope: "source"
      purpose: "Find audio file references"
    - pattern: "podcast|audio-player|sound-file"
      type: "regex"
      scope: "source"
      purpose: "Find audio player implementations"
    - pattern: "transcript|caption|subtitle"
      type: "regex"
      scope: "source"
      purpose: "Find existing transcript implementations"

  file_patterns:
    - glob: "**/*.mp3"
      purpose: "MP3 audio files"
    - glob: "**/*.wav"
      purpose: "WAV audio files"
    - glob: "**/audio/**"
      purpose: "Audio directory"
    - glob: "**/podcast*.{jsx,tsx}"
      purpose: "Podcast components"

knowledge_sources:
  specifications:
    - id: "wcag-21"
      name: "WCAG 2.1 Quick Reference"
      url: "https://www.w3.org/WAI/WCAG21/quickref/"
      offline_cache: true
      priority: "recommended"
    - id: "wcag21-121"
      name: "WCAG 2.1 Success Criterion 1.2.1 Audio-only and Video-only (Prerecorded)"
      url: "https://www.w3.org/WAI/WCAG21/Understanding/audio-only-and-video-only-prerecorded.html"
      offline_cache: true
      priority: "required"

  guides:
    - id: "w3c-transcripts"
      name: "W3C: Transcripts"
      url: "https://www.w3.org/WAI/media/av/transcripts/"
      offline_cache: true
    - id: "webaim-audio"
      name: "WebAIM: Creating Accessible Audio and Video"
      url: "https://webaim.org/techniques/captions/"
      offline_cache: true

tooling:
  static_analysis:
    - tool: "axe-core"
      purpose: "Detect audio elements without alternatives"
      offline_capable: true

  assessment_tools:
    - tool: "Otter.ai"
      purpose: "Automated transcription service"
    - tool: "Descript"
      purpose: "Audio transcription and editing"
    - tool: "Rev.com"
      purpose: "Professional transcription service"

  scripts:
    - id: "find-audio-content"
      language: "bash"
      purpose: "Find audio files and elements"
      source: "inline"
      code: |
        #!/bin/bash
        echo "=== Audio Elements ==="
        grep -rn "<audio" --include="*.html" --include="*.jsx" --include="*.tsx" . | head -20
        echo ""
        echo "=== Audio File References ==="
        grep -rn "\.mp3\|\.wav\|\.ogg\|\.m4a" --include="*.html" --include="*.jsx" --include="*.json" . | head -20

signals:
  critical:
    - id: "A11Y-AUDIO-CRIT-001"
      signal: "Audio content has no transcript available"
      evidence_pattern: "<audio> element without associated transcript link"
      explanation: |
        Deaf users cannot access audio content without transcripts.
        This is a Level A violation affecting baseline accessibility.
      remediation: "Create and link text transcript for all audio content"
    - id: "A11Y-AUDIO-CRIT-002"
      signal: "Podcast episodes without transcripts"
      evidence_pattern: "Podcast feed with no transcript files"
      explanation: |
        Podcasts are a common form of audio-only content that
        require transcripts for accessibility.
      remediation: "Generate transcripts for all podcast episodes and link in show notes"

  high:
    - id: "A11Y-AUDIO-HIGH-001"
      signal: "Transcript not easily discoverable"
      explanation: "Transcripts must be easy to find near the audio player"
      remediation: "Add visible 'Transcript' link adjacent to audio player"
    - id: "A11Y-AUDIO-HIGH-002"
      signal: "Transcript format not accessible"
      explanation: "Transcripts must be in accessible text format"
      remediation: "Provide transcript as HTML text, not PDF image"
    - id: "A11Y-AUDIO-HIGH-003"
      signal: "Audio instructions without text alternative"
      explanation: "Instructional audio must have text equivalent"
      remediation: "Provide written instructions alongside audio"

  medium:
    - id: "A11Y-AUDIO-MED-001"
      signal: "Transcript lacks speaker identification"
      remediation: "Include speaker labels in multi-speaker transcripts"
    - id: "A11Y-AUDIO-MED-002"
      signal: "Transcript does not include relevant sounds"
      remediation: "Describe significant non-speech audio (music, sound effects)"
    - id: "A11Y-AUDIO-MED-003"
      signal: "Automated transcript has significant errors"
      remediation: "Review and correct automated transcripts for accuracy"

  low:
    - id: "A11Y-AUDIO-LOW-001"
      signal: "Transcript could include more context"

  positive:
    - id: "A11Y-AUDIO-POS-001"
      signal: "All audio content has accurate transcripts"
    - id: "A11Y-AUDIO-POS-002"
      signal: "Transcripts are prominently linked"
    - id: "A11Y-AUDIO-POS-003"
      signal: "Interactive transcript with audio sync available"

procedure:
  context:
    cognitive_mode: "critical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Inventory All Audio Content"
      description: |
        Identify all audio-only content in the application,
        including embedded players, podcasts, and audio clips.
      duration_estimate: "30 min"
      commands:
        - purpose: "Find audio elements"
          command: "grep -rn '<audio' --include='*.html' --include='*.jsx' --include='*.tsx' ."
        - purpose: "Find audio file references"
          command: "find . -name '*.mp3' -o -name '*.wav' -o -name '*.ogg' 2>/dev/null | head -50"
        - purpose: "Find podcast references"
          command: "grep -rn 'podcast\\|audio' --include='*.json' --include='*.xml' . | head -20"
      expected_findings:
        - "Complete list of audio content"
        - "Audio file locations"

    - id: "2"
      name: "Check for Existing Transcripts"
      description: |
        For each audio content item, verify a transcript
        exists and is linked.
      duration_estimate: "45 min"
      commands:
        - purpose: "Find transcript files"
          command: "find . -name '*transcript*' -o -name '*caption*' 2>/dev/null | head -30"
        - purpose: "Find transcript links in code"
          command: "grep -rn 'transcript' --include='*.html' --include='*.jsx' . | head -20"
      expected_findings:
        - "Existing transcript locations"
        - "Gap between audio and transcripts"

    - id: "3"
      name: "Evaluate Transcript Quality"
      description: |
        Review available transcripts for accuracy, formatting,
        and accessibility.
      duration_estimate: "60 min"
      questions:
        - "Is the transcript accurate (>99% word accuracy)?"
        - "Are speakers identified in multi-speaker audio?"
        - "Are significant sounds described?"
        - "Is the transcript easily discoverable?"
        - "Is the transcript format accessible (HTML text)?"
      expected_findings:
        - "Quality assessment of transcripts"
        - "Formatting and accuracy issues"

    - id: "4"
      name: "Document Missing Transcripts"
      description: |
        Create a prioritized list of audio content
        requiring transcript creation.
      duration_estimate: "30 min"
      expected_findings:
        - "Prioritized missing transcript list"
        - "Estimated effort for transcript creation"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Audio Content Inventory"
        - "Transcript Coverage Report"
        - "Quality Assessment"
        - "Missing Transcript Priority List"
        - "Recommendations"

  confidence_guidance:
    high: "Manual review of audio and transcripts completed"
    medium: "Automated inventory, sample transcript review"
    low: "File-based discovery only"

offline:
  capability: "partial"

  cache_manifest:
    knowledge:
      - source_id: "wcag21-121"
        priority: "required"

profiles:
  membership:
    quick:
      included: false
      reason: "Requires content inventory and manual review"
    full:
      included: true
      priority: 1
    accessibility:
      included: true
      priority: 1

closeout_checklist:
  - id: "audio-transcript-001"
    item: "All audio-only content has transcript available"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Review each audio file and verify linked transcript exists"
    expected: "Confirmed by reviewer"

  - id: "audio-transcript-002"
    item: "Transcripts are easily discoverable near audio player"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Verify visible transcript link for each audio element"
    expected: "Confirmed by reviewer"

  - id: "audio-transcript-003"
    item: "Transcripts are in accessible format (HTML text)"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Verify transcripts are not image-based PDFs"
    expected: "Confirmed by reviewer"

  - id: "audio-transcript-004"
    item: "Transcripts include speaker identification"
    level: "WARNING"
    verification: "manual"
    verification_notes: "Check multi-speaker audio transcripts for speaker labels"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["all"]

  compliance_frameworks:
    - framework: "WCAG 2.1"
      controls: ["1.2.1"]
    - framework: "Section 508"
      controls: ["1194.22(b)"]
    - framework: "EN 301 549"
      controls: ["9.1.2.1"]
    - framework: "ADA"
      controls: ["Title III"]

relationships:
  commonly_combined:
    - "accessibility-inclusion.perceivable-auditory.video-caption"
    - "accessibility-inclusion.perceivable-auditory.audio-description"
    - "accessibility-inclusion.perceivable-visual.non-text-content-alt"
