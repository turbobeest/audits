# ============================================================
# AUDIT: No Timing Dependency - WCAG 2.1 AAA Compliance
# ============================================================
# Verifies content does not require time-dependent interaction
# per WCAG 2.1 SC 2.2.3 No Timing.

audit:
  id: "accessibility-inclusion.operable-timing.no-timing-dependency"
  name: "No Timing Dependency Audit"
  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "accessibility-inclusion"
  category_number: 15
  subcategory: "operable-timing"

  tier: "phd"
  estimated_duration: "2-3 hours"  # median: 2h

  completeness: "complete"
  requires_runtime: true
  destructive: false

execution:
  automatable: "partial"
  severity: "medium"
  scope: "codebase"

  default_profiles:
    - "full"
    - "accessibility"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    This audit evaluates compliance with WCAG 2.1 SC 2.2.3 No Timing
    (Level AAA), verifying timing is not essential to the activity
    except for real-time events.

    The audit covers:
    - Quiz and assessment time limits
    - Game timing requirements
    - Form completion deadlines
    - Interactive tutorial timing
    - Training module pacing
    - Time-based interactions
    - Synchronous activities
    - Content presentation speed

    Exceptions: Real-time events (auctions, live performances)
    and essential timing (competitive gaming) are exempt.

  why_it_matters: |
    Time pressure excludes users who need more time:

    - Cognitive disabilities affect processing speed
    - Motor impairments slow input
    - Reading disabilities slow comprehension
    - Anxiety conditions worsen under time pressure
    - Aging affects reaction time

    Where timing is not truly essential to the activity, removing
    time limits creates a more inclusive experience.

  when_to_run:
    - "When designing assessments or quizzes"
    - "When implementing training modules"
    - "Before AAA compliance audits"
    - "When building interactive tutorials"

prerequisites:
  required_artifacts:
    - type: "codebase"
      description: "Access to feature code"
    - type: "running_application"
      description: "Deployed instance for testing"
    - type: "feature_requirements"
      description: "Understanding of feature purposes"

  access_requirements:
    - "Read access to source code"
    - "Access to feature documentation"
    - "Browser access for testing"

discovery:
  code_patterns:
    - pattern: "timer|countdown|deadline|time-?limit"
      type: "regex"
      scope: "source"
      purpose: "Find timing implementations"
    - pattern: "quiz|assessment|test|exam"
      type: "regex"
      scope: "source"
      purpose: "Find assessment features"
    - pattern: "game|score|level|challenge"
      type: "regex"
      scope: "source"
      purpose: "Find gaming features"

  file_patterns:
    - glob: "**/quiz*.{jsx,tsx}"
      purpose: "Quiz components"
    - glob: "**/assessment*.{jsx,tsx}"
      purpose: "Assessment components"
    - glob: "**/tutorial*.{jsx,tsx}"
      purpose: "Tutorial components"

knowledge_sources:
  specifications:
    - id: "wcag21-223"
      name: "WCAG 2.1 Success Criterion 2.2.3 No Timing"
      url: "https://www.w3.org/WAI/WCAG21/Understanding/no-timing.html"
      offline_cache: true
      priority: "required"

  guides:
    - id: "w3c-no-timing"
      name: "W3C: No Timing Techniques"
      url: "https://www.w3.org/WAI/WCAG21/Techniques/general/G5"
      offline_cache: true

signals:
  critical:
    - id: "A11Y-NOTIMING-CRIT-001"
      signal: "Essential content requires timed interaction"
      evidence_pattern: "Critical feature only available with time limit"
      explanation: |
        If timing is not truly essential to the activity, all users
        should be able to complete tasks without time pressure.
      remediation: "Remove time limits or provide untimed alternative"

  high:
    - id: "A11Y-NOTIMING-HIGH-001"
      signal: "Assessment has time limit without untimed option"
      explanation: "Educational assessments should offer untimed mode"
      remediation: "Provide untimed assessment option for accessibility"
    - id: "A11Y-NOTIMING-HIGH-002"
      signal: "Tutorial pacing cannot be controlled"
      explanation: "Learning content should allow self-pacing"
      remediation: "Allow users to control tutorial/training pace"

  medium:
    - id: "A11Y-NOTIMING-MED-001"
      signal: "Non-essential gamification has time pressure"
      remediation: "Consider removing timing from non-competitive features"
    - id: "A11Y-NOTIMING-MED-002"
      signal: "Timed feature lacks justification"
      remediation: "Document business justification for timing requirement"

  low:
    - id: "A11Y-NOTIMING-LOW-001"
      signal: "Optional timed mode could be more accessible"

  positive:
    - id: "A11Y-NOTIMING-POS-001"
      signal: "No artificial time limits on essential content"
    - id: "A11Y-NOTIMING-POS-002"
      signal: "Untimed alternatives available for assessments"
    - id: "A11Y-NOTIMING-POS-003"
      signal: "Self-paced learning supported"

procedure:
  context:
    cognitive_mode: "evaluative"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Identify Timed Features"
      description: |
        Find all features that incorporate time limits or
        time-dependent interactions.
      duration_estimate: "30 min"
      commands:
        - purpose: "Find timer/countdown code"
          command: "grep -rn 'timer\\|countdown\\|deadline\\|time.*limit' --include='*.js' --include='*.ts' --include='*.jsx' . | head -30"
        - purpose: "Find assessment features"
          command: "grep -rln 'quiz\\|assessment\\|test\\|exam' --include='*.jsx' --include='*.tsx' . | head -15"
      expected_findings:
        - "Complete list of timed features"
        - "Timer implementations"

    - id: "2"
      name: "Evaluate Timing Necessity"
      description: |
        For each timed feature, determine if timing is
        essential to the activity.
      duration_estimate: "45 min"
      questions:
        - "Is timing essential to measure the skill being tested?"
        - "Would removing timing fundamentally change the activity?"
        - "Is this a real-time event (auction, live performance)?"
        - "Could an untimed alternative be provided?"
        - "What is the business justification for timing?"
      expected_findings:
        - "Timing necessity analysis"
        - "Features where timing is not essential"

    - id: "3"
      name: "Check for Untimed Alternatives"
      description: |
        Verify untimed alternatives exist where timing
        is not essential.
      duration_estimate: "30 min"
      questions:
        - "Are untimed versions of assessments available?"
        - "Can users request extended time or no time limit?"
        - "Is self-pacing available for tutorials?"
      expected_findings:
        - "Untimed alternative availability"
        - "Accommodation options"

    - id: "4"
      name: "Document Exceptions"
      description: |
        Document features where timing is legitimately
        essential (real-time events, competitive features).
      duration_estimate: "20 min"
      expected_findings:
        - "Documented timing exceptions"
        - "Business justifications"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Timed Feature Inventory"
        - "Timing Necessity Analysis"
        - "Untimed Alternatives"
        - "Legitimate Exceptions"
        - "Recommendations"

  confidence_guidance:
    high: "Feature analysis with business stakeholder input"
    medium: "Code analysis with feature testing"
    low: "Code pattern analysis only"

offline:
  capability: "partial"

  cache_manifest:
    knowledge:
      - source_id: "wcag21-223"
        priority: "required"

profiles:
  membership:
    quick:
      included: false
      reason: "AAA requirement, requires feature analysis"
    full:
      included: true
      priority: 3
    accessibility:
      included: true
      priority: 2

closeout_checklist:
  - id: "no-timing-001"
    item: "Timing is truly essential where used (AAA target)"
    level: "WARNING"
    verification: "manual"
    verification_notes: "Review timed features for necessity"
    expected: "Confirmed by reviewer"

  - id: "no-timing-002"
    item: "Untimed alternatives provided where possible"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Check for untimed modes in assessments"
    expected: "Confirmed by reviewer"

  - id: "no-timing-003"
    item: "Self-pacing available for learning content"
    level: "WARNING"
    verification: "manual"
    verification_notes: "Test tutorials and training modules"
    expected: "Confirmed by reviewer"

  - id: "no-timing-004"
    item: "Timing exceptions documented"
    level: "WARNING"
    verification: "manual"
    verification_notes: "Review documentation for justified exceptions"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["education", "training", "government"]

  compliance_frameworks:
    - framework: "WCAG 2.1"
      controls: ["2.2.3"]
    - framework: "EN 301 549"
      controls: ["9.2.2.3"]

relationships:
  commonly_combined:
    - "accessibility-inclusion.operable-timing.time-limit-adjustability"
    - "accessibility-inclusion.operable-timing.pause-stop-hide-control"
