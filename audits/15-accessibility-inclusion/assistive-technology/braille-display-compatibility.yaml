# ============================================================
# AUDIT: Braille Display Compatibility
# ============================================================
# Verifies application usability with refreshable braille
# displays for deafblind and braille-preferred users.
# ============================================================

audit:
  id: "accessibility-inclusion.assistive-technology.braille-display-compatibility"

  name: "Braille Display Compatibility"

  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "accessibility-inclusion"
  category_number: 15
  subcategory: "assistive-technology"

  tier: "phd"
  estimated_duration: "2-3 hours"  # median: 2h

  completeness: "requires_discovery"
  requires_runtime: true
  destructive: false

execution:
  automatable: "manual"
  severity: "medium"
  scope: "runtime"

  default_profiles:
    - "full"
    - "production"

  blocks_phase: false
  parallelizable: false

description:
  what: |
    This audit evaluates application compatibility with refreshable braille
    displays, which are essential assistive technology for deafblind users
    and preferred by many blind users who read braille.

    Refreshable braille displays:
    - Convert text to raised braille pins in real-time
    - Typically show 20-80 characters at once
    - Work with screen reader software
    - Include navigation buttons (routing buttons, panning keys)

    The audit verifies:
    - Text content converts correctly to braille
    - Navigation commands work with braille display buttons
    - Content structure allows efficient braille reading
    - Special characters and symbols are handled appropriately
    - Mathematical notation is accessible (if applicable)
    - Tables can be navigated via braille

  why_it_matters: |
    Braille displays serve critical user populations:
    - Deafblind users who cannot use audio screen readers
    - Blind users who prefer reading braille over audio
    - Blind professionals needing precise text (programmers, writers)
    - Students learning braille literacy

    While braille display compatibility largely follows screen reader
    accessibility, specific considerations exist:
    - Content length limitations (20-80 characters visible)
    - No audio cues available for deafblind users
    - Navigation relies on routing buttons and pan keys
    - Special characters may display differently

  when_to_run:
    - "For deafblind accessibility certification"
    - "When deploying to specialized disability services"
    - "For educational platforms"
    - "When braille user feedback is received"

prerequisites:
  required_artifacts:
    - type: "running_application"
      description: "Application available for braille testing"

  access_requirements:
    - "Refreshable braille display (or braille display simulator)"
    - "Screen reader configured for braille output"
    - "Access to all application features"

discovery:
  code_patterns:
    - pattern: "role=['\"]math['\"]|<math"
      type: "regex"
      scope: "source"
      purpose: "Find mathematical content needing special handling"

    - pattern: "<table|role=['\"]grid['\"]"
      type: "regex"
      scope: "source"
      purpose: "Find data tables needing structured navigation"

    - pattern: "&#[0-9]+;|&#x[0-9a-fA-F]+;"
      type: "regex"
      scope: "source"
      purpose: "Find special character entities"

  file_patterns:
    - glob: "**/*.{js,jsx,ts,tsx}"
      purpose: "JavaScript components"
    - glob: "**/*.html"
      purpose: "HTML content"
    - glob: "**/content/**"
      purpose: "Content files"

knowledge_sources:
  specifications:
    - id: "wcag-4.1"
      name: "WCAG 2.2 Guideline 4.1: Compatible"
      url: "https://www.w3.org/WAI/WCAG22/Understanding/compatible.html"
      offline_cache: true
      priority: "required"

    - id: "ueb"
      name: "Unified English Braille"
      url: "http://www.iceb.org/ueb.html"
      offline_cache: true
      priority: "recommended"

  guides:
    - id: "nvda-braille"
      name: "NVDA Braille Support"
      url: "https://www.nvaccess.org/files/nvda/documentation/userGuide.html#BrailleDisplaySupport"
      offline_cache: true

    - id: "jaws-braille"
      name: "JAWS Braille Configuration"
      url: "https://www.freedomscientific.com/products/software/jaws/"
      offline_cache: false

    - id: "deafblind-a11y"
      name: "Deafblind Accessibility Guidelines"
      url: "https://www.rnib.org.uk/professionals/accessible-communication"
      offline_cache: true

tooling:
  assessment_tools:
    - tool: "NVDA with braille display"
      purpose: "Primary braille testing"

    - tool: "JAWS with braille display"
      purpose: "Alternative braille testing"

    - tool: "NVDA Braille Viewer"
      purpose: "Simulate braille output on screen"

    - tool: "BrailleBlaster"
      purpose: "Braille transcription verification"

signals:
  critical:
    - id: "A11Y-BRAILLE-CRIT-001"
      signal: "Critical content not rendered in braille"
      evidence_indicators:
        - "Images without alt text invisible to braille users"
        - "Icon fonts render as blank or symbols"
        - "CSS-generated content not in accessibility tree"
      explanation: |
        Essential content is not available via braille display, making
        the application unusable for deafblind users who cannot rely on
        audio alternatives.
      remediation: |
        Ensure all content is in the accessibility tree:
        - Provide alt text for all meaningful images
        - Use real text instead of icon fonts where possible
        - Include aria-label for icon-only buttons
        - Ensure CSS content is accessible or has fallback

    - id: "A11Y-BRAILLE-CRIT-002"
      signal: "Navigation impossible with braille display buttons"
      evidence_indicators:
        - "Routing buttons don't activate links"
        - "Panning doesn't move through content logically"
        - "Keyboard commands not available via braille keys"
      explanation: |
        Braille displays have navigation keys that send keyboard commands.
        If the application doesn't respond to keyboard navigation, braille
        users cannot navigate.
      remediation: |
        Ensure complete keyboard accessibility:
        - All interactive elements keyboard-focusable
        - Logical focus order
        - Standard keyboard commands work
        - No mouse-only interactions

  high:
    - id: "A11Y-BRAILLE-HIGH-001"
      signal: "Tables not navigable cell-by-cell"
      evidence_indicators:
        - "Table headers not announced with data cells"
        - "Cannot move between cells using braille commands"
        - "Table structure not conveyed"
      explanation: |
        Data tables must be navigable cell-by-cell with headers announced
        for braille users to understand tabular data.
      remediation: |
        Use proper table markup:
        - <table> with proper <th> headers
        - scope attributes or headers/id for complex tables
        - caption for table description
        - Don't use tables for layout

    - id: "A11Y-BRAILLE-HIGH-002"
      signal: "Mathematical content not accessible"
      evidence_indicators:
        - "Math rendered as images without description"
        - "MathML not properly supported"
        - "Equations read as nonsense"
      explanation: |
        Mathematical notation is critical in educational and scientific
        contexts. Braille has specific math notation (Nemeth code) that
        requires proper markup.
      remediation: |
        Use MathML for mathematical content:
        - Provides semantic structure for equations
        - Screen readers can read math naturally
        - Nemeth braille translation available
        - Fallback alt text for image math

  medium:
    - id: "A11Y-BRAILLE-MED-001"
      signal: "Special characters render unexpectedly"
      evidence_indicators:
        - "Unicode symbols not converted to braille"
        - "Emoji render as blank or cryptic codes"
        - "Currency/scientific symbols unclear"
      explanation: |
        Special characters may not have direct braille equivalents or may
        render differently than expected, causing confusion.
      remediation: |
        Consider braille users when using special characters:
        - Use ASCII alternatives when possible
        - Provide text descriptions for emoji in critical contexts
        - Test symbol rendering with braille output

    - id: "A11Y-BRAILLE-MED-002"
      signal: "Content too verbose for efficient braille reading"
      evidence_indicators:
        - "Excessive announcement text"
        - "Redundant information repeated"
        - "Long aria-labels when shorter would suffice"
      explanation: |
        Braille displays show limited characters at once. Verbose content
        requires extensive panning and is inefficient to read.
      remediation: |
        Optimize content for efficient reading:
        - Use concise accessible names
        - Avoid redundant announcements
        - Structure content with headings for navigation

  low:
    - id: "A11Y-BRAILLE-LOW-001"
      signal: "Minor braille display optimization possible"
      evidence_indicators:
        - "Content could be more concise"
        - "Navigation could be more efficient"
      explanation: |
        Content works with braille displays but could be optimized for
        better user experience.
      remediation: |
        Gather feedback from braille users and optimize accordingly.

  positive:
    - id: "A11Y-BRAILLE-POS-001"
      signal: "Excellent braille display compatibility"
      evidence_indicators:
        - "All content accessible via braille"
        - "Navigation efficient with braille keys"
        - "Special content (tables, math) properly structured"

    - id: "A11Y-BRAILLE-POS-002"
      signal: "Concise, well-structured content"
      evidence_indicators:
        - "Efficient reading experience"
        - "Good use of headings for navigation"
        - "Clear, non-redundant accessible names"

procedure:
  context:
    cognitive_mode: "evaluative"
    ensemble_role: "tester"

  steps:
    - id: "1"
      name: "Configure braille testing environment"
      description: |
        Set up screen reader with braille display or braille viewer
        for testing.
      duration_estimate: "15 min"

      questions:
        - "Is braille output working with screen reader?"
        - "Is braille viewer available for visual verification?"
        - "Are routing buttons and pan keys functional?"

      expected_findings:
        - "Testing environment configured"

    - id: "2"
      name: "Test content rendering"
      description: |
        Verify all content renders correctly on braille display,
        including text, links, buttons, and images.
      duration_estimate: "45 min"

      questions:
        - "Does text content display correctly?"
        - "Are link and button labels clear?"
        - "Are image alt texts available?"
        - "Are icon-only elements labeled?"

      expected_findings:
        - "Content rendering assessment"
        - "Any invisible or unclear content"

    - id: "3"
      name: "Test navigation with braille commands"
      description: |
        Navigate application using only braille display buttons and
        commands.
      duration_estimate: "45 min"

      questions:
        - "Can you navigate by headings?"
        - "Do routing buttons click links correctly?"
        - "Does panning move through content logically?"
        - "Can forms be completed?"

      expected_findings:
        - "Navigation assessment"
        - "Any command issues"

    - id: "4"
      name: "Test special content (tables, math)"
      description: |
        If applicable, test data tables and mathematical content for
        braille accessibility.
      duration_estimate: "30 min"

      questions:
        - "Can tables be navigated cell-by-cell?"
        - "Are headers announced with data cells?"
        - "Is mathematical content readable?"
        - "Are special characters handled appropriately?"

      expected_findings:
        - "Special content assessment"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Content Rendering Assessment"
        - "Navigation Testing Results"
        - "Special Content Assessment"
        - "Recommendations"

  confidence_guidance:
    high: "Tested with physical braille display by experienced user"
    medium: "Tested with braille viewer simulation"
    low: "Inferred from screen reader testing without braille"

offline:
  capability: "partial"

  cache_manifest:
    knowledge:
      - source_id: "wcag-4.1"
        priority: "required"

profiles:
  membership:
    quick:
      included: false
      reason: "Specialized testing requiring braille equipment"
    full:
      included: true
      priority: 3
    production:
      included: true
      priority: 2

closeout_checklist:
  - id: "braille-001"
    item: "All content accessible via braille display"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Verify with NVDA braille viewer or actual display"
    expected: "Confirmed by reviewer"

  - id: "braille-002"
    item: "Navigation works with braille display buttons"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Test routing buttons and pan keys"
    expected: "Confirmed by reviewer"

  - id: "braille-003"
    item: "Tables navigable with headers"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "If tables present, verify cell-by-cell navigation"
    expected: "Confirmed by reviewer"

  - id: "braille-004"
    item: "Special characters handled appropriately"
    level: "WARNING"
    verification: "manual"
    verification_notes: "Test any special characters or symbols"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["web-application", "educational", "government", "healthcare"]

  compliance_frameworks:
    - framework: "WCAG 2.2"
      controls: ["4.1"]
    - framework: "Section 508"
      controls: ["1194.22"]
    - framework: "EN 301 549"
      controls: ["9.4"]

relationships:
  commonly_combined:
    - "accessibility-inclusion.robust-compatibility.screen-reader-testing"
    - "accessibility-inclusion.assistive-technology.screen-reader-flow"
    - "accessibility-inclusion.robust-compatibility.aria-usage"
