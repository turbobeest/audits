audit:
  id: configuration-management.configuration-status.config-reporting
  name: Configuration Reporting Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: configuration-management
  category_number: 30
  subcategory: configuration-status
  tier: phd
  estimated_duration: 2-3 hours  # median: 2h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: infrastructure
  default_profiles:
  - full
  - production
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines the reporting capabilities for configuration status
    across the organization. It evaluates:
    - Configuration inventory reports
    - Change activity reports
    - Compliance status reporting
    - Drift and variance reporting
    - Report automation and scheduling
    - Stakeholder report distribution
    - Report accuracy and timeliness
  why_it_matters: |
    Configuration reporting enables informed decision-making:
    - ITIL Configuration Status Accounting includes reporting requirements
    - Management needs visibility into configuration state
    - Compliance audits require configuration reports
    - Trend reporting enables proactive improvements
    - Stakeholders need accessible configuration information
    - Report automation reduces manual effort
    - Accurate reporting supports governance
  when_to_run:
  - When establishing configuration management
  - During management review preparations
  - When audit reporting is required
  - During process improvement initiatives
  - Quarterly reporting reviews
prerequisites:
  required_artifacts:
  - type: reporting_tools
    description: Configuration reporting tools and dashboards
  - type: documentation
    description: Reporting requirements and schedules
  access_requirements:
  - Access to configuration management tools
  - Access to reporting systems
  - Access to stakeholder requirements
discovery:
  code_patterns:
  - pattern: (report|dashboard|metrics)[-_](config|cm|status)
    type: regex
    scope: config
    purpose: Detect reporting configurations
  - pattern: (grafana|prometheus|datadog|cloudwatch)[-_]dashboard
    type: regex
    scope: config
    purpose: Detect dashboard configurations
  file_patterns:
  - glob: '**/dashboards/**'
    purpose: Dashboard definitions
  - glob: '**/reports/**'
    purpose: Report templates
  - glob: '**/*dashboard*.json'
    purpose: Dashboard JSON files
knowledge_sources:
  specifications:
  - id: itil-csa-reporting
    name: ITIL Configuration Status Accounting Reporting
    url: https://www.axelos.com/best-practice-solutions/itil
    offline_cache: true
    priority: required
  guides:
  - id: grafana-dashboards
    name: Grafana Dashboard Best Practices
    url: https://grafana.com/docs/grafana/latest/dashboards/
    offline_cache: true
tooling:
  infrastructure_tools:
  - tool: grafana
    purpose: Dashboard visualization
    command: grafana-cli plugins list
  scripts:
  - id: reporting-audit
    language: bash
    purpose: Audit configuration reporting capabilities
    source: inline
    code: |
      #!/bin/bash
      echo "=== Configuration Reporting Audit ==="
      echo ""
      echo "=== Dashboard Files ==="
      find . -name "*dashboard*" -not -path "*/node_modules/*" 2>/dev/null | head -20
      echo ""
      echo "=== Report Templates ==="
      find . -type f -path "*report*" -not -path "*/node_modules/*" 2>/dev/null | head -20
      echo ""
      echo "=== Metrics Configuration ==="
      grep -rn "metrics\|prometheus\|grafana" \
        --include="*.yaml" --include="*.json" . 2>/dev/null | head -20
signals:
  critical:
  - id: CRPT-CRIT-001
    signal: No configuration reporting capability
    evidence_indicators:
    - No reports on configuration status
    - No dashboards for configuration visibility
    - Manual data gathering for all reports
    explanation: |
      ITIL requires reporting on configuration status. Without
      reporting capability, management lacks visibility and
      compliance cannot be demonstrated efficiently.
    remediation: |
      - Implement configuration status dashboards
      - Create automated report generation
      - Define reporting requirements
      - Deploy reporting tooling
    cwe: CWE-1059
  high:
  - id: CRPT-HIGH-001
    signal: Compliance reporting manual and ad-hoc
    evidence_indicators:
    - Manual data gathering for compliance
    - Reports created only when requested
    - No automated compliance checks
    explanation: |
      Manual compliance reporting is slow and error-prone.
      Audit preparation becomes expensive and may miss
      issues that automated reporting would catch.
    remediation: |
      - Automate compliance report generation
      - Schedule regular compliance checks
      - Create compliance dashboards
      - Implement continuous compliance monitoring
  - id: CRPT-HIGH-002
    signal: Change activity reports not available
    evidence_indicators:
    - No summary of configuration changes
    - Change frequency unknown
    - No change trend analysis
    explanation: |
      Change activity reports enable understanding velocity
      and patterns. Without these reports, management cannot
      assess change management effectiveness.
    remediation: |
      - Create change activity reports
      - Track change frequency metrics
      - Enable trend analysis
      - Include change categorization
  - id: CRPT-HIGH-003
    signal: Drift reporting not implemented
    evidence_indicators:
    - No reports on configuration drift
    - Baseline variances not reported
    - Drift discovered only during incidents
    explanation: |
      Drift reporting enables proactive management. Without
      it, drift accumulates until it causes incidents,
      rather than being addressed proactively.
    remediation: |
      - Implement drift detection reporting
      - Include variance metrics in dashboards
      - Alert on drift thresholds
      - Report drift trends
  medium:
  - id: CRPT-MED-001
    signal: Reports not scheduled or automated
    evidence_indicators:
    - Manual report generation
    - No scheduled report delivery
    - Reports created on demand only
    explanation: |
      Scheduled reporting ensures regular visibility.
      On-demand only reporting may result in long gaps
      between reviews.
    remediation: |
      - Schedule regular report generation
      - Automate report delivery
      - Configure appropriate frequencies
      - Enable self-service reporting
  - id: CRPT-MED-002
    signal: Report distribution not defined
    evidence_indicators:
    - Unclear who receives reports
    - Reports not shared with stakeholders
    - No report subscription capability
    explanation: |
      Defined distribution ensures stakeholders receive
      needed information. Without distribution lists,
      reports may not reach decision-makers.
    remediation: |
      - Define report distribution lists
      - Enable report subscriptions
      - Deliver to appropriate stakeholders
      - Track report consumption
  - id: CRPT-MED-003
    signal: Report accuracy not validated
    evidence_indicators:
    - Reports contain stale data
    - Discrepancies between reports and reality
    - No report accuracy checks
    explanation: |
      Inaccurate reports lead to incorrect decisions.
      Regular validation ensures reports reflect actual
      configuration state.
    remediation: |
      - Implement report accuracy checks
      - Compare reports against source data
      - Timestamp report data clearly
      - Fix data quality issues
  low:
  - id: CRPT-LOW-001
    signal: Reports lack context and explanation
    evidence_indicators:
    - Raw data without interpretation
    - No explanatory notes
    - Recipients confused by reports
    explanation: |
      Context helps stakeholders understand report data.
      Raw data without explanation may be misinterpreted
      or ignored.
    remediation: |
      - Add context to reports
      - Include trend explanations
      - Highlight significant changes
      - Provide action recommendations
  positive:
  - id: CRPT-POS-001
    signal: Comprehensive automated reporting
    evidence_indicators:
    - Automated report generation
    - Scheduled distribution
    - Multiple report types available
  - id: CRPT-POS-002
    signal: Real-time configuration dashboards
    evidence_indicators:
    - Live configuration visibility
    - Drill-down capability
    - Alerting integration
procedure:
  context:
    cognitive_mode: methodical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Reporting Capability Assessment
    description: |
      Assess available configuration reporting tools and capabilities.
    duration_estimate: 30 min
    commands:
    - purpose: Find dashboard configurations
      command: |
        find . -name "*dashboard*" -not -path "*/node_modules/*" 2>/dev/null | head -30
    - purpose: Find report templates
      command: |
        find . -type f \( -path "*report*" -o -name "*report*" \) \
          -not -path "*/node_modules/*" 2>/dev/null | head -20
    - purpose: Check for metrics configuration
      command: |
        grep -rn "metrics\|prometheus\|grafana\|datadog" \
          --include="*.yaml" --include="*.json" . 2>/dev/null | head -30
    expected_findings:
    - Dashboard inventory
    - Report templates
    - Metrics setup
  - id: '2'
    name: Report Type Coverage
    description: |
      Evaluate coverage of required report types.
    duration_estimate: 30 min
    commands:
    - purpose: Check for inventory reports
      command: |
        grep -rl "inventory\|asset\|catalog" \
          --include="*.yaml" --include="*.json" --include="*.md" \
          . 2>/dev/null | head -20
    - purpose: Check for compliance reports
      command: |
        grep -rl "compliance\|audit\|policy" \
          --include="*.yaml" --include="*.json" --include="*.md" \
          . 2>/dev/null | head -20
    expected_findings:
    - Report type coverage
    - Compliance reporting
    - Gap identification
  - id: '3'
    name: Report Automation Assessment
    description: |
      Assess report automation and scheduling.
    duration_estimate: 30 min
    commands:
    - purpose: Find scheduled jobs for reports
      command: |
        grep -rn "schedule\|cron" --include="*.yaml" \
          . 2>/dev/null | grep -i "report" | head -20
    - purpose: Check for automated report delivery
      command: |
        grep -rn "email\|slack\|notification" --include="*.yaml" \
          . 2>/dev/null | grep -i "report" | head -20
    expected_findings:
    - Schedule configurations
    - Delivery mechanisms
    - Automation level
  - id: '4'
    name: Report Quality Review
    description: |
      Review report quality and stakeholder feedback.
    duration_estimate: 30 min
    commands:
    - purpose: Find report documentation
      command: |
        find . -name "*report*.md" -not -path "*/node_modules/*" 2>/dev/null | head -10
    - purpose: Check for report feedback mechanisms
      command: |
        grep -rl "feedback\|review\|stakeholder" \
          --include="*.md" . 2>/dev/null | head -10
    expected_findings:
    - Report documentation
    - Feedback processes
    - Quality measures
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Reporting Capability Assessment
    - Coverage Analysis
    - Recommendations
  - type: report_inventory
    format: table
    description: Available configuration reports and their purposes
  confidence_guidance:
    high: Reporting capabilities directly verified
    medium: Reporting tools found but effectiveness not verified
    low: Reporting status requires manual verification
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: itil-csa-reporting
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Reporting audit requires comprehensive review
    full:
      included: true
      priority: 2
    production:
      included: true
      priority: 2
closeout_checklist:
- id: crpt-001
  item: Configuration reporting capability exists
  level: CRITICAL
  verification: |
    find . -name "*dashboard*" -not -path "*/node_modules/*" 2>/dev/null | \
      wc -l | xargs -I{} test {} -gt 0 && echo "PASS" || echo "FAIL"
  expected: PASS
- id: crpt-002
  item: Reports are automated
  level: BLOCKING
  verification: manual
  verification_notes: Verify report generation is scheduled
  expected: Confirmed by reviewer
- id: crpt-003
  item: Compliance reporting available
  level: WARNING
  verification: manual
  verification_notes: Verify compliance reports can be generated
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: ITIL
    controls:
    - Configuration Status Accounting
  - framework: CMMI
    controls:
    - CM SP 3.2
  - framework: ISO 27001
    controls:
    - A.5.36
relationships:
  commonly_combined:
  - configuration-management.configuration-status.change-tracking
  - configuration-management.configuration-verification.compliance-checking
