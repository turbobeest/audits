audit:
  id: configuration-management.configuration-status.change-tracking
  name: Configuration Change Tracking Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: configuration-management
  category_number: 30
  subcategory: configuration-status
  tier: phd
  estimated_duration: 2-3 hours  # median: 2h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: infrastructure
  default_profiles:
  - full
  - production
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines the tracking and recording of configuration changes
    across the system. It evaluates:
    - Change event capture completeness
    - Change attribution (who, what, when)
    - Before/after state recording
    - Change reason documentation
    - Change history retention
    - Change search and query capabilities
    - Integration with incident management
  why_it_matters: |
    Configuration change tracking is essential for operational visibility:
    - CMMI CM SP 3.1 requires recording status of configuration items
    - ITIL Configuration Status Accounting tracks CI states over time
    - Change correlation with incidents enables root cause analysis
    - Audit compliance requires complete change history
    - Change tracking enables trend analysis and improvement
    - Forensic investigation depends on accurate change records
    - Troubleshooting requires understanding recent changes
  when_to_run:
  - When establishing configuration management
  - After incident response gaps due to missing change data
  - During compliance audits
  - When implementing CMDB
  - Quarterly process reviews
prerequisites:
  required_artifacts:
  - type: version_control
    description: Git history and commit logs
  - type: change_records
    description: Change management system records
  - type: audit_logs
    description: Infrastructure change audit logs
  access_requirements:
  - Read access to configuration repositories
  - Access to change management system
  - Access to infrastructure audit logs
discovery:
  code_patterns:
  - pattern: (changelog|change[-_]log|audit[-_]log)
    type: regex
    scope: config
    purpose: Detect change logging configuration
  - pattern: (modified[-_]at|updated[-_]at|changed[-_]by)
    type: regex
    scope: config
    purpose: Detect change metadata fields
  - pattern: (audit[-_]trail|event[-_]log|activity[-_]log)
    type: regex
    scope: config
    purpose: Detect audit trail configuration
  file_patterns:
  - glob: '**/CHANGELOG*'
    purpose: Change logs
  - glob: '**/audit/**'
    purpose: Audit configurations
  - glob: '**/*history*'
    purpose: History tracking
knowledge_sources:
  specifications:
  - id: cmmi-cm-sp31
    name: CMMI CM SP 3.1 - Record Actions
    url: https://cmmiinstitute.com/cmmi
    offline_cache: true
    priority: required
  - id: itil-csa
    name: ITIL Configuration Status Accounting
    url: https://www.axelos.com/best-practice-solutions/itil
    offline_cache: true
    priority: required
  guides:
  - id: keep-a-changelog
    name: Keep a Changelog
    url: https://keepachangelog.com/
    offline_cache: true
tooling:
  static_analysis:
  - tool: git
    purpose: Version control history
    offline_capable: true
  infrastructure_tools:
  - tool: aws-config
    purpose: AWS resource change tracking
    command: aws configservice get-resource-config-history
  scripts:
  - id: change-tracking-audit
    language: bash
    purpose: Audit change tracking completeness
    source: inline
    code: |
      #!/bin/bash
      echo "=== Configuration Change Tracking Audit ==="
      echo ""
      echo "=== Git Commit History ==="
      git log --oneline -30 -- "*.yaml" "*.json" "*.tf" "*.env*" 2>/dev/null
      echo ""
      echo "=== CHANGELOG Files ==="
      find . -name "CHANGELOG*" -not -path "*/node_modules/*" 2>/dev/null
      echo ""
      echo "=== Changes by Author ==="
      git shortlog -sn -- "*.yaml" "*.json" "*.tf" 2>/dev/null | head -20
signals:
  critical:
  - id: CTRK-CRIT-001
    signal: Configuration changes not tracked
    evidence_indicators:
    - No version control for configurations
    - No change audit logs
    - Changes occur without records
    explanation: |
      CMMI requires recording actions that affect configuration items.
      Untracked changes cannot be correlated with incidents, audited,
      or understood for troubleshooting purposes.
    remediation: |
      - Store all configurations in version control
      - Enable audit logging for config changes
      - Implement change event capture
      - Retain change history per policy
    cwe: CWE-778
  - id: CTRK-CRIT-002
    signal: Change attribution missing
    evidence_indicators:
    - Changes without author information
    - No record of who made changes
    - Anonymous modifications possible
    explanation: |
      Change attribution is essential for accountability and
      investigation. Without knowing who made changes, accountability
      is impossible and incident investigation is impaired.
    remediation: |
      - Require authentication for changes
      - Record author for all changes
      - Prevent anonymous modifications
      - Include attribution in audit logs
  high:
  - id: CTRK-HIGH-001
    signal: Before/after state not recorded
    evidence_indicators:
    - Only current state available
    - No diff capability
    - Cannot see what changed
    explanation: |
      Before/after state enables understanding change impact.
      Without state recording, determining what actually changed
      requires external investigation or is impossible.
    remediation: |
      - Record state before and after changes
      - Enable diff viewing in tooling
      - Store configuration snapshots
      - Implement state versioning
  - id: CTRK-HIGH-002
    signal: Change reason not captured
    evidence_indicators:
    - No commit messages or descriptions
    - Changes without business context
    - No link to change requests
    explanation: |
      Change reasons provide context for understanding and
      auditing. Without reasons, the purpose of changes cannot
      be understood or validated.
    remediation: |
      - Require change descriptions
      - Link changes to tickets/requests
      - Document business justification
      - Enforce commit message standards
  - id: CTRK-HIGH-003
    signal: Infrastructure changes not tracked
    evidence_indicators:
    - Manual infrastructure changes unrecorded
    - No audit trail for cloud changes
    - Terraform state only updated after change
    explanation: |
      Infrastructure configuration changes are often made through
      consoles or CLIs without tracking. These out-of-band changes
      create gaps in change history.
    remediation: |
      - Enable cloud provider audit logging
      - Use infrastructure-as-code exclusively
      - Detect and alert on untracked changes
      - Reconcile console changes
  medium:
  - id: CTRK-MED-001
    signal: Change history insufficient retention
    evidence_indicators:
    - Old change records deleted
    - No retention policy for change history
    - History only available for recent period
    explanation: |
      Long-term change history supports compliance and investigation.
      Insufficient retention prevents analysis of historical patterns
      or investigation of delayed-discovery issues.
    remediation: |
      - Define change history retention policy
      - Retain history per compliance requirements
      - Archive rather than delete
      - Ensure retrieval capability
  - id: CTRK-MED-002
    signal: Change tracking fragmented across systems
    evidence_indicators:
    - Different systems track different changes
    - No unified change view
    - Cross-system correlation difficult
    explanation: |
      Fragmented tracking complicates analysis and auditing.
      Without unified view, understanding full change context
      requires manual correlation.
    remediation: |
      - Consolidate change tracking
      - Implement unified change feed
      - Enable cross-system correlation
      - Create change dashboard
  - id: CTRK-MED-003
    signal: Change search capability limited
    evidence_indicators:
    - Cannot query change history effectively
    - No filtering by time, author, or type
    - Manual log review required
    explanation: |
      Search capability enables efficient investigation. Limited
      search requires manual log review, slowing incident response
      and auditing.
    remediation: |
      - Implement change history search
      - Enable filtering and querying
      - Index change records
      - Provide change history API
  low:
  - id: CTRK-LOW-001
    signal: Change notifications not configured
    evidence_indicators:
    - No alerts on configuration changes
    - Changes discovered after the fact
    - No real-time change awareness
    explanation: |
      Change notifications enable timely awareness. Without
      notifications, changes may go unnoticed until they
      cause issues.
    remediation: |
      - Configure change notifications
      - Alert relevant stakeholders
      - Integrate with monitoring
      - Enable subscription to change types
  positive:
  - id: CTRK-POS-001
    signal: Comprehensive change tracking implemented
    evidence_indicators:
    - All changes tracked with attribution
    - Before/after state recorded
    - Change reasons documented
  - id: CTRK-POS-002
    signal: Unified change view available
    evidence_indicators:
    - Single pane for all changes
    - Cross-system correlation
    - Searchable change history
procedure:
  context:
    cognitive_mode: methodical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Version Control Tracking Assessment
    description: |
      Assess change tracking through version control systems.
    duration_estimate: 30 min
    commands:
    - purpose: Verify git history for configs
      command: |
        git log --oneline -50 -- "*.yaml" "*.json" "*.tf" "*.env*" 2>/dev/null
    - purpose: Check commit message quality
      command: |
        git log --format="%s" -30 2>/dev/null | head -30
    - purpose: Verify author attribution
      command: |
        git log --format="%an <%ae>" -30 2>/dev/null | sort | uniq -c | sort -rn
    expected_findings:
    - Change history completeness
    - Commit message quality
    - Attribution coverage
  - id: '2'
    name: Changelog and Documentation Review
    description: |
      Review changelogs and change documentation practices.
    duration_estimate: 30 min
    commands:
    - purpose: Find CHANGELOG files
      command: |
        find . -name "CHANGELOG*" -not -path "*/node_modules/*" 2>/dev/null
    - purpose: Review CHANGELOG content
      command: |
        cat CHANGELOG.md CHANGELOG 2>/dev/null | head -100
    - purpose: Find change request references
      command: |
        git log --oneline -50 2>/dev/null | grep -E "(#[0-9]+|JIRA-|TICKET-)"
    expected_findings:
    - Changelog presence
    - Change documentation quality
    - Ticket linkage
  - id: '3'
    name: Infrastructure Change Tracking
    description: |
      Assess tracking of infrastructure configuration changes.
    duration_estimate: 30 min
    commands:
    - purpose: Check for audit logging configuration
      command: |
        grep -rn "cloudtrail\|audit_log\|logging" \
          --include="*.tf" --include="*.yaml" . 2>/dev/null | head -20
    - purpose: Find Terraform state files
      command: |
        find . -name "*.tfstate*" -not -path "*/.terraform/*" 2>/dev/null | head -10
    - purpose: Check for drift detection
      command: |
        grep -rn "drift\|detect\|reconcile" \
          --include="*.yaml" --include="*.tf" . 2>/dev/null | head -20
    expected_findings:
    - Audit logging setup
    - State tracking
    - Drift detection
  - id: '4'
    name: Change History Retention
    description: |
      Evaluate change history retention and searchability.
    duration_estimate: 30 min
    commands:
    - purpose: Check oldest available history
      command: |
        git log --reverse --oneline 2>/dev/null | head -5
    - purpose: Count total change history
      command: |
        git rev-list --count HEAD 2>/dev/null
    - purpose: Find retention policy documentation
      command: |
        grep -rl "retention\|archive\|history" --include="*.md" . 2>/dev/null | head -10
    expected_findings:
    - History depth
    - Retention practices
    - Searchability
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Tracking Coverage Assessment
    - Attribution and Context
    - Recommendations
  - type: tracking_coverage
    format: table
    description: Change tracking coverage by configuration type
  confidence_guidance:
    high: Change tracking directly verified
    medium: Tracking mechanisms found but completeness not verified
    low: Tracking status requires manual verification
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: cmmi-cm-sp31
      priority: required
    - source_id: itil-csa
      priority: required
profiles:
  membership:
    quick:
      included: true
      priority: 2
    full:
      included: true
      priority: 1
    production:
      included: true
      priority: 1
closeout_checklist:
- id: ctrk-001
  item: All configuration changes tracked
  level: CRITICAL
  verification: |
    git log --oneline -1 -- "*.yaml" "*.json" "*.tf" 2>/dev/null && \
      echo "PASS" || echo "FAIL"
  expected: PASS
- id: ctrk-002
  item: Change attribution present
  level: CRITICAL
  verification: |
    git log --format="%an" -10 2>/dev/null | grep -v "^$" | wc -l | \
      xargs -I{} test {} -eq 10 && echo "PASS" || echo "FAIL"
  expected: PASS
- id: ctrk-003
  item: Change history retained per policy
  level: WARNING
  verification: manual
  verification_notes: Verify retention meets compliance requirements
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: CMMI
    controls:
    - CM SP 3.1
  - framework: ITIL
    controls:
    - Configuration Status Accounting
  - framework: SOC 2
    controls:
    - CC8.1
  - framework: ISO 27001
    controls:
    - A.8.32
relationships:
  commonly_combined:
  - configuration-management.configuration-control.change-control
  - configuration-management.configuration-status.config-reporting
