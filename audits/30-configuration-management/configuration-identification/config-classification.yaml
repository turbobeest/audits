audit:
  id: configuration-management.configuration-identification.config-classification
  name: Configuration Classification Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: configuration-management
  category_number: 30
  subcategory: configuration-identification
  tier: phd
  estimated_duration: 2-3 hours  # median: 2h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: codebase
  default_profiles:
  - full
  - security
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines the classification of configuration items according
    to their type, sensitivity, and criticality. It evaluates:
    - Configuration type taxonomy (application, infrastructure, security)
    - Sensitivity classification (public, internal, confidential, secret)
    - Criticality levels for change impact assessment
    - Handling requirements based on classification
    - Classification metadata and tagging
    - Classification-based access controls
    - Classification review and updates
  why_it_matters: |
    Configuration classification enables appropriate handling and controls:
    - CMMI requires identifying and classifying configuration items
    - Security configurations require stricter change controls than
      non-sensitive settings
    - Classification drives approval workflows and access permissions
    - Sensitive configurations (secrets, credentials) need special handling
    - Criticality classification enables proper change impact assessment
    - Compliance frameworks require demonstrating configuration controls
      proportional to sensitivity
    - Classification supports least-privilege access to configurations
  when_to_run:
  - Initial configuration management implementation
  - During security assessments
  - When implementing new configuration types
  - After organizational structure changes
  - During compliance audits
prerequisites:
  required_artifacts:
  - type: configuration_files
    description: All configuration files and infrastructure code
  - type: documentation
    description: Configuration management policies
  access_requirements:
  - Read access to all configuration repositories
  - Access to security policies and classification standards
discovery:
  code_patterns:
  - pattern: (secret|credential|password|key|token|apikey|private)
    type: regex
    scope: config
    purpose: Detect sensitive configuration indicators
  - pattern: (public|internal|confidential|restricted|secret)
    type: regex
    scope: config
    purpose: Detect classification labels
  - pattern: (database|db|cache|redis|mongo|postgres|mysql)
    type: regex
    scope: config
    purpose: Detect data store configurations
  - pattern: (auth|oauth|jwt|saml|ldap|sso)
    type: regex
    scope: config
    purpose: Detect authentication configurations
  - pattern: (network|firewall|vpc|security[-_]group|acl)
    type: regex
    scope: config
    purpose: Detect network security configurations
  - pattern: (critical|essential|required|mandatory)
    type: regex
    scope: config
    purpose: Detect criticality labels
  file_patterns:
  - glob: '**/*secret*'
    purpose: Secret configuration files
  - glob: '**/*credential*'
    purpose: Credential files
  - glob: '**/security/**'
    purpose: Security configuration directories
  - glob: '**/*.enc'
    purpose: Encrypted configuration files
  - glob: '**/vault/**'
    purpose: Vault configuration
knowledge_sources:
  specifications:
  - id: cmmi-cm
    name: CMMI Configuration Management
    url: https://cmmiinstitute.com/cmmi
    offline_cache: true
    priority: required
  - id: iso-27001-classification
    name: ISO 27001 Information Classification
    url: https://www.iso.org/standard/27001
    offline_cache: true
    priority: required
  - id: nist-800-53-cm
    name: NIST 800-53 Configuration Management Controls
    url: https://csrc.nist.gov/pubs/sp/800/53/r5/upd1/final
    offline_cache: true
    priority: recommended
  guides:
  - id: cis-benchmarks
    name: CIS Configuration Benchmarks
    url: https://www.cisecurity.org/cis-benchmarks
    offline_cache: true
tooling:
  static_analysis:
  - tool: detect-secrets
    purpose: Identify sensitive configurations
    offline_capable: true
  - tool: semgrep
    purpose: Scan for configuration patterns
    offline_capable: true
  scripts:
  - id: config-classification-scan
    language: bash
    purpose: Scan and classify configurations
    source: inline
    code: |
      #!/bin/bash
      echo "=== Configuration Classification Scan ==="
      echo ""
      echo "=== Potentially Sensitive Configurations ==="
      grep -rnl "(secret|password|key|token|credential)" \
        --include="*.yaml" --include="*.json" --include="*.env*" \
        --include="*.properties" . 2>/dev/null | head -30
      echo ""
      echo "=== Security-Related Configurations ==="
      find . -type f \( -path "*security*" -o -path "*auth*" \) \
        -not -path "*/node_modules/*" 2>/dev/null | head -20
      echo ""
      echo "=== Infrastructure Configurations ==="
      find . -type f \( -name "*.tf" -o -path "*infra*" \) \
        -not -path "*/node_modules/*" 2>/dev/null | head -20
signals:
  critical:
  - id: CCLS-CRIT-001
    signal: Sensitive configurations not classified
    evidence_indicators:
    - Secrets and credentials without classification
    - No sensitivity labels on configuration items
    - Security configurations treated as regular config
    explanation: |
      Sensitive configurations require classification to enable
      appropriate access controls and handling. Unclassified
      sensitive configs may be exposed through inadequate protection.
    remediation: |
      - Classify all configurations containing secrets
      - Add sensitivity labels to configuration items
      - Implement classification-based access controls
      - Document handling requirements per classification
    cwe: CWE-732
  - id: CCLS-CRIT-002
    signal: No configuration classification taxonomy defined
    evidence_indicators:
    - No documented classification levels
    - Ad-hoc classification decisions
    - No standard for configuration sensitivity
    explanation: |
      Without a defined taxonomy, classification is inconsistent
      and unreliable. Teams make arbitrary decisions about
      configuration handling, creating security gaps.
    remediation: |
      - Define configuration classification taxonomy
      - Document classification criteria for each level
      - Train teams on classification standards
      - Implement classification in tooling
  high:
  - id: CCLS-HIGH-001
    signal: Classification not enforced in access controls
    evidence_indicators:
    - All configurations accessible with same permissions
    - No role-based config access by classification
    - Secret configs accessible without elevated privileges
    explanation: |
      Classification provides value only when enforced through
      access controls. Without enforcement, classification becomes
      documentation without security benefit.
    remediation: |
      - Implement RBAC based on configuration classification
      - Restrict access to sensitive configurations
      - Audit access to classified configurations
      - Integrate classification with identity management
  - id: CCLS-HIGH-002
    signal: Critical infrastructure configs not identified
    evidence_indicators:
    - No criticality assessment for configurations
    - All configurations treated with equal priority
    - No fast-track change process for critical configs
    explanation: |
      Criticality classification enables appropriate change
      management rigor. Without it, critical configurations may
      receive insufficient review or excessive bureaucracy.
    remediation: |
      - Assess criticality for all configuration items
      - Define change processes by criticality level
      - Document critical configuration dependencies
      - Implement criticality-based approval workflows
  - id: CCLS-HIGH-003
    signal: Configuration types not distinguished
    evidence_indicators:
    - Application and infrastructure configs mixed
    - No type taxonomy for configurations
    - Security configs not separated
    explanation: |
      Type classification enables appropriate ownership and
      expertise for configuration changes. Mixed types create
      confusion about responsibility and required expertise.
    remediation: |
      - Define configuration type taxonomy
      - Separate configurations by type
      - Assign type-specific ownership
      - Document type-specific handling
  medium:
  - id: CCLS-MED-001
    signal: Classification metadata missing from config items
    evidence_indicators:
    - No classification tags in configuration files
    - Classification tracked externally only
    - No machine-readable classification
    explanation: |
      Inline classification metadata enables automated handling
      and validation. External-only classification creates
      synchronization issues and reduces automation capability.
    remediation: |
      - Add classification metadata to configurations
      - Use standard classification tags
      - Implement automated classification validation
      - Sync inline and external classification
  - id: CCLS-MED-002
    signal: No classification review process
    evidence_indicators:
    - Classifications never reassessed
    - No periodic classification review
    - Stale classifications
    explanation: |
      Configuration sensitivity and criticality change over time.
      Without review, classifications become outdated, potentially
      under-protecting now-sensitive configurations.
    remediation: |
      - Establish classification review schedule
      - Review classifications after significant changes
      - Implement classification expiry alerts
      - Document classification change history
  - id: CCLS-MED-003
    signal: Third-party configuration classification missing
    evidence_indicators:
    - Vendor configuration not classified
    - SaaS settings not in classification scheme
    - External service configs untracked
    explanation: |
      Third-party configurations can be equally sensitive and
      critical. Excluding them from classification creates
      blind spots in configuration management.
    remediation: |
      - Include third-party configs in classification
      - Document vendor configuration sensitivity
      - Apply same handling requirements to external configs
      - Track classification for SaaS settings
  low:
  - id: CCLS-LOW-001
    signal: Classification granularity too coarse
    evidence_indicators:
    - Only two classification levels used
    - Most configs in single classification
    - No nuance in sensitivity levels
    explanation: |
      Insufficient granularity leads to over-classification or
      under-classification. More levels enable proportionate
      controls without excessive burden.
    remediation: |
      - Review classification level appropriateness
      - Add intermediate levels if needed
      - Redistribute configurations across levels
      - Document criteria for each level
  positive:
  - id: CCLS-POS-001
    signal: Comprehensive configuration classification
    evidence_indicators:
    - All configurations classified by type and sensitivity
    - Classification metadata in configuration files
    - Access controls based on classification
  - id: CCLS-POS-002
    signal: Classification-driven automation
    evidence_indicators:
    - Automated classification validation
    - Classification-based approval routing
    - Classification-aware tooling
procedure:
  context:
    cognitive_mode: methodical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Classification Taxonomy Assessment
    description: |
      Review existing classification taxonomy and documentation.
    duration_estimate: 30 min
    commands:
    - purpose: Find classification documentation
      command: |
        find . -type f \( -name "*classification*" -o -name "*sensitivity*" \
          -o -name "*data-handling*" \) -not -path "*/node_modules/*" 2>/dev/null | head -20
    - purpose: Check for classification labels in configs
      command: |
        grep -rn "(classification|sensitivity|criticality):" \
          --include="*.yaml" --include="*.json" . 2>/dev/null | head -30
    expected_findings:
    - Classification documentation
    - Classification label usage
    - Taxonomy definition
  - id: '2'
    name: Sensitive Configuration Identification
    description: |
      Identify configurations containing sensitive information.
    duration_estimate: 45 min
    commands:
    - purpose: Find potentially sensitive configurations
      command: |
        grep -rnl "(secret|password|key|token|credential|apikey)" \
          --include="*.yaml" --include="*.json" --include="*.env*" \
          --include="*.properties" . 2>/dev/null | head -50
    - purpose: Find encrypted configuration files
      command: |
        find . -type f \( -name "*.enc" -o -name "*.encrypted" \
          -o -name "*sealed*" \) 2>/dev/null | head -20
    expected_findings:
    - Sensitive configuration inventory
    - Encrypted configurations
    - Credentials and secrets locations
  - id: '3'
    name: Configuration Type Analysis
    description: |
      Analyze configuration types across the codebase.
    duration_estimate: 30 min
    commands:
    - purpose: Find infrastructure configurations
      command: |
        find . -type f \( -name "*.tf" -o -path "*infra*" -o -path "*k8s*" \) \
          -not -path "*/node_modules/*" 2>/dev/null | wc -l
    - purpose: Find application configurations
      command: |
        find . -type f \( -name "application*" -o -name "appsettings*" \
          -o -name "config.*" \) -not -path "*/node_modules/*" 2>/dev/null | head -30
    - purpose: Find security configurations
      command: |
        find . -type f -path "*security*" -o -name "*auth*" \
          -not -path "*/node_modules/*" 2>/dev/null | head -20
    expected_findings:
    - Configuration type distribution
    - Type-specific handling
    - Type ownership patterns
  - id: '4'
    name: Classification Enforcement Review
    description: |
      Evaluate enforcement of classification-based controls.
    duration_estimate: 30 min
    commands:
    - purpose: Check for classification-based access control
      command: |
        grep -rn "(classification|sensitivity).*access\|access.*(classification|sensitivity)" \
          --include="*.yaml" --include="*.tf" . 2>/dev/null | head -20
    - purpose: Find RBAC configuration for config access
      command: |
        grep -rn "role.*config\|config.*permission" \
          --include="*.yaml" --include="*.json" . 2>/dev/null | head -20
    expected_findings:
    - Access control by classification
    - Role-based config permissions
    - Enforcement mechanisms
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Classification Taxonomy Assessment
    - Sensitive Configuration Inventory
    - Enforcement Analysis
    - Recommendations
  - type: classification_matrix
    format: table
    description: Configuration items by type and sensitivity
  confidence_guidance:
    high: Classification directly observed in metadata
    medium: Classification inferred from content patterns
    low: Classification requires manual assessment
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: cmmi-cm
      priority: required
    - source_id: iso-27001-classification
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Classification audit requires thorough analysis
    full:
      included: true
      priority: 2
    security:
      included: true
      priority: 1
closeout_checklist:
- id: ccls-001
  item: Configuration classification taxonomy defined
  level: CRITICAL
  verification: manual
  verification_notes: Verify classification levels documented
  expected: Confirmed by reviewer
- id: ccls-002
  item: Sensitive configurations identified and classified
  level: CRITICAL
  verification: |
    grep -rnl "(secret|password|key|token)" --include="*.yaml" \
      --include="*.json" . 2>/dev/null | head -1 | xargs -I{} \
      grep -l "classification:" {} 2>/dev/null && echo "PASS" || echo "WARN"
  expected: PASS
- id: ccls-003
  item: Classification-based access controls implemented
  level: BLOCKING
  verification: manual
  verification_notes: Verify RBAC reflects classification levels
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: CMMI
    controls:
    - CM SP 1.1
    - CM SP 1.2
  - framework: ISO 27001
    controls:
    - A.5.12
    - A.5.13
    - A.8.9
  - framework: NIST 800-53
    controls:
    - CM-8
    - RA-2
  - framework: SOC 2
    controls:
    - CC6.1
    - CC6.7
relationships:
  commonly_combined:
  - configuration-management.secret-management.vault-integration
  - configuration-management.configuration-control.approval-workflow
  - security-trust.data-protection.data-classification
