audit:
  id: configuration-management.configuration-identification.config-baseline
  name: Configuration Baseline Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: configuration-management
  category_number: 30
  subcategory: configuration-identification
  tier: phd
  estimated_duration: 3-4 hours  # median: 3h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: infrastructure
  default_profiles:
  - full
  - production
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines the establishment and maintenance of configuration
    baselines representing known-good system states. It evaluates:
    - Baseline definition and documentation
    - Baseline versioning and history
    - Baseline approval processes
    - Environment-specific baselines
    - Baseline comparison capabilities
    - Restoration procedures from baseline
    - Baseline testing and validation
  why_it_matters: |
    Configuration baselines are essential for reliable system management:
    - CMMI CM SP 1.3 requires establishing and maintaining baselines of
      configuration items
    - ITIL defines baselines as the recorded state of a CI at a specific
      point in time for comparison and rollback
    - Without baselines, there is no reference point for drift detection
    - Incident recovery requires known-good configuration states
    - Compliance audits need documented baseline configurations
    - Change impact assessment requires baseline comparison
    - 12-factor app principles support immutable, versioned deployments
  when_to_run:
  - After major releases or deployments
  - During compliance audits
  - Before and after significant changes
  - Quarterly configuration reviews
  - When establishing new environments
prerequisites:
  required_artifacts:
  - type: configuration_files
    description: Current configuration files and infrastructure code
  - type: version_control
    description: Git history of configuration changes
  - type: documentation
    description: Release and deployment documentation
  access_requirements:
  - Read access to all configuration repositories
  - Access to configuration management tools
  - Access to deployment and release records
discovery:
  code_patterns:
  - pattern: (baseline|golden|reference|snapshot)[-_](config|configuration)
    type: regex
    scope: config
    purpose: Detect baseline configuration references
  - pattern: version:\s*['"]?[0-9]+\.[0-9]+
    type: regex
    scope: config
    purpose: Detect versioned configurations
  - pattern: terraform\.tfstate|state\.json
    type: regex
    scope: files
    purpose: Detect Terraform state files
  - pattern: (ami|image|snapshot)[-_]id
    type: regex
    scope: config
    purpose: Detect machine image references
  - pattern: 'digest:\s*sha256:'
    type: regex
    scope: config
    purpose: Detect immutable container references
  file_patterns:
  - glob: '**/baseline/**'
    purpose: Baseline directories
  - glob: '**/*.tfstate*'
    purpose: Terraform state files
  - glob: '**/golden/**'
    purpose: Golden configuration directories
  - glob: '**/CHANGELOG*'
    purpose: Change logs indicating versions
  - glob: '**/VERSION*'
    purpose: Version files
knowledge_sources:
  specifications:
  - id: cmmi-cm-sp13
    name: CMMI CM SP 1.3 - Establish Baselines
    url: https://cmmiinstitute.com/cmmi
    offline_cache: true
    priority: required
  - id: itil-baseline
    name: ITIL Configuration Baseline
    url: https://www.axelos.com/best-practice-solutions/itil
    offline_cache: true
    priority: required
  guides:
  - id: terraform-state
    name: Terraform State Management
    url: https://developer.hashicorp.com/terraform/language/state
    offline_cache: true
  - id: gitops-baseline
    name: GitOps Configuration Baselines
    url: https://www.gitops.tech/
    offline_cache: true
tooling:
  static_analysis:
  - tool: git
    purpose: Baseline versioning via tags
    offline_capable: true
  - tool: diff
    purpose: Compare configurations against baseline
    offline_capable: true
  infrastructure_tools:
  - tool: terraform
    purpose: Infrastructure state baselines
    command: terraform show
  - tool: kubectl
    purpose: Kubernetes configuration baseline
    command: kubectl get all -o yaml
  scripts:
  - id: baseline-audit
    language: bash
    purpose: Audit configuration baseline status
    source: inline
    code: |
      #!/bin/bash
      echo "=== Configuration Baseline Audit ==="
      echo ""
      echo "=== Git Tags (Release Baselines) ==="
      git tag -l --sort=-creatordate | head -20
      echo ""
      echo "=== Terraform State Files ==="
      find . -name "*.tfstate*" -type f 2>/dev/null | head -10
      echo ""
      echo "=== Version Files ==="
      find . -name "VERSION*" -o -name "version.*" -type f 2>/dev/null | head -10
      echo ""
      echo "=== Baseline Directories ==="
      find . -type d \( -name "baseline*" -o -name "golden*" \) 2>/dev/null | head -10
signals:
  critical:
  - id: CBAS-CRIT-001
    signal: No configuration baselines established
    evidence_indicators:
    - No baseline documentation or snapshots
    - No tagged releases for configuration
    - No golden configuration references
    explanation: |
      CMMI CM SP 1.3 requires establishing baselines for configuration
      items. Without baselines, there is no authoritative reference
      for system state, making drift detection and recovery impossible.
    remediation: |
      - Define baseline strategy for all environments
      - Create initial baselines for current configurations
      - Implement baseline tagging in version control
      - Document baseline approval process
    cwe: CWE-1059
  - id: CBAS-CRIT-002
    signal: Production environment lacks approved baseline
    evidence_indicators:
    - No documented production configuration baseline
    - Production state not versioned
    - No approval record for production config
    explanation: |
      Production environments require approved baselines for change
      control and recovery purposes. Without a production baseline,
      incident recovery lacks a known-good reference state.
    remediation: |
      - Create approved baseline for production environment
      - Document baseline approval with stakeholders
      - Store baseline in immutable form
      - Test restoration from baseline
  high:
  - id: CBAS-HIGH-001
    signal: Baselines not versioned or immutable
    evidence_indicators:
    - Baselines can be modified without audit trail
    - No version history for baselines
    - Baselines not stored in version control
    explanation: |
      Baselines must be immutable and versioned to serve their purpose.
      Mutable baselines can be silently changed, invalidating their
      use as authoritative reference points.
    remediation: |
      - Store baselines in version control with tags
      - Implement write protection for baseline storage
      - Maintain complete baseline version history
      - Use cryptographic hashes for baseline integrity
  - id: CBAS-HIGH-002
    signal: No baseline comparison capability
    evidence_indicators:
    - Cannot diff current state against baseline
    - No automated baseline drift detection
    - Manual comparison only
    explanation: |
      Baselines provide value when compared against current state.
      Without comparison capability, drift goes undetected and
      baselines become documentation artifacts only.
    remediation: |
      - Implement automated baseline comparison
      - Create baseline diff tooling
      - Schedule regular baseline drift checks
      - Alert on baseline deviations
  - id: CBAS-HIGH-003
    signal: Baseline restoration not tested
    evidence_indicators:
    - No restore procedures documented
    - Restoration never exercised
    - No validation of baseline completeness
    explanation: |
      Baselines must be restorable to provide incident recovery value.
      Untested baselines may be incomplete or have dependencies that
      prevent successful restoration when needed.
    remediation: |
      - Document baseline restoration procedures
      - Test baseline restoration in non-production
      - Validate baseline completeness
      - Schedule regular restoration exercises
  medium:
  - id: CBAS-MED-001
    signal: Baselines not aligned with release milestones
    evidence_indicators:
    - Releases without corresponding baselines
    - Baselines not tagged with release versions
    - Gap between release and baseline timing
    explanation: |
      Baselines should correspond to release milestones for clear
      correlation between deployments and configuration states.
      Misaligned baselines complicate rollback decisions.
    remediation: |
      - Create baselines at each release
      - Tag baselines with release versions
      - Automate baseline creation in release pipeline
      - Document baseline-release correspondence
  - id: CBAS-MED-002
    signal: Environment baselines not maintained separately
    evidence_indicators:
    - Single baseline for all environments
    - No environment-specific baseline tracking
    - Dev/staging/prod share baseline
    explanation: |
      Each environment may have legitimate configuration differences.
      Environment-specific baselines enable proper drift detection
      and targeted restoration per environment.
    remediation: |
      - Create separate baselines per environment
      - Document expected differences between environments
      - Implement environment-specific drift detection
      - Track environment baseline history independently
  - id: CBAS-MED-003
    signal: Baseline approval process informal or missing
    evidence_indicators:
    - No documented baseline approval
    - Baselines created without review
    - No stakeholder sign-off on baselines
    explanation: |
      CMMI requires formal approval for baselines. Informal approval
      creates accountability gaps and may result in baselines that
      don't represent agreed-upon configurations.
    remediation: |
      - Define baseline approval workflow
      - Require stakeholder sign-off
      - Document approval records
      - Implement approval gates in tooling
  low:
  - id: CBAS-LOW-001
    signal: Baseline documentation lacks context
    evidence_indicators:
    - Baselines without descriptions
    - No rationale for baseline configurations
    - Missing baseline creation date/author
    explanation: |
      Context helps understand baseline purpose and validity.
      Undocumented baselines require investigation to understand
      their relevance and appropriate use cases.
    remediation: |
      - Add descriptions to all baselines
      - Document baseline creation context
      - Include creation date and author
      - Note intended use and validity period
  positive:
  - id: CBAS-POS-001
    signal: Comprehensive baseline management implemented
    evidence_indicators:
    - Baselines for all environments
    - Version-controlled and immutable
    - Automated comparison and alerting
  - id: CBAS-POS-002
    signal: Baseline restoration tested and documented
    evidence_indicators:
    - Restoration procedures documented
    - Regular restoration exercises
    - Validated baseline completeness
procedure:
  context:
    cognitive_mode: methodical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Baseline Inventory Assessment
    description: |
      Identify all existing configuration baselines and their coverage.
    duration_estimate: 45 min
    commands:
    - purpose: Find baseline-related files
      command: |
        find . -type f \( -name "*baseline*" -o -name "*golden*" \
          -o -name "*snapshot*" \) -not -path "*/.git/*" 2>/dev/null | head -30
    - purpose: List git tags as release baselines
      command: |
        git tag -l --sort=-creatordate 2>/dev/null | head -30
    - purpose: Find Terraform state files
      command: |
        find . -name "*.tfstate" -o -name "*.tfstate.backup" 2>/dev/null | head -20
    expected_findings:
    - Existing baseline inventory
    - Release tag history
    - Infrastructure state files
  - id: '2'
    name: Baseline Versioning Analysis
    description: |
      Evaluate baseline versioning and immutability practices.
    duration_estimate: 45 min
    commands:
    - purpose: Check version control for config files
      command: |
        git log --oneline --all -- "*.yaml" "*.json" "*.env*" "*.tf" 2>/dev/null | head -30
    - purpose: Find version indicators in configurations
      command: |
        grep -rn "version:" --include="*.yaml" --include="*.yml" . 2>/dev/null | head -30
    expected_findings:
    - Configuration version history
    - Versioning practices
    - Immutability evidence
  - id: '3'
    name: Baseline Comparison Capability
    description: |
      Assess ability to compare current state against baselines.
    duration_estimate: 30 min
    commands:
    - purpose: Check for diff tools or scripts
      command: |
        find . -type f \( -name "*diff*" -o -name "*compare*" \) \
          -not -path "*/node_modules/*" 2>/dev/null | head -20
    - purpose: Look for drift detection configuration
      command: |
        grep -rn "drift\|baseline\|compare" --include="*.yaml" \
          --include="*.json" --include="*.tf" . 2>/dev/null | head -30
    expected_findings:
    - Comparison tooling
    - Drift detection setup
    - Baseline diff capabilities
  - id: '4'
    name: Baseline Restoration Assessment
    description: |
      Evaluate baseline restoration procedures and testing.
    duration_estimate: 30 min
    commands:
    - purpose: Find restoration documentation
      command: |
        find . -type f \( -name "*restore*" -o -name "*rollback*" \
          -o -name "*recovery*" \) -not -path "*/node_modules/*" 2>/dev/null | head -20
    - purpose: Check for restoration scripts
      command: |
        grep -rn "restore\|rollback\|recovery" --include="*.sh" \
          --include="*.yaml" . 2>/dev/null | head -30
    expected_findings:
    - Restoration procedures
    - Rollback scripts
    - Recovery documentation
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Baseline Coverage Assessment
    - Versioning and Immutability
    - Comparison and Restoration
    - Recommendations
  - type: baseline_inventory
    format: table
    description: Complete inventory of configuration baselines
  confidence_guidance:
    high: Baseline artifacts directly identified and validated
    medium: Baseline indicators found but not fully validated
    low: Baseline status requires manual verification
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: cmmi-cm-sp13
      priority: required
    - source_id: itil-baseline
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Baseline audit requires comprehensive analysis
    full:
      included: true
      priority: 1
    production:
      included: true
      priority: 1
closeout_checklist:
- id: cbas-001
  item: Configuration baselines exist for all environments
  level: CRITICAL
  verification: manual
  verification_notes: Verify baselines documented for dev/staging/production
  expected: Confirmed by reviewer
- id: cbas-002
  item: Baselines are versioned and immutable
  level: CRITICAL
  verification: |
    git tag -l 2>/dev/null | wc -l | xargs -I{} test {} -gt 0 && \
      echo "PASS" || echo "FAIL"
  expected: PASS
- id: cbas-003
  item: Baseline comparison capability exists
  level: BLOCKING
  verification: manual
  verification_notes: Verify ability to diff current state against baseline
  expected: Confirmed by reviewer
- id: cbas-004
  item: Baseline restoration tested
  level: WARNING
  verification: manual
  verification_notes: Verify restoration procedures documented and tested
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: CMMI
    controls:
    - CM SP 1.3
    - CM SP 2.1
  - framework: ITIL
    controls:
    - Configuration Management
    - Release Management
  - framework: ISO 27001
    controls:
    - A.8.9
    - A.8.32
  - framework: SOC 2
    controls:
    - CC6.1
    - CC7.1
    - CC8.1
relationships:
  commonly_combined:
  - configuration-management.configuration-verification.drift-detection
  - configuration-management.release-configuration.rollback-config
  - configuration-management.configuration-control.change-control
