audit:
  id: configuration-management.configuration-control.config-review
  name: Configuration Review Process Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: configuration-management
  category_number: 30
  subcategory: configuration-control
  tier: phd
  estimated_duration: 2-3 hours  # median: 2h
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: codebase
  default_profiles:
  - full
  - production
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit examines the review processes applied to configuration changes
    before deployment. It evaluates:
    - Technical review requirements and coverage
    - Security review for sensitive configurations
    - Peer review practices and guidelines
    - Review checklists and criteria
    - Review tooling and automation
    - Review turnaround time
    - Review quality metrics
  why_it_matters: |
    Configuration review catches errors before they cause incidents:
    - 85% of production incidents are attributed to changes (Gartner)
    - Peer review is proven to detect errors that automated testing misses
    - Security review prevents misconfigurations that create vulnerabilities
    - CMMI requires formal review of configuration items
    - SOC 2 requires review of changes before production
    - Review quality directly impacts system reliability
    - Clear review criteria enable consistent quality
  when_to_run:
  - When establishing review processes
  - After review process failures
  - During compliance audits
  - When review turnaround is slow
  - Quarterly process reviews
prerequisites:
  required_artifacts:
  - type: pull_requests
    description: Pull request history with review data
  - type: documentation
    description: Review guidelines and checklists
  access_requirements:
  - Access to pull request history
  - Access to review guidelines
  - Read access to configuration repositories
discovery:
  code_patterns:
  - pattern: required[-_]reviewers|CODEOWNERS
    type: regex
    scope: config
    purpose: Detect review requirements
  - pattern: review[-_](checklist|guidelines|criteria)
    type: regex
    scope: docs
    purpose: Detect review documentation
  - pattern: PULL_REQUEST_TEMPLATE
    type: regex
    scope: files
    purpose: Detect PR templates
  file_patterns:
  - glob: '**/.github/CODEOWNERS'
    purpose: GitHub CODEOWNERS
  - glob: '**/.github/PULL_REQUEST_TEMPLATE*'
    purpose: PR templates
  - glob: '**/review*.md'
    purpose: Review guidelines
  - glob: '**/CONTRIBUTING*'
    purpose: Contribution guidelines
knowledge_sources:
  specifications:
  - id: cmmi-verification
    name: CMMI Verification Process Area
    url: https://cmmiinstitute.com/cmmi
    offline_cache: true
    priority: required
  - id: soc2-cc81
    name: SOC 2 CC8.1 - Changes to Infrastructure
    url: https://www.aicpa.org/soc
    offline_cache: true
    priority: required
  guides:
  - id: google-code-review
    name: Google Code Review Guidelines
    url: https://google.github.io/eng-practices/review/
    offline_cache: true
tooling:
  static_analysis:
  - tool: github-api
    purpose: Review metrics extraction
    offline_capable: false
  scripts:
  - id: review-process-audit
    language: bash
    purpose: Audit configuration review process
    source: inline
    code: |
      #!/bin/bash
      echo "=== Configuration Review Process Audit ==="
      echo ""
      echo "=== CODEOWNERS ==="
      cat CODEOWNERS .github/CODEOWNERS 2>/dev/null | head -30
      echo ""
      echo "=== PR Template ==="
      cat .github/PULL_REQUEST_TEMPLATE.md 2>/dev/null | head -30
      echo ""
      echo "=== Review Guidelines ==="
      find . -name "*review*" -name "*.md" -not -path "*/node_modules/*" \
        2>/dev/null | head -10
signals:
  critical:
  - id: CREV-CRIT-001
    signal: Configuration changes not reviewed
    evidence_indicators:
    - No required reviewers for config files
    - Self-merged configuration changes
    - Review requirements not enforced
    explanation: |
      Unreviewed configuration changes bypass quality gates.
      Review catches errors, validates appropriateness, and
      ensures shared understanding of changes.
    remediation: |
      - Require review for all configuration changes
      - Configure CODEOWNERS for config files
      - Enforce review requirements in branch protection
      - Audit for review compliance
    cwe: CWE-284
  - id: CREV-CRIT-002
    signal: Security-sensitive configs lack security review
    evidence_indicators:
    - No security reviewer for auth configs
    - Security configs reviewed by non-security team
    - No security review checklist
    explanation: |
      Security-sensitive configurations require expert review.
      Non-expert review may miss security implications of
      configuration changes.
    remediation: |
      - Identify security-sensitive configuration types
      - Require security team review for sensitive configs
      - Create security review checklist
      - Train reviewers on security considerations
  high:
  - id: CREV-HIGH-001
    signal: No review criteria or checklist
    evidence_indicators:
    - Review criteria undefined
    - No configuration review checklist
    - Ad-hoc review approach
    explanation: |
      Clear criteria ensure consistent review quality.
      Without criteria, review depth varies by reviewer,
      potentially missing important considerations.
    remediation: |
      - Define configuration review criteria
      - Create review checklists by config type
      - Include security considerations
      - Train reviewers on criteria
  - id: CREV-HIGH-002
    signal: Reviews rubber-stamped without analysis
    evidence_indicators:
    - Very fast review turnaround for complex changes
    - Approvals without comments
    - Single-word approval comments
    explanation: |
      Rubber-stamped reviews provide false confidence.
      Without genuine analysis, review becomes compliance
      theater rather than quality control.
    remediation: |
      - Require substantive review comments
      - Monitor review quality metrics
      - Train on effective review practices
      - Set minimum review time expectations
  - id: CREV-HIGH-003
    signal: Insufficient reviewer expertise
    evidence_indicators:
    - Reviewers unfamiliar with config domain
    - No domain-specific reviewer requirements
    - Generic reviewer pool for all changes
    explanation: |
      Expert review is more effective than generic review.
      Reviewers without domain knowledge may miss critical
      issues specific to the configuration type.
    remediation: |
      - Map configuration types to expert reviewers
      - Use CODEOWNERS for domain-specific assignment
      - Train reviewers on specific config domains
      - Document expertise requirements
  medium:
  - id: CREV-MED-001
    signal: Review turnaround too slow
    evidence_indicators:
    - Long wait for review
    - Changes blocked on reviewer availability
    - No SLA for review completion
    explanation: |
      Slow review creates bottlenecks and pressure to bypass.
      Timely review enables flow while maintaining quality.
    remediation: |
      - Define review turnaround SLA
      - Ensure sufficient reviewer coverage
      - Monitor review queue depth
      - Enable reviewer delegation
  - id: CREV-MED-002
    signal: No PR template for configuration changes
    evidence_indicators:
    - Inconsistent PR descriptions
    - Missing context for reviewers
    - No standard information collected
    explanation: |
      PR templates ensure reviewers have necessary context.
      Without templates, important information may be omitted,
      reducing review effectiveness.
    remediation: |
      - Create PR template for configuration changes
      - Include checklist items
      - Require impact assessment
      - Request testing evidence
  - id: CREV-MED-003
    signal: Automated checks not integrated with review
    evidence_indicators:
    - Manual linting and validation
    - CI results not in PR
    - Reviewers duplicate automated checks
    explanation: |
      Automated checks complement manual review. Without
      integration, reviewers may focus on issues that
      automation could catch, missing higher-level concerns.
    remediation: |
      - Integrate CI checks with PRs
      - Run config validation automatically
      - Display results before review
      - Focus human review on judgment calls
  low:
  - id: CREV-LOW-001
    signal: Review feedback not tracked
    evidence_indicators:
    - No metrics on review findings
    - Common issues not identified
    - Review quality not measured
    explanation: |
      Tracking review findings identifies improvement areas.
      Without metrics, systemic issues in configurations
      may not be addressed at the source.
    remediation: |
      - Track review finding categories
      - Analyze common issues
      - Feed back to authoring guidelines
      - Measure review effectiveness
  positive:
  - id: CREV-POS-001
    signal: Comprehensive review process implemented
    evidence_indicators:
    - Required reviewers configured
    - Review checklist used
    - Automated checks integrated
  - id: CREV-POS-002
    signal: Domain-expert review for configurations
    evidence_indicators:
    - CODEOWNERS maps experts to config types
    - Security review for sensitive configs
    - Specialist review as needed
procedure:
  context:
    cognitive_mode: methodical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Review Requirement Assessment
    description: |
      Assess whether review is required and enforced for configurations.
    duration_estimate: 30 min
    commands:
    - purpose: Check CODEOWNERS coverage
      command: |
        cat CODEOWNERS .github/CODEOWNERS 2>/dev/null | \
          grep -E "\.(yaml|yml|json|tf|env)" | head -20
    - purpose: Check branch protection for review requirement
      command: |
        gh api repos/{owner}/{repo}/branches/main/protection 2>/dev/null | \
          jq '.required_pull_request_reviews' || echo "Cannot query"
    - purpose: Find config files not in CODEOWNERS
      command: |
        diff <(find . -name "*.yaml" -path "*config*" -not -path "*/node_modules/*" \
          2>/dev/null | sort) \
          <(cat CODEOWNERS .github/CODEOWNERS 2>/dev/null | \
          grep -oE "[^ ]+\.(yaml|yml)" | sort) 2>/dev/null | head -20
    expected_findings:
    - CODEOWNERS coverage
    - Branch protection status
    - Coverage gaps
  - id: '2'
    name: Review Guidelines Assessment
    description: |
      Assess review guidelines, checklists, and criteria.
    duration_estimate: 30 min
    commands:
    - purpose: Find review documentation
      command: |
        find . -type f \( -name "*review*" -o -name "*checklist*" \) \
          -name "*.md" -not -path "*/node_modules/*" 2>/dev/null | head -20
    - purpose: Check PR template
      command: |
        cat .github/PULL_REQUEST_TEMPLATE.md 2>/dev/null | head -50
    - purpose: Find contributing guidelines
      command: |
        cat CONTRIBUTING.md .github/CONTRIBUTING.md 2>/dev/null | head -50
    expected_findings:
    - Review guidelines
    - PR template content
    - Contributing guidance
  - id: '3'
    name: Review Practice Analysis
    description: |
      Analyze actual review practices through PR history.
    duration_estimate: 30 min
    commands:
    - purpose: List recent merged PRs with reviews
      command: |
        gh pr list --state merged --limit 20 \
          --json number,title,reviews,files 2>/dev/null | \
          jq '.[] | {number, title, reviewCount: (.reviews | length)}' || \
          echo "GitHub CLI not available"
    - purpose: Check for self-merged PRs
      command: |
        gh pr list --state merged --limit 50 \
          --json number,author,mergedBy 2>/dev/null | \
          jq '.[] | select(.author.login == .mergedBy.login)' || \
          echo "GitHub CLI not available"
    expected_findings:
    - Review frequency
    - Self-merge instances
    - Review patterns
  - id: '4'
    name: Automated Check Integration
    description: |
      Assess integration of automated checks with review process.
    duration_estimate: 30 min
    commands:
    - purpose: Find CI configuration
      command: |
        find . \( -name "*.yaml" -path ".github/workflows/*" \) -o \
          -name ".gitlab-ci.yml" 2>/dev/null | head -10
    - purpose: Check for config validation in CI
      command: |
        grep -rn "lint\|validate\|check" \
          --include="*.yaml" .github/workflows/ 2>/dev/null | head -20
    expected_findings:
    - CI configuration
    - Validation steps
    - Check integration
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Review Requirement Assessment
    - Practice Analysis
    - Recommendations
  - type: review_coverage
    format: table
    description: Review coverage by configuration type
  confidence_guidance:
    high: Review requirements and practices directly verified
    medium: Review configuration found but practices not fully verified
    low: Review status requires manual verification
offline:
  capability: partial
  cache_manifest:
    knowledge:
    - source_id: cmmi-verification
      priority: required
    - source_id: soc2-cc81
      priority: required
profiles:
  membership:
    quick:
      included: true
      priority: 3
    full:
      included: true
      priority: 2
    production:
      included: true
      priority: 1
closeout_checklist:
- id: crev-001
  item: Configuration review required and enforced
  level: CRITICAL
  verification: |
    test -f CODEOWNERS -o -f .github/CODEOWNERS && echo "PASS" || echo "FAIL"
  expected: PASS
- id: crev-002
  item: Review checklist exists
  level: BLOCKING
  verification: manual
  verification_notes: Verify review checklist or guidelines documented
  expected: Confirmed by reviewer
- id: crev-003
  item: No self-merged configuration changes
  level: WARNING
  verification: manual
  verification_notes: Verify recent PRs have independent reviewers
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: CMMI
    controls:
    - VER SP 1.1
    - VER SP 2.1
  - framework: SOC 2
    controls:
    - CC8.1
  - framework: ISO 27001
    controls:
    - A.8.32
relationships:
  commonly_combined:
  - configuration-management.configuration-control.change-control
  - configuration-management.configuration-control.approval-workflow
