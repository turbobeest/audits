# ============================================================
# AUDIT: Policy Enforcement Audit
# ============================================================
# Evaluates the effectiveness of policy enforcement mechanisms
# and compliance monitoring.
# ============================================================

audit:
  id: "compliance-legal.policy-governance.policy-enforcement"

  name: "Policy Enforcement Audit"

  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "compliance-legal"
  category_number: 19
  subcategory: "policy-governance"

  tier: "expert"
  estimated_duration: "5-7 hours"  # median: 6h

  completeness: "requires_discovery"
  requires_runtime: true
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "process"

  default_profiles:
    - "full"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Evaluates policy enforcement including:
    - Technical enforcement mechanisms
    - Administrative enforcement procedures
    - Violation detection capabilities
    - Consequence management
    - Enforcement consistency
    - Policy compliance monitoring
    - Awareness and acknowledgment tracking
    - Exception handling vs. violations

  why_it_matters: |
    Policies without enforcement are merely suggestions.
    Weak enforcement results in:
    - Policy violations with no consequences
    - Culture of non-compliance
    - Regulatory findings for ineffective policies
    - Inconsistent application creating legal exposure
    - Erosion of governance credibility
    - Competitive disadvantage to compliant competitors
    - Inability to hold employees accountable
    Effective enforcement makes policies meaningful.

  when_to_run:
    - "During compliance program assessments"
    - "After policy violation incidents"
    - "When implementing new policies"
    - "Before regulatory examinations"

prerequisites:
  required_artifacts:
    - type: "enforcement_procedures"
      description: "Policy enforcement and consequence procedures"
    - type: "violation_records"
      description: "History of policy violations"
    - type: "technical_controls"
      description: "Technical enforcement mechanisms"

  access_requirements:
    - "Enforcement procedure documentation"
    - "Violation tracking data"
    - "Technical control configurations"
    - "HR discipline records (anonymized)"

discovery:
  code_patterns:
    - pattern: "(policy|enforce|restrict|block|prevent)"
      type: "regex"
      scope: "source"
      purpose: "Find technical enforcement code"
    - pattern: "(violat|breach|incident|alert)"
      type: "regex"
      scope: "source"
      purpose: "Locate violation detection code"

  file_patterns:
    - glob: "**/policies/**"
      purpose: "Policy enforcement configurations"
    - glob: "**/security/**"
      purpose: "Security enforcement controls"

  documents_to_review:
    - type: "Enforcement procedures"
      purpose: "Understand enforcement mechanisms"
    - type: "Violation records"
      purpose: "Assess enforcement history"
    - type: "Consequence matrix"
      purpose: "Review consequence consistency"

  interviews:
    - role: "Compliance Team"
      questions:
        - "How are policy violations detected?"
        - "What are consequences for violations?"
        - "How consistent is enforcement?"
      purpose: "Understand enforcement process"
    - role: "HR"
      questions:
        - "How are policy violations handled?"
        - "Are consequences consistently applied?"
        - "What is the discipline process?"
      purpose: "Assess consequence management"

knowledge_sources:
  guides:
    - id: "policy-enforcement"
      name: "Policy Enforcement Best Practices"
      url: "https://www.shrm.org/"
      offline_cache: true
    - id: "consequence-management"
      name: "Consequence Management Framework"
      url: "https://www.compliance.com/"
      offline_cache: true

tooling:
  static_analysis:
    - tool: "Policy as Code validators"
      purpose: "Check technical policy enforcement"
      offline_capable: true

  assessment_tools:
    - tool: "Enforcement Effectiveness Checklist"
      purpose: "Evaluate enforcement mechanisms"
    - tool: "Violation Analysis Template"
      purpose: "Analyze violation patterns"

  scripts:
    - id: "find-enforcement"
      language: "bash"
      purpose: "Locate technical enforcement mechanisms"
      source: "inline"
      code: |
        #!/bin/bash
        echo "=== Policy Enforcement Code ==="
        grep -r -E "(policy|enforce|restrict|block)" \
          --include="*.py" --include="*.yaml" --include="*.json" . 2>/dev/null | head -30

signals:
  critical:
    - id: "PE-CRIT-001"
      signal: "No enforcement mechanisms for key policies"
      evidence_indicators:
        - "Policies exist but no enforcement"
        - "Technical controls not implemented"
        - "No monitoring for compliance"
      explanation: |
        Policies without enforcement provide no actual governance.
        This represents a fundamental compliance program failure.
      remediation: "Implement enforcement mechanisms for all key policies"

    - id: "PE-CRIT-002"
      signal: "Violations detected but not addressed"
      evidence_indicators:
        - "Known violations without consequence"
        - "Repeat violators not escalated"
        - "Violation backlog with no action"
      explanation: |
        Unaddressed violations signal that policies are optional.
        This undermines the entire compliance program.
      remediation: "Implement consequence management for all violations"

    - id: "PE-CRIT-003"
      signal: "Inconsistent enforcement across organization"
      evidence_indicators:
        - "Same violations, different consequences"
        - "Senior employees not held accountable"
        - "Favoritism in enforcement"
      explanation: |
        Inconsistent enforcement creates legal exposure and
        undermines credibility of compliance program.
      remediation: "Implement consistent enforcement framework"

  high:
    - id: "PE-HIGH-001"
      signal: "Technical controls can be bypassed"
      explanation: "Bypassable controls provide false assurance"
      remediation: "Strengthen technical controls to prevent bypass"

    - id: "PE-HIGH-002"
      signal: "Violation detection is manual and incomplete"
      explanation: "Manual detection misses many violations"
      remediation: "Implement automated violation detection"

    - id: "PE-HIGH-003"
      signal: "No escalation for serious violations"
      explanation: "Serious violations require appropriate escalation"
      remediation: "Implement escalation procedures"

  medium:
    - id: "PE-MED-001"
      signal: "Consequence matrix not documented"
      remediation: "Document consistent consequences for violations"

    - id: "PE-MED-002"
      signal: "Policy acknowledgment not tracked"
      remediation: "Implement acknowledgment tracking"

  low:
    - id: "PE-LOW-001"
      signal: "Enforcement reporting could be improved"

  positive:
    - id: "PE-POS-001"
      signal: "Comprehensive technical and administrative enforcement"
    - id: "PE-POS-002"
      signal: "Consistent, documented consequence management"

procedure:
  context:
    cognitive_mode: "critical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Enforcement Mechanism Inventory"
      description: |
        Identify all technical and administrative enforcement
        mechanisms for key policies.
      duration_estimate: "60 min"

      commands:
        - purpose: "Find technical enforcement"
          command: "grep -r -E '(policy|enforce|restrict)' --include='*.yaml' --include='*.json' . | head -20"

      questions:
        - "What enforcement mechanisms exist?"
        - "Which policies have technical enforcement?"
        - "What administrative controls exist?"

      expected_findings:
        - "Enforcement inventory"
        - "Coverage assessment"
        - "Gap identification"

    - id: "2"
      name: "Detection Capability Assessment"
      description: |
        Evaluate capability to detect policy violations
        through technical and administrative means.
      duration_estimate: "60 min"

      questions:
        - "How are violations detected?"
        - "What monitoring exists?"
        - "Are there detection gaps?"

      expected_findings:
        - "Detection capability"
        - "Monitoring coverage"
        - "Gap identification"

    - id: "3"
      name: "Violation History Analysis"
      description: |
        Review violation history to assess enforcement
        effectiveness and consistency.
      duration_estimate: "60 min"

      questions:
        - "What violations have occurred?"
        - "Were consequences applied?"
        - "Are there patterns or repeat violators?"

      expected_findings:
        - "Violation patterns"
        - "Consequence application"
        - "Consistency assessment"

    - id: "4"
      name: "Consequence Management Review"
      description: |
        Evaluate the consequence framework and its
        consistent application.
      duration_estimate: "45 min"

      questions:
        - "Is there a documented consequence matrix?"
        - "Are consequences consistently applied?"
        - "Is there appropriate escalation?"

      expected_findings:
        - "Framework adequacy"
        - "Consistency assessment"
        - "Escalation effectiveness"

    - id: "5"
      name: "Technical Control Validation"
      description: |
        Test technical enforcement controls for
        effectiveness and bypass resistance.
      duration_estimate: "45 min"

      expected_findings:
        - "Control effectiveness"
        - "Bypass resistance"
        - "Improvement needs"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "enforcement_assessment"
      format: "structured"
      sections:
        - "Enforcement Inventory"
        - "Detection Assessment"
        - "Violation Analysis"
        - "Consequence Review"
        - "Technical Validation"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Key Findings"
        - "Enforcement Effectiveness"
        - "Recommendations"

  confidence_guidance:
    high: "Complete enforcement review with violation analysis"
    medium: "Mechanism review with sample violation testing"
    low: "Documentation review only"

offline:
  capability: "partial"

profiles:
  membership:
    quick:
      included: false
      reason: "Requires thorough enforcement evaluation"
    full:
      included: true
      priority: 1

closeout_checklist:
  - id: "pe-001"
    item: "Enforcement mechanisms inventoried"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Confirm enforcement inventory complete"
    expected: "Confirmed by reviewer"

  - id: "pe-002"
    item: "Detection capabilities assessed"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Verify detection evaluation complete"
    expected: "Confirmed by reviewer"

  - id: "pe-003"
    item: "Violation history analyzed"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Confirm violation analysis complete"
    expected: "Confirmed by reviewer"

  - id: "pe-004"
    item: "Recommendations provided"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Verify improvement recommendations documented"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["regulated-entity", "enterprise", "financial-services"]

  compliance_frameworks:
    - framework: "Federal Sentencing Guidelines"
      controls: ["Effective Compliance Program"]
    - framework: "DOJ Guidance"
      controls: ["Evaluation of Corporate Compliance"]

relationships:
  commonly_combined:
    - "compliance-legal.policy-governance.policy-documentation"
    - "compliance-legal.risk-control.exception-management"
    - "compliance-legal.regulatory-reporting.compliance-training"
