# ============================================================
# AUDIT: Control Monitoring Audit
# ============================================================
# Evaluates ongoing control monitoring processes and
# continuous assurance capabilities.
# ============================================================

audit:
  id: "compliance-legal.risk-control.control-monitoring"

  name: "Control Monitoring Audit"

  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "compliance-legal"
  category_number: 19
  subcategory: "risk-control"

  tier: "expert"
  estimated_duration: "4-6 hours"  # median: 5h

  completeness: "requires_discovery"
  requires_runtime: true
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "process"

  default_profiles:
    - "full"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Evaluates control monitoring including:
    - Continuous monitoring capabilities
    - Key performance indicators for controls
    - Exception detection and alerting
    - Dashboard and reporting effectiveness
    - Monitoring coverage across control portfolio
    - Automated vs. manual monitoring
    - Threshold setting and calibration
    - Escalation processes

  why_it_matters: |
    Point-in-time control testing is insufficient for ongoing
    assurance. Inadequate monitoring results in:
    - Control failures going undetected
    - Delayed response to control degradation
    - Compliance exposure between assessments
    - Inability to demonstrate continuous compliance
    - Reactive rather than proactive control management
    - Audit findings for monitoring deficiencies
    - Increased risk from undetected control drift
    Continuous monitoring enables real-time assurance.

  when_to_run:
    - "During control framework reviews"
    - "When implementing monitoring solutions"
    - "During compliance program assessments"
    - "After control failures or incidents"

prerequisites:
  required_artifacts:
    - type: "monitoring_documentation"
      description: "Control monitoring procedures and KPIs"
    - type: "monitoring_dashboards"
      description: "Access to monitoring tools and dashboards"
    - type: "alert_configuration"
      description: "Alert thresholds and escalation procedures"

  access_requirements:
    - "Monitoring system access"
    - "Dashboard access"
    - "Alert configuration"
    - "Historical monitoring data"

discovery:
  code_patterns:
    - pattern: "(monitor|alert|threshold|metric)"
      type: "regex"
      scope: "source"
      purpose: "Find monitoring implementations"
    - pattern: "(dashboard|report|kpi|indicator)"
      type: "regex"
      scope: "source"
      purpose: "Locate reporting code"

  file_patterns:
    - glob: "**/monitoring/**"
      purpose: "Monitoring configuration"
    - glob: "**/alerts/**"
      purpose: "Alert configurations"

  documents_to_review:
    - type: "Monitoring procedures"
      purpose: "Understand monitoring approach"
    - type: "KPI definitions"
      purpose: "Assess metric relevance"
    - type: "Escalation procedures"
      purpose: "Review response processes"

  interviews:
    - role: "Monitoring Team"
      questions:
        - "What controls are monitored?"
        - "How are thresholds set?"
        - "How are alerts handled?"
      purpose: "Understand monitoring operations"
    - role: "Control Owners"
      questions:
        - "Are your controls monitored?"
        - "Do you receive monitoring reports?"
        - "How are issues escalated to you?"
      purpose: "Assess stakeholder awareness"

knowledge_sources:
  specifications:
    - id: "nist-csf-2"
      name: "NIST Cybersecurity Framework 2.0"
      url: "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.29.pdf"
      offline_cache: true
      priority: "recommended"

  guides:
    - id: "continuous-monitoring"
      name: "Continuous Control Monitoring Guide"
      url: "https://www.isaca.org/"
      offline_cache: true
    - id: "ccm"
      name: "AICPA Continuous Compliance Monitoring"
      url: "https://www.aicpa.org/"
      offline_cache: true

tooling:
  assessment_tools:
    - tool: "Monitoring Coverage Assessment"
      purpose: "Evaluate monitoring scope"
    - tool: "Alert Effectiveness Analysis"
      purpose: "Assess alert quality"

  scripts:
    - id: "find-monitoring"
      language: "bash"
      purpose: "Locate monitoring configurations"
      source: "inline"
      code: |
        #!/bin/bash
        echo "=== Monitoring Configurations ==="
        grep -r -E "(monitor|alert|threshold)" \
          --include="*.yaml" --include="*.json" --include="*.py" . 2>/dev/null | head -30

signals:
  critical:
    - id: "CM-CRIT-001"
      signal: "Key controls have no monitoring"
      evidence_indicators:
        - "Critical controls not monitored"
        - "No metrics or KPIs for key controls"
        - "Control status unknown between assessments"
      explanation: |
        Unmonitored key controls can fail without detection,
        creating significant risk exposure.
      remediation: "Implement monitoring for all key controls"

    - id: "CM-CRIT-002"
      signal: "Alerts not acted upon"
      evidence_indicators:
        - "Alert backlog with no response"
        - "Repeated alerts without investigation"
        - "No escalation for critical alerts"
      explanation: |
        Unaddressed alerts negate the value of monitoring
        and allow control failures to persist.
      remediation: "Implement alert triage and response procedures"

    - id: "CM-CRIT-003"
      signal: "Monitoring system not functioning"
      evidence_indicators:
        - "Monitoring tools offline"
        - "Data feeds broken"
        - "Dashboard showing stale data"
      explanation: |
        Non-functioning monitoring provides false assurance
        while controls may be failing.
      remediation: "Restore monitoring capability immediately"

  high:
    - id: "CM-HIGH-001"
      signal: "Thresholds not appropriately calibrated"
      explanation: "Poor thresholds cause alert fatigue or missed issues"
      remediation: "Review and calibrate monitoring thresholds"

    - id: "CM-HIGH-002"
      signal: "Manual monitoring not performed consistently"
      explanation: "Inconsistent manual monitoring leaves gaps"
      remediation: "Automate monitoring or enforce manual procedures"

    - id: "CM-HIGH-003"
      signal: "No monitoring for automated controls"
      explanation: "Automated controls can fail silently"
      remediation: "Implement health monitoring for automated controls"

  medium:
    - id: "CM-MED-001"
      signal: "Monitoring results not reported to stakeholders"
      remediation: "Implement regular monitoring reporting"

    - id: "CM-MED-002"
      signal: "Monitoring coverage incomplete"
      remediation: "Expand monitoring to cover all significant controls"

  low:
    - id: "CM-LOW-001"
      signal: "Monitoring documentation could be improved"

  positive:
    - id: "CM-POS-001"
      signal: "Comprehensive automated monitoring with effective alerting"
    - id: "CM-POS-002"
      signal: "Real-time dashboards with stakeholder access"

procedure:
  context:
    cognitive_mode: "critical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Monitoring Inventory"
      description: |
        Identify all control monitoring in place and assess
        coverage of the control portfolio.
      duration_estimate: "45 min"

      questions:
        - "What controls are monitored?"
        - "What monitoring tools are used?"
        - "What is the coverage percentage?"

      expected_findings:
        - "Monitoring inventory"
        - "Coverage assessment"
        - "Gap identification"

    - id: "2"
      name: "Monitoring Design Assessment"
      description: |
        Evaluate the design of monitoring including metrics,
        thresholds, and alerting logic.
      duration_estimate: "60 min"

      commands:
        - purpose: "Find monitoring configurations"
          command: "grep -r -E '(threshold|alert|monitor)' --include='*.yaml' --include='*.json' . | head -20"

      expected_findings:
        - "Design adequacy"
        - "Threshold appropriateness"
        - "Alert logic review"

    - id: "3"
      name: "Alert Effectiveness Review"
      description: |
        Assess alert effectiveness including response times,
        false positive rates, and resolution.
      duration_estimate: "60 min"

      questions:
        - "How are alerts prioritized?"
        - "What is the response time for alerts?"
        - "What is the false positive rate?"

      expected_findings:
        - "Alert effectiveness"
        - "Response timeliness"
        - "Quality metrics"

    - id: "4"
      name: "Dashboard and Reporting"
      description: |
        Evaluate monitoring dashboards and reports for
        usefulness and accessibility.
      duration_estimate: "30 min"

      expected_findings:
        - "Dashboard effectiveness"
        - "Reporting adequacy"
        - "Stakeholder access"

    - id: "5"
      name: "Escalation Process"
      description: |
        Review escalation procedures for monitoring
        exceptions and issues.
      duration_estimate: "30 min"

      expected_findings:
        - "Escalation clarity"
        - "Process effectiveness"
        - "Documentation adequacy"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "monitoring_assessment"
      format: "structured"
      sections:
        - "Monitoring Inventory"
        - "Design Assessment"
        - "Alert Effectiveness"
        - "Dashboard Review"
        - "Escalation Process"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Key Findings"
        - "Coverage Assessment"
        - "Recommendations"

  confidence_guidance:
    high: "Complete monitoring review with effectiveness analysis"
    medium: "Inventory with sample effectiveness review"
    low: "Coverage review only"

offline:
  capability: "partial"

profiles:
  membership:
    quick:
      included: false
      reason: "Requires thorough monitoring evaluation"
    full:
      included: true
      priority: 1

closeout_checklist:
  - id: "cm-001"
    item: "Monitoring inventory completed"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Confirm monitoring coverage assessed"
    expected: "Confirmed by reviewer"

  - id: "cm-002"
    item: "Monitoring design evaluated"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Verify design assessment complete"
    expected: "Confirmed by reviewer"

  - id: "cm-003"
    item: "Alert effectiveness reviewed"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Confirm alert review complete"
    expected: "Confirmed by reviewer"

  - id: "cm-004"
    item: "Recommendations provided"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Verify improvement recommendations documented"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["regulated-entity", "enterprise", "financial-services"]

  compliance_frameworks:
    - framework: "COSO"
      controls: ["Monitoring Activities"]
    - framework: "COBIT"
      controls: ["MEA01", "MEA02"]

relationships:
  commonly_combined:
    - "compliance-legal.risk-control.control-effectiveness"
    - "compliance-legal.risk-control.exception-management"
    - "compliance-legal.financial-reporting.sox-compliance"
