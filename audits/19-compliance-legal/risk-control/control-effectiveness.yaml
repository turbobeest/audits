audit:
  id: compliance-legal.risk-control.control-effectiveness
  name: Control Effectiveness Audit
  version: 1.0.0
  last_updated: '2026-01-19'
  status: active
  category: compliance-legal
  category_number: 19
  subcategory: risk-control
  tier: phd
  estimated_duration: 6-10 hours  # median: 8h
  completeness: requires_discovery
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: process
  default_profiles:
  - full
  - security
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates control effectiveness including:
    - Control design adequacy
    - Operating effectiveness testing
    - Control automation and reliability
    - Key control identification
    - Control documentation accuracy
    - Compensating control adequacy
    - Control gap identification
    - Control ownership and accountability
  why_it_matters: |
    Controls are the foundation of compliance and risk management.
    Ineffective controls result in:
    - Compliance violations despite control existence
    - Risk exposure from false sense of security
    - Audit findings and material weaknesses
    - Regulatory enforcement for control failures
    - Operational losses from unmitigated risks
    - Resource waste on controls that don't work
    - Inability to rely on control assertions
    Control effectiveness must be validated, not assumed.
  when_to_run:
  - During annual control assessments
  - Before SOX or regulatory audits
  - After control implementations
  - Following control failures or incidents
prerequisites:
  required_artifacts:
  - type: control_inventory
    description: List of controls with design documentation
  - type: control_evidence
    description: Evidence of control operation
  - type: testing_methodology
    description: Control testing approach
  access_requirements:
  - Control documentation
  - Operating evidence
  - System access for control testing
  - Control owner access for walkthroughs
discovery:
  code_patterns:
  - pattern: (control|check|validat|verify|approv)
    type: regex
    scope: source
    purpose: Find control implementations
  - pattern: (audit|log|track|monitor)
    type: regex
    scope: source
    purpose: Locate monitoring controls
  file_patterns:
  - glob: '**/controls/**'
    purpose: Control implementation code
  - glob: '**/validation/**'
    purpose: Validation logic
  documents_to_review:
  - type: Control matrix
    purpose: Understand control landscape
  - type: Control procedures
    purpose: Review control design
  - type: Test results
    purpose: Assess operating effectiveness
  interviews:
  - role: Control Owners
    questions:
    - How does this control work?
    - How do you know it's operating effectively?
    - What evidence exists of control operation?
    purpose: Understand control operation
  - role: Internal Audit
    questions:
    - Which controls have been tested?
    - What deficiencies have been found?
    - How is control effectiveness tracked?
    purpose: Assess testing coverage
knowledge_sources:
  specifications:
  - id: coso-ic
    name: COSO Internal Control Framework
    url: https://www.coso.org/Pages/ic.aspx
    offline_cache: true
    priority: required
  - id: cobit
    name: COBIT Control Objectives
    url: https://www.isaca.org/resources/cobit
    offline_cache: true
    priority: required
  - id: nist-csf-2
    name: NIST Cybersecurity Framework 2.0
    url: https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.29.pdf
    offline_cache: true
    priority: recommended
  guides:
  - id: control-testing
    name: Control Testing Best Practices
    url: https://www.isaca.org/
    offline_cache: true
tooling:
  assessment_tools:
  - tool: Control Design Assessment Template
    purpose: Evaluate control design
  - tool: Operating Effectiveness Testing Template
    purpose: Document control testing
  scripts:
  - id: find-controls
    language: bash
    purpose: Locate control implementations in code
    source: inline
    code: |
      #!/bin/bash
      echo "=== Control Implementations ==="
      grep -r -E "(control|validate|check|approve)" \
        --include="*.py" --include="*.java" --include="*.ts" . 2>/dev/null | head -30

      echo "=== Automated Monitoring ==="
      grep -r -E "(monitor|alert|threshold)" \
        --include="*.py" --include="*.yaml" . 2>/dev/null | head -20
signals:
  critical:
  - id: CE-CRIT-001
    signal: Key control not operating as designed
    evidence_indicators:
    - Control documented but not executed
    - Control bypassed or overridden routinely
    - Control output not used for decision-making
    explanation: |
      A key control that doesn't operate provides no risk
      mitigation despite appearing to address the risk.
    remediation: Implement control as designed or redesign control
  - id: CE-CRIT-002
    signal: No evidence of control operation
    evidence_indicators:
    - Cannot demonstrate control execution
    - No logs, reports, or documentation
    - Control owner cannot explain operation
    explanation: |
      Without evidence, control operation cannot be verified
      and auditors cannot rely on the control.
    remediation: Implement evidence generation and retention
  - id: CE-CRIT-003
    signal: Control design does not address the risk
    evidence_indicators:
    - Control does not prevent or detect the risk
    - Risk can occur despite control operation
    - Gap between control objective and implementation
    explanation: |
      Controls must be designed to effectively address risks.
      Misaligned controls waste resources and leave risks unaddressed.
    remediation: Redesign control to effectively address the risk
  high:
  - id: CE-HIGH-001
    signal: Automated control has no monitoring
    explanation: Automated controls can fail silently without monitoring
    remediation: Implement monitoring and alerting for automated controls
  - id: CE-HIGH-002
    signal: Manual control inconsistently performed
    explanation: Inconsistent execution indicates unreliable control
    remediation: Automate control or implement enforcement mechanisms
  - id: CE-HIGH-003
    signal: Compensating controls inadequate
    explanation: Weak compensating controls leave residual risk
    remediation: Strengthen compensating controls or address primary control
  medium:
  - id: CE-MED-001
    signal: Control documentation does not match operation
    remediation: Update documentation or correct control operation
  - id: CE-MED-002
    signal: Control testing not performed regularly
    remediation: Implement regular control testing schedule
  low:
  - id: CE-LOW-001
    signal: Control efficiency could be improved
  positive:
  - id: CE-POS-001
    signal: Automated controls with continuous monitoring
  - id: CE-POS-002
    signal: Regular testing with documented evidence
procedure:
  context:
    cognitive_mode: critical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Control Inventory Review
    description: |
      Review control inventory and select controls for
      effectiveness testing based on risk and materiality.
    duration_estimate: 45 min
    questions:
    - What controls exist in the environment?
    - Which controls are key controls?
    - What is the testing coverage plan?
    expected_findings:
    - Control inventory
    - Key control identification
    - Testing scope
  - id: '2'
    name: Design Effectiveness Assessment
    description: |
      Evaluate whether controls are designed to effectively
      address their intended risks.
    duration_estimate: 90 min
    questions:
    - Does the control address the risk?
    - Is the control design appropriate?
    - Are there design gaps?
    expected_findings:
    - Design adequacy assessment
    - Gap identification
    - Design recommendations
  - id: '3'
    name: Operating Effectiveness Testing
    description: |
      Test control operation through inspection, observation,
      re-performance, or inquiry.
    duration_estimate: 120 min
    commands:
    - purpose: Find control evidence in logs
      command: grep -r -E '(control|approved|validated)' --include='*.log' . 2>/dev/null | head -20
    expected_findings:
    - Operating effectiveness results
    - Evidence assessment
    - Exception identification
  - id: '4'
    name: Control Monitoring Assessment
    description: |
      Evaluate ongoing monitoring of control effectiveness
      and exception handling.
    duration_estimate: 45 min
    questions:
    - How are controls monitored?
    - How are exceptions detected and handled?
    - What metrics exist for control performance?
    expected_findings:
    - Monitoring adequacy
    - Exception handling
    - Metrics availability
  - id: '5'
    name: Finding Classification
    description: |
      Classify findings by severity and determine
      remediation priorities.
    duration_estimate: 30 min
    expected_findings:
    - Finding classification
    - Severity assessment
    - Remediation priorities
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: effectiveness_assessment
    format: structured
    sections:
    - Control Inventory
    - Design Assessment
    - Operating Effectiveness
    - Monitoring Review
    - Finding Classification
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Key Findings
    - Deficiency Assessment
    - Recommendations
  confidence_guidance:
    high: Complete design and operating effectiveness testing
    medium: Design review with sample operating tests
    low: Design review without operating testing
offline:
  capability: partial
  cache_manifest:
    knowledge:
    - source_id: coso-ic
      priority: required
    - source_id: cobit
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires thorough control testing
    full:
      included: true
      priority: 1
closeout_checklist:
- id: ce-001
  item: Control inventory reviewed
  level: CRITICAL
  verification: manual
  verification_notes: Confirm control scope identified
  expected: Confirmed by reviewer
- id: ce-002
  item: Design effectiveness assessed
  level: CRITICAL
  verification: manual
  verification_notes: Verify design evaluation complete
  expected: Confirmed by reviewer
- id: ce-003
  item: Operating effectiveness tested
  level: CRITICAL
  verification: manual
  verification_notes: Confirm operating tests performed
  expected: Confirmed by reviewer
- id: ce-004
  item: Findings classified
  level: BLOCKING
  verification: manual
  verification_notes: Verify finding severity assessed
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - public-company
    - regulated-entity
    - enterprise
  compliance_frameworks:
  - framework: COSO
    controls:
    - Internal Control Framework
  - framework: SOX
    controls:
    - Section 404
  - framework: COBIT
    controls:
    - Control Objectives
relationships:
  commonly_combined:
  - compliance-legal.financial-reporting.sox-compliance
  - compliance-legal.risk-control.control-monitoring
  - compliance-legal.risk-control.risk-assessment-process
