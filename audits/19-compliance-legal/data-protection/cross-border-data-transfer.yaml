audit:
  id: compliance-legal.data-protection.cross-border-data-transfer
  name: Cross-Border Data Transfer Audit
  version: 1.0.0
  last_updated: '2026-01-19'
  status: active
  category: compliance-legal
  category_number: 19
  subcategory: data-protection
  tier: phd
  estimated_duration: 4-6 hours  # median: 5h
  completeness: requires_discovery
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: organizational
  default_profiles:
  - full
  - security
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates international data transfers against legal requirements including
    adequacy decisions, Standard Contractual Clauses (SCCs), Binding Corporate
    Rules (BCRs), and derogations. Assesses transfer impact assessments (TIAs),
    supplementary measures, and ongoing compliance monitoring. Post-Schrems II
    focus on government access risks and encryption requirements.
  why_it_matters: |
    Post-Schrems II, international data transfers face heightened scrutiny.
    Transfers without valid legal basis are unlawful and may result in
    enforcement action, processing bans, and fines. Organizations must assess
    third-country government access risks and implement supplementary measures.
    Invalid transfers undermine entire data protection compliance programs.
  when_to_run:
  - When establishing new international data flows
  - After Schrems II or similar transfer mechanism changes
  - During vendor assessments involving international transfers
  - When expanding to new geographic markets
  - Following regulatory guidance updates
prerequisites:
  required_artifacts:
  - type: data_flow_map
    description: Documentation of international data flows
  - type: transfer_mechanisms
    description: SCCs, BCRs, or other transfer documentation
  - type: tia_records
    description: Transfer Impact Assessments
  access_requirements:
  - Data flow documentation
  - Vendor and processor locations
  - Transfer mechanism documentation (SCCs, BCRs)
  - Transfer impact assessments
  - Cloud service provider locations
discovery:
  code_patterns:
  - pattern: (transfer|export|cross.?border|international)
    type: regex
    scope: source
    purpose: Find data transfer code
  - pattern: (aws|azure|gcp|cloud|s3|blob)
    type: regex
    scope: config
    purpose: Identify cloud service usage
  file_patterns:
  - glob: '**/config/*cloud*'
    purpose: Find cloud configurations
  - glob: '**/legal/*transfer*'
    purpose: Locate transfer documentation
  - glob: '**/*scc*'
    purpose: Find SCC documentation
  documents_to_review:
  - type: Data flow diagrams
    purpose: Map international transfers
  - type: Standard Contractual Clauses
    purpose: Verify transfer mechanism validity
  - type: Transfer Impact Assessments
    purpose: Evaluate risk assessments
  interviews:
  - role: Legal/Privacy counsel
    questions:
    - What transfer mechanisms are in place?
    - Have TIAs been conducted?
    - What supplementary measures are implemented?
    purpose: Understand transfer compliance approach
  - role: Infrastructure/Cloud team
    questions:
    - Where is data physically stored?
    - Which cloud regions are used?
    - Are there data residency controls?
    purpose: Map actual data locations
knowledge_sources:
  specifications:
  - id: gdpr-ch5
    name: GDPR Chapter V - Transfers to Third Countries
    url: https://gdpr-info.eu/chapter-5/
    offline_cache: true
    priority: required
  - id: schrems-ii
    name: Schrems II Judgment (C-311/18)
    url: https://curia.europa.eu/juris/liste.jsf?num=C-311/18
    offline_cache: true
    priority: required
  - id: eu-sccs
    name: EU Standard Contractual Clauses (2021)
    url: https://ec.europa.eu/info/law/law-topic/data-protection/international-dimension-data-protection/standard-contractual-clauses-scc_en
    offline_cache: true
    priority: required
  guides:
  - id: edpb-transfers
    name: EDPB Recommendations on Supplementary Measures
    url: https://edpb.europa.eu/our-work-tools/our-documents/recommendations/recommendations-012020-measures-supplement-transfer_en
    offline_cache: true
  - id: edpb-tia
    name: EDPB Transfer Impact Assessment Guidance
    url: https://edpb.europa.eu/our-work-tools/our-documents/recommendations/edpb-recommendations-022020_en
    offline_cache: true
tooling:
  assessment_tools:
  - tool: Transfer mapping template
    purpose: Document all international data flows
  - tool: TIA framework
    purpose: Structured transfer impact assessment
  scripts:
  - id: cloud-region-finder
    language: bash
    purpose: Find cloud region configurations
    source: inline
    code: |
      #!/bin/bash
      echo "=== AWS Regions ==="
      grep -r -E "(us-east|eu-west|ap-|sa-|af-|me-)" \
        --include="*.yaml" --include="*.json" --include="*.tf" . 2>/dev/null

      echo "=== Cloud Provider References ==="
      grep -r -E "(region|location|zone)" \
        --include="*.yaml" --include="*.json" --include="*.tf" . 2>/dev/null
signals:
  critical:
  - id: TRANSFER-CRIT-001
    signal: Transfers to inadequate countries without legal mechanism
    evidence_indicators:
    - Data flows to non-adequate countries
    - No SCCs or BCRs in place
    - No derogation applies
    explanation: |
      GDPR Chapter V prohibits transfers without adequate protection. Post-
      Schrems II, transfers to US require SCCs plus supplementary measures.
      Transfers without legal basis are unlawful and may result in bans.
    remediation: Implement valid transfer mechanism (SCCs with supplementary measures)
  - id: TRANSFER-CRIT-002
    signal: No Transfer Impact Assessment conducted
    evidence_indicators:
    - No TIA documentation
    - Third-country legal framework not assessed
    - Government access risks not evaluated
    explanation: |
      EDPB requires TIA for transfers relying on SCCs to assess third-country
      legal framework and government access risks. Without TIA, transfer
      legality cannot be determined.
    remediation: Conduct Transfer Impact Assessment for each destination
  - id: TRANSFER-CRIT-003
    signal: Outdated SCCs still in use
    evidence_indicators:
    - Pre-2021 SCC versions
    - Controller-processor clauses not updated
    explanation: |
      New EU SCCs effective June 2021 with transition deadline December 2022.
      Old SCCs no longer valid transfer mechanism. Use of outdated SCCs
      means transfers lack legal basis.
    remediation: Update to current SCC versions with supplementary measures
  high:
  - id: TRANSFER-HIGH-001
    signal: No supplementary measures despite government access risk
    explanation: TIA identifies risk but no additional protections implemented
    remediation: Implement encryption, pseudonymization, or contractual measures
  - id: TRANSFER-HIGH-002
    signal: Data localization requirements not respected
    explanation: Some jurisdictions require data to remain within borders
    remediation: Implement data residency controls for affected jurisdictions
  - id: TRANSFER-HIGH-003
    signal: Sub-processor transfers not documented
    explanation: Processor engages sub-processors in third countries without review
    remediation: Map and assess all sub-processor transfer chains
  medium:
  - id: TRANSFER-MED-001
    signal: Transfer documentation incomplete
    remediation: Complete transfer mapping and documentation
  - id: TRANSFER-MED-002
    signal: TIAs not regularly reviewed
    remediation: Establish periodic TIA review process
  low:
  - id: TRANSFER-LOW-001
    signal: Transfer register not centralized
    remediation: Create centralized international transfer register
  positive:
  - id: TRANSFER-POS-001
    signal: Comprehensive TIAs with supplementary measures
  - id: TRANSFER-POS-002
    signal: Data residency controls implemented
  - id: TRANSFER-POS-003
    signal: Transfer monitoring and review process established
procedure:
  context:
    cognitive_mode: critical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Map international data flows
    description: |
      Identify all transfers of personal data outside the EEA/UK,
      including cloud services, vendors, and group companies.
    duration_estimate: 60 min
    commands:
    - purpose: Find cloud region configurations
      command: grep -r -E '(region|location|zone)' --include='*.yaml' --include='*.json' --include='*.tf'
        .
    questions:
    - What data flows to third countries?
    - What cloud providers and regions are used?
    - What processors and sub-processors are in third countries?
    expected_findings:
    - Complete transfer inventory
    - Data flow diagram
  - id: '2'
    name: Assess adequacy status
    description: |
      Determine adequacy status of each destination country and
      identify transfers requiring additional mechanisms.
    duration_estimate: 30 min
    questions:
    - Which destinations have EU adequacy decisions?
    - Which destinations require transfer mechanisms?
    expected_findings:
    - Adequacy status mapping
    - Mechanism requirements identified
  - id: '3'
    name: Review transfer mechanisms
    description: |
      Evaluate transfer mechanisms (SCCs, BCRs, derogations) for
      validity and currency.
    duration_estimate: 60 min
    questions:
    - Are current SCC versions in use?
    - Are SCCs properly executed?
    - Do BCRs cover relevant entities?
    expected_findings:
    - Mechanism validity assessment
    - Documentation gaps
  - id: '4'
    name: Evaluate Transfer Impact Assessments
    description: |
      Review TIAs for completeness, accuracy of legal assessment,
      and appropriateness of supplementary measures.
    duration_estimate: 60 min
    expected_findings:
    - TIA coverage
    - Assessment quality evaluation
  - id: '5'
    name: Review supplementary measures
    description: |
      Assess technical, contractual, and organizational supplementary
      measures implemented to address identified risks.
    duration_estimate: 45 min
    questions:
    - What encryption measures are in place?
    - Is data pseudonymized before transfer?
    - What contractual protections exist?
    expected_findings:
    - Supplementary measures assessment
    - Gap analysis
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: transfer_assessment
    format: structured
    sections:
    - Transfer Inventory
    - Mechanism Assessment
    - TIA Evaluation
    - Supplementary Measures Review
    - Risk Assessment
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Transfer Compliance Status
    - Recommendations
  confidence_guidance:
    high: Complete transfer mapping and documentation reviewed
    medium: Key transfers assessed, some documentation gaps
    low: Partial transfer visibility
offline:
  capability: partial
  cache_manifest:
    knowledge:
    - source_id: gdpr-ch5
      priority: required
    - source_id: edpb-transfers
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires comprehensive transfer mapping
    full:
      included: true
      priority: 1
closeout_checklist:
- id: transfer-001
  item: All international transfers identified
  level: CRITICAL
  verification: manual
  verification_notes: Complete transfer inventory documented
  expected: Confirmed by reviewer
- id: transfer-002
  item: Valid transfer mechanisms in place
  level: CRITICAL
  verification: manual
  verification_notes: Current SCCs, BCRs, or adequacy covers all transfers
  expected: Confirmed by reviewer
- id: transfer-003
  item: TIAs completed for SCC-based transfers
  level: CRITICAL
  verification: manual
  verification_notes: TIA documents third-country assessment
  expected: Confirmed by reviewer
- id: transfer-004
  item: Supplementary measures implemented where required
  level: BLOCKING
  verification: manual
  verification_notes: Encryption, pseudonymization, or contractual measures in place
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: GDPR
    controls:
    - Chapter V
    - Articles 44-49
  - framework: UK GDPR
    controls:
    - Chapter V
  - framework: CCPA
    controls:
    - Cross-border provisions
relationships:
  commonly_combined:
  - compliance-legal.data-protection.gdpr-compliance
  - compliance-legal.data-protection.data-processing-agreement
  - compliance-legal.industry-standards.soc2-compliance
