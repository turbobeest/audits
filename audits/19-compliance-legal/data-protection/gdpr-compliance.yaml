audit:
  id: compliance-legal.data-protection.gdpr-compliance
  name: GDPR Compliance Audit
  version: 1.0.0
  last_updated: '2026-01-19'
  status: active
  category: compliance-legal
  category_number: 19
  subcategory: data-protection
  tier: phd
  estimated_duration: 8-12 hours  # median: 10h
  completeness: requires_discovery
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: critical
  scope: organizational
  default_profiles:
  - full
  - security
  blocks_phase: true
  parallelizable: false
description:
  what: |
    Comprehensive evaluation of GDPR compliance including lawful bases for
    processing, data subject rights implementation, data protection impact
    assessments, records of processing activities, international data transfers,
    breach notification procedures, and organizational measures. Reviews both
    technical implementations and governance frameworks.
  why_it_matters: |
    GDPR non-compliance exposes organizations to significant financial penalties
    (up to 4% of global annual turnover or EUR 20 million), reputational damage,
    and enforcement actions including processing bans. GDPR applies to any
    organization processing EU residents' data, regardless of location. Compliance
    demonstrates respect for fundamental privacy rights.
  when_to_run:
  - Before launching products processing EU personal data
  - During annual compliance reviews
  - After significant changes to data processing activities
  - Following data breaches or regulatory inquiries
  - When expanding into EU markets
prerequisites:
  required_artifacts:
  - type: ropa
    description: Records of Processing Activities
  - type: privacy_policies
    description: Privacy notices and policies
  - type: dpia_records
    description: Data Protection Impact Assessments
  access_requirements:
  - Access to data processing documentation
  - Data flow diagrams and system architecture
  - Privacy policy and consent mechanisms
  - Data Protection Officer or privacy team
  - Third-party processor agreements
discovery:
  code_patterns:
  - pattern: (personal.?data|pii|gdpr|data.?subject)
    type: regex
    scope: source
    purpose: Find personal data handling code
  - pattern: (consent|legitimate.?interest|lawful.?basis)
    type: regex
    scope: source
    purpose: Locate lawful basis implementations
  - pattern: (erasure|deletion|right.?to.?be.?forgotten)
    type: regex
    scope: source
    purpose: Find data subject rights implementations
  file_patterns:
  - glob: '**/privacy/**'
    purpose: Find privacy-related modules
  - glob: '**/gdpr/**'
    purpose: Locate GDPR-specific implementations
  - glob: '**/docs/*privacy*'
    purpose: Find privacy documentation
  documents_to_review:
  - type: Records of Processing Activities (ROPA)
    purpose: Verify Article 30 compliance
  - type: Privacy notices
    purpose: Evaluate transparency and information provision
  - type: Data Processing Agreements
    purpose: Assess processor compliance
  interviews:
  - role: Data Protection Officer
    questions:
    - How are processing activities documented and maintained?
    - What is the process for conducting DPIAs?
    - How are data subject requests handled?
    purpose: Understand governance and accountability
  - role: Engineering leads
    questions:
    - How is personal data identified and classified?
    - What data minimization practices are in place?
    - How is data retention enforced technically?
    purpose: Assess technical implementation
knowledge_sources:
  specifications:
  - id: gdpr-full
    name: General Data Protection Regulation (EU) 2016/679
    url: https://eur-lex.europa.eu/eli/reg/2016/679/oj
    offline_cache: true
    priority: required
  - id: gdpr-recitals
    name: GDPR Recitals and Guidelines
    url: https://gdpr-info.eu/
    offline_cache: true
    priority: required
  - id: nist-800-53
    name: NIST SP 800-53 Rev 5
    url: https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
    offline_cache: true
    priority: recommended
  guides:
  - id: edpb-guidelines
    name: European Data Protection Board Guidelines
    url: https://edpb.europa.eu/our-work-tools/our-documents/guidelines_en
    offline_cache: true
  - id: ico-guidance
    name: ICO UK GDPR Guidance
    url: https://ico.org.uk/for-organisations/guide-to-data-protection/guide-to-the-general-data-protection-regulation-gdpr/
    offline_cache: true
tooling:
  assessment_tools:
  - tool: GDPR compliance checklist
    purpose: Structured evaluation of compliance requirements
  - tool: Data mapping tools
    purpose: Document data flows and processing activities
  scripts:
  - id: personal-data-finder
    language: bash
    purpose: Find potential personal data handling
    source: inline
    code: |
      #!/bin/bash
      echo "=== Personal Data Patterns ==="
      grep -r -E "(email|phone|address|name|ssn|dob|birth)" \
        --include="*.py" --include="*.ts" --include="*.java" . 2>/dev/null

      echo "=== GDPR Annotations ==="
      grep -r -E "@(PersonalData|GDPR|PII)" \
        --include="*.java" --include="*.py" . 2>/dev/null
signals:
  critical:
  - id: GDPR-CRIT-001
    signal: No lawful basis documented for processing activities
    evidence_indicators:
    - Processing occurs without documented legal basis
    - No ROPA or processing register exists
    explanation: |
      Article 6 requires a lawful basis for all personal data processing.
      Processing without lawful basis is fundamentally unlawful and
      exposes the organization to maximum penalties.
    remediation: Document lawful basis for each processing activity in ROPA
  - id: GDPR-CRIT-002
    signal: No data subject rights implementation
    evidence_indicators:
    - No mechanism for access requests (SAR)
    - No data portability capability
    - No erasure/deletion capability
    explanation: |
      Articles 15-22 mandate data subject rights. Inability to fulfill
      these rights constitutes ongoing non-compliance and exposes
      organization to complaints and enforcement.
    remediation: Implement all required data subject rights mechanisms
  - id: GDPR-CRIT-003
    signal: Unlawful international data transfers
    evidence_indicators:
    - Data transferred outside EEA without valid mechanism
    - No SCCs, adequacy decision, or binding corporate rules
    explanation: |
      Chapter V restricts international transfers. Post-Schrems II,
      transfers to inadequate countries require SCCs with supplementary
      measures. Unlawful transfers may result in processing bans.
    remediation: Implement valid transfer mechanisms (SCCs, adequacy, BCRs)
  high:
  - id: GDPR-HIGH-001
    signal: No breach notification procedure
    explanation: Article 33/34 require 72-hour breach notification capability
    remediation: Implement and test breach detection and notification procedures
  - id: GDPR-HIGH-002
    signal: DPIAs not conducted for high-risk processing
    explanation: Article 35 mandates DPIAs for high-risk processing activities
    remediation: Identify high-risk processing and conduct required DPIAs
  - id: GDPR-HIGH-003
    signal: No Data Protection Officer when required
    explanation: Article 37 requires DPO for certain processing activities
    remediation: Appoint DPO if mandatory conditions are met
  medium:
  - id: GDPR-MED-001
    signal: Privacy notices incomplete or unclear
    remediation: Update privacy notices to include all Article 13/14 information
  - id: GDPR-MED-002
    signal: Processing records not regularly updated
    remediation: Establish process for maintaining current ROPA
  - id: GDPR-MED-003
    signal: Processor agreements missing required clauses
    remediation: Update DPAs to include all Article 28 requirements
  low:
  - id: GDPR-LOW-001
    signal: Privacy training not documented
    remediation: Implement and document regular privacy training program
  positive:
  - id: GDPR-POS-001
    signal: Comprehensive ROPA maintained and current
  - id: GDPR-POS-002
    signal: Privacy by design implemented in development lifecycle
  - id: GDPR-POS-003
    signal: Automated data subject rights fulfillment
procedure:
  context:
    cognitive_mode: critical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Review Records of Processing Activities
    description: |
      Evaluate ROPA completeness and accuracy. Verify all processing
      activities documented with required Article 30 elements.
    duration_estimate: 90 min
    questions:
    - Does ROPA exist and is it current?
    - Are all processing purposes documented?
    - Are lawful bases identified for each activity?
    - Are data categories and retention periods specified?
    expected_findings:
    - ROPA completeness assessment
    - Gaps in processing documentation
  - id: '2'
    name: Assess lawful bases
    description: |
      Evaluate whether appropriate lawful bases are documented and
      implemented for each processing activity.
    duration_estimate: 60 min
    questions:
    - Is consent used appropriately and validly?
    - Are legitimate interest assessments documented?
    - Is necessity basis correctly applied?
    expected_findings:
    - Lawful basis validity assessment
    - Potentially unlawful processing identified
  - id: '3'
    name: Evaluate data subject rights
    description: |
      Review implementation of all data subject rights and test
      fulfillment processes.
    duration_estimate: 90 min
    commands:
    - purpose: Find rights implementation code
      command: grep -r -E '(access.?request|sar|erasure|portability)' --include='*.py' --include='*.ts'
        .
    expected_findings:
    - Rights implementation status
    - Process effectiveness assessment
  - id: '4'
    name: Review international transfers
    description: |
      Identify all international data transfers and evaluate
      transfer mechanisms and supplementary measures.
    duration_estimate: 60 min
    questions:
    - What data flows outside the EEA?
    - What transfer mechanisms are in place?
    - Are supplementary measures implemented?
    expected_findings:
    - Transfer inventory
    - Transfer mechanism assessment
  - id: '5'
    name: Assess breach notification capability
    description: |
      Evaluate breach detection, assessment, and notification
      procedures against 72-hour requirement.
    duration_estimate: 45 min
    expected_findings:
    - Breach procedure assessment
    - Notification capability status
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: compliance_assessment
    format: structured
    sections:
    - Lawful Basis Assessment
    - Data Subject Rights Review
    - International Transfer Analysis
    - DPIA Evaluation
    - Breach Notification Assessment
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Compliance Status
    - Risk Assessment
    - Recommendations
  confidence_guidance:
    high: Full documentation access and stakeholder interviews completed
    medium: Key documentation reviewed, limited stakeholder access
    low: Partial documentation available
offline:
  capability: partial
  cache_manifest:
    knowledge:
    - source_id: gdpr-full
      priority: required
    - source_id: edpb-guidelines
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Comprehensive compliance audit requires full review
    full:
      included: true
      priority: 1
closeout_checklist:
- id: gdpr-001
  item: ROPA exists and contains required elements
  level: CRITICAL
  verification: manual
  verification_notes: Article 30 elements documented for all processing
  expected: Confirmed by reviewer
- id: gdpr-002
  item: Lawful basis documented for all processing
  level: CRITICAL
  verification: manual
  verification_notes: Each processing activity has valid lawful basis
  expected: Confirmed by reviewer
- id: gdpr-003
  item: Data subject rights mechanisms functional
  level: CRITICAL
  verification: manual
  verification_notes: All required rights can be exercised
  expected: Confirmed by reviewer
- id: gdpr-004
  item: International transfers have valid mechanisms
  level: CRITICAL
  verification: manual
  verification_notes: SCCs, adequacy, or BCRs in place for transfers
  expected: Confirmed by reviewer
- id: gdpr-005
  item: Breach notification procedure documented and tested
  level: BLOCKING
  verification: manual
  verification_notes: 72-hour notification capability verified
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: GDPR
    controls:
    - Articles 5-49
    - Chapter II-V
  - framework: UK GDPR
    controls:
    - Full regulation
  - framework: ePrivacy Directive
    controls:
    - Article 5
relationships:
  commonly_combined:
  - compliance-legal.data-protection.ccpa-compliance
  - compliance-legal.data-protection.data-breach-notification
  - compliance-legal.data-protection.cross-border-data-transfer
