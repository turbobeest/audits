# ============================================================
# AUDIT: ISO 27001 Compliance Audit
# ============================================================
# Evaluates Information Security Management System (ISMS) compliance
# with ISO/IEC 27001:2022 requirements and Annex A controls.

audit:
  id: "compliance-legal.industry-standards.iso27001-compliance"

  name: "ISO 27001 Compliance Audit"

  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "compliance-legal"
  category_number: 19
  subcategory: "industry-standards"

  tier: "expert"
  estimated_duration: "10-16 hours"  # median: 13h

  completeness: "requires_discovery"
  requires_runtime: true
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "organizational"

  default_profiles:
    - "full"
    - "security"

  blocks_phase: false
  parallelizable: false

description:
  what: |
    Comprehensive evaluation of Information Security Management System (ISMS)
    against ISO/IEC 27001:2022 requirements. Reviews ISMS documentation, risk
    assessment methodology, Statement of Applicability, control implementation,
    management review, internal audits, and continual improvement processes.
    Assesses readiness for ISO 27001 certification audit.

  why_it_matters: |
    ISO 27001 is the international standard for information security management.
    Certification demonstrates systematic approach to managing sensitive
    information. Increasingly required by enterprise customers, government
    contracts, and regulatory frameworks. Provides competitive advantage and
    insurance premium reductions. Drives security culture and operational
    maturity.

  when_to_run:
    - "Before initiating ISO 27001 certification"
    - "During annual ISMS surveillance audit preparation"
    - "After significant organizational changes"
    - "When expanding ISMS scope"
    - "As part of continual improvement"

prerequisites:
  required_artifacts:
    - type: "isms_documentation"
      description: "ISMS policies, procedures, and records"
    - type: "risk_assessment"
      description: "Information security risk assessment"
    - type: "soa"
      description: "Statement of Applicability"

  access_requirements:
    - "ISMS documentation"
    - "Risk assessment records"
    - "Statement of Applicability"
    - "Internal audit reports"
    - "Management review minutes"
    - "Corrective action records"

discovery:
  file_patterns:
    - glob: "**/isms/**"
      purpose: "Find ISMS documentation"
    - glob: "**/policies/**"
      purpose: "Locate security policies"
    - glob: "**/risk/**"
      purpose: "Find risk assessment documents"

  documents_to_review:
    - type: "Information Security Policy"
      purpose: "Evaluate top-level commitment"
    - type: "Risk Assessment Methodology"
      purpose: "Assess risk management approach"
    - type: "Statement of Applicability"
      purpose: "Review control selection"
    - type: "Internal Audit Reports"
      purpose: "Evaluate audit program"

  interviews:
    - role: "Top management"
      questions:
        - "How is ISMS leadership demonstrated?"
        - "What resources are allocated to ISMS?"
        - "How are ISMS objectives set?"
      purpose: "Assess management commitment"
    - role: "ISMS Manager"
      questions:
        - "How is the risk assessment maintained?"
        - "How are controls monitored for effectiveness?"
        - "What is the internal audit schedule?"
      purpose: "Understand ISMS operations"

knowledge_sources:
  specifications:
    - id: "iso27001-2022"
      name: "ISO/IEC 27001:2022 Information Security Management"
      url: "https://www.iso.org/standard/27001"
      offline_cache: true
      priority: "required"
    - id: "iso27002-2022"
      name: "ISO/IEC 27002:2022 Information Security Controls"
      url: "https://www.iso.org/standard/75652.html"
      offline_cache: true
      priority: "required"

  guides:
    - id: "iso27003"
      name: "ISO/IEC 27003 ISMS Implementation Guidance"
      url: "https://www.iso.org/standard/63417.html"
      offline_cache: true
    - id: "iso27004"
      name: "ISO/IEC 27004 Information Security Measurement"
      url: "https://www.iso.org/standard/64120.html"
      offline_cache: true

tooling:
  assessment_tools:
    - tool: "ISO 27001 clause checklist"
      purpose: "Structured evaluation of ISMS requirements"
    - tool: "Annex A control assessment"
      purpose: "Control implementation review"

signals:
  critical:
    - id: "ISO-CRIT-001"
      signal: "No documented ISMS scope"
      evidence_indicators:
        - "ISMS boundaries not defined"
        - "No scope statement exists"
        - "Interfaces not identified"
      explanation: |
        Clause 4.3 requires defined ISMS scope. Without scope definition,
        organization cannot demonstrate what is covered by ISMS and what
        controls apply.
      remediation: "Define and document ISMS scope and boundaries"

    - id: "ISO-CRIT-002"
      signal: "No risk assessment conducted"
      evidence_indicators:
        - "No risk assessment methodology"
        - "Risks not identified"
        - "No risk treatment plan"
      explanation: |
        Clause 6.1.2 requires risk assessment. Risk assessment is core
        to ISO 27001; controls must be selected based on assessed risks.
        Without risk assessment, ISMS has no foundation.
      remediation: "Conduct information security risk assessment"

    - id: "ISO-CRIT-003"
      signal: "No Statement of Applicability"
      evidence_indicators:
        - "SoA does not exist"
        - "Control selection not justified"
        - "Annex A controls not addressed"
      explanation: |
        Clause 6.1.3 requires Statement of Applicability. SoA documents
        selected controls and justifications. Essential for certification
        and demonstrating due diligence.
      remediation: "Create Statement of Applicability with all Annex A controls"

  high:
    - id: "ISO-HIGH-001"
      signal: "No internal audit program"
      explanation: "Clause 9.2 requires internal audits at planned intervals"
      remediation: "Establish internal audit program and schedule"

    - id: "ISO-HIGH-002"
      signal: "No management review conducted"
      explanation: "Clause 9.3 requires top management to review ISMS"
      remediation: "Conduct and document management review"

    - id: "ISO-HIGH-003"
      signal: "Corrective actions not implemented"
      explanation: "Clause 10.1 requires nonconformity management"
      remediation: "Implement corrective action process"

  medium:
    - id: "ISO-MED-001"
      signal: "ISMS objectives not measurable"
      remediation: "Define measurable security objectives with metrics"

    - id: "ISO-MED-002"
      signal: "Competence requirements not defined"
      remediation: "Document competence requirements and training records"

    - id: "ISO-MED-003"
      signal: "Documented information not controlled"
      remediation: "Implement document control procedures"

  low:
    - id: "ISO-LOW-001"
      signal: "ISMS metrics not tracked"
      remediation: "Define and track ISMS performance metrics"

  positive:
    - id: "ISO-POS-001"
      signal: "Comprehensive ISMS with all mandatory documentation"
    - id: "ISO-POS-002"
      signal: "Risk-based control selection with justified SoA"
    - id: "ISO-POS-003"
      signal: "Active continual improvement program"

procedure:
  context:
    cognitive_mode: "evaluative"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Review ISMS context and scope"
      description: |
        Evaluate understanding of organizational context, interested
        parties, and ISMS scope definition (Clauses 4.1-4.3).
      duration_estimate: "60 min"
      questions:
        - "Are internal and external issues identified?"
        - "Are interested parties and their requirements documented?"
        - "Is ISMS scope clearly defined?"
      expected_findings:
        - "Context understanding assessment"
        - "Scope definition status"

    - id: "2"
      name: "Assess leadership and commitment"
      description: |
        Review top management commitment, policy, and roles
        (Clauses 5.1-5.3).
      duration_estimate: "45 min"
      questions:
        - "Is there evidence of management commitment?"
        - "Is information security policy appropriate?"
        - "Are roles and responsibilities assigned?"
      expected_findings:
        - "Leadership commitment assessment"
        - "Policy evaluation"

    - id: "3"
      name: "Evaluate planning and risk management"
      description: |
        Review risk assessment, risk treatment, and security
        objectives (Clauses 6.1-6.3).
      duration_estimate: "90 min"
      expected_findings:
        - "Risk assessment adequacy"
        - "Risk treatment plan"
        - "SoA completeness"

    - id: "4"
      name: "Review support and operations"
      description: |
        Evaluate resources, competence, awareness, communication,
        and documented information (Clauses 7-8).
      duration_estimate: "90 min"
      expected_findings:
        - "Support function assessment"
        - "Operational planning status"

    - id: "5"
      name: "Assess performance evaluation"
      description: |
        Review monitoring, internal audit, and management review
        (Clause 9).
      duration_estimate: "60 min"
      expected_findings:
        - "Performance monitoring status"
        - "Audit program assessment"
        - "Management review evaluation"

    - id: "6"
      name: "Evaluate improvement"
      description: |
        Review nonconformity management and continual improvement
        (Clause 10).
      duration_estimate: "45 min"
      expected_findings:
        - "Corrective action process"
        - "Improvement activities"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "isms_assessment"
      format: "structured"
      sections:
        - "Context and Scope"
        - "Leadership"
        - "Planning"
        - "Support"
        - "Operations"
        - "Performance Evaluation"
        - "Improvement"
        - "Annex A Control Assessment"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Certification Readiness"
        - "Gap Analysis"
        - "Recommendations"

  confidence_guidance:
    high: "Full ISMS documentation reviewed and stakeholders interviewed"
    medium: "Key documentation reviewed, limited interviews"
    low: "Partial documentation access"

offline:
  capability: "partial"

  cache_manifest:
    knowledge:
      - source_id: "iso27001-2022"
        priority: "required"
      - source_id: "iso27002-2022"
        priority: "required"

profiles:
  membership:
    quick:
      included: false
      reason: "Requires comprehensive ISMS evaluation"
    full:
      included: true
      priority: 1

closeout_checklist:
  - id: "iso-001"
    item: "ISMS scope defined and documented"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Scope statement exists with boundaries"
    expected: "Confirmed by reviewer"

  - id: "iso-002"
    item: "Risk assessment completed with methodology"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Risk assessment current and comprehensive"
    expected: "Confirmed by reviewer"

  - id: "iso-003"
    item: "Statement of Applicability documented"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "SoA covers all Annex A controls with justifications"
    expected: "Confirmed by reviewer"

  - id: "iso-004"
    item: "Internal audit program operational"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Audit schedule and reports available"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["all"]

  compliance_frameworks:
    - framework: "ISO 27001"
      controls: ["Clauses 4-10", "Annex A"]
    - framework: "SOC 2"
      controls: ["Mapped to TSC"]

relationships:
  commonly_combined:
    - "compliance-legal.industry-standards.soc2-compliance"
    - "compliance-legal.industry-standards.nist-framework"
    - "compliance-legal.audit-trail.audit-log-completeness"
