# ============================================================
# AUDIT: NIST Framework Audit
# ============================================================
# Evaluates cybersecurity posture against NIST Cybersecurity
# Framework (CSF) and related NIST standards.

audit:
  id: "compliance-legal.industry-standards.nist-framework"

  name: "NIST Framework Audit"

  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "compliance-legal"
  category_number: 19
  subcategory: "industry-standards"

  tier: "expert"
  estimated_duration: "6-10 hours"  # median: 8h

  completeness: "requires_discovery"
  requires_runtime: true
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "organizational"

  default_profiles:
    - "full"
    - "security"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Comprehensive evaluation of cybersecurity practices against the NIST
    Cybersecurity Framework (CSF) 2.0 core functions: Govern, Identify,
    Protect, Detect, Respond, and Recover. Assesses current profile,
    target profile, and maturity across framework categories and
    subcategories. Maps to NIST SP 800-53 controls where applicable.

  why_it_matters: |
    NIST CSF is the most widely adopted cybersecurity framework in the US,
    used across critical infrastructure sectors and private industry.
    Executive Order 13800 requires federal agencies to use CSF. Framework
    provides common language for security discussions and enables risk-based
    decision making. Adoption demonstrates security maturity to customers
    and insurers.

  when_to_run:
    - "When establishing cybersecurity program"
    - "During annual security reviews"
    - "After significant security incidents"
    - "When developing security roadmaps"
    - "For vendor security assessments"

prerequisites:
  required_artifacts:
    - type: "security_documentation"
      description: "Security policies and procedures"
    - type: "asset_inventory"
      description: "Information asset inventory"
    - type: "risk_assessment"
      description: "Cybersecurity risk assessment"

  access_requirements:
    - "Security policies and procedures"
    - "Asset and data inventories"
    - "Risk assessment documentation"
    - "Incident response procedures"
    - "Business continuity plans"

discovery:
  code_patterns:
    - pattern: "(security|protect|detect|respond|recover)"
      type: "regex"
      scope: "source"
      purpose: "Find security implementations"
    - pattern: "(monitor|alert|incident|backup)"
      type: "regex"
      scope: "source"
      purpose: "Locate operational security"

  file_patterns:
    - glob: "**/security/**"
      purpose: "Find security implementations"
    - glob: "**/policies/**"
      purpose: "Locate policy documents"
    - glob: "**/incident/**"
      purpose: "Find incident response"

  documents_to_review:
    - type: "Security policies"
      purpose: "Evaluate governance"
    - type: "Asset inventory"
      purpose: "Assess identification"
    - type: "Incident response plan"
      purpose: "Review response capability"

  interviews:
    - role: "CISO/Security leadership"
      questions:
        - "What is the security governance structure?"
        - "How is security risk managed?"
        - "What is the target security profile?"
      purpose: "Understand security strategy"
    - role: "Security operations"
      questions:
        - "What detection capabilities exist?"
        - "How are incidents handled?"
        - "What is the recovery capability?"
      purpose: "Assess operational security"

knowledge_sources:
  specifications:
    - id: "nist-csf-2"
      name: "NIST Cybersecurity Framework 2.0"
      url: "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.29.pdf"
      offline_cache: true
      priority: "required"
    - id: "nist-800-53"
      name: "NIST SP 800-53 Rev 5"
      url: "https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf"
      offline_cache: true
      priority: "required"

  guides:
    - id: "csf-implementation"
      name: "Framework Implementation Guidance"
      url: "https://www.nist.gov/cyberframework/online-learning"
      offline_cache: true
    - id: "csf-profiles"
      name: "Framework Profiles and Tiers"
      url: "https://www.nist.gov/cyberframework/framework"
      offline_cache: true

tooling:
  assessment_tools:
    - tool: "NIST CSF assessment template"
      purpose: "Structured framework evaluation"
    - tool: "Maturity model assessment"
      purpose: "Evaluate implementation tiers"

signals:
  critical:
    - id: "NIST-CRIT-001"
      signal: "No asset inventory exists"
      evidence_indicators:
        - "Assets not identified"
        - "No data classification"
        - "Unknown system inventory"
      explanation: |
        CSF Identify function (ID.AM) requires asset management. Without
        knowing what assets exist, organization cannot protect them.
        Asset inventory is foundation of cybersecurity program.
      remediation: "Create comprehensive asset and data inventory"

    - id: "NIST-CRIT-002"
      signal: "No incident response capability"
      evidence_indicators:
        - "No incident response plan"
        - "No incident detection"
        - "No defined response procedures"
      explanation: |
        CSF Respond function (RS) requires incident management capability.
        Without response capability, incidents cause extended damage and
        violate regulatory notification requirements.
      remediation: "Develop incident response plan and procedures"

    - id: "NIST-CRIT-003"
      signal: "No risk assessment process"
      evidence_indicators:
        - "Risks not identified"
        - "No risk management strategy"
        - "Security not risk-based"
      explanation: |
        CSF Identify function (ID.RA) requires risk assessment. Risk-based
        approach is core framework principle. Without risk assessment,
        security investments are not prioritized appropriately.
      remediation: "Implement cybersecurity risk assessment process"

  high:
    - id: "NIST-HIGH-001"
      signal: "No security awareness program"
      explanation: "PR.AT requires awareness and training"
      remediation: "Implement security awareness training program"

    - id: "NIST-HIGH-002"
      signal: "No detection capabilities"
      explanation: "DE function requires anomaly and event detection"
      remediation: "Implement security monitoring and detection"

    - id: "NIST-HIGH-003"
      signal: "No recovery planning"
      explanation: "RC function requires recovery planning"
      remediation: "Develop recovery plans and procedures"

  medium:
    - id: "NIST-MED-001"
      signal: "Security governance informal"
      remediation: "Formalize cybersecurity governance (GV function)"

    - id: "NIST-MED-002"
      signal: "Supply chain risk not addressed"
      remediation: "Implement supply chain risk management (ID.SC)"

    - id: "NIST-MED-003"
      signal: "Communications plans incomplete"
      remediation: "Develop security communications plan"

  low:
    - id: "NIST-LOW-001"
      signal: "Framework profile not documented"
      remediation: "Document current and target CSF profiles"

  positive:
    - id: "NIST-POS-001"
      signal: "Comprehensive coverage across all CSF functions"
    - id: "NIST-POS-002"
      signal: "Risk-based security prioritization"
    - id: "NIST-POS-003"
      signal: "Continuous improvement program"

procedure:
  context:
    cognitive_mode: "evaluative"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Assess Govern function"
      description: |
        Evaluate cybersecurity governance including policies, risk
        management strategy, roles, and supply chain management.
      duration_estimate: "60 min"
      questions:
        - "Is there a cybersecurity governance structure?"
        - "Is there a risk management strategy?"
        - "Are roles and responsibilities defined?"
      expected_findings:
        - "Governance assessment"
        - "Policy framework status"

    - id: "2"
      name: "Assess Identify function"
      description: |
        Evaluate asset management, business environment understanding,
        governance, risk assessment, and risk management strategy.
      duration_estimate: "60 min"
      expected_findings:
        - "Asset management status"
        - "Risk assessment coverage"

    - id: "3"
      name: "Assess Protect function"
      description: |
        Evaluate access control, awareness and training, data security,
        information protection, maintenance, and protective technology.
      duration_estimate: "90 min"
      commands:
        - purpose: "Find protection implementations"
          command: "grep -r -E '(access|encrypt|protect|firewall)' --include='*.py' --include='*.ts' --include='*.yaml' ."
      expected_findings:
        - "Protection control status"
        - "Access control assessment"

    - id: "4"
      name: "Assess Detect function"
      description: |
        Evaluate anomalies and events detection, security continuous
        monitoring, and detection processes.
      duration_estimate: "60 min"
      expected_findings:
        - "Detection capability assessment"
        - "Monitoring coverage"

    - id: "5"
      name: "Assess Respond and Recover functions"
      description: |
        Evaluate response planning, communications, analysis, mitigation,
        improvements, recovery planning, and improvements.
      duration_estimate: "60 min"
      expected_findings:
        - "Response capability status"
        - "Recovery planning assessment"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "csf_assessment"
      format: "structured"
      sections:
        - "Govern (GV)"
        - "Identify (ID)"
        - "Protect (PR)"
        - "Detect (DE)"
        - "Respond (RS)"
        - "Recover (RC)"
        - "Current Profile"
        - "Target Profile"
        - "Gap Analysis"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Maturity Assessment"
        - "Recommendations"

  confidence_guidance:
    high: "All functions evaluated with documentation and interviews"
    medium: "Key functions evaluated"
    low: "Limited assessment scope"

offline:
  capability: "full"

  cache_manifest:
    knowledge:
      - source_id: "nist-csf-2"
        priority: "required"
      - source_id: "nist-800-53"
        priority: "recommended"

profiles:
  membership:
    quick:
      included: false
      reason: "Requires comprehensive function evaluation"
    full:
      included: true
      priority: 2

closeout_checklist:
  - id: "nist-001"
    item: "Asset inventory documented"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Comprehensive asset and data inventory exists"
    expected: "Confirmed by reviewer"

  - id: "nist-002"
    item: "Risk assessment completed"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Current cybersecurity risk assessment documented"
    expected: "Confirmed by reviewer"

  - id: "nist-003"
    item: "Incident response capability verified"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "IR plan exists and has been tested"
    expected: "Confirmed by reviewer"

  - id: "nist-004"
    item: "CSF profile documented"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Current and target profiles documented"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["all"]

  compliance_frameworks:
    - framework: "NIST CSF"
      controls: ["All functions and categories"]
    - framework: "NIST SP 800-53"
      controls: ["Mapped controls"]

relationships:
  commonly_combined:
    - "compliance-legal.industry-standards.iso27001-compliance"
    - "compliance-legal.industry-standards.soc2-compliance"
    - "compliance-legal.audit-trail.audit-log-completeness"
