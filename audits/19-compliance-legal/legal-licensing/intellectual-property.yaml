# ============================================================
# AUDIT: Intellectual Property Audit
# ============================================================
# Evaluates intellectual property management including ownership,
# protection, third-party IP, and infringement risk.

audit:
  id: "compliance-legal.legal-licensing.intellectual-property"

  name: "Intellectual Property Audit"

  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "compliance-legal"
  category_number: 19
  subcategory: "legal-licensing"

  tier: "expert"
  estimated_duration: "4-6 hours"  # median: 5h

  completeness: "requires_discovery"
  requires_runtime: false
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "organizational"

  default_profiles:
    - "full"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Evaluates intellectual property management including ownership of
    developed IP, employee/contractor IP assignments, third-party IP usage,
    patent and trademark considerations, and infringement risk. Reviews
    IP policies, agreements, and protection measures.

  why_it_matters: |
    Unclear IP ownership can jeopardize company valuation, investor
    relationships, and M&A transactions. Using third-party IP without
    proper rights exposes to infringement claims. Failure to protect
    proprietary IP allows competitors to copy innovations. IP issues
    are common blockers in due diligence.

  when_to_run:
    - "During M&A due diligence"
    - "Before funding rounds"
    - "When establishing new development practices"
    - "After engaging contractors for development"
    - "When concerned about competitive copying"

prerequisites:
  required_artifacts:
    - type: "ip_policy"
      description: "Intellectual property policy"
    - type: "employment_agreements"
      description: "Employee IP assignment agreements"
    - type: "contractor_agreements"
      description: "Contractor IP assignment agreements"

  access_requirements:
    - "IP policies and procedures"
    - "Employment and contractor agreements"
    - "Patent and trademark registrations"
    - "Third-party license agreements"

discovery:
  code_patterns:
    - pattern: "(copyright|patent|trademark|proprietary)"
      type: "regex"
      scope: "source"
      purpose: "Find IP notices"

  file_patterns:
    - glob: "**/LICENSE*"
      purpose: "Find license files"
    - glob: "**/*.patent"
      purpose: "Find patent documentation"

  documents_to_review:
    - type: "IP policy"
      purpose: "Evaluate IP governance"
    - type: "Employment agreements"
      purpose: "Verify IP assignment"
    - type: "Contractor agreements"
      purpose: "Verify work-for-hire"

  interviews:
    - role: "Legal/General Counsel"
      questions:
        - "What IP protection strategy exists?"
        - "Are all developer agreements in place?"
        - "What third-party IP is used?"
      purpose: "Understand IP management"

knowledge_sources:
  guides:
    - id: "ip-management"
      name: "IP Management Best Practices"
      url: "https://www.wipo.int/publications/en/"
      offline_cache: true

tooling:
  assessment_tools:
    - tool: "IP audit checklist"
      purpose: "Structured IP review"

signals:
  critical:
    - id: "IP-CRIT-001"
      signal: "Unclear ownership of core IP"
      evidence_indicators:
        - "No IP assignment from founders"
        - "Key code written before company formation"
        - "Missing contractor assignments"
      explanation: |
        Unclear IP ownership can void company value and block transactions.
        Investors and acquirers require clear IP chain of title. Disputes
        over ownership can result in injunctions and forced licensing.
      remediation: "Obtain clear IP assignments for all contributed work"

    - id: "IP-CRIT-002"
      signal: "Using third-party IP without rights"
      evidence_indicators:
        - "Copied code without license"
        - "Using patented technology without license"
        - "Trademark infringement"
      explanation: |
        Using IP without proper rights exposes to infringement claims,
        injunctions, and damages. Patent trolls actively target successful
        companies.
      remediation: "Obtain proper licenses or remove infringing content"

    - id: "IP-CRIT-003"
      signal: "Employee IP agreements missing"
      evidence_indicators:
        - "No IP assignment in employment agreement"
        - "Agreements not signed"
        - "Contractor agreements without work-for-hire"
      explanation: |
        Without IP assignment, employees may own what they create.
        California law specifically limits employer claims. Proper
        agreements essential for clear ownership.
      remediation: "Execute IP assignment agreements with all developers"

  high:
    - id: "IP-HIGH-001"
      signal: "No IP protection strategy"
      explanation: "Failing to protect IP allows copying by competitors"
      remediation: "Develop IP protection strategy (patents, trade secrets)"

    - id: "IP-HIGH-002"
      signal: "Trade secrets not protected"
      explanation: "Valuable information requires protective measures"
      remediation: "Implement trade secret protection program"

  medium:
    - id: "IP-MED-001"
      signal: "IP policy not documented"
      remediation: "Create formal IP policy"

    - id: "IP-MED-002"
      signal: "Third-party IP not tracked"
      remediation: "Inventory all third-party IP usage"

  low:
    - id: "IP-LOW-001"
      signal: "IP inventory not maintained"
      remediation: "Create and maintain IP asset inventory"

  positive:
    - id: "IP-POS-001"
      signal: "Clear IP assignment chain from all developers"
    - id: "IP-POS-002"
      signal: "Comprehensive IP protection strategy"
    - id: "IP-POS-003"
      signal: "Regular IP portfolio review"

procedure:
  context:
    cognitive_mode: "critical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Review IP ownership"
      description: |
        Verify ownership chain for all key intellectual property
        including assignments from founders, employees, and contractors.
      duration_estimate: "60 min"
      questions:
        - "Are founder IP assignments in place?"
        - "Do all employees have IP agreements?"
        - "Are contractor agreements work-for-hire?"
      expected_findings:
        - "Ownership chain assessment"
        - "Assignment gaps"

    - id: "2"
      name: "Inventory IP assets"
      description: |
        Create inventory of intellectual property assets including
        patents, trademarks, copyrights, and trade secrets.
      duration_estimate: "45 min"
      expected_findings:
        - "IP asset inventory"
        - "Registration status"

    - id: "3"
      name: "Assess third-party IP"
      description: |
        Review usage of third-party intellectual property including
        licensed technology and potential infringement.
      duration_estimate: "60 min"
      expected_findings:
        - "Third-party IP inventory"
        - "License compliance"

    - id: "4"
      name: "Evaluate protection measures"
      description: |
        Review measures for protecting proprietary IP including
        trade secret programs and registration strategy.
      duration_estimate: "45 min"
      expected_findings:
        - "Protection assessment"
        - "Gaps in protection"

    - id: "5"
      name: "Assess infringement risk"
      description: |
        Evaluate risk of third-party claims including freedom to
        operate analysis for key technologies.
      duration_estimate: "45 min"
      expected_findings:
        - "Infringement risk assessment"
        - "Freedom to operate status"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "ip_assessment"
      format: "structured"
      sections:
        - "Ownership Analysis"
        - "IP Asset Inventory"
        - "Third-Party IP Review"
        - "Protection Assessment"
        - "Risk Analysis"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Ownership Status"
        - "Recommendations"

  confidence_guidance:
    high: "Full documentation reviewed with legal confirmation"
    medium: "Key agreements reviewed"
    low: "Limited documentation access"

offline:
  capability: "full"

  cache_manifest:
    knowledge:
      - source_id: "ip-management"
        priority: "recommended"

profiles:
  membership:
    quick:
      included: false
      reason: "Requires thorough IP review"
    full:
      included: true
      priority: 1

closeout_checklist:
  - id: "ip-001"
    item: "IP ownership chain verified"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Assignments from all contributors"
    expected: "Confirmed by reviewer"

  - id: "ip-002"
    item: "Employee/contractor agreements in place"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "All developers under IP agreement"
    expected: "Confirmed by reviewer"

  - id: "ip-003"
    item: "Third-party IP properly licensed"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "All third-party IP has proper rights"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["all"]

  compliance_frameworks:
    - framework: "Due diligence"
      controls: ["IP verification"]

relationships:
  commonly_combined:
    - "compliance-legal.legal-licensing.open-source-license-compliance"
    - "compliance-legal.legal-licensing.software-license-management"
