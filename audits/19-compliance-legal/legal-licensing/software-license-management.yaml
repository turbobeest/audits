# ============================================================
# AUDIT: Software License Management Audit
# ============================================================
# Evaluates management of commercial software licenses including
# procurement, compliance, tracking, and optimization.

audit:
  id: "compliance-legal.legal-licensing.software-license-management"

  name: "Software License Management Audit"

  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "compliance-legal"
  category_number: 19
  subcategory: "legal-licensing"

  tier: "expert"
  estimated_duration: "4-6 hours"  # median: 5h

  completeness: "requires_discovery"
  requires_runtime: true
  destructive: false

execution:
  automatable: "partial"
  severity: "medium"
  scope: "organizational"

  default_profiles:
    - "full"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Evaluates commercial software license management including license
    inventory, entitlement tracking, compliance monitoring, renewal
    management, and cost optimization. Reviews license procurement
    processes, usage tracking, and audit readiness for major vendors
    (Microsoft, Oracle, SAP, etc.).

  why_it_matters: |
    Software license non-compliance exposes organizations to vendor audits,
    true-up costs, and legal action. Major vendors actively audit customers
    with significant financial penalties for under-licensing. Over-licensing
    wastes significant budget. Effective license management ensures
    compliance while optimizing costs.

  when_to_run:
    - "Before vendor license audits"
    - "During annual budget planning"
    - "When renewing enterprise agreements"
    - "After acquisitions or reorganizations"
    - "When deploying new software"

prerequisites:
  required_artifacts:
    - type: "license_inventory"
      description: "Software license inventory"
    - type: "license_agreements"
      description: "License agreements and contracts"
    - type: "usage_data"
      description: "Software deployment and usage data"

  access_requirements:
    - "License management system"
    - "Software asset inventory"
    - "Deployment configurations"
    - "Procurement records"
    - "Vendor portal access"

discovery:
  file_patterns:
    - glob: "**/licenses/**"
      purpose: "Find license documentation"

  documents_to_review:
    - type: "License agreements"
      purpose: "Understand entitlements"
    - type: "Asset inventory"
      purpose: "Compare to entitlements"
    - type: "Usage reports"
      purpose: "Verify compliance"

  interviews:
    - role: "IT Asset Management"
      questions:
        - "How are licenses tracked?"
        - "What is the license position for major vendors?"
        - "When were licenses last reconciled?"
      purpose: "Understand license management"
    - role: "Procurement"
      questions:
        - "How are licenses procured?"
        - "When are renewals due?"
        - "What optimization opportunities exist?"
      purpose: "Assess procurement process"

knowledge_sources:
  guides:
    - id: "sam-best-practices"
      name: "Software Asset Management Best Practices"
      url: "https://www.iso.org/standard/68531.html"
      offline_cache: true
    - id: "microsoft-licensing"
      name: "Microsoft Licensing Guides"
      url: "https://www.microsoft.com/licensing"
      offline_cache: true

tooling:
  assessment_tools:
    - tool: "License compliance checklist"
      purpose: "Structured license review"
    - tool: "SAM tools"
      purpose: "Software asset management"

signals:
  critical:
    - id: "SLM-CRIT-001"
      signal: "Software deployed without valid licenses"
      evidence_indicators:
        - "Usage exceeds entitlements"
        - "Unlicensed software installed"
        - "License expired for production software"
      explanation: |
        Using software without valid licenses violates vendor agreements
        and copyright law. Vendor audits discover violations with true-up
        costs plus penalties, often millions of dollars for enterprise software.
      remediation: "Acquire additional licenses or remove unauthorized software"

    - id: "SLM-CRIT-002"
      signal: "No license inventory maintained"
      evidence_indicators:
        - "No license tracking system"
        - "Cannot report license position"
        - "Unknown license compliance status"
      explanation: |
        Without license inventory, compliance status is unknown. Cannot
        respond to vendor audits or demonstrate compliance. Exposes
        organization to significant audit risk.
      remediation: "Implement comprehensive license inventory and tracking"

  high:
    - id: "SLM-HIGH-001"
      signal: "License usage not monitored"
      explanation: "Cannot detect compliance drift without monitoring"
      remediation: "Implement license usage monitoring"

    - id: "SLM-HIGH-002"
      signal: "License renewals not tracked"
      explanation: "Risk of expired licenses or auto-renewal surprises"
      remediation: "Implement renewal tracking and calendar"

  medium:
    - id: "SLM-MED-001"
      signal: "Significant over-licensing"
      remediation: "Optimize licenses to reduce costs"

    - id: "SLM-MED-002"
      signal: "License agreements not centrally managed"
      remediation: "Centralize license agreement management"

  low:
    - id: "SLM-LOW-001"
      signal: "No license optimization review"
      remediation: "Conduct annual license optimization review"

  positive:
    - id: "SLM-POS-001"
      signal: "Comprehensive license management system"
    - id: "SLM-POS-002"
      signal: "Automated usage tracking and compliance monitoring"
    - id: "SLM-POS-003"
      signal: "Regular optimization reviews reducing costs"

procedure:
  context:
    cognitive_mode: "evaluative"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Inventory licenses"
      description: |
        Create or verify comprehensive inventory of all commercial
        software licenses and entitlements.
      duration_estimate: "60 min"
      questions:
        - "What commercial software is licensed?"
        - "What are the entitlement terms?"
        - "Where are license records maintained?"
      expected_findings:
        - "License inventory"
        - "Entitlement documentation"

    - id: "2"
      name: "Assess deployment"
      description: |
        Review software deployments and usage against license
        entitlements.
      duration_estimate: "60 min"
      expected_findings:
        - "Deployment inventory"
        - "Usage statistics"

    - id: "3"
      name: "Compare entitlements to usage"
      description: |
        Reconcile license entitlements against actual deployments
        to identify compliance gaps.
      duration_estimate: "60 min"
      expected_findings:
        - "Compliance status"
        - "Gap identification"

    - id: "4"
      name: "Review license management processes"
      description: |
        Evaluate processes for procurement, deployment, tracking,
        and renewal.
      duration_estimate: "45 min"
      expected_findings:
        - "Process assessment"
        - "Control gaps"

    - id: "5"
      name: "Identify optimization opportunities"
      description: |
        Review license position for cost optimization including
        over-licensing and license harvesting.
      duration_estimate: "30 min"
      expected_findings:
        - "Optimization opportunities"
        - "Cost savings potential"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "license_assessment"
      format: "structured"
      sections:
        - "License Inventory"
        - "Deployment Analysis"
        - "Compliance Status"
        - "Process Review"
        - "Optimization Opportunities"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Compliance Status"
        - "Recommendations"

  confidence_guidance:
    high: "Complete inventory with verified usage data"
    medium: "Key vendor licenses reviewed"
    low: "Limited inventory visibility"

offline:
  capability: "partial"

  cache_manifest:
    knowledge:
      - source_id: "sam-best-practices"
        priority: "required"

profiles:
  membership:
    quick:
      included: false
      reason: "Requires thorough license review"
    full:
      included: true
      priority: 2

closeout_checklist:
  - id: "slm-001"
    item: "License inventory documented"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Complete inventory of commercial licenses"
    expected: "Confirmed by reviewer"

  - id: "slm-002"
    item: "License compliance verified"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Usage within entitlements"
    expected: "Confirmed by reviewer"

  - id: "slm-003"
    item: "License tracking process operational"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "System for ongoing tracking exists"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["all"]

  compliance_frameworks:
    - framework: "ISO 19770"
      controls: ["Software Asset Management"]

relationships:
  commonly_combined:
    - "compliance-legal.legal-licensing.open-source-license-compliance"
    - "compliance-legal.audit-trail.audit-log-completeness"
