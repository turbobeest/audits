# ============================================================
# AUDIT: Legal Hold Capability Audit
# ============================================================
# Evaluates capability to preserve data and documents when
# litigation or regulatory investigation is anticipated.

audit:
  id: "compliance-legal.legal-licensing.legal-hold-capability"

  name: "Legal Hold Capability Audit"

  version: "1.0.0"
  last_updated: "2026-01-19"
  status: "active"

  category: "compliance-legal"
  category_number: 19
  subcategory: "legal-licensing"

  tier: "expert"
  estimated_duration: "4-6 hours"  # median: 5h

  completeness: "requires_discovery"
  requires_runtime: true
  destructive: false

execution:
  automatable: "partial"
  severity: "high"
  scope: "organizational"

  default_profiles:
    - "full"

  blocks_phase: false
  parallelizable: true

description:
  what: |
    Evaluates organizational capability to implement and manage legal holds
    for litigation, regulatory investigation, or audit. Reviews preservation
    processes, technical hold mechanisms, custodian management, documentation,
    and ability to suspend routine deletion. Assesses compliance with
    e-discovery obligations.

  why_it_matters: |
    Failure to preserve relevant data when litigation is reasonably anticipated
    constitutes spoliation, resulting in severe sanctions including adverse
    inference instructions, monetary penalties, and case dismissal. Courts
    increasingly hold organizations to strict preservation standards.
    Inadequate legal hold capability exposes organization to catastrophic
    litigation consequences.

  when_to_run:
    - "When establishing legal hold processes"
    - "As part of litigation readiness assessment"
    - "After data management changes"
    - "During e-discovery preparation"
    - "When anticipating litigation or investigation"

prerequisites:
  required_artifacts:
    - type: "legal_hold_policy"
      description: "Legal hold policy and procedures"
    - type: "data_map"
      description: "Data sources and custodian mapping"
    - type: "retention_policy"
      description: "Data retention policies that may need suspension"

  access_requirements:
    - "Legal hold policy documentation"
    - "Data management systems"
    - "Retention and deletion configurations"
    - "E-discovery or hold management tools"
    - "Legal and IT teams"

discovery:
  code_patterns:
    - pattern: "(legal.?hold|preserve|litigation|suspend.?delet)"
      type: "regex"
      scope: "source"
      purpose: "Find legal hold implementations"
    - pattern: "(retention|delete|purge|archive)"
      type: "regex"
      scope: "source"
      purpose: "Find data lifecycle code"

  file_patterns:
    - glob: "**/legal/**"
      purpose: "Find legal documentation"
    - glob: "**/retention/**"
      purpose: "Find retention configurations"

  documents_to_review:
    - type: "Legal hold policy"
      purpose: "Evaluate preservation process"
    - type: "Data map"
      purpose: "Understand data sources"
    - type: "Hold notices"
      purpose: "Review notification process"

  interviews:
    - role: "Legal/General Counsel"
      questions:
        - "How are legal holds triggered?"
        - "How is preservation verified?"
        - "What documentation is maintained?"
      purpose: "Understand hold process"
    - role: "IT/Data management"
      questions:
        - "Can deletion be suspended per-custodian?"
        - "What systems require hold configuration?"
        - "How is hold coverage verified?"
      purpose: "Assess technical capability"

knowledge_sources:
  specifications:
    - id: "frcp-ediscovery"
      name: "Federal Rules of Civil Procedure - E-Discovery"
      url: "https://www.uscourts.gov/rules-policies/current-rules-practice-procedure/federal-rules-civil-procedure"
      offline_cache: true
      priority: "required"
    - id: "sedona-principles"
      name: "The Sedona Principles on E-Discovery"
      url: "https://thesedonaconference.org/publication/The_Sedona_Principles"
      offline_cache: true
      priority: "required"

  guides:
    - id: "edrm"
      name: "Electronic Discovery Reference Model"
      url: "https://edrm.net/frameworks-and-standards/edrm-model/"
      offline_cache: true

tooling:
  assessment_tools:
    - tool: "Legal hold readiness checklist"
      purpose: "Structured capability assessment"

signals:
  critical:
    - id: "LH-CRIT-001"
      signal: "No legal hold capability"
      evidence_indicators:
        - "Cannot suspend automated deletion"
        - "No hold process documented"
        - "No custodian preservation mechanism"
      explanation: |
        Without legal hold capability, organization cannot meet preservation
        obligations when litigation is anticipated. Spoliation sanctions
        can be case-determinative and include adverse inferences.
      remediation: "Implement legal hold capability immediately"

    - id: "LH-CRIT-002"
      signal: "Hold does not cover all relevant data sources"
      evidence_indicators:
        - "Some systems not included in hold"
        - "Cloud data not preserved"
        - "Mobile devices excluded"
      explanation: |
        Preservation duty extends to all reasonably accessible relevant
        data. Partial holds constitute spoliation for data that should
        have been preserved.
      remediation: "Extend hold capability to all data sources"

    - id: "LH-CRIT-003"
      signal: "Automated deletion continues despite hold"
      evidence_indicators:
        - "Retention policies not suspendable"
        - "Data deleted after hold issued"
        - "Technical inability to pause deletion"
      explanation: |
        Routine deletion must stop when hold is issued. Continuing
        deletion after hold awareness is willful spoliation with
        severe sanctions.
      remediation: "Implement technical ability to suspend all deletion"

  high:
    - id: "LH-HIGH-001"
      signal: "No custodian notification process"
      explanation: "Custodians must be notified and acknowledge hold"
      remediation: "Implement custodian notification and acknowledgment"

    - id: "LH-HIGH-002"
      signal: "Hold not documented"
      explanation: "Must demonstrate hold scope and implementation"
      remediation: "Document all hold implementations"

  medium:
    - id: "LH-MED-001"
      signal: "Hold release process not defined"
      remediation: "Document hold release procedures"

    - id: "LH-MED-002"
      signal: "Data map not current"
      remediation: "Update data source inventory"

  low:
    - id: "LH-LOW-001"
      signal: "No hold metrics tracking"
      remediation: "Track hold statistics and compliance"

  positive:
    - id: "LH-POS-001"
      signal: "Automated legal hold with custodian tracking"
    - id: "LH-POS-002"
      signal: "Verified suspension across all data sources"
    - id: "LH-POS-003"
      signal: "Regular hold capability testing"

procedure:
  context:
    cognitive_mode: "critical"
    ensemble_role: "auditor"

  steps:
    - id: "1"
      name: "Review legal hold policy"
      description: |
        Evaluate documented legal hold policy including triggers,
        process, and responsibilities.
      duration_estimate: "45 min"
      questions:
        - "Is there a formal hold policy?"
        - "What triggers a hold?"
        - "Who has authority to issue holds?"
        - "What is the implementation process?"
      expected_findings:
        - "Policy assessment"
        - "Process documentation"

    - id: "2"
      name: "Map data sources"
      description: |
        Verify understanding of all data sources that may be subject
        to preservation including on-premise, cloud, and devices.
      duration_estimate: "60 min"
      expected_findings:
        - "Data source inventory"
        - "Coverage assessment"

    - id: "3"
      name: "Assess technical capability"
      description: |
        Evaluate technical ability to suspend deletion and preserve
        data across all identified sources.
      duration_estimate: "60 min"
      commands:
        - purpose: "Find retention and deletion code"
          command: "grep -r -E '(retention|delete|purge|archive)' --include='*.py' --include='*.ts' --include='*.yaml' . | head -30"
      expected_findings:
        - "Technical capability status"
        - "System-by-system assessment"

    - id: "4"
      name: "Review custodian management"
      description: |
        Evaluate process for identifying, notifying, and tracking
        custodian compliance with holds.
      duration_estimate: "45 min"
      expected_findings:
        - "Custodian process assessment"
        - "Notification mechanism"

    - id: "5"
      name: "Test hold implementation"
      description: |
        If possible, test legal hold implementation to verify
        preservation across systems.
      duration_estimate: "45 min"
      expected_findings:
        - "Implementation verification"
        - "Gap identification"

output:
  deliverables:
    - type: "finding_list"
      format: "structured"

    - type: "hold_capability_assessment"
      format: "structured"
      sections:
        - "Policy Review"
        - "Data Source Mapping"
        - "Technical Capability"
        - "Custodian Management"
        - "Implementation Testing"

    - type: "summary"
      format: "prose"
      sections:
        - "Executive Summary"
        - "Capability Status"
        - "Recommendations"

  confidence_guidance:
    high: "Full capability tested and verified"
    medium: "Documentation and configuration reviewed"
    low: "Limited access to systems"

offline:
  capability: "partial"

  cache_manifest:
    knowledge:
      - source_id: "frcp-ediscovery"
        priority: "required"
      - source_id: "sedona-principles"
        priority: "recommended"

profiles:
  membership:
    quick:
      included: false
      reason: "Requires thorough capability assessment"
    full:
      included: true
      priority: 1

closeout_checklist:
  - id: "lh-001"
    item: "Legal hold policy documented"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Formal hold process exists"
    expected: "Confirmed by reviewer"

  - id: "lh-002"
    item: "Can suspend deletion across all data sources"
    level: "CRITICAL"
    verification: "manual"
    verification_notes: "Technical capability verified"
    expected: "Confirmed by reviewer"

  - id: "lh-003"
    item: "Custodian notification mechanism exists"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Can notify and track custodians"
    expected: "Confirmed by reviewer"

  - id: "lh-004"
    item: "Hold capability tested"
    level: "BLOCKING"
    verification: "manual"
    verification_notes: "Implementation verified through testing"
    expected: "Confirmed by reviewer"

governance:
  applicable_to:
    archetypes: ["all"]

  compliance_frameworks:
    - framework: "FRCP"
      controls: ["Rules 26, 37"]
    - framework: "Sedona Principles"
      controls: ["E-discovery obligations"]

relationships:
  commonly_combined:
    - "compliance-legal.data-protection.data-retention-compliance"
    - "compliance-legal.audit-trail.audit-log-retention"
