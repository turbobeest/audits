audit:
  id: compliance-legal.financial-reporting.sox-compliance
  name: SOX Compliance Audit
  version: 1.0.0
  last_updated: '2026-01-19'
  status: active
  category: compliance-legal
  category_number: 19
  subcategory: financial-reporting
  tier: phd
  estimated_duration: 6-10 hours  # median: 8h
  completeness: requires_discovery
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: critical
  scope: process
  default_profiles:
  - full
  - security
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates Sarbanes-Oxley Act compliance for IT systems that support
    financial reporting, including:
    - Internal control over financial reporting (ICFR)
    - Access controls for financial systems
    - Audit trail completeness and integrity
    - Change management for financial applications
    - Data integrity controls
    - Segregation of duties enforcement
    - Management assessment and certification readiness
    - External auditor requirements alignment
  why_it_matters: |
    SOX compliance is mandatory for publicly traded companies in the US.
    Section 404 requires management to assess and report on internal
    controls over financial reporting. Non-compliance can result in:
    - Material weakness disclosures affecting stock price
    - Personal liability for executives (CEO/CFO certification)
    - SEC enforcement actions and penalties
    - Loss of investor confidence
    - Restatement of financial statements
    - Criminal penalties for willful violations
    IT controls are foundational to financial reporting integrity.
  when_to_run:
  - During annual SOX compliance assessment
  - When implementing new financial systems
  - After significant IT changes affecting financial applications
  - During pre-IPO preparation
prerequisites:
  required_artifacts:
  - type: sox_controls_matrix
    description: IT General Controls (ITGC) documentation
  - type: financial_systems_inventory
    description: List of systems in scope for SOX
  - type: access_control_documentation
    description: Access management policies and procedures
  access_requirements:
  - Financial system access logs
  - Change management records
  - User access review documentation
  - Control testing evidence
discovery:
  code_patterns:
  - pattern: (financial|accounting|ledger|journal|transaction)
    type: regex
    scope: source
    purpose: Identify financial processing code
  - pattern: (audit.?log|audit.?trail|log.?entry)
    type: regex
    scope: source
    purpose: Find audit logging implementations
  - pattern: (approval|authorize|sign.?off)
    type: regex
    scope: source
    purpose: Locate approval workflow code
  file_patterns:
  - glob: '**/finance/**'
    purpose: Financial module code
  - glob: '**/accounting/**'
    purpose: Accounting system code
  - glob: '**/audit/**'
    purpose: Audit trail implementations
  documents_to_review:
  - type: ITGC matrix
    purpose: Understand control framework
  - type: Access control policy
    purpose: Review access management requirements
  - type: Change management policy
    purpose: Assess change control procedures
  - type: Previous SOX audit findings
    purpose: Understand remediation status
  interviews:
  - role: IT Controls Owner
    questions:
    - What IT systems are in scope for SOX?
    - How are ITGCs documented and tested?
    - What control gaps exist currently?
    purpose: Understand control environment
  - role: Financial Systems Admin
    questions:
    - How is privileged access managed?
    - What audit logging is in place?
    - How are changes deployed to production?
    purpose: Assess operational controls
  - role: Internal Audit
    questions:
    - What deficiencies were found in prior testing?
    - How are control exceptions tracked?
    - What is the testing schedule?
    purpose: Understand audit history
knowledge_sources:
  specifications:
  - id: sox-404
    name: SOX Section 404 - Management Assessment
    url: https://www.sec.gov/rules/final/33-8238.htm
    offline_cache: true
    priority: required
  - id: pcaob-as5
    name: PCAOB AS 2201 - Audit of ICFR
    url: https://pcaobus.org/oversight/standards/auditing-standards/details/AS2201
    offline_cache: true
    priority: required
  guides:
  - id: coso-icfr
    name: COSO Internal Control Framework
    url: https://www.coso.org/pages/ic.aspx
    offline_cache: true
  - id: isaca-itgc
    name: ISACA IT General Controls Guide
    url: https://www.isaca.org/
    offline_cache: true
tooling:
  assessment_tools:
  - tool: SOX ITGC Assessment Checklist
    purpose: Structured evaluation of IT controls
  - tool: Access Review Template
    purpose: Document user access assessments
  scripts:
  - id: find-audit-logs
    language: bash
    purpose: Locate audit logging implementations
    source: inline
    code: |
      #!/bin/bash
      echo "=== Audit Log Implementations ==="
      grep -r -E "(audit.?log|audit.?trail|write.?audit)" \
        --include="*.py" --include="*.java" --include="*.ts" . 2>/dev/null

      echo "=== Financial Transaction Logging ==="
      grep -r -E "(transaction.?log|journal.?entry)" \
        --include="*.py" --include="*.java" . 2>/dev/null
signals:
  critical:
  - id: SOX-CRIT-001
    signal: No audit trail for financial transactions
    evidence_indicators:
    - Financial records can be modified without logging
    - Audit logs can be tampered with or deleted
    - No record of who made changes
    explanation: |
      SOX requires complete audit trails for financial data. Missing
      or incomplete audit trails constitute a material weakness that
      must be disclosed and can result in qualified audit opinions.
    remediation: Implement immutable audit logging for all financial transactions
  - id: SOX-CRIT-002
    signal: Shared administrative accounts for financial systems
    evidence_indicators:
    - Generic admin accounts used by multiple people
    - No individual accountability for privileged actions
    - Root/admin passwords shared among team
    explanation: |
      Individual accountability is fundamental to SOX controls. Shared
      accounts prevent audit trail attribution and enable fraud.
    remediation: Implement individual accounts with privileged access management
  - id: SOX-CRIT-003
    signal: No change management for financial applications
    evidence_indicators:
    - Direct production changes without approval
    - No separation between development and production
    - Undocumented system changes
    explanation: |
      Change management controls ensure only authorized, tested changes
      affect financial systems. Uncontrolled changes risk data integrity.
    remediation: Implement formal change management with segregation of duties
  high:
  - id: SOX-HIGH-001
    signal: Access reviews not performed or documented
    explanation: Regular access reviews ensure only authorized users have access
    remediation: Implement quarterly access reviews with documented certification
  - id: SOX-HIGH-002
    signal: Insufficient segregation of duties
    explanation: SOD prevents single individuals from controlling entire processes
    remediation: Implement role-based access with incompatible duty separation
  - id: SOX-HIGH-003
    signal: Terminated user access not promptly revoked
    explanation: Active accounts for departed employees enable unauthorized access
    remediation: Implement automated deprovisioning tied to HR termination
  medium:
  - id: SOX-MED-001
    signal: Control documentation incomplete or outdated
    remediation: Update ITGC documentation to reflect current processes
  - id: SOX-MED-002
    signal: Control testing evidence not retained
    remediation: Implement evidence retention for audit period
  low:
  - id: SOX-LOW-001
    signal: Control descriptions use inconsistent terminology
  positive:
  - id: SOX-POS-001
    signal: Comprehensive ITGC framework documented and tested
  - id: SOX-POS-002
    signal: Automated controls with continuous monitoring
procedure:
  context:
    cognitive_mode: critical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Identify SOX Scope
    description: |
      Determine which IT systems and applications are in scope
      for SOX compliance based on financial reporting impact.
    duration_estimate: 60 min
    questions:
    - What systems process or store financial data?
    - Which applications generate financial reports?
    - What interfaces exist between financial systems?
    expected_findings:
    - SOX scope inventory
    - System criticality assessment
    - Interface mapping
  - id: '2'
    name: Access Control Assessment
    description: |
      Evaluate access controls for financial systems including
      provisioning, review, and deprovisioning processes.
    duration_estimate: 90 min
    commands:
    - purpose: Find access control code
      command: grep -r -E '(role|permission|access|authorize)' --include='*.py' --include='*.java' . |
        head -30
    questions:
    - How is access provisioned and approved?
    - Are access reviews performed and documented?
    - How quickly is terminated access revoked?
    expected_findings:
    - Access control effectiveness
    - Review process adequacy
    - Deprovisioning timeliness
  - id: '3'
    name: Change Management Review
    description: |
      Assess change management controls for financial applications
      including approval, testing, and deployment processes.
    duration_estimate: 60 min
    questions:
    - Is there separation of development and production?
    - Are changes approved before production deployment?
    - Is testing documented before release?
    expected_findings:
    - Change control effectiveness
    - Segregation of duties compliance
    - Documentation adequacy
  - id: '4'
    name: Audit Trail Verification
    description: |
      Verify audit logging completeness, integrity protection,
      and retention for financial transactions.
    duration_estimate: 60 min
    commands:
    - purpose: Find audit logging implementations
      command: grep -r -E '(audit|log|track).*write' --include='*.py' --include='*.java' . | head -20
    expected_findings:
    - Audit trail completeness
    - Log integrity controls
    - Retention compliance
  - id: '5'
    name: Control Testing Assessment
    description: |
      Review control testing methodology, evidence, and
      deficiency tracking processes.
    duration_estimate: 45 min
    questions:
    - How frequently are controls tested?
    - Is testing evidence retained?
    - How are deficiencies tracked and remediated?
    expected_findings:
    - Testing coverage
    - Evidence retention
    - Remediation tracking
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: sox_assessment
    format: structured
    sections:
    - Scope and Materiality
    - Access Control Assessment
    - Change Management Assessment
    - Audit Trail Assessment
    - Control Testing Review
    - Deficiency Classification
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Key Findings
    - Material Weakness Assessment
    - Recommendations
  confidence_guidance:
    high: Complete control testing with evidence review
    medium: Design review with sample testing
    low: Documentation review without operational testing
offline:
  capability: partial
  cache_manifest:
    knowledge:
    - source_id: sox-404
      priority: required
    - source_id: pcaob-as5
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Requires comprehensive control assessment
    full:
      included: true
      priority: 1
closeout_checklist:
- id: sox-001
  item: SOX scope documented
  level: CRITICAL
  verification: manual
  verification_notes: Confirm all in-scope systems identified
  expected: Confirmed by reviewer
- id: sox-002
  item: Access controls assessed
  level: CRITICAL
  verification: manual
  verification_notes: Verify access review and provisioning evaluated
  expected: Confirmed by reviewer
- id: sox-003
  item: Change management evaluated
  level: CRITICAL
  verification: manual
  verification_notes: Confirm change control assessment complete
  expected: Confirmed by reviewer
- id: sox-004
  item: Audit trails verified
  level: CRITICAL
  verification: manual
  verification_notes: Verify audit logging completeness assessed
  expected: Confirmed by reviewer
- id: sox-005
  item: Deficiency classification completed
  level: BLOCKING
  verification: manual
  verification_notes: Confirm findings classified as deficiency/significant deficiency/material weakness
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - public-company
    - pre-ipo
    - financial-services
  compliance_frameworks:
  - framework: SOX
    controls:
    - Section 302
    - Section 404
    - Section 802
  - framework: PCAOB
    controls:
    - AS 2201
  - framework: COSO
    controls:
    - Internal Control Framework
relationships:
  commonly_combined:
  - compliance-legal.financial-reporting.segregation-of-duties
  - compliance-legal.financial-reporting.audit-readiness
  - compliance-legal.risk-control.control-effectiveness
