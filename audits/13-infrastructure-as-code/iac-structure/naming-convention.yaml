audit:
  id: infrastructure-as-code.iac-structure.naming-convention
  name: IaC Naming Convention
  version: 1.0.0
  last_updated: '2026-01-19'
  status: active
  category: infrastructure-as-code
  category_number: 13
  subcategory: iac-structure
  tier: expert
  estimated_duration: 1.5 hours
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: infrastructure
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit evaluates naming conventions used in Infrastructure as Code
    for resources, modules, variables, outputs, and files. It verifies
    consistency, clarity, and adherence to established standards.

    Key areas examined:
    - Resource naming patterns and cloud provider conventions
    - Variable and output naming consistency
    - File and directory naming standards
    - Module naming and versioning conventions
    - Tag naming strategies
    - Environment and region identifiers
  why_it_matters: |
    Consistent naming conventions are essential for:
    - Discoverability: Resources can be found easily in cloud consoles
    - Automation: Scripts and tools can parse resource names reliably
    - Cost allocation: Tags enable accurate cost attribution
    - Compliance: Audit trails require identifiable resources
    - Collaboration: Team members understand code without context
    - Incident response: Quick identification of affected resources

    Poor naming leads to confusion, incorrect resource targeting,
    billing attribution errors, and security blind spots.
  when_to_run:
  - During code reviews for new infrastructure
  - When establishing organizational IaC standards
  - Before migration or consolidation projects
  - During infrastructure audits
prerequisites:
  required_artifacts:
  - type: iac_repository
    description: Access to infrastructure code repositories
  - type: naming_standards
    description: Organizational naming convention documentation (if exists)
  access_requirements:
  - Read access to IaC repositories
  - Access to naming convention documentation
discovery:
  code_patterns:
  - pattern: resource\s+"[^"]+"\s+"([^"]+)"
    type: regex
    scope: config
    purpose: Extract Terraform resource names
  - pattern: name\s*=\s*"([^"]+)"
    type: regex
    scope: config
    purpose: Extract cloud resource names
  - pattern: variable\s+"([^"]+)"
    type: regex
    scope: config
    purpose: Extract variable names
  - pattern: output\s+"([^"]+)"
    type: regex
    scope: config
    purpose: Extract output names
  - pattern: tags\s*=\s*\{[^}]+\}
    type: regex
    scope: config
    purpose: Extract tag definitions
  file_patterns:
  - glob: '**/*.tf'
    purpose: Terraform configuration files
  - glob: '**/variables.tf'
    purpose: Variable definition files
  - glob: '**/outputs.tf'
    purpose: Output definition files
knowledge_sources:
  guides:
  - id: aws-tagging
    name: AWS Tagging Best Practices
    url: https://docs.aws.amazon.com/general/latest/gr/aws_tagging.html
    offline_cache: true
  - id: azure-naming
    name: Azure Naming Conventions
    url: https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/naming-and-tagging
    offline_cache: true
  - id: gcp-naming
    name: GCP Resource Naming Convention
    url: https://cloud.google.com/compute/docs/naming-resources
    offline_cache: true
  - id: terraform-style
    name: Terraform Style Conventions
    url: https://developer.hashicorp.com/terraform/language/style
    offline_cache: true
tooling:
  static_analysis:
  - tool: tflint
    purpose: Check naming convention compliance
    offline_capable: true
  - tool: terraform fmt
    purpose: Ensure consistent formatting
    offline_capable: true
  scripts:
  - id: naming-analyzer
    language: bash
    purpose: Analyze naming patterns in Terraform code
    source: inline
    code: |
      #!/bin/bash
      echo "=== Resource Names ==="
      grep -rh 'resource\s*"[^"]*"\s*"[^"]*"' --include='*.tf' | \
        sed 's/.*resource\s*"[^"]*"\s*"\([^"]*\)".*/\1/' | sort | uniq -c | sort -rn

      echo ""
      echo "=== Variable Names ==="
      grep -rh 'variable\s*"[^"]*"' --include='*.tf' | \
        sed 's/.*variable\s*"\([^"]*\)".*/\1/' | sort | uniq -c | sort -rn
signals:
  critical:
  - id: IAC-NAME-CRIT-001
    signal: Sensitive information in resource names
    evidence_pattern: (password|secret|key|token|credential)[^"]*=\s*"[^$]
    explanation: |
      Resource names containing sensitive information expose secrets
      in cloud provider consoles, logs, and billing reports.
    remediation: Remove sensitive data from resource names; use secret managers for credentials
  high:
  - id: IAC-NAME-HIGH-001
    signal: No consistent naming pattern across resources
    evidence_indicators:
    - Mixed naming styles (camelCase, snake_case, kebab-case)
    - Inconsistent prefixes or suffixes
    - Random or unclear resource names
    explanation: |
      Inconsistent naming makes resources hard to find, manage, and
      correlate, leading to operational and security issues.
    remediation: Establish and enforce organization-wide naming conventions
  - id: IAC-NAME-HIGH-002
    signal: Missing required tags
    evidence_indicators:
    - Resources without environment tags
    - Missing owner or team tags
    - No cost center tags
    explanation: |
      Missing tags prevent proper cost allocation, ownership tracking,
      and security policy enforcement.
    remediation: Implement required tag policies using provider default_tags or checkov
  - id: IAC-NAME-HIGH-003
    signal: Environment names embedded in code instead of variables
    evidence_pattern: '"(prod|staging|dev|production|development|qa)[^"]*"'
    explanation: |
      Hardcoded environment names prevent code reuse and increase
      risk of accidental production changes.
    remediation: Use variables for environment-specific naming components
  medium:
  - id: IAC-NAME-MED-001
    signal: Inconsistent variable naming conventions
    evidence_indicators:
    - Mixed snake_case and camelCase in variables
    - Abbreviated vs full names inconsistently
    remediation: Standardize on snake_case for Terraform variables per HashiCorp conventions
  - id: IAC-NAME-MED-002
    signal: Generic or unclear resource names
    evidence_pattern: '"(main|default|resource|instance|bucket)"'
    remediation: Use descriptive names that indicate purpose and ownership
  - id: IAC-NAME-MED-003
    signal: Naming pattern does not include region identifier
    evidence_indicators:
    - Resources in multiple regions with same base name
    - No region component in naming scheme
    remediation: Include region identifier in resource names for multi-region deployments
  low:
  - id: IAC-NAME-LOW-001
    signal: Inconsistent abbreviation usage
    evidence_indicators:
    - Some resources use 'prod', others use 'production'
    - Mixed abbreviation styles
    remediation: Create an approved abbreviation dictionary
  - id: IAC-NAME-LOW-002
    signal: File naming does not follow conventions
    evidence_indicators:
    - Inconsistent use of underscores vs dashes in filenames
    - Non-standard file organization
    remediation: 'Follow Terraform conventions: main.tf, variables.tf, outputs.tf'
  positive:
  - id: IAC-NAME-POS-001
    signal: Consistent naming pattern with clear structure
    evidence_pattern: (\$\{var\.project\}|\$\{var\.environment\}|\$\{var\.region\})
  - id: IAC-NAME-POS-002
    signal: Comprehensive tagging strategy implemented
    evidence_indicators:
    - Default tags configured at provider level
    - Mandatory tags enforced via policy
procedure:
  context:
    cognitive_mode: evaluative
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Resource Name Analysis
    description: |
      Extract and analyze all resource names to identify patterns,
      inconsistencies, and violations.
    duration_estimate: 20 min
    commands:
    - purpose: Extract Terraform resource local names
      command: grep -rh 'resource\s*"[^"]*"\s*"[^"]*"' --include='*.tf' | sed 's/.*resource\s*"[^"]*"\s*"\([^"]*\)".*/\1/'
        | sort | uniq -c | sort -rn | head -30
    - purpose: Extract cloud resource name attributes
      command: grep -rhn 'name\s*=\s*"[^"]*"' --include='*.tf' | head -50
    - purpose: Check for hardcoded environment names
      command: grep -rn '"\(prod\|staging\|dev\|production\|development\)' --include='*.tf' | head -20
    expected_findings:
    - Resource naming patterns in use
    - Naming inconsistencies
    - Hardcoded environment identifiers
  - id: '2'
    name: Variable and Output Naming Review
    description: |
      Assess consistency of variable and output naming across
      modules and configurations.
    duration_estimate: 15 min
    commands:
    - purpose: List all variable names
      command: grep -rh 'variable\s*"[^"]*"' --include='*.tf' | sed 's/.*variable\s*"\([^"]*\)".*/\1/'
        | sort | uniq -c | sort -rn | head -30
    - purpose: Check for naming style consistency
      command: grep -rh 'variable\s*"[^"]*"' --include='*.tf' | sed 's/.*variable\s*"\([^"]*\)".*/\1/'
        | grep -E '[A-Z]' | head -10
    - purpose: List all output names
      command: grep -rh 'output\s*"[^"]*"' --include='*.tf' | sed 's/.*output\s*"\([^"]*\)".*/\1/' | sort
        | uniq -c | sort -rn | head -20
    expected_findings:
    - Variable naming patterns
    - Style violations (camelCase in Terraform)
    - Output naming consistency
  - id: '3'
    name: Tag Analysis
    description: |
      Evaluate tagging strategies and compliance with required
      tag policies.
    duration_estimate: 20 min
    commands:
    - purpose: Extract tag definitions
      command: grep -rA10 'tags\s*=' --include='*.tf' | grep -E '^\s+[A-Za-z_-]+\s*=' | sed 's/^\s*//'
        | sort | uniq -c | sort -rn | head -20
    - purpose: Check for default_tags
      command: grep -rn 'default_tags' --include='*.tf'
    - purpose: Find resources without tags
      command: grep -rL 'tags\s*=' --include='*.tf' $(grep -rl '^resource' --include='*.tf')
    expected_findings:
    - Common tag patterns
    - Missing required tags
    - Default tag configuration
  - id: '4'
    name: File and Directory Naming
    description: |
      Review file and directory naming conventions for
      consistency and best practices.
    duration_estimate: 10 min
    commands:
    - purpose: List all Terraform files
      command: find . -name '*.tf' -type f | sort
    - purpose: Check for non-standard file names
      command: find . -name '*.tf' -type f | xargs -I{} basename {} | sort | uniq -c | sort -rn
    - purpose: Check directory structure
      command: find . -type d -name 'modules' -o -type d -name 'environments' | head -20
    expected_findings:
    - File naming patterns
    - Directory organization
    - Non-standard file names
  - id: '5'
    name: Naming Convention Documentation
    description: |
      Verify that naming conventions are documented and
      accessible to all team members.
    duration_estimate: 15 min
    questions:
    - Is there documented naming convention standard?
    - Are naming conventions enforced via automation?
    - How are new team members trained on naming standards?
    expected_findings:
    - Documentation existence and quality
    - Enforcement mechanisms
    - Team awareness levels
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Naming Pattern Analysis
    - Tagging Strategy Assessment
    - Recommendations
    - Proposed Naming Convention
  confidence_guidance:
    high: Direct pattern analysis with clear violations
    medium: Pattern interpretation with some ambiguity
    low: Inferred from limited examples
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: terraform-style
      priority: required
    - source_id: aws-tagging
      priority: recommended
profiles:
  membership:
    quick:
      included: true
      priority: 3
      reason: Naming issues can be quickly identified
    full:
      included: true
      priority: 1
closeout_checklist:
- id: naming-001
  item: No sensitive information in resource names
  level: CRITICAL
  verification: grep -rEi '(password|secret|api_key|token)' --include='*.tf' | grep -v 'sensitive\s*=\s*true'
    | grep 'name\s*=' | wc -l | xargs -I{} test {} -eq 0 && echo PASS || echo FAIL
  expected: PASS
- id: naming-002
  item: Consistent naming convention across resources
  level: BLOCKING
  verification: manual
  verification_notes: Review resource names for consistent pattern (e.g., project-env-resource-purpose)
  expected: Confirmed by reviewer
- id: naming-003
  item: Required tags present on all taggable resources
  level: BLOCKING
  verification: manual
  verification_notes: Verify environment, owner, and cost center tags on all resources
  expected: Confirmed by reviewer
- id: naming-004
  item: Variables follow snake_case convention
  level: WARNING
  verification: grep -rh 'variable\s*"[^"]*"' --include='*.tf' | sed 's/.*variable\s*"\([^"]*\)".*/\1/'
    | grep -E '[A-Z]' | wc -l | xargs -I{} test {} -eq 0 && echo PASS || echo FAIL
  expected: PASS
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: AWS Well-Architected
    controls:
    - Cost Optimization Pillar - Tagging
  - framework: FinOps Foundation
    controls:
    - Resource Tagging
relationships:
  commonly_combined:
  - infrastructure-as-code.iac-structure.module-organization
  - infrastructure-as-code.iac-structure.file-structure
