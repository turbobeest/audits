audit:
  id: infrastructure-as-code.security-compliance.security-scanning-integration
  name: IaC Security Scanning Integration
  version: 1.0.0
  last_updated: '2026-01-19'
  status: active
  category: infrastructure-as-code
  category_number: 13
  subcategory: security-compliance
  tier: phd
  estimated_duration: 1.5 hours
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: security
  default_profiles:
  - full
  - security
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit evaluates the integration of security scanning tools into
    Infrastructure as Code development and deployment workflows. It examines
    tool selection, configuration, pipeline integration, and result handling.

    Key areas examined:
    - Security scanner tool selection and coverage
    - CI/CD pipeline integration
    - Pre-commit hook configuration
    - Scan result handling and triage
    - False positive management
    - Scan performance and developer experience
  why_it_matters: |
    Security scanning integration provides:
    - Early detection: Find issues before deployment
    - Consistency: Same checks for all changes
    - Developer enablement: Feedback during development
    - Audit trail: Record of security checks
    - Shift-left security: Issues cheaper to fix early

    Poor integration leads to:
    - Security issues reaching production
    - Developer friction and bypasses
    - Inconsistent security checks
    - Missing audit evidence
  when_to_run:
  - When establishing IaC security practices
  - After adopting new scanning tools
  - During DevSecOps maturity assessments
  - When developer feedback indicates issues
prerequisites:
  required_artifacts:
  - type: iac_repository
    description: Access to infrastructure code repository
  - type: ci_cd_config
    description: Access to CI/CD pipeline configurations
  access_requirements:
  - Read access to IaC repositories
  - CI/CD pipeline configuration access
  - Pre-commit configuration access
discovery:
  code_patterns:
  - pattern: tfsec|checkov|terrascan|trivy|snyk
    type: regex
    scope: config
    purpose: Find security scanner references
  - pattern: pre-commit
    type: keyword
    scope: config
    purpose: Find pre-commit configurations
  file_patterns:
  - glob: '**/.pre-commit-config.yaml'
    purpose: Pre-commit hook configuration
  - glob: '**/.github/workflows/*.yml'
    purpose: GitHub Actions workflows
  - glob: '**/.gitlab-ci.yml'
    purpose: GitLab CI configuration
  - glob: '**/Jenkinsfile'
    purpose: Jenkins pipeline
  - glob: '**/.tfsec/**'
    purpose: tfsec configuration
  - glob: '**/.checkov.yaml'
    purpose: Checkov configuration
  - glob: '**/trivy.yaml'
    purpose: Trivy configuration
knowledge_sources:
  guides:
  - id: tfsec-docs
    name: tfsec Documentation
    url: https://aquasecurity.github.io/tfsec/
    offline_cache: true
  - id: checkov-docs
    name: Checkov Documentation
    url: https://www.checkov.io/
    offline_cache: true
  - id: trivy-iac
    name: Trivy IaC Scanning
    url: https://aquasecurity.github.io/trivy/latest/docs/scanner/misconfiguration/
    offline_cache: true
  - id: terrascan-docs
    name: Terrascan Documentation
    url: https://runterrascan.io/
    offline_cache: true
tooling:
  static_analysis:
  - tool: tfsec
    purpose: Terraform security scanner
    offline_capable: true
  - tool: checkov
    purpose: Multi-framework IaC scanner
    offline_capable: true
  - tool: trivy
    purpose: Comprehensive vulnerability scanner
    offline_capable: true
  - tool: terrascan
    purpose: Detect compliance violations
    offline_capable: true
  - tool: snyk iac
    purpose: Snyk IaC scanning
    offline_capable: false
  infrastructure_tools:
  - tool: tfsec
    purpose: Run security scan
    command: tfsec . --format json
  - tool: checkov
    purpose: Run compliance scan
    command: checkov -d . --output cli
  - tool: trivy
    purpose: Run vulnerability scan
    command: trivy config .
signals:
  critical:
  - id: IAC-SSI-CRIT-001
    signal: No security scanning in CI/CD pipeline
    evidence_indicators:
    - No scanner execution in pipeline
    - No security checks before deployment
    explanation: |
      Without pipeline scanning, security issues can reach production
      undetected. This is the last automated defense.
    remediation: Add security scanning step to CI/CD pipeline
  - id: IAC-SSI-CRIT-002
    signal: Security scan results don't block deployment
    evidence_indicators:
    - Critical findings don't fail pipeline
    - continue-on-error for security scans
    explanation: |
      Non-blocking scans are suggestions that can be ignored,
      providing no actual protection.
    remediation: Configure critical findings to fail deployment
  high:
  - id: IAC-SSI-HIGH-001
    signal: Only one security scanner in use
    evidence_indicators:
    - Single scanner covers all checks
    - No defense in depth
    explanation: |
      Different scanners have different strengths. Using multiple
      tools improves coverage.
    remediation: Implement multiple complementary scanners
  - id: IAC-SSI-HIGH-002
    signal: No pre-commit security scanning
    evidence_indicators:
    - No pre-commit hooks for security
    - Developers only see issues in CI
    explanation: |
      Without pre-commit scanning, developers don't get immediate
      feedback, leading to wasted CI cycles.
    remediation: Add security scanners to pre-commit hooks
  - id: IAC-SSI-HIGH-003
    signal: Scan results not reviewed or triaged
    evidence_indicators:
    - Findings pile up without action
    - No process for reviewing results
    explanation: |
      Unreviewed findings provide no security value and create
      alert fatigue.
    remediation: Establish triage process for scan findings
  medium:
  - id: IAC-SSI-MED-001
    signal: High false positive rate causing bypasses
    evidence_indicators:
    - Many skip annotations
    - Developers complaining about noise
    remediation: Tune scanner configurations to reduce false positives
  - id: IAC-SSI-MED-002
    signal: Scan performance impacting development
    evidence_indicators:
    - Scans taking >5 minutes
    - Developers avoiding commits due to slow hooks
    remediation: Optimize scan performance; use incremental scanning
  - id: IAC-SSI-MED-003
    signal: Scanner configuration not version controlled
    evidence_indicators:
    - Scanner config not in repository
    - Different configurations per environment
    remediation: Version control all scanner configurations
  low:
  - id: IAC-SSI-LOW-001
    signal: Scan results not stored for audit
    evidence_indicators:
    - Results only in CI logs
    - No SARIF or structured output
    remediation: Generate and archive structured scan reports
  positive:
  - id: IAC-SSI-POS-001
    signal: Comprehensive security scanning integration
    evidence_indicators:
    - Multiple scanners in pre-commit and CI
    - Critical findings block deployment
    - Results triaged and tracked
  - id: IAC-SSI-POS-002
    signal: Developer-friendly scanning experience
    evidence_indicators:
    - Fast pre-commit scans
    - Clear remediation guidance
procedure:
  context:
    cognitive_mode: evaluative
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Scanner Inventory
    description: |
      Identify what security scanning tools are configured
      and where they run.
    duration_estimate: 20 min
    commands:
    - purpose: Find scanner references in CI/CD
      command: grep -rn 'tfsec\|checkov\|terrascan\|trivy\|snyk' --include='*.yml' --include='*.yaml'
        --include='Jenkinsfile'
    - purpose: Check for pre-commit configuration
      command: cat .pre-commit-config.yaml 2>/dev/null | grep -A5 -E 'tfsec|checkov|trivy'
    - purpose: Find scanner configuration files
      command: find . -name '.tfsec*' -o -name '.checkov*' -o -name 'trivy*' -o -name '.terrascan*'
    expected_findings:
    - Scanners in use
    - Integration points
    - Configuration files
  - id: '2'
    name: Pipeline Integration Review
    description: |
      Evaluate how scanners are integrated into CI/CD
      pipelines.
    duration_estimate: 25 min
    commands:
    - purpose: Find scanner steps in GitHub Actions
      command: grep -rA10 'tfsec\|checkov\|trivy' .github/workflows/*.yml 2>/dev/null | head -100
    - purpose: Check if scans block deployment
      command: grep -rn 'continue-on-error\|soft-fail\|allow-failure' --include='*.yml' --include='*.yaml'
        | grep -iE 'security|scan|check'
    - purpose: Find deployment dependencies on scans
      command: grep -rB5 -A5 'deploy\|apply' --include='*.yml' --include='*.yaml' | grep -iE 'needs|depends'
    expected_findings:
    - Pipeline integration
    - Blocking configuration
    - Deployment dependencies
  - id: '3'
    name: Pre-commit Configuration Review
    description: |
      Assess pre-commit hook configuration for security
      scanning.
    duration_estimate: 15 min
    commands:
    - purpose: Read pre-commit config
      command: cat .pre-commit-config.yaml 2>/dev/null || echo 'No pre-commit config found'
    - purpose: Check for security hooks
      command: grep -E 'tfsec|checkov|trivy|terrascan|gitleaks|trufflehog' .pre-commit-config.yaml 2>/dev/null
        | head -20
    expected_findings:
    - Pre-commit hooks present
    - Security scanners included
    - Hook configuration
  - id: '4'
    name: Result Handling Assessment
    description: |
      Evaluate how scan results are handled, triaged, and
      tracked.
    duration_estimate: 20 min
    commands:
    - purpose: Find skip annotations
      command: grep -rn '#tfsec:ignore\|#checkov:skip\|#trivy:ignore' --include='*.tf' | wc -l
    - purpose: Check for result output formats
      command: grep -rn 'output.*sarif\|output.*json\|format.*json' --include='*.yml' --include='*.yaml'
        | grep -iE 'tfsec|checkov|trivy'
    - purpose: Look for result storage
      command: grep -rn 'upload.*artifact\|upload.*sarif' --include='*.yml' --include='*.yaml'
    expected_findings:
    - Skip annotation count
    - Result format and storage
    - Triage process indicators
  - id: '5'
    name: Performance Assessment
    description: |
      Evaluate scan performance and developer experience
      impact.
    duration_estimate: 10 min
    commands:
    - purpose: Time a tfsec scan
      command: time tfsec . --no-color 2>/dev/null | tail -5 || echo 'tfsec not available'
    - purpose: Time a checkov scan
      command: time checkov -d . --compact 2>/dev/null | tail -5 || echo 'checkov not available'
    expected_findings:
    - Scan duration
    - Performance bottlenecks
    - Developer experience impact
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Scanner Inventory
    - Integration Assessment
    - Coverage Analysis
    - Recommendations
  confidence_guidance:
    high: Direct configuration analysis
    medium: Inferred from patterns
    low: Based on documentation or naming
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: tfsec-docs
      priority: required
    - source_id: checkov-docs
      priority: required
profiles:
  membership:
    quick:
      included: false
      reason: Integration review requires thorough analysis
    full:
      included: true
      priority: 2
    security:
      included: true
      priority: 1
closeout_checklist:
- id: ssi-001
  item: Security scanning in CI/CD pipeline
  level: CRITICAL
  verification: grep -rn 'tfsec\|checkov\|terrascan\|trivy' --include='*.yml' --include='*.yaml' .github/
    .gitlab-ci.yml Jenkinsfile 2>/dev/null | wc -l | xargs -I{} test {} -gt 0 && echo PASS || echo FAIL
  expected: PASS
- id: ssi-002
  item: Critical findings block deployment
  level: CRITICAL
  verification: manual
  verification_notes: Verify security scan failures prevent deployment to production
  expected: Confirmed by reviewer
- id: ssi-003
  item: Pre-commit hooks include security scanning
  level: BLOCKING
  verification: grep -E 'tfsec|checkov|trivy' .pre-commit-config.yaml 2>/dev/null | wc -l | xargs -I{}
    test {} -gt 0 && echo PASS || echo FAIL
  expected: PASS
- id: ssi-004
  item: Multiple complementary scanners in use
  level: WARNING
  verification: grep -rh 'tfsec\|checkov\|terrascan\|trivy\|snyk' --include='*.yml' --include='*.yaml'
    | tr -c '[:alpha:]' '\n' | grep -E '^(tfsec|checkov|terrascan|trivy|snyk)$' | sort -u | wc -l | xargs
    -I{} test {} -ge 2 && echo PASS || echo FAIL
  expected: PASS
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: SOC 2
    controls:
    - CC6.1
    - CC7.1
  - framework: NIST CSF
    controls:
    - DE.CM-8
relationships:
  commonly_combined:
  - infrastructure-as-code.security-compliance.policy-as-code
  - infrastructure-as-code.security-compliance.secret-handling
