audit:
  id: infrastructure-as-code.drift-detection.drift-remediation-process
  name: IaC Drift Remediation Process
  version: 1.0.0
  last_updated: '2026-01-19'
  status: active
  category: infrastructure-as-code
  category_number: 13
  subcategory: drift-detection
  tier: phd
  estimated_duration: 1.5 hours
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: manual
  severity: high
  scope: process
  default_profiles:
  - full
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit evaluates the organizational processes for remediating
    detected infrastructure drift. It examines decision frameworks,
    remediation approaches, automation capabilities, and post-remediation
    verification.

    Key areas examined:
    - Drift prioritization and triage processes
    - Remediation decision framework (update IaC vs infrastructure)
    - Automated vs manual remediation approaches
    - Remediation verification and validation
    - Root cause analysis for recurring drift
    - Documentation and knowledge capture
  why_it_matters: |
    Detecting drift is only valuable if it leads to remediation:
    - Unresolved drift negates IaC benefits
    - Improper remediation can cause outages
    - Root cause analysis prevents recurrence
    - Verification ensures remediation completeness

    A robust remediation process ensures drift is resolved safely and
    efficiently while addressing underlying causes.
  when_to_run:
  - After establishing drift detection
  - When drift accumulates despite detection
  - Following drift-related incidents
  - During process improvement initiatives
prerequisites:
  required_artifacts:
  - type: runbooks
    description: Access to drift remediation runbooks
  - type: incident_history
    description: History of drift-related incidents
  - type: change_records
    description: Records of drift remediation activities
  access_requirements:
  - Access to operational runbooks
  - Incident management system access
  - Change management records
discovery:
  documents_to_review:
  - type: Drift remediation runbooks
    purpose: Understand documented remediation procedures
  - type: Incident reports
    purpose: Analyze drift-related incidents and resolutions
  - type: Change records
    purpose: Review how drift remediation is tracked
  interviews:
  - role: Platform/DevOps engineers
    questions:
    - How do you decide whether to update IaC or revert infrastructure?
    - What is the typical time to remediate drift?
    - How do you verify remediation was successful?
    - What causes most recurring drift?
    purpose: Understand remediation practices
  - role: Engineering managers
    questions:
    - Are there SLAs for drift remediation?
    - How is drift remediation prioritized?
    - What resources are dedicated to drift remediation?
    purpose: Understand organizational commitment
  file_patterns:
  - glob: '**/*.tf'
    purpose: Terraform files
  - glob: '**/*.tfstate'
    purpose: Terraform state files
  - glob: '**/terraform.tfvars'
    purpose: Terraform variables
  - glob: '**/.terraform/**'
    purpose: Terraform working directory
  - glob: '**/pulumi*.yaml'
    purpose: Pulumi configuration
  code_patterns:
  - pattern: terraform|pulumi|cloudformation|ansible
    type: regex
    scope: config
    purpose: IaC tool references
knowledge_sources:
  guides:
  - id: terraform-import
    name: Terraform Import
    url: https://developer.hashicorp.com/terraform/cli/import
    offline_cache: true
  - id: terraform-state-mv
    name: Terraform State Operations
    url: https://developer.hashicorp.com/terraform/cli/commands/state
    offline_cache: true
  - id: spacelift-reconciliation
    name: Spacelift Auto-Reconciliation
    url: https://docs.spacelift.io/concepts/run/drift-detection#auto-reconciliation
    offline_cache: true
tooling:
  infrastructure_tools:
  - tool: terraform apply
    purpose: Apply IaC to remediate drift
    command: terraform apply -auto-approve
  - tool: terraform import
    purpose: Import orphaned resources
    command: terraform import RESOURCE_TYPE.NAME ID
  - tool: terraform state rm
    purpose: Remove resources from state
    command: terraform state rm RESOURCE_ADDRESS
  assessment_tools:
  - tool: Process maturity assessment
    purpose: Evaluate remediation process maturity
signals:
  critical:
  - id: IAC-DRP-CRIT-001
    signal: No remediation process for detected drift
    evidence_indicators:
    - Drift alerts acknowledged but not resolved
    - Drift accumulates over time
    - No ownership for drift remediation
    explanation: |
      Without a remediation process, drift detection provides no value
      and drift accumulates, creating compounding security and
      operational risks.
    remediation: Establish clear ownership and SLAs for drift remediation
  - id: IAC-DRP-CRIT-002
    signal: Security drift not prioritized for immediate remediation
    evidence_indicators:
    - Security group drift persists for days
    - IAM drift not urgently addressed
    explanation: |
      Security-relevant drift creates vulnerability windows that
      attackers can exploit. Delayed remediation extends exposure.
    remediation: Define critical SLA (<24h) for security-relevant drift
  high:
  - id: IAC-DRP-HIGH-001
    signal: No decision framework for remediation approach
    evidence_indicators:
    - Inconsistent decisions on update IaC vs revert infra
    - No documented criteria for remediation approach
    explanation: |
      Without a framework, remediation decisions are ad-hoc and may
      either lose intentional changes or perpetuate unwanted drift.
    remediation: 'Create decision framework: when to update IaC vs revert infrastructure'
  - id: IAC-DRP-HIGH-002
    signal: No verification of successful remediation
    evidence_indicators:
    - Remediation claimed without re-running drift detection
    - No post-remediation plan
    explanation: |
      Without verification, remediation may be incomplete or
      introduce new issues.
    remediation: Require post-remediation drift detection to verify resolution
  - id: IAC-DRP-HIGH-003
    signal: No root cause analysis for recurring drift
    evidence_indicators:
    - Same resources drift repeatedly
    - No investigation into why drift occurs
    explanation: |
      Without RCA, the same drift recurs indefinitely, creating
      toil and perpetual risk.
    remediation: Implement RCA process for recurring drift patterns
  medium:
  - id: IAC-DRP-MED-001
    signal: Drift remediation not tracked in change management
    evidence_indicators:
    - No change records for drift remediation
    - Remediation happens outside normal process
    remediation: Log all drift remediation in change management system
  - id: IAC-DRP-MED-002
    signal: No automation for common remediation scenarios
    evidence_indicators:
    - Manual remediation for predictable drift
    - No auto-remediation capabilities
    remediation: Automate remediation for low-risk, predictable drift
  - id: IAC-DRP-MED-003
    signal: Knowledge not captured from remediation
    evidence_indicators:
    - Remediation lessons not documented
    - Same issues require repeated investigation
    remediation: Document remediation outcomes and learnings
  low:
  - id: IAC-DRP-LOW-001
    signal: Remediation SLAs not tracked
    evidence_indicators:
    - No metrics on time to remediate
    - SLA compliance not measured
    remediation: Track and report on drift remediation SLAs
  positive:
  - id: IAC-DRP-POS-001
    signal: Mature drift remediation process
    evidence_indicators:
    - Clear ownership and SLAs
    - Decision framework documented
    - Verification required
    - RCA for recurring drift
  - id: IAC-DRP-POS-002
    signal: Auto-remediation for appropriate drift
    evidence_indicators:
    - Automated remediation for low-risk drift
    - Human approval for significant changes
procedure:
  context:
    cognitive_mode: evaluative
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Process Documentation Review
    description: |
      Review documented drift remediation procedures and
      runbooks.
    duration_estimate: 20 min
    commands:
    - purpose: Find remediation documentation
      command: find . -name '*.md' -exec grep -l -i 'remediat\|resolve.*drift\|fix.*drift' {} \;
    - purpose: Search for runbooks
      command: find . -type f \( -name '*runbook*' -o -name '*playbook*' \) | head -20
    expected_findings:
    - Documentation existence
    - Procedure completeness
    - Decision framework presence
  - id: '2'
    name: Ownership and SLA Review
    description: |
      Assess ownership model and SLA definitions for drift
      remediation.
    duration_estimate: 20 min
    questions:
    - Who owns drift remediation?
    - What are the SLAs for different drift severities?
    - How is SLA compliance tracked?
    expected_findings:
    - Ownership model
    - SLA definitions
    - Escalation procedures
  - id: '3'
    name: Decision Framework Assessment
    description: |
      Evaluate the decision framework for choosing
      remediation approach.
    duration_estimate: 20 min
    questions:
    - How do you decide whether to update IaC or revert infrastructure?
    - What factors influence the decision?
    - Who approves remediation approach?
    expected_findings:
    - Decision criteria
    - Approval process
    - Framework documentation
  - id: '4'
    name: Verification Process Review
    description: |
      Assess how remediation success is verified.
    duration_estimate: 15 min
    questions:
    - How is successful remediation verified?
    - Is post-remediation drift detection required?
    - How long after remediation is verification performed?
    expected_findings:
    - Verification procedures
    - Post-remediation testing
    - Sign-off requirements
  - id: '5'
    name: Root Cause Analysis Assessment
    description: |
      Evaluate RCA practices for recurring drift.
    duration_estimate: 15 min
    questions:
    - Is RCA performed for recurring drift?
    - How are drift patterns analyzed?
    - What preventive measures result from RCA?
    expected_findings:
    - RCA practices
    - Pattern analysis
    - Preventive measures
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Process Maturity Assessment
    - Gap Analysis
    - Recommendations
    - Proposed Remediation Framework
  confidence_guidance:
    high: Direct documentation and interview evidence
    medium: Inferred from partial evidence
    low: Based on limited information
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: terraform-import
      priority: recommended
profiles:
  membership:
    quick:
      included: false
      reason: Process assessment requires thorough review
    full:
      included: true
      priority: 3
closeout_checklist:
- id: drp-001
  item: Drift remediation ownership is defined
  level: CRITICAL
  verification: manual
  verification_notes: Verify clear ownership for drift remediation exists
  expected: Confirmed by reviewer
- id: drp-002
  item: SLAs defined for drift remediation
  level: BLOCKING
  verification: manual
  verification_notes: Verify SLAs exist for different drift severities
  expected: Confirmed by reviewer
- id: drp-003
  item: Decision framework documented
  level: BLOCKING
  verification: manual
  verification_notes: Verify documented criteria for choosing remediation approach
  expected: Confirmed by reviewer
- id: drp-004
  item: Verification process in place
  level: WARNING
  verification: manual
  verification_notes: Verify post-remediation verification is required
  expected: Confirmed by reviewer
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: SOC 2
    controls:
    - CC6.8
    - CC7.1
  - framework: ISO 27001
    controls:
    - A.14.2.2
relationships:
  commonly_combined:
  - infrastructure-as-code.drift-detection.configuration-drift
  - infrastructure-as-code.drift-detection.drift-detection-process
