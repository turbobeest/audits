audit:
  id: infrastructure-as-code.drift-detection.drift-detection-process
  name: IaC Drift Detection Process
  version: 1.0.0
  last_updated: '2026-01-19'
  status: active
  category: infrastructure-as-code
  category_number: 13
  subcategory: drift-detection
  tier: phd
  estimated_duration: 2 hours
  completeness: complete
  requires_runtime: false
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: process
  default_profiles:
  - full
  blocks_phase: false
  parallelizable: true
description:
  what: |
    This audit evaluates the organizational processes and automation in
    place for detecting infrastructure drift. It examines the tooling,
    scheduling, alerting, and response procedures for drift detection.

    Key areas examined:
    - Drift detection tooling and automation
    - Scheduled drift checks and frequency
    - Alerting and notification mechanisms
    - Coverage of drift detection
    - Integration with incident response
    - Drift detection metrics and reporting
  why_it_matters: |
    Having drift detection tools is insufficient without processes to:
    - Ensure regular, comprehensive detection
    - Route alerts to appropriate responders
    - Track drift trends over time
    - Prioritize remediation efforts
    - Prevent drift from recurring

    Without robust processes, drift accumulates undetected, leading to
    security vulnerabilities, compliance failures, and operational issues.
  when_to_run:
  - During process maturity assessments
  - When establishing IaC operations
  - After drift-related incidents
  - During compliance audits
prerequisites:
  required_artifacts:
  - type: ci_cd_config
    description: Access to CI/CD pipeline configurations
  - type: monitoring_config
    description: Access to monitoring and alerting configurations
  - type: runbooks
    description: Access to operational runbooks
  access_requirements:
  - Read access to CI/CD configurations
  - Access to monitoring dashboards
  - Operational documentation access
discovery:
  file_patterns:
  - glob: '**/.github/workflows/*.yml'
    purpose: GitHub Actions workflows
  - glob: '**/.gitlab-ci.yml'
    purpose: GitLab CI configurations
  - glob: '**/Jenkinsfile'
    purpose: Jenkins pipeline definitions
  - glob: '**/atlantis.yaml'
    purpose: Atlantis configuration
  - glob: '**/runbook*.md'
    purpose: Operational runbooks
  interviews:
  - role: Platform/SRE engineers
    questions:
    - How often is drift detection run?
    - What tools are used for drift detection?
    - How are drift alerts handled?
    - What is the drift remediation process?
    purpose: Understand current drift detection practices
  - role: Security team
    questions:
    - Are you notified of security-relevant drift?
    - How is drift prioritized for remediation?
    purpose: Understand security integration
knowledge_sources:
  guides:
  - id: terraform-cloud-drift
    name: Terraform Cloud Drift Detection
    url: https://developer.hashicorp.com/terraform/cloud-docs/workspaces/health
    offline_cache: true
  - id: spacelift-drift
    name: Spacelift Drift Detection
    url: https://docs.spacelift.io/concepts/run/drift-detection
    offline_cache: true
  - id: env0-drift
    name: env0 Drift Detection
    url: https://docs.env0.com/docs/drift-detection
    offline_cache: true
tooling:
  infrastructure_tools:
  - tool: Terraform Cloud/Enterprise
    purpose: Built-in drift detection with health assessments
    command: Workspace health checks
  - tool: Spacelift
    purpose: Automated drift detection and remediation
    command: Scheduled drift detection runs
  - tool: driftctl
    purpose: Open-source drift detection
    command: driftctl scan
  - tool: AWS Config
    purpose: AWS resource configuration tracking
    command: AWS Config rules
  assessment_tools:
  - tool: Process maturity assessment
    purpose: Evaluate drift detection process maturity
signals:
  critical:
  - id: IAC-DDP-CRIT-001
    signal: No automated drift detection in place
    evidence_indicators:
    - No scheduled terraform plan runs
    - No drift detection tooling configured
    - Manual-only drift detection
    explanation: |
      Without automated detection, drift accumulates undetected,
      creating security risks and operational issues that compound
      over time.
    remediation: Implement automated drift detection with scheduled runs
  - id: IAC-DDP-CRIT-002
    signal: Drift alerts not routed to security team
    evidence_indicators:
    - Security-relevant drift not flagged
    - No security team notification
    explanation: |
      Security teams must be aware of drift in security-critical
      resources to assess and respond to potential vulnerabilities.
    remediation: Configure alerts for security-relevant drift to security team
  high:
  - id: IAC-DDP-HIGH-001
    signal: Drift detection coverage is incomplete
    evidence_indicators:
    - Some environments not covered
    - Certain resource types excluded
    explanation: |
      Incomplete coverage creates blind spots where drift can
      accumulate without detection.
    remediation: Extend drift detection to all environments and resource types
  - id: IAC-DDP-HIGH-002
    signal: No escalation process for persistent drift
    evidence_indicators:
    - Drift alerts ignored or acknowledged without action
    - No SLA for drift remediation
    explanation: |
      Without escalation, drift alerts become noise and drift
      persists indefinitely.
    remediation: Define SLAs for drift remediation with escalation procedures
  - id: IAC-DDP-HIGH-003
    signal: Drift detection frequency too low
    evidence_indicators:
    - Drift detection runs monthly or less
    - No continuous drift monitoring
    explanation: |
      Infrequent detection allows drift to persist and compound,
      making remediation more difficult.
    remediation: Run drift detection daily at minimum; hourly for critical resources
  medium:
  - id: IAC-DDP-MED-001
    signal: No drift metrics or trending
    evidence_indicators:
    - Drift not tracked over time
    - No dashboards for drift status
    remediation: Implement drift metrics collection and trending dashboards
  - id: IAC-DDP-MED-002
    signal: Drift detection not integrated with CI/CD
    evidence_indicators:
    - CI/CD doesn't check for drift
    - Deployments proceed despite drift
    remediation: Add drift checks to CI/CD pipelines; block deployments on drift
  - id: IAC-DDP-MED-003
    signal: No runbook for drift remediation
    evidence_indicators:
    - No documented drift response procedures
    - Ad-hoc remediation approach
    remediation: Create runbooks for common drift scenarios
  low:
  - id: IAC-DDP-LOW-001
    signal: Drift detection alerts lack context
    evidence_indicators:
    - Alerts don't include affected resources
    - No remediation guidance in alerts
    remediation: Enrich alerts with context and remediation steps
  positive:
  - id: IAC-DDP-POS-001
    signal: Comprehensive drift detection process
    evidence_indicators:
    - Automated daily drift detection
    - Alerting with proper routing
    - Documented remediation procedures
  - id: IAC-DDP-POS-002
    signal: Drift metrics tracked and improving
    evidence_indicators:
    - Drift trending dashboards
    - Decreasing drift over time
procedure:
  context:
    cognitive_mode: evaluative
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Tooling Assessment
    description: |
      Identify what drift detection tools are in use and
      their configuration.
    duration_estimate: 25 min
    commands:
    - purpose: Check for Terraform Cloud/Enterprise
      command: grep -rn 'cloud\s*{\|remote\s*{' --include='*.tf'
    - purpose: Find scheduled CI/CD jobs
      command: grep -rn 'schedule\|cron' --include='*.yml' --include='*.yaml'
    - purpose: Look for driftctl configuration
      command: find . -name '.driftctl.yaml' -o -name 'driftctl.yaml'
    expected_findings:
    - Drift detection tools in use
    - Scheduled job configurations
    - Tool coverage
  - id: '2'
    name: Scheduling and Frequency Review
    description: |
      Evaluate how often drift detection runs and whether
      frequency is appropriate.
    duration_estimate: 20 min
    commands:
    - purpose: Find scheduled terraform plans
      command: grep -rB5 -A5 'terraform\s\+plan' --include='*.yml' --include='*.yaml' | grep -E 'schedule|cron'
    - purpose: Check for health check configurations
      command: grep -rn 'health\|drift' --include='*.yml' --include='*.yaml'
    expected_findings:
    - Drift detection schedule
    - Frequency assessment
    - Coverage by environment
  - id: '3'
    name: Alerting and Notification Review
    description: |
      Assess how drift alerts are generated and routed to
      appropriate responders.
    duration_estimate: 25 min
    commands:
    - purpose: Find alerting configurations
      command: grep -rn 'alert\|notify\|slack\|pagerduty' --include='*.yml' --include='*.yaml'
    - purpose: Check for email/webhook notifications
      command: grep -rn 'email\|webhook' --include='*.yml' --include='*.yaml'
    expected_findings:
    - Alert routing configuration
    - Notification channels
    - Security team inclusion
  - id: '4'
    name: Process Documentation Review
    description: |
      Verify drift response procedures are documented and
      accessible.
    duration_estimate: 20 min
    commands:
    - purpose: Find drift-related documentation
      command: find . -name '*.md' -exec grep -l -i 'drift' {} \;
    - purpose: Search for runbooks
      command: find . -type f \( -name '*runbook*' -o -name '*playbook*' \)
    expected_findings:
    - Documentation coverage
    - Runbook quality
    - Response procedure clarity
  - id: '5'
    name: Metrics and Reporting Assessment
    description: |
      Evaluate drift tracking, trending, and reporting
      capabilities.
    duration_estimate: 20 min
    questions:
    - Are drift metrics collected and stored?
    - Is drift trending available?
    - Are drift reports generated regularly?
    - Are drift SLAs defined and tracked?
    expected_findings:
    - Metrics collection status
    - Trending capabilities
    - SLA definitions
output:
  deliverables:
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Tooling Assessment
    - Process Maturity Evaluation
    - Gap Analysis
    - Recommendations
  confidence_guidance:
    high: Direct configuration and documentation review
    medium: Inferred from partial evidence
    low: Based on interviews or assumptions
offline:
  capability: full
  cache_manifest:
    knowledge:
    - source_id: terraform-cloud-drift
      priority: recommended
profiles:
  membership:
    quick:
      included: false
      reason: Process assessment requires thorough review
    full:
      included: true
      priority: 2
closeout_checklist:
- id: ddp-001
  item: Automated drift detection is configured
  level: CRITICAL
  verification: manual
  verification_notes: Verify scheduled drift detection runs exist in CI/CD or drift detection tool
  expected: Confirmed by reviewer
- id: ddp-002
  item: Drift detection runs at least daily
  level: BLOCKING
  verification: manual
  verification_notes: Verify drift detection schedule is daily or more frequent
  expected: Confirmed by reviewer
- id: ddp-003
  item: Drift alerts routed to appropriate teams
  level: BLOCKING
  verification: manual
  verification_notes: Verify security team receives security-relevant drift alerts
  expected: Confirmed by reviewer
- id: ddp-004
  item: Drift remediation runbook exists
  level: WARNING
  verification: find . -name '*.md' -exec grep -l -i 'drift.*remediation\|remediat.*drift' {} \; | wc
    -l | xargs -I{} test {} -gt 0 && echo PASS || echo FAIL
  expected: PASS
governance:
  applicable_to:
    archetypes:
    - all
  compliance_frameworks:
  - framework: SOC 2
    controls:
    - CC6.8
    - CC7.1
    - CC7.2
  - framework: ISO 27001
    controls:
    - A.12.1.2
relationships:
  commonly_combined:
  - infrastructure-as-code.drift-detection.configuration-drift
  - infrastructure-as-code.drift-detection.drift-remediation-process
