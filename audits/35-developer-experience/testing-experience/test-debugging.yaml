audit:
  id: developer-experience.testing-experience.test-debugging
  name: Test Debugging Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: developer-experience
  category_number: 35
  subcategory: testing-experience
  tier: expert
  estimated_duration: 2-3 hours  # median: 2h
  completeness: requires_discovery
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: development
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates the ability to debug failing tests including debugger
    integration, error message quality, stack trace clarity, and tools
    for investigating test failures. Assesses how quickly developers
    can diagnose why a test is failing.
  why_it_matters: |
    When tests fail, developers need to quickly understand why. Poor
    debugging support turns test failures into time sinks. Good test
    debugging tools reduce the time from failure to fix, encouraging
    developers to maintain comprehensive test suites.
  when_to_run:
  - When developers report debugging difficulties
  - After test framework changes
  - When test failure investigations take too long
  - Quarterly DX review
prerequisites:
  required_artifacts:
  - type: test_suite
    description: Existing test suite
  - type: ide_configuration
    description: IDE debug configuration
  access_requirements:
  - Test suite access
  - IDE access
  - Debugger access
discovery:
  file_patterns:
  - glob: '**/.vscode/launch.json'
    purpose: Find VS Code test debug configs
  - glob: '**/jest.config.{js,ts}'
    purpose: Find Jest configuration
  - glob: '**/vitest.config.{js,ts}'
    purpose: Find Vitest configuration
  interview_questions:
  - role: Developer
    questions:
    - How do you debug failing tests?
    - Can you use breakpoints in tests?
    - Are test error messages helpful?
    - What makes test debugging difficult?
knowledge_sources:
  guides:
  - id: jest-debugging
    name: Jest Debugging Guide
    url: https://jestjs.io/docs/troubleshooting
  - id: vscode-testing
    name: VS Code Testing
    url: https://code.visualstudio.com/docs/editor/testing
  standards:
  - id: test-debugging
    name: Test Debugging Best Practices
    relevance: Effective test investigation
tooling:
  analysis_tools:
  - tool: vscode
    purpose: IDE test debugging
  - tool: jest
    purpose: Test runner with debug support
    command: node --inspect-brk node_modules/.bin/jest --runInBand
  - tool: vitest
    purpose: Test runner with debug support
    command: vitest --inspect-brk --single-thread
  - tool: ndb
    purpose: Improved Node.js debugging
    command: ndb jest
signals:
  critical:
  - id: TESTDEBUG-CRIT-001
    signal: Cannot set breakpoints in tests
    evidence_indicators:
    - No debug configuration
    - Breakpoints ignored
    - Source maps broken
    explanation: |
      Without breakpoints, test debugging relies on
      console.log, which is inefficient.
    remediation: |
      Configure IDE debug integration for test runner.
      Add launch.json configuration for test debugging.
  - id: TESTDEBUG-CRIT-002
    signal: Test errors lack useful information
    evidence_indicators:
    - Generic failure messages
    - Missing stack traces
    - No diff for assertion failures
    explanation: |
      Unhelpful error messages make understanding failures
      require significant investigation.
    remediation: |
      Configure detailed error reporting. Use matchers
      with good diff output.
  high:
  - id: TESTDEBUG-HIGH-001
    signal: Stack traces don't point to test code
    remediation: |
      Configure source maps and ensure stack trace
      filtering preserves relevant frames.
  - id: TESTDEBUG-HIGH-002
    signal: Cannot run single failing test easily
    remediation: |
      Use IDE test explorer or configure single test
      running commands.
  - id: TESTDEBUG-HIGH-003
    signal: Async test failures hard to trace
    remediation: |
      Enable async stack traces and proper error
      propagation in async tests.
  medium:
  - id: TESTDEBUG-MED-001
    signal: Watch mode debugging unavailable
    remediation: |
      Configure debugger to work with test watch mode
      for rapid iteration.
  - id: TESTDEBUG-MED-002
    signal: Test isolation issues hard to diagnose
    remediation: |
      Add tools for detecting test pollution and
      running tests in isolation.
  - id: TESTDEBUG-MED-003
    signal: No test explorer integration
    remediation: |
      Configure IDE test explorer for visual test
      management and debugging.
  low:
  - id: TESTDEBUG-LOW-001
    signal: Debug shortcuts not documented
    remediation: |
      Document how to debug tests in IDE and CLI.
  - id: TESTDEBUG-LOW-002
    signal: Verbose logging not easily enabled
    remediation: |
      Add configuration for verbose test logging.
  positive:
  - id: TESTDEBUG-POS-001
    signal: IDE test debugging with breakpoints
  - id: TESTDEBUG-POS-002
    signal: Clear error messages with diffs
  - id: TESTDEBUG-POS-003
    signal: Test explorer integration
  - id: TESTDEBUG-POS-004
    signal: Watch mode with debugging
procedure:
  context:
    cognitive_mode: evaluative
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Review Debug Configuration
    description: Check IDE test debug settings
    duration_estimate: 30 min
  - id: '2'
    name: Test Breakpoint Debugging
    description: Verify breakpoints work in tests
    duration_estimate: 30 min
  - id: '3'
    name: Evaluate Error Messages
    description: Assess quality of failure messages
    duration_estimate: 30 min
  - id: '4'
    name: Test Stack Traces
    description: Verify stack traces are useful
    duration_estimate: 30 min
  - id: '5'
    name: Gather Developer Feedback
    description: Interview developers about debug experience
    duration_estimate: 30 min
output:
  deliverables:
  - type: debug_assessment
    format: structured
    sections:
    - Debug configuration review
    - Breakpoint testing results
    - Error message evaluation
    - Developer feedback
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Debug Capabilities
    - Gap Analysis
    - Recommendations
closeout_checklist:
- id: testdebug-001
  item: Debug configuration reviewed
  level: ERROR
  verification: manual
- id: testdebug-002
  item: Breakpoint debugging tested
  level: WARNING
  verification: manual
- id: testdebug-003
  item: Developer feedback collected
  level: WARNING
  verification: manual
governance:
  applicable_to:
    archetypes:
    - all-software-projects
  compliance_mappings:
  - framework: ISO 27001
    control: A.14.2
    description: Security in development
relationships:
  commonly_combined:
  - developer-experience.testing-experience.test-execution-speed
  - developer-experience.local-development.debug-experience
  depends_on:
  - devops-ci-cd.test-automation
  feeds_into:
  - developer-experience.productivity-metrics.developer-velocity
