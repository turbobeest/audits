audit:
  id: developer-experience.testing-experience.watch-mode-experience
  name: Watch Mode Experience Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: developer-experience
  category_number: 35
  subcategory: testing-experience
  tier: expert
  estimated_duration: 2-3 hours  # median: 2h
  completeness: requires_discovery
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: development
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates the test watch mode experience including file change detection,
    related test detection, filtering capabilities, and performance. Assesses
    whether watch mode enables rapid test-driven development cycles.
  why_it_matters: |
    Watch mode is essential for test-driven development, providing instant
    feedback on code changes. Poor watch mode disrupts the development flow
    with delayed or incorrect re-runs. Good watch mode enables tight
    edit-test-fix cycles.
  when_to_run:
  - When adopting test-driven development
  - When developers report watch mode issues
  - After test framework changes
  - Quarterly DX review
prerequisites:
  required_artifacts:
  - type: test_suite
    description: Existing test suite
  - type: test_configuration
    description: Test runner configuration
  access_requirements:
  - Test suite access
  - Development environment
  - File system access
discovery:
  file_patterns:
  - glob: '**/jest.config.{js,ts}'
    purpose: Find Jest configuration
  - glob: '**/vitest.config.{js,ts}'
    purpose: Find Vitest configuration
  - glob: '**/.watchmanconfig'
    purpose: Find Watchman configuration
  interview_questions:
  - role: Developer
    questions:
    - Do you use test watch mode?
    - How fast does it re-run on changes?
    - Does it run the right tests?
    - What's frustrating about watch mode?
knowledge_sources:
  guides:
  - id: jest-watch
    name: Jest Watch Mode
    url: https://jestjs.io/docs/cli#--watch
  - id: vitest-watch
    name: Vitest Watch Mode
    url: https://vitest.dev/guide/cli.html
  standards:
  - id: tdd
    name: Test-Driven Development
    relevance: Watch mode enables TDD
tooling:
  analysis_tools:
  - tool: jest
    purpose: Watch mode testing
    command: jest --watch
  - tool: vitest
    purpose: Watch mode testing
    command: vitest
  - tool: watchman
    purpose: File watching
    command: watchman watch-project .
signals:
  critical:
  - id: WATCH-CRIT-001
    signal: Watch mode unavailable
    evidence_indicators:
    - No watch command
    - Manual re-runs required
    - Watch not supported by runner
    explanation: |
      Without watch mode, developers must manually re-run
      tests after every change, breaking flow.
    remediation: |
      Use test runner with watch mode support. Configure
      watch command in package.json.
  - id: WATCH-CRIT-002
    signal: Watch mode runs all tests on every change
    evidence_indicators:
    - Full suite on every save
    - No related test detection
    - Long waits after small changes
    explanation: |
      Running all tests defeats the purpose of watch mode
      for rapid feedback.
    remediation: |
      Configure related test detection. Use patterns to
      limit watched tests.
  high:
  - id: WATCH-HIGH-001
    signal: File changes not detected reliably
    remediation: |
      Use Watchman for better file watching. Check for
      polling vs native watch issues.
  - id: WATCH-HIGH-002
    signal: Watch mode resource intensive
    remediation: |
      Configure watch to ignore non-relevant directories.
      Optimize watched file patterns.
  - id: WATCH-HIGH-003
    signal: Cannot filter to specific tests in watch
    remediation: |
      Learn watch mode filter commands (p for pattern,
      t for test name in Jest).
  medium:
  - id: WATCH-MED-001
    signal: Watch re-run delay over 2 seconds
    remediation: |
      Profile watch mode startup. Consider Vitest for
      faster re-runs.
  - id: WATCH-MED-002
    signal: Related test detection inaccurate
    remediation: |
      Configure dependency tracking. Review heuristics
      for related test finding.
  - id: WATCH-MED-003
    signal: Watch mode UI confusing
    remediation: |
      Document watch mode commands and provide
      training on features.
  low:
  - id: WATCH-LOW-001
    signal: Watch mode features not documented
    remediation: |
      Document watch mode usage and available commands.
  - id: WATCH-LOW-002
    signal: No watch mode keyboard shortcuts
    remediation: |
      Configure or document keyboard shortcuts for
      common watch operations.
  positive:
  - id: WATCH-POS-001
    signal: Instant re-run on file changes
  - id: WATCH-POS-002
    signal: Accurate related test detection
  - id: WATCH-POS-003
    signal: Rich filtering and interaction
  - id: WATCH-POS-004
    signal: Low resource overhead
procedure:
  context:
    cognitive_mode: evaluative
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Test Watch Mode Availability
    description: Verify watch mode is configured
    duration_estimate: 15 min
  - id: '2'
    name: Measure Re-run Speed
    description: Time from file save to test results
    duration_estimate: 30 min
  - id: '3'
    name: Test Related Detection
    description: Verify correct tests run on changes
    duration_estimate: 30 min
  - id: '4'
    name: Evaluate Features
    description: Test filtering and interaction features
    duration_estimate: 30 min
  - id: '5'
    name: Gather Developer Feedback
    description: Interview developers about watch experience
    duration_estimate: 30 min
output:
  deliverables:
  - type: watch_assessment
    format: structured
    sections:
    - Availability check
    - Performance measurements
    - Feature evaluation
    - Developer feedback
  - type: finding_list
    format: structured
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Watch Mode Analysis
    - Recommendations
closeout_checklist:
- id: watch-001
  item: Watch mode tested
  level: ERROR
  verification: manual
- id: watch-002
  item: Performance measured
  level: WARNING
  verification: manual
- id: watch-003
  item: Developer feedback collected
  level: WARNING
  verification: manual
governance:
  applicable_to:
    archetypes:
    - all-software-projects
  compliance_mappings:
  - framework: ISO 27001
    control: A.14.2
    description: Security in development
relationships:
  commonly_combined:
  - developer-experience.testing-experience.test-execution-speed
  - developer-experience.local-development.hot-reload-performance
  depends_on:
  - devops-ci-cd.test-automation
  feeds_into:
  - developer-experience.productivity-metrics.developer-velocity
