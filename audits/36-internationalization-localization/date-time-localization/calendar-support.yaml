audit:
  id: internationalization-localization.date-time-localization.calendar-support
  name: Calendar System Support Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: internationalization-localization
  category_number: 36
  subcategory: date-time-localization
  tier: expert
  estimated_duration: 2-4 hours  # median: 3h
  completeness: requires_discovery
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: localization
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates support for non-Gregorian calendar systems used in various
    regions including Islamic (Hijri), Hebrew, Buddhist, Japanese Imperial,
    Persian, and others. Examines calendar conversion, display, date input,
    and holiday handling for these systems.
  why_it_matters: |
    Many regions use non-Gregorian calendars for official or cultural
    purposes. Saudi Arabia uses Hijri calendar officially, Thailand uses
    Buddhist calendar, Japan uses Imperial year. Supporting these calendars
    is essential for user trust and market fit.
  when_to_run:
  - Before launching in Middle East/Asia
  - When adding calendar features
  - During localization for specific regions
  - When implementing date pickers
prerequisites:
  required_artifacts:
  - type: source_code
    description: Application source code
  - type: i18n_config
    description: Calendar/date configuration
  - type: market_requirements
    description: Target market calendar requirements
  access_requirements:
  - Read access to source code
  - Access to running application
  - Knowledge of target market requirements
discovery:
  file_patterns:
  - glob: '**/*calendar*'
    purpose: Find calendar-related files
  - glob: '**/*hijri*'
    purpose: Find Islamic calendar implementation
  - glob: '**/*datepicker*'
    purpose: Find date picker components
knowledge_sources:
  guides:
  - id: icu-calendars
    name: ICU Calendar Types
    url: https://unicode-org.github.io/icu/userguide/datetime/calendar/
  - id: cldr-calendars
    name: CLDR Calendar Data
    url: https://cldr.unicode.org/development/development-process/design-proposals/extended-calendar-data
  standards:
  - id: icu
    name: ICU Calendar Support
    relevance: Calendar system standard
  - id: iso-8601
    name: ISO 8601
    relevance: Gregorian date standard
tooling:
  analysis_tools:
  - tool: intl
    purpose: JavaScript Intl.DateTimeFormat with calendar option
  - tool: moment-hijri
    purpose: Hijri calendar for Moment.js
    install: npm install moment-hijri
  - tool: luxon
    purpose: Calendar support in Luxon
    install: npm install luxon
signals:
  critical:
  - id: I18N-CAL-CRIT-001
    signal: Gregorian-only in region requiring other calendar
    evidence_indicators:
    - Only Gregorian dates displayed in Saudi market
    - No Hijri calendar option for Arabic users
    explanation: |
      Some regions legally or culturally require non-Gregorian calendars.
      Gregorian-only display is inappropriate and may be non-compliant.
    remediation: Implement required calendar system support
  high:
  - id: I18N-CAL-HIGH-001
    signal: Calendar conversion errors
    evidence_indicators:
    - Incorrect date conversions between calendars
    - Off-by-one errors in calendar math
    remediation: Use validated calendar conversion libraries
  - id: I18N-CAL-HIGH-002
    signal: Date picker doesn't support required calendars
    evidence_indicators:
    - Date picker Gregorian-only
    - No calendar switching in date input
    remediation: Implement multi-calendar date picker
  medium:
  - id: I18N-CAL-MED-001
    signal: Holidays not calendar-aware
    evidence_indicators:
    - Islamic holidays on fixed Gregorian dates
    - No lunar calendar holiday calculation
    remediation: Implement proper holiday calculation per calendar
  - id: I18N-CAL-MED-002
    signal: Year display not matching calendar
    evidence_indicators:
    - Buddhist year not showing +543 offset
    - Japanese Imperial year not used
    remediation: Display years in appropriate calendar system
  low:
  - id: I18N-CAL-LOW-001
    signal: Dual calendar display not available
    remediation: Consider showing both calendar systems
  - id: I18N-CAL-LOW-002
    signal: Week start day not localized
    remediation: Use locale-appropriate week start day
  positive:
  - id: I18N-CAL-POS-001
    signal: Full support for target market calendars
  - id: I18N-CAL-POS-002
    signal: Calendar switching available for users
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Identify Required Calendars
    description: Determine which calendars target markets need
    duration_estimate: 20 min
  - id: '2'
    name: Review Calendar Implementation
    description: Analyze current calendar support
    duration_estimate: 30 min
  - id: '3'
    name: Test Calendar Conversions
    description: Verify date conversion accuracy
    duration_estimate: 45 min
  - id: '4'
    name: Evaluate Date Pickers
    description: Test date input components
    duration_estimate: 30 min
  - id: '5'
    name: Check Holiday Handling
    description: Verify calendar-aware holidays
    duration_estimate: 20 min
  - id: '6'
    name: Document Findings
    description: Compile calendar support audit report
    duration_estimate: 30 min
output:
  deliverables:
  - type: calendar_assessment
    format: structured
    description: Calendar support status by system
  - type: conversion_validation
    format: tabular
    description: Calendar conversion test results
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Required Calendars
    - Current Support Status
    - Conversion Accuracy
    - Recommendations
closeout_checklist:
- id: i18n-cal-001
  item: Required calendars supported
  level: ERROR
  verification: manual
- id: i18n-cal-002
  item: Calendar conversions accurate
  level: WARNING
  verification: automated
- id: i18n-cal-003
  item: Date pickers support needed calendars
  level: WARNING
  verification: manual
governance:
  applicable_to:
    archetypes:
    - global-applications
    - middle-east-expansion
    - asia-expansion
    company_sizes:
    - startup
    - scaleup
    - enterprise
  compliance_mappings:
  - framework: Regional-Compliance
    control: Calendar Requirements
    description: Region-specific calendar requirements
  - framework: Market-Requirements
    control: Cultural Appropriateness
    description: Market cultural expectations
relationships:
  commonly_combined:
  - internationalization-localization.date-time-localization.date-format-consistency
  - internationalization-localization.content-localization.cultural-adaptation
  depends_on:
  - internationalization-localization.locale-detection.user-locale-detection
  feeds_into:
  - internationalization-localization.content-localization.holiday-handling
