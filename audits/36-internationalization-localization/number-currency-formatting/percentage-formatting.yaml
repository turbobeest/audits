audit:
  id: internationalization-localization.number-currency-formatting.percentage-formatting
  name: Percentage Formatting Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: internationalization-localization
  category_number: 36
  subcategory: number-currency-formatting
  tier: expert
  estimated_duration: 1-2 hours  # median: 1h
  completeness: requires_discovery
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: medium
  scope: localization
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates localization of percentage formatting including percent sign
    placement, spacing, decimal handling, and locale-specific conventions.
    Examines whether percentages like "25%" are displayed appropriately
    per locale (25%, 25 %, %25, etc.).
  why_it_matters: |
    Percentage formats vary by locale. French uses "25 %" (with space),
    Turkish puts percent sign before number "%25". Inconsistent or incorrect
    formatting appears unprofessional and can confuse users.
  when_to_run:
  - Before international launches
  - When implementing analytics dashboards
  - During discount/sale feature development
  - When displaying statistics
prerequisites:
  required_artifacts:
  - type: source_code
    description: Application source code
  - type: i18n_config
    description: Number formatting configuration
  - type: running_application
    description: Access to test percentage displays
  access_requirements:
  - Read access to source code
  - Access to running application
  - Ability to switch locales
discovery:
  file_patterns:
  - glob: '**/*percent*'
    purpose: Find percentage-related files
  - glob: '**/*format*.{js,ts,tsx}'
    purpose: Find formatting utilities
  - glob: '**/*discount*'
    purpose: Find discount displays
knowledge_sources:
  guides:
  - id: mdn-percent
    name: MDN Percentage Formatting
    url: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/NumberFormat
  - id: cldr-percent
    name: CLDR Percent Patterns
    url: https://cldr.unicode.org/translation/numbers-currency
  standards:
  - id: cldr
    name: Unicode CLDR
    relevance: Percentage format patterns
tooling:
  analysis_tools:
  - tool: intl-numberformat
    purpose: Built-in percentage formatting
  - tool: d3-format
    purpose: Data visualization formatting
    install: npm install d3-format
signals:
  critical:
  - id: I18N-PCT-CRIT-001
    signal: Percentage symbol hardcoded
    evidence_indicators:
    - value + '%' patterns
    - Always suffix percent sign
    explanation: |
      Hardcoded percent signs display incorrectly in locales
      where placement or spacing differs.
    remediation: 'Use Intl.NumberFormat with style: ''percent'''
  high:
  - id: I18N-PCT-HIGH-001
    signal: Percentage calculation displayed incorrectly
    evidence_indicators:
    - 0.25 shown as '0.25%' instead of '25%'
    - Confusion between decimal and percentage
    remediation: Ensure proper decimal to percentage conversion
  medium:
  - id: I18N-PCT-MED-001
    signal: Percentage decimal places inconsistent
    evidence_indicators:
    - Mix of '25%' and '25.00%'
    - Arbitrary precision
    remediation: Standardize percentage decimal precision
  - id: I18N-PCT-MED-002
    signal: Percentage spacing not localized
    evidence_indicators:
    - '''25%'' shown where ''25 %'' expected'
    - Space handling inconsistent
    remediation: Use locale percentage patterns from Intl
  low:
  - id: I18N-PCT-LOW-001
    signal: Negative percentage format not localized
    remediation: Use locale-appropriate negative format
  positive:
  - id: I18N-PCT-POS-001
    signal: Intl.NumberFormat used for all percentages
  - id: I18N-PCT-POS-002
    signal: Consistent percentage styling throughout
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Inventory Percentage Displays
    description: Find all percentage displays
    duration_estimate: 15 min
  - id: '2'
    name: Analyze Formatting Code
    description: Review percentage formatting
    duration_estimate: 20 min
    tools:
    - name: grep
      command: grep -rn 'percent\|%' --include='*.{js,ts,tsx}'
  - id: '3'
    name: Test Multiple Locales
    description: Verify formatting in different locales
    duration_estimate: 30 min
  - id: '4'
    name: Check Consistency
    description: Compare formats across features
    duration_estimate: 15 min
  - id: '5'
    name: Document Findings
    description: Compile percentage audit report
    duration_estimate: 15 min
output:
  deliverables:
  - type: percentage_inventory
    format: tabular
    description: All percentage displays
  - type: locale_testing
    format: structured
    description: Percentage display by locale
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Formatting Analysis
    - Locale Testing
    - Recommendations
closeout_checklist:
- id: i18n-pct-001
  item: Percentages use locale-aware formatting
  level: WARNING
  verification: automated
- id: i18n-pct-002
  item: Consistent percentage precision
  level: INFO
  verification: manual
governance:
  applicable_to:
    archetypes:
    - global-applications
    - analytics-platforms
    - e-commerce
    company_sizes:
    - startup
    - scaleup
    - enterprise
  compliance_mappings:
  - framework: UX-Standards
    control: Number Display
    description: Locale-appropriate numbers
relationships:
  commonly_combined:
  - internationalization-localization.number-currency-formatting.number-formats
  - internationalization-localization.number-currency-formatting.decimal-precision
  depends_on:
  - internationalization-localization.locale-detection.user-locale-detection
  feeds_into:
  - internationalization-localization.testing-validation.locale-coverage
