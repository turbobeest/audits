audit:
  id: internationalization-localization.content-localization.phone-formats
  name: Phone Number Format Localization Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: internationalization-localization
  category_number: 36
  subcategory: content-localization
  tier: expert
  estimated_duration: 2-3 hours  # median: 2h
  completeness: requires_discovery
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: localization
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates handling of international phone numbers including input formats,
    validation, storage, and display formatting. Examines country code handling,
    national vs international format, input masking, and phone type detection
    (mobile, landline).
  why_it_matters: |
    Phone number formats vary significantly by country. US numbers are 10 digits,
    UK numbers are 10-11 digits with different patterns, and Indian numbers are
    10 digits. Rigid validation rejects valid numbers, and poor formatting
    makes numbers hard to read.
  when_to_run:
  - Before international launches
  - When implementing phone input
  - During authentication system setup
  - After phone-related user complaints
prerequisites:
  required_artifacts:
  - type: source_code
    description: Phone input components
  - type: validation_config
    description: Phone validation rules
  - type: running_application
    description: Access to test forms
  access_requirements:
  - Read access to source code
  - Access to running application
  - Test phone numbers from different countries
discovery:
  file_patterns:
  - glob: '**/*phone*'
    purpose: Find phone-related files
  - glob: '**/*tel*'
    purpose: Find telephone components
  - glob: '**/auth*'
    purpose: Find authentication forms
knowledge_sources:
  guides:
  - id: libphonenumber
    name: Google libphonenumber
    url: https://github.com/google/libphonenumber
  - id: e164
    name: E.164 Format
    url: https://www.itu.int/rec/T-REC-E.164/
  standards:
  - id: e164
    name: ITU E.164
    relevance: International phone format
  - id: rfc-3966
    name: RFC 3966
    relevance: 'tel: URI format'
tooling:
  analysis_tools:
  - tool: libphonenumber-js
    purpose: Phone number parsing and formatting
    install: npm install libphonenumber-js
  - tool: react-phone-input-2
    purpose: Phone input component
    install: npm install react-phone-input-2
  - tool: awesome-phonenumber
    purpose: Phone number library
    install: npm install awesome-phonenumber
signals:
  critical:
  - id: I18N-PHONE-CRIT-001
    signal: Phone validation rejects valid international numbers
    evidence_indicators:
    - 10-digit only validation
    - International numbers fail validation
    explanation: |
      Rejecting valid phone numbers prevents users from
      registering or providing contact information.
    remediation: Use libphonenumber for validation
  - id: I18N-PHONE-CRIT-002
    signal: Country code handling incorrect
    evidence_indicators:
    - No country code selection
    - Country code stripped or lost
    explanation: |
      Without proper country code handling, phone numbers
      become invalid or undiallable.
    remediation: Implement proper country code handling
  high:
  - id: I18N-PHONE-HIGH-001
    signal: Phone stored in non-standard format
    evidence_indicators:
    - Inconsistent storage formats
    - Formatting characters in storage
    remediation: Store in E.164 format, format on display
  - id: I18N-PHONE-HIGH-002
    signal: Input mask breaks for international
    evidence_indicators:
    - US mask applied to all numbers
    - Input mask prevents valid entry
    remediation: Use country-adaptive input handling
  medium:
  - id: I18N-PHONE-MED-001
    signal: Display format not localized
    evidence_indicators:
    - US formatting for all numbers
    - No national format option
    remediation: Format numbers in national format for locale
  - id: I18N-PHONE-MED-002
    signal: No country code auto-detection
    evidence_indicators:
    - Users must manually select country
    - No detection from IP or profile
    remediation: Default country code based on locale
  low:
  - id: I18N-PHONE-LOW-001
    signal: Phone type not detected
    remediation: Consider mobile vs landline detection
  - id: I18N-PHONE-LOW-002
    signal: No click-to-call formatting
    remediation: 'Use tel: links for clickable numbers'
  positive:
  - id: I18N-PHONE-POS-001
    signal: Full international phone number support
  - id: I18N-PHONE-POS-002
    signal: E.164 storage with locale formatting
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Inventory Phone Inputs
    description: Find all phone input/display locations
    duration_estimate: 15 min
  - id: '2'
    name: Test International Numbers
    description: Test input with various country formats
    duration_estimate: 45 min
  - id: '3'
    name: Check Validation Logic
    description: Review phone validation implementation
    duration_estimate: 30 min
  - id: '4'
    name: Verify Storage Format
    description: Check how numbers are stored
    duration_estimate: 20 min
  - id: '5'
    name: Test Display Formatting
    description: Verify formatted display
    duration_estimate: 20 min
  - id: '6'
    name: Document Findings
    description: Compile phone format audit report
    duration_estimate: 20 min
output:
  deliverables:
  - type: phone_handling_analysis
    format: structured
    description: Phone number handling assessment
  - type: validation_testing
    format: tabular
    description: Validation test results by country
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Input Handling
    - Validation Review
    - Storage Format
    - Recommendations
closeout_checklist:
- id: i18n-phone-001
  item: International numbers accepted
  level: ERROR
  verification: automated
- id: i18n-phone-002
  item: Numbers stored in E.164 format
  level: WARNING
  verification: automated
- id: i18n-phone-003
  item: Country code handling correct
  level: WARNING
  verification: manual
governance:
  applicable_to:
    archetypes:
    - global-applications
    - e-commerce
    - communication-platforms
    company_sizes:
    - startup
    - scaleup
    - enterprise
  compliance_mappings:
  - framework: Data-Quality
    control: Phone Data
    description: Valid phone data collection
  - framework: Communication
    control: Contact Information
    description: Usable contact information
relationships:
  commonly_combined:
  - internationalization-localization.content-localization.address-formats
  - authentication.multi-factor
  depends_on:
  - internationalization-localization.locale-detection.user-locale-detection
  feeds_into:
  - communication.sms-delivery
