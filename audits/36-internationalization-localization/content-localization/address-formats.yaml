audit:
  id: internationalization-localization.content-localization.address-formats
  name: Address Format Localization Audit
  version: 1.0.0
  last_updated: '2025-01-22'
  status: active
  category: internationalization-localization
  category_number: 36
  subcategory: content-localization
  tier: expert
  estimated_duration: 2-4 hours  # median: 3h
  completeness: requires_discovery
  requires_runtime: true
  destructive: false
execution:
  automatable: partial
  severity: high
  scope: localization
  default_profiles:
  - full
  - quick
  blocks_phase: false
  parallelizable: true
description:
  what: |
    Evaluates handling of international address formats including field labels,
    field order, required fields, postal code formats, and display formatting.
    Examines whether address forms and displays adapt to country-specific
    conventions.
  why_it_matters: |
    Address formats vary dramatically by country. Japan puts postal code first,
    UK has no state field, Germany uses 5-digit postal codes. Forcing US-style
    address forms causes user frustration, data quality issues, and shipping
    problems.
  when_to_run:
  - Before shipping to new countries
  - When implementing address forms
  - During e-commerce localization
  - After address-related user complaints
prerequisites:
  required_artifacts:
  - type: source_code
    description: Address form components
  - type: address_config
    description: Address format configuration
  - type: running_application
    description: Access to test forms
  access_requirements:
  - Read access to source code
  - Access to running application
  - Ability to test different countries
discovery:
  file_patterns:
  - glob: '**/*address*'
    purpose: Find address-related files
  - glob: '**/*checkout*'
    purpose: Find checkout forms
  - glob: '**/*shipping*'
    purpose: Find shipping components
knowledge_sources:
  guides:
  - id: google-address
    name: Google Address Components
    url: https://developers.google.com/maps/documentation/javascript/examples/places-autocomplete-addressform
  - id: universal-postal
    name: Universal Postal Union
    url: https://www.upu.int/en/Postal-Solutions/Programmes-Services/Addressing-Solutions
  standards:
  - id: cldr-addresses
    name: CLDR Address Formats
    relevance: Country address patterns
  - id: iso-3166
    name: ISO 3166
    relevance: Country codes
tooling:
  analysis_tools:
  - tool: libaddressinput
    purpose: Google address data library
  - tool: '@shopify/address'
    purpose: Address formatting library
    install: npm install @shopify/address
  - tool: postal-codes-js
    purpose: Postal code validation
    install: npm install postal-codes-js
signals:
  critical:
  - id: I18N-ADDR-CRIT-001
    signal: US address format forced for all countries
    evidence_indicators:
    - State field required for all addresses
    - ZIP code (5-digit) validation for all
    explanation: |
      US-only address forms prevent users in other countries
      from entering valid addresses.
    remediation: Implement country-specific address formats
  - id: I18N-ADDR-CRIT-002
    signal: Postal code validation fails for valid formats
    evidence_indicators:
    - UK postcodes rejected
    - International postal codes fail
    remediation: Use country-specific postal code validation
  high:
  - id: I18N-ADDR-HIGH-001
    signal: Required fields wrong for country
    evidence_indicators:
    - State required where not applicable
    - Province field missing for Canada
    remediation: Adjust required fields per country
  - id: I18N-ADDR-HIGH-002
    signal: Field order doesn't match country convention
    evidence_indicators:
    - Name after address in Japan
    - Wrong ordering for target country
    remediation: Use country-specific field ordering
  medium:
  - id: I18N-ADDR-MED-001
    signal: Field labels not localized
    evidence_indicators:
    - '''ZIP Code'' instead of ''Postal Code'''
    - '''State'' for all countries'
    remediation: Use country-appropriate field labels
  - id: I18N-ADDR-MED-002
    signal: Address display format incorrect
    evidence_indicators:
    - All addresses displayed in US format
    - Wrong line breaks or ordering
    remediation: Format displayed addresses per country
  low:
  - id: I18N-ADDR-LOW-001
    signal: No address autocomplete for international
    remediation: Consider international address autocomplete
  - id: I18N-ADDR-LOW-002
    signal: Country dropdown not optimized
    remediation: Sort countries appropriately, show common first
  positive:
  - id: I18N-ADDR-POS-001
    signal: Dynamic address forms per country
  - id: I18N-ADDR-POS-002
    signal: Country-specific validation and formatting
procedure:
  context:
    cognitive_mode: analytical
    ensemble_role: auditor
  steps:
  - id: '1'
    name: Inventory Address Forms
    description: Find all address input/display locations
    duration_estimate: 20 min
  - id: '2'
    name: Test Multiple Countries
    description: Test address forms for key countries
    duration_estimate: 60 min
  - id: '3'
    name: Check Validation Rules
    description: Verify postal code and field validation
    duration_estimate: 30 min
  - id: '4'
    name: Review Field Configuration
    description: Analyze address field configuration
    duration_estimate: 30 min
  - id: '5'
    name: Check Display Formatting
    description: Verify address display formatting
    duration_estimate: 20 min
  - id: '6'
    name: Document Findings
    description: Compile address format audit report
    duration_estimate: 30 min
output:
  deliverables:
  - type: address_form_analysis
    format: structured
    description: Address form configuration by country
  - type: validation_testing
    format: tabular
    description: Validation test results by country
  - type: summary
    format: prose
    sections:
    - Executive Summary
    - Address Form Analysis
    - Validation Review
    - Country Coverage
    - Recommendations
closeout_checklist:
- id: i18n-addr-001
  item: Address forms adapt to country
  level: ERROR
  verification: manual
- id: i18n-addr-002
  item: Postal codes validated correctly
  level: ERROR
  verification: automated
- id: i18n-addr-003
  item: Field labels appropriate per country
  level: WARNING
  verification: manual
governance:
  applicable_to:
    archetypes:
    - e-commerce
    - shipping-logistics
    - global-applications
    company_sizes:
    - startup
    - scaleup
    - enterprise
  compliance_mappings:
  - framework: E-Commerce
    control: Address Handling
    description: Proper address collection
  - framework: Shipping
    control: Address Accuracy
    description: Deliverable address requirements
relationships:
  commonly_combined:
  - internationalization-localization.content-localization.phone-formats
  - e-commerce.checkout-experience
  depends_on:
  - internationalization-localization.locale-detection.user-locale-detection
  feeds_into:
  - e-commerce.shipping-fulfillment
